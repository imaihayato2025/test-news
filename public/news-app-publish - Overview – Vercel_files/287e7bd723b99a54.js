
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="4413f9e5-92a3-533a-a867-2cc47426ee4d")}catch(e){}}();
(globalThis.TURBOPACK=globalThis.TURBOPACK||[]).push(["object"==typeof document?document.currentScript:void 0,{1093907:[e=>{"use strict";e.s({DeploymentTypeSelector:()=>S},1093907);var t=e.i(6645307),r=e.i(555528),i=e.i(8084653),n=e.i(889716),s=e.i(4105925),o=e.i(6530772),a=e.i(5938635),l=e.i(4760712),d=e.i(2362802),c=e.i(4418725),u=e.i(7753619),p=e.i(8673823),h=e.i(1049058),m=e.i(6859825),g=e.i(9505396);e.s({Selector:()=>w},9215364);var y=e.i(9948746),f=e.i(4237550),x=e.i(653558),j=e.i(2733203),b=e.i(1190215),v=e.i(6192985);function w(e){let{values:a,selectedValue:l,onChange:d,disabled:c,ariaLabel:u,width:p,className:h,children:m}=e,[g,w]=(0,o.useState)(!1),I=Object.entries(a).map(e=>{let[t,r]=e;return{value:t,...r}});return(0,t.jsxs)(b.MenuContainer,{position:"bottom-end",children:[(0,t.jsx)(j.MenuButton,{align:"start","aria-label":u,disabled:c,onClick:()=>w(!1),shape:"square",style:{padding:"0 var(--geist-gap-half)",width:p},suffix:(0,t.jsx)(f.ChevronDown,{}),svgOnly:!0,type:"secondary",typeName:"button",className:h,children:(0,t.jsx)(i.Text,{children:a[l].label})}),(0,t.jsxs)(x.Menu,{style:{display:g?"none":void 0},width:p+160,children:[I.map(e=>{let{value:a,label:c,description:u,disabledDescription:p,legacy:h,upgradeButton:m,divider:f}=e;return f?(0,t.jsx)(v.MenuDivider,{},a):(0,t.jsx)(s.MenuItem,{disabled:!!p,onClick:()=>{a!==l&&d(a)},style:{height:"auto",padding:"var(--geist-space-gap-quarter)",pointerEvents:p?"auto":"inherit",cursor:p?"not-allowed":"pointer"},suffix:l===a?(0,t.jsx)(y.Check,{}):null,children:(0,t.jsx)(r.Tooltip,{delay:!1,desktopOnly:!0,disableTriggers:!p,forceHide:g,maxWidth:324,position:"right",style:{width:"100%"},text:p,children:(0,t.jsxs)(n.Stack,{align:"center",direction:"row",gap:2,justify:"space-between",style:{width:"100%"},children:[(0,t.jsxs)(n.Stack,{justify:"center",children:[(0,t.jsx)(i.Text,{color:p||h?"gray-700":"gray-1000",children:c}),(0,t.jsx)(i.Text,{color:p||h?"gray-700":"gray-900",children:u})]}),m?(0,o.cloneElement)(m,{onClick:()=>{w(!0),m.props?.onClick?.()}}):null]})})},a)}),m]})]})}var I=e.i(3326412);let P=e=>{let{productionAliases:s,recommended:o,newDpStandardProtection:a}=e,c=s?.length||0,u="Standard Protection";a?u="(Legacy) Standard Protection":o&&(u="Standard Protection (recommended)");let p=s?.find(e=>e.includes("-git-"));return{label:u,legacy:!!a,description:(0,t.jsxs)(i.Text,{as:"span",color:"inherit",children:["Protect all except the"," ",(0,t.jsx)(r.Tooltip,{desktopOnly:!0,maxWidth:350,text:(0,t.jsxs)(n.Stack,{gap:2,children:[(0,t.jsxs)(i.Text,{children:["Only"," ",c>1?`these ${c} domains`:"this domain"," ","will be publicly accessible."]}),(0,t.jsx)("span",{className:"flex flex-wrap gap-1",children:s?.slice(0,20)?.map(e=>(0,t.jsx)(l.default,{icon:!0,title:e,truncate:!0,url:e}))}),c>20?(0,t.jsx)(i.Text,{children:(0,t.jsx)(d.Link,{href:"domains",variant:"underline",children:"See all project domains"})}):null]}),children:(0,t.jsx)("u",{style:{cursor:"help",textDecorationStyle:"dotted",textUnderlineOffset:2},children:"up-to-date Production Domains"})})," ","for your project."," ",a?`This does not include auto-generated production domains${p?`, such as ${p}`:""}`:"Protect all other requests","."]})}},T={label:"Production Deployments",description:"Protect only production deployments."},k={label:"All Deployments",description:"Protect all domains."};function S(e){let{overrides:y,project:f,selectedValue:x,currentValue:j,...b}=e,{value:v}=(0,I.useLaunchDarklyTeamFeatureFlag)("new-dp-standard-protection"),{data:S}=(0,a.default)(f?.targets?.production?.id),{allAliases:C}=function(e,t){let{isLoggedOut:r}=(0,u.useIsLoggedIn)(),i=(0,c.useTeamSlug)()??void 0,{data:n,mutate:s,isLoading:a}=(0,p.useAliasesV2)({deploymentId:e?.id,teamId:i},void 0),l=a?void 0:n||{aliases:[]},d=(0,o.useRef)({branchDomain:"",otherDomains:[],allAliases:[],isLoading:!r,mutate:s}),y=(0,m.getGitMeta)(e?.meta)?.branchName,{data:f,isLoading:x}=(0,g.useProjectDomains)(y&&e?.projectId,{gitBranch:y});if(l?.aliases&&(d.current.isLoading||l.aliases.length)){let t=l.aliases.slice(),r=e?.meta.branchAlias||"";for(let{name:e}of(r&&!t.some(e=>e.alias===r)&&t.push({alias:r,uid:"",createdAt:0,updatedAt:0}),(x?void 0:f||[])??[]))t.some(t=>t.alias===e)||t.push({alias:e,uid:"",createdAt:0,updatedAt:0});let i=(0,h.getSortedNonRedirectDomains)(t.map(e=>({name:e.alias,...e}))),o=i.map(e=>e.name);if(e?.meta.branchAlias){let e=o.indexOf(r);-1!==e&&o.splice(e,1)}d.current={branchAlias:t.find(e=>e.alias===r),branchDomain:r,otherDomains:o,allAliases:i,isLoading:a&&!n||x&&!f,mutate:s}}return d.current.mutate=s,d.current}(S),A=C.map(e=>{let{alias:t}=e;return t}),[E,{domains:_}]=(0,g.useProjectDomainsInfinite)(f?.id,{production:!0,redirects:!1}),D="prod_deployment_urls_and_all_previews"===j||"preview"===j,R=D||f?.createdAt&&new Date(f.createdAt)<new Date("2025-07-21"),[M,O]=(0,o.useState)(D),N={...v?{all_except_custom_domains:{...(e=>{let{protectedDomains:s}=e,o=s?.length||0;return{label:"Standard Protection",description:(0,t.jsxs)(i.Text,{as:"span",color:"inherit",children:["Protect all except production"," ",(0,t.jsx)(r.Tooltip,{desktopOnly:!0,maxWidth:350,text:(0,t.jsxs)(n.Stack,{gap:2,children:[(0,t.jsxs)(i.Text,{children:["Only ",o>1?`these ${o} domains`:"this domain"," will be publicly accessible."]}),(0,t.jsx)("span",{className:"flex flex-wrap gap-1",children:s?.slice(0,20)?.map(e=>(0,t.jsx)(l.default,{icon:!0,title:e,truncate:!0,url:e}))}),o>20?(0,t.jsx)(i.Text,{children:(0,t.jsx)(d.Link,{href:"domains",variant:"underline",children:"See all project domains"})}):null]}),children:(0,t.jsx)("u",{style:{cursor:"help",textDecorationStyle:"dotted",textUnderlineOffset:2},children:"Custom Domains"})})," ","for your project."]})}})({protectedDomains:_.map(e=>{let{name:t}=e;return t})}),...y?.all_except_custom_domains}}:void 0,...v?void 0:{prod_deployment_urls_and_all_previews:{...P({productionAliases:A,recommended:y?.prod_deployment_urls_and_all_previews?.recommended,newDpStandardProtection:v}),...y?.prod_deployment_urls_and_all_previews}},...y?.production?{production:{...T,...y.production}}:{},all:{...k,...y?.all},...!v||M?{...v?{divider:{divider:!0},prod_deployment_urls_and_all_previews:{...P({productionAliases:A,recommended:y?.prod_deployment_urls_and_all_previews?.recommended,newDpStandardProtection:v}),...y?.prod_deployment_urls_and_all_previews}}:{},preview:{...(e=>{let{newDpStandardProtection:t}=e;return{legacy:!!t,label:t?"(Legacy) Pre-Production Deployments":"Only Pre-Production Deployments",description:"Protect only Pre-Production Deployments. This does not include past production deployments."}})({newDpStandardProtection:v}),...y?.preview}}:void 0};return(0,t.jsx)(w,{ariaLabel:"Select the deployment type for the protection",values:N,width:300,selectedValue:x,...b,children:v&&R&&!M?(0,t.jsx)(s.MenuItem,{onClick:e=>{e.preventDefault(),O(!0)},innerMenuItemClassName:"h-8",children:(0,t.jsx)("span",{className:"text-center w-full inline-block text-gray-900 text-sm cursor-pointer",role:"button",children:"See legacy options"})}):null})}},[9215364]],1931079:e=>{"use strict";e.s({ExceptionsInfo:()=>o});var t=e.i(6645307),r=e.i(6465700),i=e.i(6530772),n=e.i(555528),s=e.i(5610210);function o(e){let{project:o,className:a}=e,l=(0,i.useMemo)(()=>{if(!o)return null;let e=[];return o.trustedIps&&("additional"===o.trustedIps.protectionMode?e.push("Additionally, only visitors from an IP address in Trusted IPs can access deployments."):e.push("Visitors from an allowed IP address in Trusted IPs will bypass protection.")),e.push("Shareable Links, Protection Bypass for Automation, and Deployment Protection Exceptions will bypass protection."),e.join(" ")},[o]);return(0,t.jsx)(n.Tooltip,{text:l,className:(0,s.clsx)("cursor-pointer",a),children:(0,t.jsx)(r.InformationFillSmall,{})})}},8116508:e=>{"use strict";e.s({PasswordProtection:()=>C});var t=e.i(6645307),r=e.i(6530772),i=e.i(889716),n=e.i(8084653),s=e.i(9495609),o=e.i(584439),a=e.i(2362802),l=e.i(7573892),d=e.i(9802771),c=e.i(503726),u=e.i(3585235),p=e.i(5785123),h=e.i(7581255),m=e.i(1155472),g=e.i(2408607),y=e.i(2240289),f=e.i(7200618),x=e.i(1389821),j=e.i(5193454),b=e.i(6958389),v=e.i(1093907),w=e.i(1931079),I=e.i(3326412),P=e.i(3128293);let T="__VERCEL_PASS__";function k(){let e=(0,o.useToasts)(),m=(0,x.useProjectIdOrName)(),{data:k,mutate:C}=(0,y.useProject)(m,{apiVersion:"v10"}),A=(0,c.useAccount)(),{can:E,isLoading:_}=(0,u.default)(),{user:D,team:R}=A,[M,O]=(0,r.useState)(!!k?.passwordProtection),[N,L]=(0,r.useState)(""),{value:$}=(0,I.useLaunchDarklyTeamFeatureFlag)("new-dp-standard-protection"),B=$?"all_except_custom_domains":"prod_deployment_urls_and_all_previews",[V,F]=(0,r.useState)(k?.passwordProtection?.deploymentType||B),[H,z]=(0,r.useState)(!1),[U,q]=(0,r.useState)(null),[W,Y]=(0,r.useState)(!1),G=(0,r.useCallback)(async()=>{z(!0);try{l.analytics.track(d.AnalyticsEvent.DEPLOYMENT_PROTECTION_TOGGLE_PASSWORD_PROTECTION,{enabled:M,protectProductionEnvironment:"all"===V,projectId:m}),q(null);let t=N&&N!==T?N:null;await (0,g.default)(m,R?.id,{passwordProtection:M?{deploymentType:V,password:t||void 0}:null}),e.success("Updated Password Protection successfully."),await C()}catch(e){q(e.message)}z(!1),Y(!1)},[m,C,R,e,M,V,N]),J=(0,r.useCallback)(e=>{O(e),Y(!0)},[]),K=(0,r.useCallback)(()=>{N===T&&L("")},[N]),Z=(0,r.useCallback)(()=>{""===N&&k?.passwordProtection&&L(T)},[k?.passwordProtection,N]),Q=(0,r.useCallback)(e=>{L(e),Y(!0)},[]),X=(0,r.useCallback)(e=>{F(e),Y(!0)},[]);(0,r.useEffect)(()=>{O(!!k?.passwordProtection),L(k?.passwordProtection?T:""),F(k?.passwordProtection?.deploymentType||B)},[k?.passwordProtection,B]);let{addOn:ee,isADPEnabled:et,enableADP:er,ADPModal:ei}=(0,j.useToggleAdvancedDeploymentProtection)("project-settings-password-protection"),{enabled:en,message:es,action:eo}=(0,f.default)({addOn:ee,isEnabled:et,enable:er,modal:ei}),ea=!k||!(R||D)||_,el=E(p.Action.Update,p.Resource.Project),ed=E(p.Action.Create,p.Resource.PasswordProtection),ec=el&&N&&W,eu=(0,r.useCallback)(()=>el?en?(0,t.jsxs)(n.Text,{color:"gray-900",children:["Learn more about"," ",(0,t.jsx)(a.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-protect-deployments/password-protection",type:"highlight",children:"Password Protection"})]}):ed?es:(0,t.jsxs)(n.Text,{lineHeight:32,color:"gray-900",children:["You need additional permissions to enable"," ",(0,t.jsx)(a.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-protect-deployments/password-protection",type:"highlight",children:"Password Protection"})," ","for your project."]}):(0,t.jsxs)(n.Text,{lineHeight:32,color:"gray-900",children:["You need additional permissions to manage your project's"," ",(0,t.jsx)(a.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-protect-deployments/password-protection",type:"highlight",children:"Password Protection"}),"."]}),[el,en,es,ed]);if(ea)return(0,t.jsx)(S,{});let ep=H||!M,eh=!el||!en;return(0,t.jsx)(b.ProjectSettingsFieldset,{action:ed?eo:void 0,description:"Ensures visitors to your deployments must enter a password in order to gain access.",disabled:!el,disabledForBilling:eh,error:U,highlightNote:!el,headerNote:M?(0,t.jsx)(P.MicrofrontendsHelpBadge,{childHelp:"This configuration only applies to domains belonging to this project.",parentHelp:"This configuration applies to production and pre-production deployments for the group."}):null,note:eu(),onSave:en?G:null,saveDisabled:!ec,saveLoading:H,title:"Password Protection",children:(0,t.jsxs)(i.Stack,{gap:4,children:[(0,t.jsxs)(i.Stack,{align:"center",direction:"row",gap:{sm:2,md:4,lg:4},className:"flex-wrap justify-between md:justify-start",children:[(0,t.jsx)(i.Stack,{align:"center",direction:"row",gap:2,style:{padding:"var(--geist-gap-quarter) 0"},children:(0,t.jsx)(s.Toggle,{"aria-labelledby":"label-for-password-protection-enabled-toggle",checked:M,direction:"switch-first",onChange:J,size:"large",children:(0,t.jsx)(n.Text,{color:eh?"gray-800":void 0,id:"label-for-password-protection-enabled-toggle",transform:"none",weight:500,children:M?"Enabled for":"Disabled"})})}),M?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v.DeploymentTypeSelector,{disabled:ep,onChange:X,currentValue:k?.passwordProtection?.deploymentType,overrides:$?{all_except_custom_domains:{recommended:!0}}:{prod_deployment_urls_and_all_previews:{recommended:!0}},project:k,selectedValue:V,className:"order-3 md:order-none"}),(0,t.jsx)(w.ExceptionsInfo,{project:k,className:"order-2 md:order-none"})]}):null]}),(0,t.jsx)(i.Stack,{gap:4,children:(0,t.jsxs)(i.Stack,{gap:2,children:[(0,t.jsx)(n.Text,{color:"gray-900",id:"label-for-password-protection-password-input",size:12,transform:"uppercase",weight:500,children:"Password"}),(0,t.jsx)(h.default,{"aria-labelledby":"label-for-password-protection-password-input",autoFocus:W,disabled:ep,maxLength:72,onBlur:Z,onChange:e=>Q(e.target.value),onFocus:K,placeholder:ep?"":"Enter password",typeName:"password",value:N,width:"290px"},`input-focus-on-change-${M.toString()}`)]})})]})})}function S(){return(0,t.jsx)(m.default,{height:170})}function C(){return(0,t.jsx)(r.Suspense,{fallback:(0,t.jsx)(S,{}),children:(0,t.jsx)(k,{})})}},1350841:e=>{"use strict";e.s({VercelAuth:()=>A});var t=e.i(6645307),r=e.i(6530772),i=e.i(889716),n=e.i(8084653),s=e.i(9495609),o=e.i(555528),a=e.i(584439),l=e.i(2362802),d=e.i(7573892),c=e.i(9802771),u=e.i(854226),p=e.i(2781454),h=e.i(503726),m=e.i(3585235),g=e.i(5785123),y=e.i(1155472),f=e.i(2408607),x=e.i(2240289),j=e.i(1389821),b=e.i(7200618),v=e.i(5193454),w=e.i(6958389),I=e.i(1093907),P=e.i(1931079),T=e.i(3326412),k=e.i(3128293);function S(){let e=(0,j.useProjectIdOrName)(),{data:y,mutate:S}=(0,x.useProject)(e,{apiVersion:"v10"}),{user:A,team:E}=(0,h.useAccount)(),{can:_,isLoading:D}=(0,m.default)(),[R,M]=(0,r.useState)(!!y?.ssoProtection),{value:O}=(0,T.useLaunchDarklyTeamFeatureFlag)("new-dp-standard-protection"),N=O?"all_except_custom_domains":"prod_deployment_urls_and_all_previews",[L,$]=(0,r.useState)(y?.ssoProtection?.deploymentType||N),[B,V]=(0,r.useState)(!1),[F,H]=(0,r.useState)(null),z=(0,a.useToasts)(),{track:U}=(0,u.useTrackActivity)(),q=E?.standaloneTrustedIps?.enabled||!1,W=y?.trustedIps?.deploymentType&&"production"!==y.trustedIps.deploymentType,Y=(0,r.useCallback)(async()=>{V(!0),H(null);try{d.analytics.track(c.AnalyticsEvent.DEPLOYMENT_PROTECTION_TOGGLE_VERCEL_AUTHENTICATION,{enabled:R,protectProductionEnvironment:"all"===L,projectId:e}),U(p.VercelActivityAction.ProjectSettingsUpdated,{name:"vercel-authentication",projectId:e,teamId:E?.id||"",value:{enabled:R,deploymentType:L}}),await (0,f.default)(e,E?.id,{ssoProtection:R?{deploymentType:L}:null}),z.success("Updated Vercel Authentication successfully."),await S()}catch(e){H(e.message)}V(!1)},[e,S,E,z,R,L,U]),G=(0,r.useCallback)(()=>{M(!R)},[M,R]),J=(0,r.useCallback)(e=>{$(e)},[]);(0,r.useEffect)(()=>{M(!!y?.ssoProtection),$(y?.ssoProtection?.deploymentType||N)},[y?.ssoProtection,N]);let{addOn:K,isADPEnabled:Z,enableADP:Q,ADPModal:X}=(0,v.useToggleAdvancedDeploymentProtection)("project-settings-vercel-auth"),{message:ee,action:et}=(0,b.default)({addOn:K,isEnabled:Z,enable:Q,modal:X}),er=!y||!(E||A)||D,ei=_(g.Action.Update,g.Resource.Project);if(er)return(0,t.jsx)(C,{});let en=null===E&&A?.billing?.plan==="hobby",es=!!y.ssoProtection!==R||y.ssoProtection?.deploymentType&&y.ssoProtection.deploymentType!==L,eo=!q&&W;return(0,t.jsx)(w.ProjectSettingsFieldset,{description:(0,t.jsx)(i.Stack,{as:"span",gap:4,children:en?(0,t.jsx)(n.Text,{as:"span",children:"Ensures visitors to your deployments are logged in to Vercel."}):(0,t.jsx)(n.Text,{as:"span",children:"Ensures visitors to your deployments are logged in to Vercel and are a member of your team."})}),disabled:!ei,error:F,highlightNote:!ei,note:ei?(0,t.jsxs)(n.Text,{color:"gray-900",children:["Learn more about"," ",(0,t.jsx)(l.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-protect-deployments/vercel-authentication",type:"highlight",children:"Vercel Authentication"})]}):(0,t.jsxs)(n.Text,{lineHeight:32,color:"gray-900",children:["You need additional permissions to manage your project's"," ",(0,t.jsx)(l.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-protect-deployments/vercel-authentication",type:"highlight",children:"Vercel Authentication"})]}),onSave:Y,saveDisabled:!es,saveLoading:B,title:"Vercel Authentication",headerNote:(0,t.jsx)(k.MicrofrontendsHelpBadge,{childHelp:(0,t.jsxs)(t.Fragment,{children:["This configuration applies only to this project's domains. It's recommended to protect"," ",(0,t.jsx)(n.Text,{as:"span",weight:500,color:"inherit",children:"All Deployments"})," ","for a child microfrontends project."]}),parentHelp:(0,t.jsxs)(t.Fragment,{children:["This configuration applies to production and pre-production deployments for the group. It's recommended to use"," ",(0,t.jsx)(n.Text,{as:"span",weight:500,color:"inherit",children:"Standard Protection"})," ","for the default app microfrontends project."]})}),children:(0,t.jsx)(i.Stack,{gap:4,children:(0,t.jsxs)(i.Stack,{align:"center",direction:"row",gap:{sm:2,md:4,lg:4},className:"flex-wrap justify-between md:justify-start",children:[(0,t.jsx)(i.Stack,{align:"center",direction:"row",gap:2,style:{padding:"var(--geist-gap-quarter) 0"},children:(0,t.jsx)(o.Tooltip,{desktopOnly:!0,forceHide:!R||!eo,text:"Trusted IPs can not be enabled in preview environments without Vercel Authentication.",children:(0,t.jsx)(s.Toggle,{"aria-labelledby":"label-for-vercel-auth-enabled-toggle",checked:R,direction:"switch-first",disabled:!!(R&&eo),onChange:G,size:"large",children:(0,t.jsx)(n.Text,{id:"label-for-vercel-auth-enabled-toggle",transform:"none",weight:500,children:R?"Enabled for":"Disabled"})})})}),R?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(I.DeploymentTypeSelector,{disabled:B,onChange:J,currentValue:y?.ssoProtection?.deploymentType,overrides:{...O?{all_except_custom_domains:{recommended:!0}}:{prod_deployment_urls_and_all_previews:{recommended:!0}},all:{disabledDescription:ee,upgradeButton:et}},project:y,selectedValue:L,className:"order-3 md:order-none"}),(0,t.jsx)(P.ExceptionsInfo,{project:y,className:"order-2 md:order-none"})]}):null]})})})}function C(){return(0,t.jsx)(y.default,{height:88})}function A(){return(0,t.jsx)(r.Suspense,{fallback:(0,t.jsx)(C,{}),children:(0,t.jsx)(S,{})})}},2984153:e=>{e.v({autoHeight:"deployment-protection-module__HaauuW__autoHeight",minHeight:"deployment-protection-module__HaauuW__minHeight",noBorder:"deployment-protection-module__HaauuW__noBorder",snippetButton:"deployment-protection-module__HaauuW__snippetButton"})},8142727:e=>{"use strict";e.s({AnimatedNote:()=>l});var t=e.i(6645307),r=e.i(6621512),i=e.i(3277953),n=e.i(889716),s=e.i(8158100),o=e.i(2726686),a=e.i(2769324);function l(e){let{type:l,keyName:d,children:c}=e;return(0,t.jsx)(a.AnimatePresence,{children:c?(0,t.jsx)(o.m.div,{animate:{height:"auto",opacity:1,marginTop:0},exit:{height:0,opacity:0,marginTop:"var(--geist-space-4x-negative)"},initial:{height:0,opacity:0,marginTop:"var(--geist-space-4x-negative)"},style:{overflow:"hidden"},transition:{ease:"easeInOut"},children:(0,t.jsx)(s.Note,{fill:!0,label:!1,style:{backgroundColor:"warning"===l?void 0:"var(--ds-gray-100)",border:"none",color:"warning"===l?void 0:"var(--accents-6)"},type:l,variant:"contrast",children:(0,t.jsxs)(n.Stack,{align:"center",direction:"row",gap:2,children:["warning"===l?(0,t.jsx)(i.Warning,{className:"-mb-px shrink-0"}):(0,t.jsx)(r.Information,{className:"shrink-0"}),c]})})},d):null})}},9996641:e=>{"use strict";e.s({AutomationBypass:()=>K});var t=e.i(6645307),r=e.i(6530772),i=e.i(5610210),n=e.i(5674541),s=e.i(8934201),o=e.i(889716),a=e.i(8084653),l=e.i(584439),d=e.i(555528),c=e.i(4105925),u=e.i(631755),p=e.i(4646240),h=e.i(5163670),m=e.i(5175803),g=e.i(5015782),y=e.i(1635782),f=e.i(2362802),x=e.i(7573892),j=e.i(9802771),b=e.i(503726),v=e.i(3509620),w=e.i(4652282),I=e.i(3585235),P=e.i(5785123),T=e.i(7337588),k=e.i(3604170),S=e.i(2145411),C=e.i(2240289),A=e.i(1389821),E=e.i(7267582),_=e.i(3813724),D=e.i(8582756),R=e.i(5124991),M=e.i(6683076),O=e.i(1155472),N=e.i(6958389),L=e.i(2984153),$=e.i(8142727),B=e.i(6799491),V=e.i(674684),F=e.i(4049272),H=e.i(4418725),z=e.i(3128293);let U="VERCEL_AUTOMATION_BYPASS_SECRET";function q(){let e=(0,A.useProjectIdOrName)(),{data:s,mutate:h}=(0,C.useProject)(e,{apiVersion:"v10"}),{can:m,isLoading:g}=(0,I.default)(),{user:y,team:T}=(0,b.useAccount)(),k=s?(0,E.getProtectionBypass)(s,"automation-bypass"):null,[S,D]=(0,r.useState)(null),[O,N]=(0,r.useState)(!1),[B,V]=(0,r.useState)(null),[F,H]=(0,r.useState)(!1),q=(0,r.useRef)(null),[K,Z]=(0,r.useState)(null),Q=!s||!(T||y)||g,X=m(P.Action.Update,P.Resource.Project),ee=m(P.Action.Read,P.Resource.ProjectProtectionBypass),et=X&&m(P.Action.Delete,P.Resource.ProjectProtectionBypass),er=X&&m(P.Action.Update,P.Resource.ProjectProtectionBypass),ei=X&&m(P.Action.Create,P.Resource.ProjectProtectionBypass),en=(0,r.useCallback)(async t=>{D(null),N(!0);try{let r="Created";switch(t.revoke&&(r=t.generate?.secret?"Updated":t.revoke.regenerate?"Regenerated":"Deleted"),r){case"Deleted":case"Created":x.analytics.track(j.AnalyticsEvent.DEPLOYMENT_PROTECTION_TOGGLE_BYPASS_FOR_AUTOMATION,{enabled:"Created"===r,projectId:e});break;case"Updated":case"Regenerated":x.analytics.track(j.AnalyticsEvent.DEPLOYMENT_PROTECTION_REGENERATE_BYPASS_HEADER,{projectId:e})}await (0,_.updateProjectProtectionBypass)({teamId:T?.id,projectIdOrName:e,body:t}),l.toasts.success(`${r} Automation Bypass successfully.`)}catch(e){D(`Request failed: ${e.message}`)}await h(),N(!1)},[e,T?.id,h]),es=async(e,t)=>{let{value:r}=t;if(!r)throw Error("Please enter a 32 character secret.");if(32!==r.length)throw Error(`Secret must be 32 characters long. Currently it is ${r.length} characters long.`);if(!/^[a-zA-Z0-9]{32}$/.test(r))throw Error("Secret can only contain letters and numbers.");return en({revoke:{secret:e,regenerate:!0},generate:r?{secret:r}:void 0})},eo=(0,r.useCallback)(async()=>{B&&(await en({revoke:B}),V(null))},[B,en]),ea=(0,r.useCallback)(async()=>{let e=q.current?.value;await en({generate:e?{secret:e}:void 0}),H(!1)},[en,q]),el=(0,r.useCallback)(()=>Q?null:X?(0,t.jsxs)(a.Text,{color:"gray-900",children:["Learn more about"," ",(0,t.jsx)(f.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-bypass-deployment-protection/protection-bypass-automation",type:"highlight",children:"Protection Bypass for Automation"})]}):(0,t.jsxs)(a.Text,{lineHeight:32,color:"gray-900",children:["You need additional permissions to manage your project's"," ",(0,t.jsx)(f.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-bypass-deployment-protection/protection-bypass-automation",type:"highlight",children:"Protection Bypass for Automation"}),"."]}),[X,Q]);if(Q)return(0,t.jsx)(J,{});let ed=!!(s.ssoProtection||s.passwordProtection||s.trustedIps),ec={noPermission:ei?null:"Missing the required permissions to create a secret.",noProtectionEnabled:ed||k?null:"No protections currently enabled for the project."},eu=ec.noPermission||ec.noProtectionEnabled,ep=Object.entries(s.protectionBypass||{}),eh=ep.filter(e=>{let[t,r]=e;return"automation-bypass"===r.scope}),em=ep.filter(e=>{let[t,r]=e;return"integration-automation-bypass"===r.scope});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(G,{action:k?null:(0,t.jsx)(n.Button,{disabled:!!eu,loading:O,onClick:()=>H(!0),prefix:(0,t.jsx)(w.Plus,{}),size:"small",children:(0,t.jsx)(d.Tooltip,{forceHide:!eu,text:eu,children:"Add Secret"})}),disabled:!(ee&&X),disabledForBilling:!ee||!ei&&!k,error:S,highlightNote:!ee,note:el(),headerNote:(0,t.jsx)(z.MicrofrontendsHelpBadge,{childHelp:"This secret bypasses deployment protection for this project's routes. The default app's secret also applies to this project.",parentHelp:"This secret bypasses deployment protection for all projects in the microfrontends group."}),children:(0,t.jsxs)(o.Stack,{gap:4,style:{marginTop:"20px"},children:[(0,t.jsx)($.AnimatedNote,{keyName:"automation-bypass-no-protection-enabled-note",children:k&&!ed?(0,t.jsx)("span",{children:"Protection Bypass for Automation with no protections enabled has no effect."}):null}),(0,t.jsx)(M.EntityCollapsible,{disableAnimation:!!K,disabled:!X,emptyDescription:"Add a secret that can be used to bypass Deployment Protection for this project.",entities:eh.map(e=>{let[r,n]=e,s=K===r;return{key:`protection-bypass-${n.createdAt}`,component:(0,t.jsx)(R.EnvVarEntity,{additionalMenuItems:er?(0,t.jsx)(c.MenuItem,{onClick:()=>{V({regenerate:!0,secret:r})},children:"Regenerate secret"}):(0,t.jsx)(p.MenuItemLocked,{children:"Regenerate secret"}),canReadProductionValues:ee,className:(0,i.clsx)(L.default.noBorder,L.default.minHeight),customSave:e=>es(r,e),disableComment:!0,disableDeleteEnvVariable:!et,disableEditEnvVariable:!er,disableEnvironmentInput:!0,disableNameInput:!0,editTextareaValueProps:{rows:1,className:L.default.autoHeight,wrapperClassName:L.default.autoHeight},env:{id:"protection-bypass",type:v.EnvType.Encrypted,key:U,value:r,decrypted:!0,createdAt:n.createdAt,target:[v.EnvTarget.Preview,v.EnvTarget.Production],applyToAllCustomEnvironments:!0},isEditing:s,onRemove:()=>{V({regenerate:!1,secret:r})},setIsEditing:e=>Z(e?r:null),team:T})}}),isLoading:Q,title:"Secrets"}),em.length>0?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.Text,{color:"gray-900",size:14,style:{marginTop:"20px"},transform:"initial",children:"Automation Protection Bypass created by integrations"}),(0,t.jsx)(M.EntityCollapsible,{disableAnimation:!!K,disabled:!X,emptyDescription:"",entities:em.map(e=>{let[r,i]=e;return{key:`integration-protection-bypass-${i.createdAt}`,component:(0,t.jsx)(W,{integrationAutomationBypass:i,secret:r})}}),isLoading:Q,title:"Integration Secrets"})]}):null]})}),(0,t.jsxs)(Y,{active:!!B,close:()=>V(null),loading:O,onConfirm:()=>void eo(),title:B?.regenerate?"Regenerate Protection Bypass Secret":"Delete Protection Bypass Secret",children:[(0,t.jsx)(a.Text,{color:"gray-900",transform:"initial",children:B?.regenerate?"Regenerating this secret will mean any automation services using the current secret will no longer work and may report errors until they are switched to the new secret.":"Deleting this secret will mean any automation services currently using it will no longer work and may report errors."}),(0,t.jsx)(a.Text,{color:"gray-900",transform:"initial",children:"Are you sure you want to continue?"})]}),(0,t.jsxs)(Y,{active:F,close:()=>H(!1),confirmButtonTitle:"Save",loading:O,onConfirm:()=>void ea(),title:"Add Secret",children:[(0,t.jsx)(a.Text,{color:"gray-900",transform:"initial",children:"Add a new secret to bypass Deployment Protection for this project."}),(0,t.jsx)(u.Input,{disabled:!0,label:"Environment Variable",title:"Environment Variable",value:U}),(0,t.jsx)(u.Input,{label:"Value",maxLength:32,minLength:32,placeholder:"Optionally specify a 32-character value",ref:q,title:"Value"})]})]})}function W(e){let{integrationAutomationBypass:i,secret:s}=e,{integration:l}=(0,B.useIntegration)(i.integrationId),d=(0,V.useRouter)(),[u,p]=(0,r.useState)(!1),h=`Click to ${u?"hide":"show"}`,f=(0,H.useTeamSlug)();return(0,t.jsxs)(T.Entity,{className:"!border-0",menuItems:[(0,t.jsx)(c.MenuItem,{onClick:()=>{f&&d.push((0,F.getInstallationDetailsLink)({teamSlug:f,integrationSlug:i.integrationId,configurationId:i.configurationId,isMarketplace:!0}))},children:"Manage"},"manage-integration")],thumbnail:(0,t.jsx)(k.EntityThumbnail,{size:24,children:(0,t.jsx)(m.Avatar,{size:24,hash:l?.icon})}),children:[(0,t.jsx)(S.EntityField,{width:"40%",title:l?.name}),(0,t.jsx)(S.EntityField,{children:(0,t.jsx)(o.Stack,{direction:"row",gap:2,children:(0,t.jsxs)(o.Stack,{align:"center",direction:"row",gap:2,children:[(0,t.jsx)(n.Button,{"aria-label":h,onClick:()=>p(!u),svgOnly:!0,title:h,variant:"unstyled",children:u?(0,t.jsx)(g.EyeOff,{size:16}):(0,t.jsx)(y.Eye,{size:16})}),u?(0,t.jsx)(D.CopyInlineCode,{value:s}):(0,t.jsx)(a.Text,{color:"gray-900",lineHeight:20,children:"â€¢".repeat(15)})]})})})]})}function Y(e){let{active:r,close:i,onConfirm:n,loading:l,title:d,children:c,confirmButtonTitle:u="Confirm"}=e;return(0,t.jsx)(s.Modal.Modal,{active:r,onClickOutside:i,width:480,children:(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),n()},children:[(0,t.jsx)(s.Modal.Body,{children:(0,t.jsx)(s.Modal.Header,{children:(0,t.jsxs)(o.Stack,{gap:4,children:[(0,t.jsx)(a.Text,{size:20,transform:"initial",weight:500,children:d}),(0,t.jsx)(s.Modal.Subtitle,{children:(0,t.jsx)(o.Stack,{gap:4,children:c})})]})})}),(0,t.jsxs)(s.Modal.Actions,{children:[(0,t.jsx)(s.Modal.Action,{onClick:i,type:"secondary",children:"Cancel"}),(0,t.jsx)(s.Modal.Action,{buttonType:"submit",loading:l,children:u})]})]})})}function G(e){let{children:r,note:i,...n}=e;return(0,t.jsx)(N.ProjectSettingsFieldset,{description:(0,t.jsxs)(t.Fragment,{children:["Enable access for automation services to protected deployments on this project. The secret is available as a"," ",(0,t.jsx)(f.Link,{href:"/docs/environment-variables/system-environment-variables",variant:"highlight",children:"System Environment Variable"})," ","in all deployments after the value is created. You can bypass Deployment Protection by setting an HTTP header or query parameter with the secret provided below named"," ",(0,t.jsx)(D.CopyInlineCode,{value:"x-vercel-protection-bypass"}),"."]}),note:i||(0,t.jsx)(h.Skeleton,{height:16,width:240}),title:"Protection Bypass for Automation",...n,children:r})}function J(){return(0,t.jsx)(G,{note:"",children:(0,t.jsx)(M.LoadingState,{})})}function K(){return(0,t.jsx)(r.Suspense,{fallback:(0,t.jsx)(O.default,{}),children:(0,t.jsx)(q,{})})}},8538288:e=>{var{m:t,e:r}=e;!function(e){"use strict";let r="(0?\\d+|0x[a-f0-9]+)",i={fourOctet:RegExp(`^${r}\\.${r}\\.${r}\\.${r}$`,"i"),threeOctet:RegExp(`^${r}\\.${r}\\.${r}$`,"i"),twoOctet:RegExp(`^${r}\\.${r}$`,"i"),longValue:RegExp(`^${r}$`,"i")},n=RegExp("^0[0-7]+$","i"),s=RegExp("^0x[a-f0-9]+$","i"),o="%[0-9a-z]{1,}",a="(?:[0-9a-f]+::?)+",l={zoneIndex:RegExp(o,"i"),native:RegExp(`^(::)?(${a})?([0-9a-f]+)?(::)?(${o})?$`,"i"),deprecatedTransitional:RegExp(`^(?:::)(${r}\\.${r}\\.${r}\\.${r}(${o})?)$`,"i"),transitional:RegExp(`^((?:${a})|(?:::)(?:${a})?)${r}\\.${r}\\.${r}\\.${r}(${o})?$`,"i")};function d(e,t){let r,i;if(e.indexOf("::")!==e.lastIndexOf("::"))return null;let n=0,s=-1,o=(e.match(l.zoneIndex)||[])[0];for(o&&(o=o.substring(1),e=e.replace(/%.+$/,""));(s=e.indexOf(":",s+1))>=0;)n++;if("::"===e.substr(0,2)&&n--,"::"===e.substr(-2,2)&&n--,n>t)return null;for(i=t-n,r=":";i--;)r+="0:";return":"===(e=e.replace("::",r))[0]&&(e=e.slice(1)),":"===e[e.length-1]&&(e=e.slice(0,-1)),{parts:t=function(){let t=e.split(":"),r=[];for(let e=0;e<t.length;e++)r.push(parseInt(t[e],16));return r}(),zoneId:o}}function c(e,t,r,i){let n;if(e.length!==t.length)throw Error("ipaddr: cannot match CIDR for objects with different lengths");let s=0;for(;i>0;){if((n=r-i)<0&&(n=0),e[s]>>n!=t[s]>>n)return!1;i-=r,s+=1}return!0}function u(e){if(s.test(e))return parseInt(e,16);if("0"===e[0]&&!isNaN(parseInt(e[1],10))){if(n.test(e))return parseInt(e,8);throw Error(`ipaddr: cannot parse ${e} as octal`)}return parseInt(e,10)}let p={};p.IPv4=function(){function e(e){let t,r;if(4!==e.length)throw Error("ipaddr: ipv4 octet count should be 4");for(t=0;t<e.length;t++)if(!(0<=(r=e[t])&&r<=255))throw Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=e}return e.prototype.SpecialRanges={unspecified:[[new e([0,0,0,0]),8]],broadcast:[[new e([255,255,255,255]),32]],multicast:[[new e([224,0,0,0]),4]],linkLocal:[[new e([169,254,0,0]),16]],loopback:[[new e([127,0,0,0]),8]],carrierGradeNat:[[new e([100,64,0,0]),10]],private:[[new e([10,0,0,0]),8],[new e([172,16,0,0]),12],[new e([192,168,0,0]),16]],reserved:[[new e([192,0,0,0]),24],[new e([192,0,2,0]),24],[new e([192,88,99,0]),24],[new e([198,18,0,0]),15],[new e([198,51,100,0]),24],[new e([203,0,113,0]),24],[new e([240,0,0,0]),4]],as112:[[new e([192,175,48,0]),24],[new e([192,31,196,0]),24]],amt:[[new e([192,52,193,0]),24]]},e.prototype.kind=function(){return"ipv4"},e.prototype.match=function(e,t){let r;if(void 0===t&&(e=(r=e)[0],t=r[1]),"ipv4"!==e.kind())throw Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return c(this.octets,e.octets,8,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e,t,r,i=0,n=!1,s={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0};for(e=3;e>=0;e-=1){if(!((t=this.octets[e])in s)||(r=s[t],n&&0!==r))return null;8!==r&&(n=!0),i+=r}return 32-i},e.prototype.range=function(){return p.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){return this.octets.slice(0)},e.prototype.toIPv4MappedAddress=function(){return p.IPv6.parse(`::ffff:${this.toString()}`)},e.prototype.toNormalizedString=function(){return this.toString()},e.prototype.toString=function(){return this.octets.join(".")},e}(),p.IPv4.broadcastAddressFromCIDR=function(e){try{let t=this.parseCIDR(e),r=t[0].toByteArray(),i=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),n=[],s=0;for(;s<4;)n.push(parseInt(r[s],10)|255^parseInt(i[s],10)),s++;return new this(n)}catch(e){throw Error("ipaddr: the address does not have IPv4 CIDR format")}},p.IPv4.isIPv4=function(e){return null!==this.parser(e)},p.IPv4.isValid=function(e){try{return new this(this.parser(e)),!0}catch(e){return!1}},p.IPv4.isValidCIDR=function(e){try{return this.parseCIDR(e),!0}catch(e){return!1}},p.IPv4.isValidFourPartDecimal=function(e){return!!(p.IPv4.isValid(e)&&e.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},p.IPv4.networkAddressFromCIDR=function(e){let t,r,i,n,s;try{for(i=(t=this.parseCIDR(e))[0].toByteArray(),s=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),n=[],r=0;r<4;)n.push(parseInt(i[r],10)&parseInt(s[r],10)),r++;return new this(n)}catch(e){throw Error("ipaddr: the address does not have IPv4 CIDR format")}},p.IPv4.parse=function(e){let t=this.parser(e);if(null===t)throw Error("ipaddr: string is not formatted like an IPv4 Address");return new this(t)},p.IPv4.parseCIDR=function(e){let t;if(t=e.match(/^(.+)\/(\d+)$/)){let e=parseInt(t[2]);if(e>=0&&e<=32){let r=[this.parse(t[1]),e];return Object.defineProperty(r,"toString",{value:function(){return this.join("/")}}),r}}throw Error("ipaddr: string is not formatted like an IPv4 CIDR range")},p.IPv4.parser=function(e){let t,r;if(t=e.match(i.fourOctet)){let e=t.slice(1,6),r=[];for(let t=0;t<e.length;t++)r.push(u(e[t]));return r}if(t=e.match(i.longValue)){if((r=u(t[1]))>0xffffffff||r<0)throw Error("ipaddr: address outside defined range");return(function(){let e,t=[];for(e=0;e<=24;e+=8)t.push(r>>e&255);return t})().reverse()}if(t=e.match(i.twoOctet)){let e=t.slice(1,4),i=[];if((r=u(e[1]))>0xffffff||r<0)throw Error("ipaddr: address outside defined range");return i.push(u(e[0])),i.push(r>>16&255),i.push(r>>8&255),i.push(255&r),i}{if(!(t=e.match(i.threeOctet)))return null;let n=t.slice(1,5),s=[];if((r=u(n[2]))>65535||r<0)throw Error("ipaddr: address outside defined range");return s.push(u(n[0])),s.push(u(n[1])),s.push(r>>8&255),s.push(255&r),s}},p.IPv4.subnetMaskFromPrefixLength=function(e){if((e=parseInt(e))<0||e>32)throw Error("ipaddr: invalid IPv4 prefix length");let t=[0,0,0,0],r=0,i=Math.floor(e/8);for(;r<i;)t[r]=255,r++;return i<4&&(t[i]=Math.pow(2,e%8)-1<<8-e%8),new this(t)},p.IPv6=function(){function e(e,t){let r,i;if(16===e.length)for(r=0,this.parts=[];r<=14;r+=2)this.parts.push(e[r]<<8|e[r+1]);else if(8===e.length)this.parts=e;else throw Error("ipaddr: ipv6 part count should be 8 or 16");for(r=0;r<this.parts.length;r++)if(!(0<=(i=this.parts[r])&&i<=65535))throw Error("ipaddr: ipv6 part should fit in 16 bits");t&&(this.zoneId=t)}return e.prototype.SpecialRanges={unspecified:[new e([0,0,0,0,0,0,0,0]),128],linkLocal:[new e([65152,0,0,0,0,0,0,0]),10],multicast:[new e([65280,0,0,0,0,0,0,0]),8],loopback:[new e([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new e([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new e([0,0,0,0,0,65535,0,0]),96],discard:[new e([256,0,0,0,0,0,0,0]),64],rfc6145:[new e([0,0,0,0,65535,0,0,0]),96],rfc6052:[new e([100,65435,0,0,0,0,0,0]),96],"6to4":[new e([8194,0,0,0,0,0,0,0]),16],teredo:[new e([8193,0,0,0,0,0,0,0]),32],benchmarking:[new e([8193,2,0,0,0,0,0,0]),48],amt:[new e([8193,3,0,0,0,0,0,0]),32],as112v6:[[new e([8193,4,274,0,0,0,0,0]),48],[new e([9760,79,32768,0,0,0,0,0]),48]],deprecated:[new e([8193,16,0,0,0,0,0,0]),28],orchid2:[new e([8193,32,0,0,0,0,0,0]),28],droneRemoteIdProtocolEntityTags:[new e([8193,48,0,0,0,0,0,0]),28],reserved:[[new e([8193,0,0,0,0,0,0,0]),23],[new e([8193,3512,0,0,0,0,0,0]),32]]},e.prototype.isIPv4MappedAddress=function(){return"ipv4Mapped"===this.range()},e.prototype.kind=function(){return"ipv6"},e.prototype.match=function(e,t){let r;if(void 0===t&&(e=(r=e)[0],t=r[1]),"ipv6"!==e.kind())throw Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return c(this.parts,e.parts,16,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e,t,r=0,i=!1,n={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0};for(let s=7;s>=0;s-=1){if(!((e=this.parts[s])in n)||(t=n[e],i&&0!==t))return null;16!==t&&(i=!0),r+=t}return 128-r},e.prototype.range=function(){return p.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){let e,t=[],r=this.parts;for(let i=0;i<r.length;i++)t.push((e=r[i])>>8),t.push(255&e);return t},e.prototype.toFixedLengthString=function(){let e=(function(){let e=[];for(let t=0;t<this.parts.length;t++)e.push(function(e,t){for(;e.length<4;)e=`0${e}`;return e}(this.parts[t].toString(16),0));return e}).call(this).join(":"),t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw Error("ipaddr: trying to convert a generic ipv6 address to ipv4");let e=this.parts.slice(-2),t=e[0],r=e[1];return new p.IPv4([t>>8,255&t,r>>8,255&r])},e.prototype.toNormalizedString=function(){let e=(function(){let e=[];for(let t=0;t<this.parts.length;t++)e.push(this.parts[t].toString(16));return e}).call(this).join(":"),t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toRFC5952String=function(){let e,t=/((^|:)(0(:|$)){2,})/g,r=this.toNormalizedString(),i=0,n=-1;for(;e=t.exec(r);)e[0].length>n&&(i=e.index,n=e[0].length);return n<0?r:`${r.substring(0,i)}::${r.substring(i+n)}`},e.prototype.toString=function(){return this.toRFC5952String()},e}(),p.IPv6.broadcastAddressFromCIDR=function(e){try{let t=this.parseCIDR(e),r=t[0].toByteArray(),i=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),n=[],s=0;for(;s<16;)n.push(parseInt(r[s],10)|255^parseInt(i[s],10)),s++;return new this(n)}catch(e){throw Error(`ipaddr: the address does not have IPv6 CIDR format (${e})`)}},p.IPv6.isIPv6=function(e){return null!==this.parser(e)},p.IPv6.isValid=function(e){if("string"==typeof e&&-1===e.indexOf(":"))return!1;try{let t=this.parser(e);return new this(t.parts,t.zoneId),!0}catch(e){return!1}},p.IPv6.isValidCIDR=function(e){if("string"==typeof e&&-1===e.indexOf(":"))return!1;try{return this.parseCIDR(e),!0}catch(e){return!1}},p.IPv6.networkAddressFromCIDR=function(e){let t,r,i,n,s;try{for(i=(t=this.parseCIDR(e))[0].toByteArray(),s=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),n=[],r=0;r<16;)n.push(parseInt(i[r],10)&parseInt(s[r],10)),r++;return new this(n)}catch(e){throw Error(`ipaddr: the address does not have IPv6 CIDR format (${e})`)}},p.IPv6.parse=function(e){let t=this.parser(e);if(null===t.parts)throw Error("ipaddr: string is not formatted like an IPv6 Address");return new this(t.parts,t.zoneId)},p.IPv6.parseCIDR=function(e){let t,r,i;if((r=e.match(/^(.+)\/(\d+)$/))&&(t=parseInt(r[2]))>=0&&t<=128)return Object.defineProperty(i=[this.parse(r[1]),t],"toString",{value:function(){return this.join("/")}}),i;throw Error("ipaddr: string is not formatted like an IPv6 CIDR range")},p.IPv6.parser=function(e){let t,r,i,n,s,o;if(i=e.match(l.deprecatedTransitional))return this.parser(`::ffff:${i[1]}`);if(l.native.test(e))return d(e,8);if((i=e.match(l.transitional))&&(o=i[6]||"",t=i[1],i[1].endsWith("::")||(t=t.slice(0,-1)),(t=d(t+o,6)).parts)){for(r=0,s=[parseInt(i[2]),parseInt(i[3]),parseInt(i[4]),parseInt(i[5])];r<s.length;r++)if(!(0<=(n=s[r])&&n<=255))return null;return t.parts.push(s[0]<<8|s[1]),t.parts.push(s[2]<<8|s[3]),{parts:t.parts,zoneId:t.zoneId}}return null},p.IPv6.subnetMaskFromPrefixLength=function(e){if((e=parseInt(e))<0||e>128)throw Error("ipaddr: invalid IPv6 prefix length");let t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r=0,i=Math.floor(e/8);for(;r<i;)t[r]=255,r++;return i<16&&(t[i]=Math.pow(2,e%8)-1<<8-e%8),new this(t)},p.fromByteArray=function(e){let t=e.length;if(4===t)return new p.IPv4(e);if(16===t)return new p.IPv6(e);throw Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},p.isValid=function(e){return p.IPv6.isValid(e)||p.IPv4.isValid(e)},p.isValidCIDR=function(e){return p.IPv6.isValidCIDR(e)||p.IPv4.isValidCIDR(e)},p.parse=function(e){if(p.IPv6.isValid(e))return p.IPv6.parse(e);if(p.IPv4.isValid(e))return p.IPv4.parse(e);throw Error("ipaddr: the address has neither IPv6 nor IPv4 format")},p.parseCIDR=function(e){try{return p.IPv6.parseCIDR(e)}catch(t){try{return p.IPv4.parseCIDR(e)}catch(e){throw Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},p.process=function(e){let t=this.parse(e);return"ipv6"===t.kind()&&t.isIPv4MappedAddress()?t.toIPv4Address():t},p.subnetMatch=function(e,t,r){let i,n,s,o;for(n in null==r&&(r="unicast"),t)if(Object.prototype.hasOwnProperty.call(t,n)){for(!(s=t[n])[0]||s[0]instanceof Array||(s=[s]),i=0;i<s.length;i++)if(o=s[i],e.kind()===o[0].kind()&&e.match.apply(e,o))return n}return r},t.exports?t.exports=p:e.ipaddr=p}(e.e)},9931986:e=>{e.v({input:"trusted-ips-module__2PgDza__input",ipInput:"trusted-ips-module__2PgDza__ipInput",list:"trusted-ips-module__2PgDza__list",noteInput:"trusted-ips-module__2PgDza__noteInput"})},2050410:e=>{"use strict";e.s({TrustedIps:()=>z},2050410);var t=e.i(6645307),r=e.i(6530772),i=e.i(889716),n=e.i(8084653),s=e.i(5674541),o=e.i(555528),a=e.i(8934201),l=e.i(584439),d=e.i(9495609),c=e.i(631755),u=e.i(2254575),p=e.i(6621512),h=e.i(6960707),m=e.i(1209519),g=e.i(4968913),y=e.i(3277953),f=e.i(5610210),x=e.i(1164214),j=e.i(503726),b=e.i(534589),v=e.i(2362802),w=e.i(3585235),I=e.i(5785123),P=e.i(3326412),T=e.i(6700141),k=e.i(1155472),S=e.i(2408607),C=e.i(2240289),A=e.i(1389821),E=e.i(3004270),_=e.i(6958389),D=e.i(8142727),R=e.i(8538288);let M=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];for(let i of t)try{if((0,R.isValid)(e)&&(0,R.isValid)(i))e===i&&r.push(i);else if((0,R.isValid)(e))(0,R.parse)(e).match((0,R.parseCIDR)(i))&&r.push(i);else if((0,R.isValid)(i))(0,R.parse)(i).match((0,R.parseCIDR)(e))&&r.push(i);else{let t=(0,R.parseCIDR)(e),n=(0,R.parseCIDR)(i);(t[0].match(n)||n[0].match(t))&&r.push(i)}}catch(e){}return r};var O=e.i(1093907),N=e.i(9215364);function L(e){let{overrides:r,...i}=e,s={additional:{label:"Trusted IP Required",description:(0,t.jsxs)(n.Text,{as:"span",color:"inherit",children:["Visitors"," ",(0,t.jsx)(n.Text,{as:"span",color:"inherit",weight:500,children:"must"})," ","come from a Trusted IP address, and satisfy Vercel Authentication or Password Protection if enabled."]}),...r?.additional},exclusive:{label:"Trusted IP Optional",description:(0,t.jsxs)(n.Text,{as:"span",color:"inherit",children:["Visitors from a Trusted IP address will automatically"," ",(0,t.jsx)(n.Text,{as:"span",color:"inherit",weight:500,children:"bypass"})," ","Vercel Authentication and Password Protection. Other users will be prompted with the enabled Deployment Protection methods."]}),...r?.exclusive}};return(0,t.jsx)(N.Selector,{ariaLabel:"Select the protection mode for Trusted IPs.",values:s,width:280,...i})}var $=e.i(9931986),B=e.i(3128293);function V(){let e=(0,l.useToasts)(),k=(0,A.useProjectIdOrName)(),{data:N,mutate:V}=(0,C.useProject)(k,{apiVersion:"v10"}),z=(0,j.useAccount)(),{can:U,isLoading:q}=(0,w.default)(),W=U(I.Action.Update,I.Resource.Project)&&U(I.Action.Update,I.Resource.TrustedIps),Y=U(I.Action.Read,I.Resource.TrustedIps),{user:G,team:J}=z,{value:K}=(0,T.useTrustedIpsCustomLimitFlag)(),Z=F(K),Q=J?.standaloneTrustedIps?.enabled||!1,X=(0,r.useMemo)(()=>!!(Y&&N?.trustedIps),[Y,N?.trustedIps]),[ee,et]=(0,r.useState)(X),er=(0,r.useMemo)(()=>Y&&N?.trustedIps?.deploymentType||"production",[Y,N?.trustedIps?.deploymentType]),[ei,en]=(0,r.useState)(er),es=(0,r.useMemo)(()=>Y&&N?.trustedIps?.protectionMode||"additional",[Y,N?.trustedIps?.protectionMode]),[eo,ea]=(0,r.useState)(es),[el,ed]=(0,r.useState)(!1),[ec,eu]=(0,r.useState)(null),[ep,eh]=(0,r.useState)(!1),{value:em}=(0,P.useIPBlockingTeamFlag)(),eg=U(I.Action.Read,I.Resource.IpBlocking),{data:ey}=(0,E.useIPBlocking)({limit:128}),ef=(0,r.useCallback)(e=>e.map((r,i)=>{let{value:n,note:s}=r;if(!n&&s)return{...r,error:"Please enter a value."};let o=(e=>{let t=(e=>{try{return(0,R.parse)(e)}catch{return null}})(e)||(e=>{try{let[t]=(0,R.parseCIDR)(e);return t}catch{return null}})(e);return t&&"ipv4"===t.kind()?["private","unspecified","loopback"].includes(t.range())?"unsupported-range":"valid":"unsupported-format"})(n);if(n&&"unsupported-format"===o)return{...r,error:"Unsupported format: Must be an IPv4 address or IPv4 CIDR block."};if(n&&"unsupported-range"===o)return{...r,error:"Unsupported range"};if(n&&e.slice(0,i).filter(e=>{let{value:t}=e;return t===n}).length>0)return{...r,error:"Address already in the list."};if(J?.slug){let e=em&&eg?ey?.result.map(e=>{let{ip:t}=e;return t}):void 0,i=`/${J.slug}/~/settings/security#ip-blocking`,s=M(n,e);if(s.length>0)return{...r,warning:(0,t.jsxs)(t.Fragment,{children:["Potential conflict with"," ",(0,t.jsx)(v.Link,{href:i,variant:"blend",children:"Blocked IPs"})," ","(",s.join(", "),"). Blocked addresses will not be trusted."]})}}return{...r,error:null,warning:null}}),[ey,em,eg,J?.slug]),ex=(0,r.useMemo)(()=>{let e=Date.now();return Y&&N?.trustedIps?.addresses&&0!==N.trustedIps.addresses.length?ef(N.trustedIps.addresses.map((t,r)=>{let{value:i,note:n}=t;return{renderingId:e+r,value:i,note:n,error:null,warning:null}})):[{renderingId:e,value:"",error:null,warning:null}]},[Y,N?.trustedIps,ef]),[ej,eb]=(0,r.useState)(ex),ev=(0,r.useMemo)(()=>({trustedIps:ee?{deploymentType:ei,addresses:ej.map(e=>{let{value:t,note:r}=e;return{value:t,note:r}}).filter(e=>{let{value:t}=e;return!!t}),protectionMode:eo}:null}),[ee,ei,ej,eo]),ew=(0,r.useCallback)(async()=>{ed(!0);try{eu(null),await (0,S.default)(k,J?.id,ev),e.success("Updated Trusted IPs successfully."),await V()}catch(e){eu(e.message)}ed(!1)},[k,V,J,e,ev]),eI=(0,r.useCallback)(e=>{et(e),eb(e=>{let[t,...r]=e;return[{...t,renderingId:t.renderingId-1},...r]})},[]),eP=(0,r.useCallback)(e=>{en(e)},[]),eT=(0,r.useCallback)(()=>{eb(e=>[...e,{renderingId:Date.now(),value:"",error:null,warning:null}])},[]),ek=(0,r.useCallback)(e=>{eb(t=>{if(t.length<=1)return[{renderingId:Date.now(),value:"",error:null,warning:null}];let r=t.findIndex(t=>{let{renderingId:r}=t;return r===e});return[...t.slice(0,r),...t.slice(r+1)]})},[]),eS=(0,r.useCallback)((e,t)=>{let{value:r,note:i}=t;eb(t=>t.map(t=>t.renderingId===e?{...t,value:r??t.value,note:i??t.note}:t))},[]),eC=(0,r.useCallback)((e,t)=>{t.relatedTarget?.id!==`remove-input-${e}`&&eb(ef)},[ef]);(0,r.useEffect)(()=>{et(X),en(er),eb(ex),ea(es)},[es,ex,X,er]);let eA=!N||!(J||G)||q,eE=JSON.stringify(N?.trustedIps?.addresses)!==JSON.stringify(ev.trustedIps?.addresses),e_=(N?.trustedIps||ev.trustedIps)&&(N?.trustedIps?.deploymentType!==ev.trustedIps?.deploymentType||N?.trustedIps?.protectionMode!==ev.trustedIps?.protectionMode||eE),eD=ee&&ej.find(e=>{let{error:t}=e;return!!t}),eR=W&&e_&&!eD&&(!ev.trustedIps||ev.trustedIps.addresses.length>0),eM=J?.billing?.plan==="enterprise"&&W,eO=(0,r.useCallback)(()=>W?eM?(0,t.jsxs)(n.Text,{color:"gray-900",children:["Learn more about"," ",(0,t.jsx)(v.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-protect-deployments/trusted-ips",type:"highlight",children:"Trusted IPs"})]}):(0,t.jsxs)(n.Text,{as:"span",color:"gray-900",children:["This feature is available on the"," ",(0,t.jsx)(v.Link,{external:!0,href:"/pricing",type:"highlight",children:"Enterprise plan"}),"."]}):(0,t.jsxs)(n.Text,{lineHeight:32,color:"gray-900",children:["You need additional permissions to manage your project's"," ",(0,t.jsx)(v.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-protect-deployments/trusted-ips",type:"highlight",children:"Trusted IPs"}),"."]}),[W,eM]);if(eA)return(0,t.jsx)(H,{});let eN=el||!ee||!Y,eL=!(N.ssoProtection||N.passwordProtection||N.trustedIps?.protectionMode==="exclusive"),e$=ej.length>=Z,eB=()=>{eh(!1)},eV=!W||!eM,eF=N.ssoProtection?.deploymentType||Q?null:"Vercel Authentication must also enabled to enable Trusted IPs in preview environments.";return(0,t.jsxs)(_.ProjectSettingsFieldset,{action:eM?null:(0,t.jsx)(v.ButtonLink,{"data-testid":(0,x.tid)("project-settings","paid-feature","contact-sales"),href:b.CONTACT_SALES_DASHBOARD_HREF,size:"small",tab:!0,children:"Contact Sales"}),description:(0,t.jsxs)(t.Fragment,{children:["Restrict access to deployments to visitors from specific IP addresses only. A maximum of ",Z," IP addresses can be added."]}),disabled:!W,disabledForBilling:eV,error:ec,highlightNote:!W,note:eO(),onSave:eM?async()=>{ee?await ew():eh(!0)}:null,saveDisabled:!eR,saveLoading:el,title:"Trusted IPs",headerNote:ee?(0,t.jsx)(B.MicrofrontendsHelpBadge,{childHelp:(0,t.jsxs)(t.Fragment,{children:["This configuration applies only to this project's domains. It's recommended to protect"," ",(0,t.jsx)(n.Text,{as:"span",weight:500,color:"inherit",children:"All Deployments"})," ","for a child microfrontends project."]}),parentHelp:"This configuration applies to production and pre-production deployments for the group."}):null,children:[(0,t.jsxs)(i.Stack,{gap:4,children:[(0,t.jsxs)(i.Stack,{align:"center",direction:"row",gap:{sm:2,md:4,lg:4},style:{flexWrap:"wrap"},children:[(0,t.jsx)(i.Stack,{align:"center",direction:"row",gap:2,children:(0,t.jsx)(d.Toggle,{"aria-labelledby":"label-for-trusted-ips-enabled-toggle",checked:ee,direction:"switch-first",onChange:eI,size:"large",style:{padding:"var(--geist-gap-quarter) 0"},children:(0,t.jsx)(n.Text,{color:eV?"gray-800":void 0,id:"label-for-trusted-ips-enabled-toggle",transform:"none",weight:500,children:ee?"Enabled for":"Disabled"})})}),ee?(0,t.jsx)(O.DeploymentTypeSelector,{disabled:eN,onChange:eP,overrides:{preview:{disabledDescription:eF},production:{},all:{disabledDescription:eF},all_except_custom_domains:{disabledDescription:eF},prod_deployment_urls_and_all_previews:{disabledDescription:eF}},currentValue:N?.trustedIps?.deploymentType,project:N,selectedValue:ei}):null]}),(0,t.jsx)("hr",{className:(0,f.clsx)("geist-hr-reset","geist-show-on-mobile")}),(0,t.jsxs)(i.Stack,{as:"form",autoComplete:"off",gap:3,children:[(0,t.jsxs)(i.Stack,{align:"center",direction:"row",gap:1,children:[(0,t.jsx)(n.Text,{color:eV?"gray-800":"gray-900",id:"label-for-trusted-ips-trusted-ips-input",size:12,transform:"uppercase",weight:500,children:"IP / CIDR"}),(0,t.jsx)(o.Tooltip,{text:"Supported formats: IPv4 and IPv4 CIDR.",children:(0,t.jsx)(p.Information,{})})]}),(0,t.jsx)(u.Entity.List,{className:$.default.list,children:ej.sort((e,t)=>e.renderingId>t.renderingId?1:-1).map((e,r)=>{let{renderingId:a,value:l,note:d,error:p,warning:m}=e,x=!eN&&(p||m)&&l?(0,t.jsxs)(i.Stack,{align:"center",direction:"row",gap:2,children:[p?(0,t.jsx)(g.Stop,{color:"red-900",size:14,style:{flexShrink:0}}):(0,t.jsx)(y.Warning,{color:"amber-900",size:14,style:{flexShrink:0}}),(0,t.jsx)(n.Text,{as:"span",color:p?"red-900":"amber-900",children:p||m})]}):null;return(0,t.jsx)(u.Entity,{footer:x,left:(0,t.jsxs)(n.Text,{style:{width:"20px",marginTop:"-2px"},children:[r+1,"."]}),right:(0,t.jsx)(o.Tooltip,{disableTriggers:eN,text:"Remove",children:(0,t.jsx)(s.Button,{"aria-label":"Remove IP Address",disabled:eN,id:`remove-input-${a}`,onClick:()=>ek(a),shape:"circle",size:"small",style:{border:"none",background:"none"},svgOnly:!0,type:"tertiary",children:(0,t.jsx)(h.MinusCircle,{})})}),children:(0,t.jsxs)(i.Stack,{align:"center",direction:"row",gap:4,style:{width:"100%"},children:[(0,t.jsx)(c.Input,{"aria-labelledby":"label-for-trusted-ips-trusted-ips-input",autoComplete:"one-time-code",autoFocus:eE,disabled:eN,error:eN?null:p,innerWrapperClassName:(0,f.clsx)($.default.input,$.default.ipInput),onBlur:e=>eC(a,e),onChange:e=>eS(a,{value:e.target.value}),placeholder:eN?"":p||"85.146.82.237",showErrorMessage:!1,size:"small",type:m?"warning":void 0,value:l}),(0,t.jsx)(c.Input,{"aria-labelledby":"label-for-trusted-ips-trusted-ips-input",autoComplete:"one-time-code",disabled:eN,innerWrapperClassName:(0,f.clsx)($.default.input,$.default.noteInput),maxLength:20,onBlur:e=>eC(a,e),onChange:e=>eS(a,{note:e.target.value}),placeholder:eN?"":"Note",size:"small",value:d})]})},a)})})]}),(0,t.jsx)(o.Tooltip,{disableTriggers:!e$,position:"right",style:{alignSelf:"flex-start"},text:`Maximum ${Z} addresses allowed.`,children:(0,t.jsx)(s.Button,{disabled:eN||e$,onClick:eT,prefix:(0,t.jsx)(m.PlusCircle,{}),size:"small",style:{alignSelf:"flex-start"},type:"secondary",children:"Add another"})}),Q?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("hr",{className:"geist-hr-reset"}),(0,t.jsxs)(i.Stack,{align:"center",direction:"row",gap:2,children:[(0,t.jsx)(n.Text,{color:eN?"gray-900":void 0,weight:500,children:"Protection mode"}),(0,t.jsx)(L,{disabled:eN,onChange:ea,overrides:{exclusive:{disabledDescription:eL?"No additional protections currently enabled.":null}},selectedValue:eo})]})]}):null,(0,t.jsx)(D.AnimatedNote,{keyName:"trusted-ips-ip-note",children:ee&&"exclusive"===eo&&!(N.passwordProtection||N.ssoProtection)?(0,t.jsx)("span",{children:"Configuration of Trusted IP Optional with no other protections enabled has no effect."}):null})]}),(0,t.jsxs)(a.Modal.Modal,{active:ep,onClickOutside:eB,children:[(0,t.jsx)(a.Modal.Body,{children:(0,t.jsxs)(i.Stack,{align:"flex-start",gap:4,children:[(0,t.jsx)(a.Modal.Title,{children:"Disable Trusted IPs"}),(0,t.jsx)(a.Modal.Subtitle,{children:"If you disable Trusted IPs, you will lose any previous values."}),(0,t.jsx)(a.Modal.Subtitle,{children:"Are you sure you want to continue?"})]})}),(0,t.jsxs)(a.Modal.Actions,{children:[(0,t.jsx)(a.Modal.Action,{onClick:eB,type:"secondary",children:"Cancel"}),(0,t.jsx)(a.Modal.Action,{onClick:async()=>{eh(!1),await ew()},children:"Continue"})]})]})]})}let F=e=>"number"!=typeof e?20:e>200?200:e<20?20:e;function H(){return(0,t.jsx)(k.default,{height:280})}function z(){return(0,t.jsx)(r.Suspense,{fallback:(0,t.jsx)(H,{}),children:(0,t.jsx)(V,{})})}},223184:e=>{"use strict";e.s({DeploymentProtectionExceptions:()=>$},223184);var t=e.i(6645307),r=e.i(6530772),i=e.i(5175803),n=e.i(5674541),s=e.i(631755),o=e.i(4105925),a=e.i(8934201),l=e.i(8158100),d=e.i(5163670),c=e.i(889716),u=e.i(8084653),p=e.i(584439),h=e.i(2362802),m=e.i(6649026),g=e.i(1183506),y=e.i(9336536),f=e.i(503726),x=e.i(3585235),j=e.i(5785123),b=e.i(2774739),v=e.i(7581255),w=e.i(8735078),I=e.i(7200618),P=e.i(1389821),T=e.i(2240289),k=e.i(1155472),S=e.i(3813724),C=e.i(3521787),A=e.i(5193454),E=e.i(1201680),_=e.i(6958389),D=e.i(5304032),R=e.i(3128293);function M(e){let{value:r}=e;return(0,t.jsx)(i.Avatar,{size:30,uid:r})}function O(e){let{value:t}=e;return(0,b.useAge)(t,{justNowThreshold:6e4})}function N(){let e=(0,p.useToasts)(),i=(0,P.useProjectIdOrName)(),{data:b}=(0,T.useProject)(i,{apiVersion:"v10"}),{user:k,team:N}=(0,f.useAccount)(),{can:$,isLoading:B}=(0,x.default)(),[V,F]=(0,r.useState)(!1),[H,z]=(0,r.useState)(null),[U,q]=(0,r.useState)(null),[W,Y]=(0,r.useState)(!1),[G,J]=(0,r.useState)(null),[K,Z]=(0,r.useState)(null),{data:{exceptions:Q=[]}={},mutate:X}=function(e,t){let{projectId:r,teamId:i}=e;return(0,C.default)(()=>r?`${(0,y.API_PROJECTS_VERSION)("v10")}/${r}/deployment-protection-exceptions${(0,m.encode)({teamId:i})}`:null,e=>(0,g.fetchAPI)(e),void 0)}({teamId:N?.id,projectId:b?.id}),ee=(0,r.useCallback)(async(r,i)=>{if(!W&&("create"!==r||G)&&b){q(null),Y(!0);try{let[n,s]=await Promise.all([(0,g.fetchAPI)(`${y.API_ALIASES}/${i}${(0,m.encode)({teamId:N?.id,projectId:b.id})}`,{throwOnHTTPError:!0}),(0,g.fetchAPI)((0,E.getDeploymentKey)(i,N?.id),{throwOnHTTPError:!1})]),o=(n?{id:n.uid,url:n.alias}:void 0)??(s&&s.url===i&&s.projectId===b.id?s:void 0);o?(await (0,S.updateAliasProtectionBypass)({teamId:N?.id,aliasId:o.id,body:{override:{scope:"alias-protection-override",action:r}}}),e.success("create"===r?`Successfully unprotected ${o.url}`:`Successfully removed ${o.url} from Deployment Protection Exceptions`),J(null)):q((0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("b",{children:i})," not found in project ",(0,t.jsx)("b",{children:b.name}),"."]}))}catch(e){q(e.message||"An error occured, please try again later.")}F(!1),await X(),Y(!1)}},[G,N?.id,W,b,e,X]),{addOn:et,isADPEnabled:er,enableADP:ei,ADPModal:en}=(0,A.useToggleAdvancedDeploymentProtection)("project-settings-deployment-protection-exceptions"),{enabled:es,message:eo,action:ea}=(0,I.default)({addOn:et,isEnabled:er,enable:ei,modal:en}),el=!b||!(N||k)||B,ed=$(j.Action.Update,j.Resource.Project),ec=$(j.Action.Update,j.Resource.AliasProtectionBypass),eu=$(j.Action.List,j.Resource.AliasProtectionBypass),ep=$(j.Action.Create,j.Resource.PasswordProtection),eh=(0,r.useCallback)(()=>ed&&ec&&eu?es?(0,t.jsxs)(u.Text,{color:"gray-900",children:["Learn more about"," ",(0,t.jsx)(h.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-bypass-deployment-protection/deployment-protection-exceptions",type:"highlight",children:"Deployment Protection Exceptions"})]}):ep?eo:(0,t.jsxs)(u.Text,{lineHeight:32,color:"gray-900",children:["You need additional permissions to enable"," ",(0,t.jsx)(h.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-bypass-deployment-protection/deployment-protection-exceptions",type:"highlight",children:"Deployment Protection Exceptions"})," ","for your project."]}):(0,t.jsxs)(u.Text,{lineHeight:32,color:"gray-900",children:["You need additional permissions to manage your project's"," ",(0,t.jsx)(h.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-bypass-deployment-protection/deployment-protection-exceptions",type:"highlight",children:"Deployment Protection Exceptions"}),"."]}),[ed,es,eo,ep,ec,eu]),em=(0,r.useCallback)(()=>(z(null),!!G&&(!Q.map(e=>{let{alias:t}=e;return t}).includes(G)||(z((0,t.jsxs)(t.Fragment,{children:["Invalid Input: ",(0,t.jsx)("b",{children:G})," is already included in Deployment Protection Exceptions."]})),!1))),[G,Q]),eg=()=>{q(null),J(null),F("add")},ey=(0,r.useCallback)(e=>{e.preventDefault(),em()&&F("confirm-add")},[em]),ef=(0,r.useCallback)(async e=>{e.preventDefault(),G&&await ee("create",G)},[G,ee]),ex=(0,r.useCallback)(async e=>{e.preventDefault(),K&&await ee("revoke",K)},[K,ee]),ej=(0,r.useCallback)(()=>{z(null),G||J("")},[G]),eb=(0,r.useCallback)(()=>{em(),G||J(null)},[G,em]),ev=(0,r.useMemo)(()=>{switch(V){case"add":return{title:"Unprotect Domain",description:"Enter the preview domain that you would like to unprotect.",body:(0,t.jsx)(v.default,{error:H,id:"alias",name:"alias",onBlur:eb,onChange:e=>J(e.target.value),onFocus:ej,placeholder:"domain.vercel.app",required:!0,value:G||"",width:"100%"}),actionTitle:"Continue",action:ey};case"confirm-add":return{title:"Unprotect Domain",description:(0,t.jsxs)(l.Note,{fill:!0,type:"warning",variant:"contrast",children:["This action will remove any deployent protection for the domain, making it ",(0,t.jsx)("b",{children:"publicly accessible"}),", until the domain is manually removed from this list."]}),body:(0,t.jsx)(a.Modal.Inset,{last:!0,children:(0,t.jsxs)(c.Stack,{gap:6,children:[(0,t.jsx)("label",{children:(0,t.jsxs)(c.Stack,{gap:2,children:[(0,t.jsxs)(u.Text,{color:"gray-900",size:14,weight:400,children:["Enter the domain"," ",(0,t.jsx)("b",{style:{overflowWrap:"anywhere"},children:G})," ","to continue:"]}),(0,t.jsx)(s.Input,{"aria-label":"Domain Name",disabled:W,pattern:`\\s*${G||""}\\s*`,required:!0})]})}),(0,t.jsx)("label",{children:(0,t.jsxs)(c.Stack,{gap:2,children:[(0,t.jsxs)(u.Text,{color:"gray-900",size:14,weight:400,children:["To verify, type ",(0,t.jsx)("b",{children:"unprotect my domain"})," below:"]}),(0,t.jsx)(s.Input,{"aria-label":"Verification Code",disabled:W,pattern:"\\s*unprotect my domain\\s*",required:!0})]})})]})}),actionTitle:"Confirm",action:ef};case"confirm-remove":return{title:"Reprotect Domain",description:(0,t.jsxs)(l.Note,{fill:!0,type:"warning",variant:"contrast",children:["This action will reprotect the domain with Deployment Protection, making it ",(0,t.jsx)("b",{children:"no longer publicly accessible"}),"."]}),body:(0,t.jsx)(a.Modal.Inset,{last:!0,children:(0,t.jsxs)(c.Stack,{gap:6,children:[(0,t.jsx)("label",{children:(0,t.jsxs)(c.Stack,{gap:2,children:[(0,t.jsxs)(u.Text,{color:"gray-900",size:14,weight:400,children:["Enter the domain"," ",(0,t.jsx)("b",{style:{overflowWrap:"anywhere"},children:K})," ","to continue:"]}),(0,t.jsx)(s.Input,{"aria-label":"Domain Name",disabled:W,pattern:`\\s*${K||""}\\s*`,required:!0})]})}),(0,t.jsx)("label",{children:(0,t.jsxs)(c.Stack,{gap:2,children:[(0,t.jsxs)(u.Text,{color:"gray-900",size:14,weight:400,children:["To verify, type ",(0,t.jsx)("b",{children:"reprotect my domain"})," below:"]}),(0,t.jsx)(s.Input,{"aria-label":"Verification Code",disabled:W,pattern:"\\s*reprotect my domain\\s*",required:!0})]})})]})}),actionTitle:"Confirm",action:ex};case!1:return null}},[V,K,G,H,eb,ef,ex,ej,ey,W]);if(el)return(0,t.jsx)(L,{});let ew=!ed||!es||!ec||!eu;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(_.ProjectSettingsFieldset,{action:ep?ea:void 0,description:(0,t.jsxs)(c.Stack,{align:"start",as:"span",direction:{sm:"column",md:"row",lg:"row"},gap:4,justify:"space-between",children:[(0,t.jsxs)("span",{children:["Specify pre-production domains that you want to exclude from Deployment Protection. ",(0,t.jsx)("br",{}),(0,t.jsxs)(u.Text,{as:"span",color:ew?"inherit":"amber-900",children:["Domains listed will become"," ",(0,t.jsx)(u.Text,{as:"span",color:"inherit",weight:500,children:"unprotected"})," ","and"," ",(0,t.jsx)(u.Text,{as:"span",color:"inherit",weight:500,children:"publicly accessible"}),"."]})]}),(0,t.jsx)(n.Button,{onClick:eg,type:"warning",children:"Add Domain"})]}),disabled:!ed,disabledForBilling:ew,error:U,highlightNote:!ed,note:eh(),saveLoading:W,title:"Deployment Protection Exceptions",headerNote:(0,t.jsx)(R.MicrofrontendsHelpBadge,{childHelp:"This configuration only applies to domains belonging to this project.",parentHelp:"This configuration only applies to domains belonging to this project."}),children:Q.length>0?(0,t.jsx)(w.default,{caption:"Unprotected Domains",columns:[{Header:"Unprotected Domains",accessor:"alias"},{Header:"Creator",accessor:"createdBy",Cell:M},{Header:"Age",accessor:"createdAt",Cell:O}],data:Q.map(e=>{let{alias:t,protectionBypass:r}=e,{createdBy:i,createdAt:n}=(0,D.getAliasDeploymentProtectionException)(r)||{};return{alias:t,createdBy:i,createdAt:n}}),headerActions:()=>(0,t.jsx)(o.MenuItem,{onClick:eg,children:"Add domain"}),rowActions:e=>{let{row:{original:{alias:r}}}=e;return(0,t.jsx)(o.MenuItem,{onClick:()=>{Z(r),F("confirm-remove")},type:"error",children:"Remove"})},selectable:!0,sortable:!0}):null}),(0,t.jsx)(a.Modal.Modal,{active:!!ev,onClickOutside:()=>F(!1),width:480,children:(0,t.jsxs)("form",{onSubmit:ev?.action,children:[(0,t.jsx)(a.Modal.Body,{children:(0,t.jsx)(a.Modal.Header,{children:(0,t.jsxs)(c.Stack,{gap:4,children:[ev?(0,t.jsx)(u.Text,{size:20,transform:"initial",weight:500,children:ev.title}):(0,t.jsx)(d.Skeleton,{height:24,width:"100%"}),(0,t.jsx)(a.Modal.Subtitle,{children:(0,t.jsx)(c.Stack,{gap:4,children:ev?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.Text,{color:"gray-900",transform:"initial",children:ev.description}),(0,t.jsx)(u.Text,{color:"gray-900",transform:"initial",children:ev.body})]}):(0,t.jsx)(d.Skeleton,{height:80,width:"100%"})})})]})})}),(0,t.jsxs)(a.Modal.Actions,{children:[(0,t.jsx)(a.Modal.Action,{onClick:()=>F(!1),type:"secondary",children:"Cancel"}),ev?(0,t.jsx)(a.Modal.Action,{buttonType:"submit",loading:W||!ev,type:"warning",children:ev.actionTitle}):(0,t.jsx)(d.Skeleton,{height:40,width:50})]})]})})]})}function L(){return(0,t.jsx)(k.default,{height:170})}function $(){return(0,t.jsx)(r.Suspense,{fallback:(0,t.jsx)(L,{}),children:(0,t.jsx)(N,{})})}},4089156:e=>{"use strict";e.s({OPTIONSAllowlist:()=>A});var t=e.i(6645307),r=e.i(6530772),i=e.i(5674541),n=e.i(631755),s=e.i(889716),o=e.i(8084653),a=e.i(9495609),l=e.i(555528),d=e.i(584439),c=e.i(2362802),u=e.i(6960707),p=e.i(1209519),h=e.i(6649026),m=e.i(1183506),g=e.i(9336536),y=e.i(503726),f=e.i(3585235),x=e.i(5785123),j=e.i(1389821),b=e.i(2240289),v=e.i(1155472),w=e.i(6958389),I=e.i(3128293);function P(){let e=(0,j.useProjectIdOrName)(),{data:r,mutate:i}=(0,b.useProject)(e,{apiVersion:"v10"}),{team:n}=(0,y.useAccount)(),{can:s,isLoading:o}=(0,f.default)();return!r||o?(0,t.jsx)(T,{}):(0,t.jsx)(k,{can:s,project:r,revalidateProject:i,teamId:n?.id})}function T(){return(0,t.jsx)(v.default,{height:170})}function k(e){let{project:n,revalidateProject:u,teamId:y,can:f}=e,j=n.optionsAllowlist,[b,v]=(0,r.useState)(!!j),[P,T]=(0,r.useState)(j?.paths.map(e=>{let{value:t}=e;return{value:t,key:C(t)}})||[{value:"",key:C("")}]),[k,A]=(0,r.useState)(null),[E,_]=(0,r.useState)(!1),D=f(x.Action.Update,x.Resource.Project),R=f(x.Action.Update,x.Resource.OptionsAllowlist),M=f(x.Action.Read,x.Resource.OptionsAllowlist),O=!D||!R||!M,N=(0,r.useMemo)(()=>JSON.stringify({optionsAllowlist:b?{paths:P.map(e=>{let{value:t}=e;return{value:t}})}:null}),[b,P]),L=(0,r.useMemo)(()=>!!(b?N!==JSON.stringify({optionsAllowlist:j}):j),[b,N,j]),$=(0,r.useMemo)(()=>L?b&&0===P.length?"Must have at least one path":b&&P.some(e=>""===e.value)?"Cannot save empty paths":b&&P.some(e=>!e.value.startsWith("/"))?"Paths must start with a /":void 0:"No changes made",[b,P,L]),B=(0,r.useCallback)(async()=>{if(A(null),!$){_(!0);try{await (0,m.fetchAPI)(`${(0,g.API_PROJECTS_VERSION)("v5")}/${n.id}${(0,h.encode)({teamId:y})}`,{method:"PATCH",body:N,throwOnHTTPError:!0}),b||T([{value:"",key:C("")}]),d.toasts.success("OPTIONS Allowlist updated.")}catch(e){A(`Request failed: ${e.message}`)}await u(),_(!1)}},[n.id,y,u,N,b,$]),V=(0,r.useCallback)(()=>O?(0,t.jsxs)(o.Text,{lineHeight:32,color:"gray-900",children:["You need additional permissions to manage your project's"," ",(0,t.jsx)(c.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-bypass-deployment-protection/options-allowlist",type:"highlight",children:"OPTIONS Allowlist"}),"."]}):(0,t.jsxs)(o.Text,{color:"gray-900",children:["Learn more about"," ",(0,t.jsx)(c.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-bypass-deployment-protection/options-allowlist",type:"highlight",children:"OPTIONS Allowlist"})]}),[O]),F=(0,r.useMemo)(()=>P.length>=5?"Maximum number of paths reached":R?void 0:"Missing required permission",[P,R]),H=(0,r.useCallback)(()=>{A(null),T([...P,{value:"",key:C("")}])},[P]),z=(0,r.useCallback)(e=>{A(null),T(P.filter(t=>t.key!==e))},[P]),U=(0,r.useCallback)((e,t)=>{A(null),T(P.map(r=>r.key===e?{...r,value:t}:r))},[P]),q=(0,r.useCallback)(()=>{A(null),v(!b)},[b]),W={noPermission:R?null:"Missing required permission",noProtectionEnabled:n.ssoProtection||n.passwordProtection||n.trustedIps||j?null:"No protections currently enabled for the project."},Y=W.noPermission||W.noProtectionEnabled;return(0,t.jsx)(w.ProjectSettingsFieldset,{description:(0,t.jsxs)(t.Fragment,{children:["Specify paths to be unprotected for ",(0,t.jsx)("code",{children:"OPTIONS"})," requests. This can be used to enable"," ",(0,t.jsx)(c.Link,{external:!0,href:"https://developer.mozilla.org/en-US/docs/Glossary/Preflight_request",variant:"highlight",children:"CORS preflight"})," ","requests to this project's protected deployments, as browsers do not send authentication on preflight requests. If an incoming request path"," ",(0,t.jsx)(o.Text,{as:"span",color:"inherit",weight:500,children:"starts with"})," ","one of the specified paths, and has the method ",(0,t.jsx)("code",{children:"OPTIONS"}),", the request will bypass deployment protection."]}),disabled:!D,disabledForBilling:O,error:k,highlightNote:!D,note:V(),onSave:B,saveDisabled:!!$,saveDisabledMessage:$,saveLoading:E,title:"OPTIONS Allowlist",headerNote:b?(0,t.jsx)(I.MicrofrontendsHelpBadge,{childHelp:"This configuration only applies to domains belonging to this project.",parentHelp:"This configuration applies to production and pre-production deployments for the group."}):null,children:(0,t.jsxs)(s.Stack,{gap:4,children:[(0,t.jsx)(l.Tooltip,{forceHide:!Y,text:Y,children:(0,t.jsx)(a.Toggle,{"aria-labelledby":"label-for-protection-bypass-automation-header",checked:b,direction:"switch-first",disabled:!!Y,onChange:q,size:"large",children:(0,t.jsx)(o.Text,{color:Y?"gray-900":void 0,id:"label-for-protection-bypass-automation-header",weight:500,children:b?"Enabled":"Disabled"})})}),b?(0,t.jsxs)(t.Fragment,{children:[P.map(e=>(0,t.jsx)(S,{canRemove:P.length>1&&R,onChange:t=>U(e.key,t),onRemove:()=>z(e.key),path:e},e.key)),(0,t.jsx)(l.Tooltip,{style:{alignSelf:"flex-start"},text:F,children:(0,t.jsx)(i.Button,{disabled:!!F,onClick:H,prefix:(0,t.jsx)(p.PlusCircle,{}),size:"small",style:{alignSelf:"flex-start"},type:"secondary",children:"Add path"})})]}):null]})})}function S(e){let{path:r,onRemove:o,canRemove:a,onChange:l}=e;return(0,t.jsxs)(s.Stack,{direction:"row",gap:2,children:[(0,t.jsx)(n.Input,{"aria-labelledby":"path input",defaultValue:r.value,onChange:e=>l(e.target.value),placeholder:"/api",width:"100%"}),(0,t.jsx)(i.Button,{"aria-label":"Remove",disabled:!a,onClick:o,shape:"square",svgOnly:!0,type:"secondary",children:(0,t.jsx)(u.MinusCircle,{})})]})}function C(e){return`${e}-${Math.random()}-${Date.now()}`}function A(){return(0,t.jsx)(r.Suspense,{fallback:(0,t.jsx)(T,{}),children:(0,t.jsx)(P,{})})}}}]);

//# sourceMappingURL=395155c37c07856d.js.map
//# debugId=4413f9e5-92a3-533a-a867-2cc47426ee4d
