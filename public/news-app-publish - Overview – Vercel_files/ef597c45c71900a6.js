
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="4738882f-5979-510f-8294-2f25198463a9")}catch(e){}}();
(globalThis.TURBOPACK=globalThis.TURBOPACK||[]).push(["object"==typeof document?document.currentScript:void 0,{5123665:e=>{e.v({menu:"selector-module__oCmCoq__menu",menuButton:"selector-module__oCmCoq__menuButton",menuItem:"selector-module__oCmCoq__menuItem",text:"selector-module__oCmCoq__text"})},4513341:e=>{e.v({permissionSkeleton:"deployment-retention-module__VXSv3W__permissionSkeleton",permissionText:"deployment-retention-module__VXSv3W__permissionText",selector:"deployment-retention-module__VXSv3W__selector",selectorRow:"deployment-retention-module__VXSv3W__selectorRow",selectorSkeleton:"deployment-retention-module__VXSv3W__selectorSkeleton",selectorTitle:"deployment-retention-module__VXSv3W__selectorTitle",selectorTitleText:"deployment-retention-module__VXSv3W__selectorTitleText",selectors:"deployment-retention-module__VXSv3W__selectors"})},6014267:e=>{e.v({deletedBox:"recently-deleted-deployments-module__SnYF2q__deletedBox",deletedRows:"recently-deleted-deployments-module__SnYF2q__deletedRows",line:"recently-deleted-deployments-module__SnYF2q__line",loadMore:"recently-deleted-deployments-module__SnYF2q__loadMore",loadMoreSkeleton:"recently-deleted-deployments-module__SnYF2q__loadMoreSkeleton",noDeletedBox:"recently-deleted-deployments-module__SnYF2q__noDeletedBox",noDeletedIcon:"recently-deleted-deployments-module__SnYF2q__noDeletedIcon",noDeletedText:"recently-deleted-deployments-module__SnYF2q__noDeletedText",permissionSkeleton:"recently-deleted-deployments-module__SnYF2q__permissionSkeleton",permissionText:"recently-deleted-deployments-module__SnYF2q__permissionText"})},1832150:e=>{e.v({altBackground:"deployment-row-module__0MDG_q__altBackground",daysLeftColumn:"deployment-row-module__0MDG_q__daysLeftColumn",regBackground:"deployment-row-module__0MDG_q__regBackground",titleColumn:"deployment-row-module__0MDG_q__titleColumn"})},2930751:e=>{e.v({avatarSkeleton:"days-left-module__gBhflG__avatarSkeleton",daysLeftContainer:"days-left-module__gBhflG__daysLeftContainer",daysLeftSkeleton:"days-left-module__gBhflG__daysLeftSkeleton",textAlert:"days-left-module__gBhflG__textAlert",textUsual:"days-left-module__gBhflG__textUsual",textWarn:"days-left-module__gBhflG__textWarn"})},4385503:e=>{e.v({env:"env-module__VN_k3a__env",envSkeleton:"env-module__VN_k3a__envSkeleton"})},8461940:e=>{e.v({menu:"menu-module__WU3D1q__menu",menuButton:"menu-module__WU3D1q__menuButton"})},8054295:e=>{e.v({branchSkeleton:"source-module__4oT2TG__branchSkeleton",commitSkeleton:"source-module__4oT2TG__commitSkeleton",deploymentSource:"source-module__4oT2TG__deploymentSource",hiddenOnMobile:"source-module__4oT2TG__hiddenOnMobile",icon:"source-module__4oT2TG__icon",line:"source-module__4oT2TG__line",link:"source-module__4oT2TG__link",nonOriginal:"source-module__4oT2TG__nonOriginal",rebuild:"source-module__4oT2TG__rebuild",sourceLinks:"source-module__4oT2TG__sourceLinks"})},1083513:e=>{e.v({link:"title-module__FVOHYG__link",skeleton:"title-module__FVOHYG__skeleton"})},1286129:e=>{"use strict";e.s({default:()=>eD},1286129);var t=e.i(6645307),n=e.i(5535439),l=e.i(889716),o=e.i(3514588),s=e.i(5454140),i=e.i(557317),a=e.i(6530772),r=e.i(7315479),d=e.i(631755),c=e.i(8934201),u=e.i(8158100),m=e.i(5163670),x=e.i(8811733),h=e.i(8084653),p=e.i(9495609),y=e.i(584439),j=e.i(2362802),f=e.i(3585235),g=e.i(5785123),_=e.i(8975439),S=e.i(2408607),b=e.i(2240289),v=e.i(6958389);function k(e){let[n,l]=(0,a.useState)(""),[o,s]=(0,a.useState)(null),i=(0,a.useRef)(null);return(0,a.useEffect)(()=>{e.active&&setTimeout(()=>i.current?.focus(),0)},[e.active,i]),(0,t.jsx)(c.Modal.Modal,{active:e.active,onClickOutside:e.onCancel,width:500,children:(0,t.jsxs)("form",{onSubmit:t=>{if(t.preventDefault(),e.name!==n.trim())return s(`The text you entered did not match "${e.name}".`);e.onConfirm()},children:[(0,t.jsxs)(c.Modal.Body,{children:[(0,t.jsx)(c.Modal.Title,{children:"Disable Build Logs and Source Protection"}),(0,t.jsx)(x.Spacer,{}),(0,t.jsx)(u.Note,{fill:!0,label:"Warning",type:"error",variant:"contrast",children:"Continuing will make Deployment Status, Build Logs and Source for all deployments publicly accessible."}),(0,t.jsx)(x.Spacer,{}),(0,t.jsxs)("label",{children:[(0,t.jsxs)(h.Text,{children:["Enter ",(0,t.jsx)("b",{style:{overflowWrap:"anywhere"},children:e.name})," to continue:"]}),(0,t.jsx)(x.Spacer,{y:1/4}),(0,t.jsx)(d.Input,{"aria-label":"Confirmation Text",error:o,onChange:e=>{l(e.target.value),s(null)},ref:i,value:n})]})]}),(0,t.jsxs)(c.Modal.Actions,{children:[(0,t.jsx)(c.Modal.Action,{onClick:e.onCancel,type:"secondary",children:"Cancel"}),(0,t.jsx)(c.Modal.Action,{buttonType:"submit",loading:e.loading,children:"Disable"})]})]})})}function T(){let{project:e}=(0,n.useParams)()||{},{data:l,mutate:i}=(0,b.useProject)(String(e)),{data:d}=(0,s.useUser)(),{team:c,isReady:u}=(0,o.useTeam)(),{can:T,isLoading:D}=(0,f.default)(),[C,w]=(0,a.useState)(!l?.publicSource),[N,M]=(0,a.useState)(!1),[P,L]=(0,a.useState)(!1),[B,E]=(0,a.useState)(null),R=(0,y.useToasts)(),F=!l||!u||!d||D||!e;async function I(){if(!F){L(!0),M(!1);try{E(null),await (0,S.default)(e,c?.id,{publicSource:!C}),R.success("Updated Build Logs and Source Protection successfully."),await i()}catch(e){E((0,r.errorToString)(e))}L(!1)}}let O=T(g.Action.Update,g.Resource.Project),A=!F&&O&&!l.publicSource!==C;return(0,a.useEffect)(()=>{F||w(!l.publicSource)},[F,l]),(0,t.jsx)(v.ProjectSettingsFieldset,{description:(0,t.jsxs)(t.Fragment,{children:["Ensures visitors of the ",(0,t.jsx)(_.default,{children:"/_logs"})," and"," ",(0,t.jsx)(_.default,{children:"/_src"})," paths of your Production and Pre-Production Deployments must log in with Vercel (requires being a member of your team) to see the Source, Logs and Deployment Status."]}),disabled:F||!O,error:B,highlightNote:!F&&!O,note:F?(0,t.jsx)(m.Skeleton,{boxHeight:32,vcenter:!0,width:200}):O?(0,t.jsxs)(h.Text,{color:"gray-900",children:["Learn more about"," ",(0,t.jsx)(j.Link,{external:!0,href:"/docs/projects/overview#build-logs-and-source-protection",type:"highlight",children:"Build Logs and Source Protection"})]}):(0,t.jsx)(h.Text,{lineHeight:32,color:"gray-900",children:"You need additional permissions to manage your project's logs and source protection."}),onSave:C?I:()=>M(!0),saveDisabled:!A,saveLoading:P,title:"Build Logs and Source Protection",type:F||C?"default":"error",children:F?(0,t.jsx)(m.Skeleton,{height:30,width:140}):(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{style:{cursor:"pointer"},children:[(0,t.jsx)(p.Toggle,{checked:C,onChange:()=>w(e=>!e),size:"large"}),(0,t.jsx)(x.Spacer,{inline:!0,x:.5}),(0,t.jsx)(h.Text,{as:"span",weight:500,children:C?"Enabled":"Disabled"})]}),(0,t.jsx)(k,{active:N,loading:F,name:[c?.slug??d.user?.username,l.name].join("/"),onCancel:()=>{w(!0),M(!1)},onConfirm:I},String(N))]})})}var D=e.i(5747252);function C(e){let[n,l]=(0,a.useState)(""),[o,s]=(0,a.useState)(null),i=(0,a.useRef)(null);return(0,a.useEffect)(()=>{e.active&&setTimeout(()=>i.current?.focus(),0)},[e.active,i]),(0,t.jsx)(c.Modal.Modal,{active:e.active,onClickOutside:e.onCancel,width:500,children:(0,t.jsxs)("form",{onSubmit:t=>{if(t.preventDefault(),e.name!==n.trim())return s(`The text you entered did not match "${e.name}".`);e.onConfirm()},children:[(0,t.jsxs)(c.Modal.Body,{children:[(0,t.jsx)(c.Modal.Title,{children:"Git Fork Protection"}),(0,t.jsx)(x.Spacer,{}),(0,t.jsx)(u.Note,{fill:!0,label:"Warning",type:"error",variant:"contrast",children:"Continuing will expose your Environment Variables to pull requests from outside of your team."}),(0,t.jsx)(x.Spacer,{}),(0,t.jsxs)("label",{children:[(0,t.jsxs)(h.Text,{children:["Enter ",(0,t.jsx)("b",{style:{overflowWrap:"anywhere"},children:e.name})," to continue:"]}),(0,t.jsx)(x.Spacer,{y:1/4}),(0,t.jsx)(d.Input,{"aria-label":"Confirmation Text",error:o,onChange:e=>{l(e.target.value),s(null)},ref:i,value:n})]})]}),(0,t.jsxs)(c.Modal.Actions,{children:[(0,t.jsx)(c.Modal.Action,{onClick:e.onCancel,type:"secondary",children:"Cancel"}),(0,t.jsx)(c.Modal.Action,{buttonType:"submit",loading:e.loading,children:"Disable"})]})]})})}function w(){let{project:e}=(0,n.useParams)()||{},{data:l,mutate:i}=(0,b.useProject)(String(e)),{data:d}=(0,s.useUser)(),{team:c,isReady:u}=(0,o.useTeam)(),{can:k,isLoading:T}=(0,f.default)(),w=l?.gitForkProtection??!0,[N,M,P]=(0,D.default)(w),[L,B]=(0,a.useState)(!1),[E,R]=(0,a.useState)(!1),[F,I]=(0,a.useState)(null),O=(0,y.useToasts)(),A=!l||!u||!d||T,G=k(g.Action.Update,g.Resource.Project),U=!A&&e&&G&&N!==w;async function q(){if(U){R(!0),B(!1);try{I(null),await (0,S.default)(e,c?.id,{gitForkProtection:N}),O.success("Updated Git Fork Protection successfully."),P(),await i()}catch(e){I((0,r.errorToString)(e))}R(!1)}}return(0,t.jsx)(v.ProjectSettingsFieldset,{description:(0,t.jsxs)(t.Fragment,{children:["Ensures that pull requests targeting your Git repository must be authorized by a member of your Team before deploying if your Project has Environment Variables, OIDC Federation is enabled or if the pull request includes a change to ",(0,t.jsx)(_.default,{children:"vercel.json"}),"."]}),disabled:A||!G,error:F,highlightNote:!A&&!G,note:A?(0,t.jsx)(m.Skeleton,{height:32,width:200}):G?(0,t.jsxs)(h.Text,{color:"gray-900",children:["Learn more about"," ",(0,t.jsx)(j.Link,{external:!0,href:"/docs/project-configuration/security-settings#git-fork-protection",type:"highlight",children:"Git Fork Protection"})]}):(0,t.jsxs)(h.Text,{lineHeight:32,color:"gray-900",children:["You need ",(0,t.jsx)(j.Link,{external:!0,href:"/docs/rbac/access-roles/team-level-roles",type:"highlight",children:"additional permissions"})," ","to manage your project's git fork protection."]}),onSave:N?q:()=>B(!0),saveDisabled:!U,saveLoading:E,title:"Git Fork Protection",type:A||N?"default":"error",children:A?(0,t.jsx)(m.Skeleton,{height:30,width:140}):(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{style:{cursor:"pointer"},children:[(0,t.jsx)(p.Toggle,{checked:N,onChange:()=>M(e=>!e),size:"large"}),(0,t.jsx)(x.Spacer,{inline:!0,x:.5}),(0,t.jsx)(h.Text,{as:"span",weight:500,children:N?"Enabled":"Disabled"})]}),(0,t.jsx)(C,{active:L,loading:A,name:[c?.slug??d.user?.username,l.name].join("/"),onCancel:()=>{M(!0),B(!1)},onConfirm:q},String(L))]})})}function N(e){let[n,l]=(0,a.useState)(""),[o,s]=(0,a.useState)(null),i=(0,a.useRef)(null);return(0,a.useEffect)(()=>{e.active&&setTimeout(()=>i.current?.focus(),0)},[e.active,i]),(0,t.jsx)(c.Modal.Modal,{active:e.active,onClickOutside:e.onCancel,width:500,children:(0,t.jsxs)("form",{onSubmit:t=>{if(t.preventDefault(),e.name!==n.trim())return s(`The text you entered did not match "${e.name}".`);e.onConfirm()},children:[(0,t.jsxs)(c.Modal.Body,{children:[(0,t.jsx)(c.Modal.Title,{children:"Customer Support Code Visibility"}),(0,t.jsx)(x.Spacer,{}),(0,t.jsx)(u.Note,{fill:!0,label:"Warning",type:"error",variant:"contrast",children:"Continuing will allow Vercel customer support to view code for deployments from this project."}),(0,t.jsx)(x.Spacer,{}),(0,t.jsxs)("label",{children:[(0,t.jsxs)(h.Text,{children:["Enter ",(0,t.jsx)("b",{style:{overflowWrap:"anywhere"},children:e.name})," to continue:"]}),(0,t.jsx)(x.Spacer,{y:1/4}),(0,t.jsx)(d.Input,{"aria-label":"Confirmation Text",error:o,onChange:e=>{l(e.target.value),s(null)},ref:i,value:n})]})]}),(0,t.jsxs)(c.Modal.Actions,{children:[(0,t.jsx)(c.Modal.Action,{onClick:e.onCancel,type:"secondary",children:"Cancel"}),(0,t.jsx)(c.Modal.Action,{buttonType:"submit",loading:e.loading,children:"Enable"})]})]})})}function M(){let{project:e}=(0,n.useParams)()||{},{data:l,mutate:i}=(0,b.useProject)(String(e)),{data:d}=(0,s.useUser)(),{team:c,isReady:u}=(0,o.useTeam)(),{can:_,isLoading:k}=(0,f.default)(),T=l?.customerSupportCodeVisibility??!1,[C,w,M]=(0,D.default)(T),[P,L]=(0,a.useState)(!1),[B,E]=(0,a.useState)(!1),[R,F]=(0,a.useState)(null),I=(0,y.useToasts)(),O=!l||!u||!d||k,A=_(g.Action.Update,g.Resource.Project),G=!O&&e&&A&&C!==T;async function U(){if(G){E(!0),L(!1);try{F(null),await (0,S.default)(e,c?.id,{customerSupportCodeVisibility:C}),I.success("Updated customer support code visibility successfully."),M(),await i()}catch(e){F((0,r.errorToString)(e))}E(!1)}}return(0,t.jsx)(v.ProjectSettingsFieldset,{description:(0,t.jsx)(t.Fragment,{children:"Allows Vercel Customer Support to inspect all Deployments' source code in this project to assist with debugging."}),disabled:O||!A,error:R,highlightNote:!O&&!A,note:O?(0,t.jsx)(m.Skeleton,{height:32,width:200}):A?null:(0,t.jsxs)(h.Text,{lineHeight:32,children:["You need"," ",(0,t.jsx)(j.Link,{external:!0,href:"/docs/rbac/access-roles/team-level-roles",type:"highlight",children:"additional permissions"})," ","to manage"," ",(0,t.jsx)(j.Link,{external:!0,href:"/docs/project-configuration/security-settings",type:"highlight",children:"customer success code visibility"}),"."]}),onSave:C?()=>L(!0):U,saveDisabled:!G,saveLoading:B,title:"Customer Success Code Visibility",type:"default",children:O?(0,t.jsx)(m.Skeleton,{height:30,width:140}):(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{style:{cursor:"pointer"},children:[(0,t.jsx)(p.Toggle,{checked:C,onChange:()=>w(e=>!e),size:"large"}),(0,t.jsx)(x.Spacer,{inline:!0,x:.5}),(0,t.jsx)(h.Text,{as:"span",weight:500,children:C?"Enabled":"Disabled"})]}),(0,t.jsx)(N,{active:P,loading:O,name:[c?.slug??d.user?.username,l.name].join("/"),onCancel:()=>{w(!0),L(!1)},onConfirm:U},String(P))]})})}var P=e.i(3921802),L=e.i(4519408),B=e.i(6530145),E=e.i(604868);function R(){let e=(0,E.useIsMobile)(),{project:s}=(0,n.useParams)()||{},{data:i,mutate:d}=(0,b.useProject)(String(s),{apiVersion:"v9"}),{team:c,isReady:u}=(0,o.useTeam)(),{can:x,isLoading:p}=(0,f.default)(),_=i?.oidcTokenConfig,[k,T,C]=(0,D.default)(_?.issuerMode??"team"),[w,N]=(0,a.useState)(!1),[M,R]=(0,a.useState)(null),F=x(g.Action.Update,g.Resource.Project),I=(0,y.useToasts)(),O=!i||!s||!u||p,A=!(O||!F)&&k!==_?.issuerMode;async function G(){if(A){N(!0),R(null);try{await (0,S.updateProjectSettingsV9)(s,c?.id,{oidcTokenConfig:{issuerMode:k}}),I.success("Updated Secure Backend Access with OIDC Federation settings successfully."),C(),await d()}catch(e){R((0,r.errorToString)(e))}finally{N(!1)}}}let U=Math.floor(Date.now()/1e3),q=[{name:"iss",kind:"Issuer",value:"global"===k?"https://oidc.vercel.com":`https://oidc.vercel.com/${c?.slug}`},{name:"aud",kind:"Audience",value:`https://vercel.com/${c?.slug}`},{name:"sub",kind:"Subject",value:`owner:${c?.slug}:project:${s}:environment:production`},{name:"scope",kind:"Scope",value:`owner:${c?.slug}:project:${s}:environment:production`},{name:"iat",kind:"Issued At",value:U},{name:"nbf",kind:"Not Before",value:U},{name:"exp",kind:"Expiration",value:U+3600}];return(0,t.jsxs)(v.ProjectSettingsFieldset,{description:(0,t.jsx)(h.Text,{as:"span",children:"Authenticate with your cloud providers using OpenID Connect JSON Web Tokens."}),error:M,highlightNote:!O&&!F,note:O?(0,t.jsx)(m.Skeleton,{height:32,width:200}):(0,t.jsxs)(h.Text,{color:"gray-900",children:["Learn more about"," ",(0,t.jsx)(j.Link,{external:!0,href:"/docs/oidc",type:"highlight",children:"Secure Backend Access with OIDC Federation"})]}),onSave:G,saveDisabled:!A,saveDisabledMessage:F?void 0:"You need additional permissions to manage OIDC Federation settings.",saveLoading:w,title:"Secure Backend Access with OIDC Federation",type:M?"error":"default",children:[(0,t.jsx)(l.Stack,{paddingBottom:2,children:(0,t.jsx)(m.Skeleton,{show:O,children:(0,t.jsxs)(L.ChoiceboxGroup,{disabled:!F,direction:e?"column":"row",label:"Issuer Mode",onChange:e=>T(e),showLabel:!0,type:"radio",value:k,children:[(0,t.jsx)(L.ChoiceboxGroup.Item,{description:(0,t.jsxs)("span",{className:"font-mono text-xs text-gray-900",children:["https://oidc.vercel.com/",(0,t.jsx)("wbr",{}),c?.slug]}),title:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"text-gray-900",children:"Team"})," ",(0,t.jsx)(P.Badge,{size:"sm",variant:F?"blue":"gray",children:"Recommended"})]}),value:"team"}),(0,t.jsx)(L.ChoiceboxGroup.Item,{description:(0,t.jsx)("span",{className:"font-mono text-xs text-gray-900",children:"https://oidc.vercel.com"}),title:(0,t.jsx)("span",{className:"text-gray-900",children:"Global"}),value:"global"})]})})}),(0,t.jsxs)(B.Table,{children:[(0,t.jsxs)(B.Table.Colgroup,{children:[(0,t.jsx)(B.Table.Col,{className:"w-[15%]"}),(0,t.jsx)(B.Table.Col,{className:"w-[15%]"})]}),(0,t.jsx)(B.Table.Header,{children:(0,t.jsxs)(B.Table.Row,{children:[(0,t.jsx)(B.Table.Head,{children:"Claim"}),(0,t.jsx)(B.Table.Head,{children:"Kind"}),(0,t.jsx)("th",{className:"text-muted-foreground h-10 px-2 text-left align-middle font-medium",children:"Value"})]})}),(0,t.jsx)(B.Table.Body,{interactive:!0,striped:!0,children:q.map(e=>(0,t.jsxs)(B.Table.Row,{children:[(0,t.jsx)(B.Table.Cell,{children:(0,t.jsx)("code",{className:"rounded border p-1",children:e.name})}),(0,t.jsx)(B.Table.Cell,{children:e.kind}),(0,t.jsx)("td",{className:"px-2 py-2.5",children:O?(0,t.jsx)(m.Skeleton,{width:"100%"}):(0,t.jsx)("pre",{children:e.value})})]},e.name))})]})]})}var F=e.i(1183506),I=e.i(9336536),O=e.i(6858714),A=e.i(9948746),G=e.i(4237550),U=e.i(653558),q=e.i(2733203),V=e.i(1190215),W=e.i(4105925),$=e.i(5123665);function Y(e){let{values:n,selectedValue:l,onChange:o,disabled:s,ariaLabel:i}=e,a=n.find(e=>{let{value:t}=e;return t===l});return(0,t.jsxs)(V.MenuContainer,{position:"bottom-end",children:[(0,t.jsx)(q.MenuButton,{align:"start","aria-label":i,disabled:s,suffix:(0,t.jsx)(G.ChevronDown,{}),svgOnly:!0,type:"secondary",typeName:"button",children:(0,t.jsx)(h.Text,{children:a?.label??""})}),(0,t.jsx)(U.Menu,{className:$.default.menu,children:n.map(e=>{let{value:n,label:s}=e;return(0,t.jsx)(W.MenuItem,{className:$.default.menuItem,onClick:()=>{n!==l&&o(n)},suffix:l===n?(0,t.jsx)(A.Check,{}):null,children:(0,t.jsx)(h.Text,{className:$.default.text,children:s})},n)})})]})}var H=e.i(4513341);function z(e){let{title:n,selectedDays:o,onChange:s,loading:i}=e,r=(0,a.useMemo)(()=>{let e=O.retentionOptions.map(e=>{let{days:t,label:n}=e;return{label:n,value:t}});return -1===e.findIndex(e=>{let{value:t}=e;return t===o})&&e.unshift({label:o>1?`${o} days`:`${o} day`,value:o}),e},[o]);return(0,t.jsxs)(l.Stack,{className:H.default.selectorRow,children:[(0,t.jsx)(l.Stack,{className:H.default.selectorTitle,children:(0,t.jsx)(h.Text,{className:H.default.selectorTitleText,children:n})}),(0,t.jsx)(l.Stack,{className:H.default.selector,children:i?(0,t.jsx)(m.Skeleton,{className:H.default.selectorSkeleton}):(0,t.jsx)(Y,{ariaLabel:"Select the deployment retention policy",disabled:i,onChange:s,selectedValue:o,values:r})})]})}function X(){let{project:e}=(0,n.useParams)()||{},{data:i,mutate:d}=(0,b.useProject)(String(e),{fetchParams:{includeDeleted:!0}}),{data:c}=(0,s.useUser)(),{team:u,isReady:x}=(0,o.useTeam)(),p=u?.id,{can:_,isLoading:S}=(0,f.default)(),[k,T]=(0,a.useState)(!1),[D,C]=(0,a.useState)(!1),[w,N]=(0,a.useState)(null),M=(0,y.useToasts)(),P=!i||!x||!c||S,L=_(g.Action.Write,g.Resource.ProjectDeploymentExpiration),B=!P&&e&&L&&k,[E,R]=(0,a.useState)((0,O.defaultDeploymentExpiration)());(0,a.useEffect)(()=>{i?.deploymentExpiration&&R(i.deploymentExpiration)},[i,M]);let A=(0,a.useCallback)(e=>{let t={...E};t.expirationDays=(0,O.getDaysFromOption)(e)??(0,O.defaultDeploymentExpiration)().expirationDays,R(t),T(!0)},[E]),G=(0,a.useCallback)(e=>{let t={...E};t.expirationDaysProduction=(0,O.getDaysFromOption)(e)??(0,O.defaultDeploymentExpiration)().expirationDaysProduction,R(t),T(!0)},[E]),U=(0,a.useCallback)(e=>{let t={...E};t.expirationDaysCanceled=(0,O.getDaysFromOption)(e)??(0,O.defaultDeploymentExpiration)().expirationDaysCanceled,R(t),T(!0)},[E]),q=(0,a.useCallback)(e=>{let t={...E};t.expirationDaysErrored=(0,O.getDaysFromOption)(e)??(0,O.defaultDeploymentExpiration)().expirationDaysErrored,R(t),T(!0)},[E]);async function V(){if(B){C(!0);try{N(null),await (0,F.fetchAPI)(`${(0,I.API_PROJECTS_DEPLOYMENT_RETENTION)(i.id)}?teamId=${encodeURIComponent(p??"")}`,{method:"PATCH",body:(0,O.generateDeploymentRetentionRequestBody)(E),throwOnHTTPError:!0}),M.success("Updated deployment retention policy successfully."),await d()}catch(e){N((0,r.errorToString)(e))}C(!1),T(!1)}}return(0,t.jsx)(v.ProjectSettingsFieldset,{description:(0,t.jsx)(h.Text,{as:"span",children:"Define a retention period for all Deployments for this Project. Deployments will be deleted after the defined time."}),disabled:P||!L,error:w,highlightNote:!P&&!L,note:P?(0,t.jsx)(m.Skeleton,{className:H.default.permissionSkeleton}):L?(0,t.jsxs)(h.Text,{className:H.default.permissionText,children:["Learn more about"," ",(0,t.jsx)(j.Link,{external:!0,href:"/docs/security/deployment-retention",type:"highlight",children:"Deployment Retention"})]}):(0,t.jsx)(h.Text,{className:H.default.permissionText,children:"You need additional permissions to manage deployments retention policies on this project."}),onSave:V,saveDisabled:!B,saveLoading:D,title:"Deployment Retention Policy",type:"default",children:(0,t.jsxs)(l.Stack,{className:H.default.selectors,children:[(0,t.jsx)(z,{title:"Canceled Deployments",selectedDays:E.expirationDaysCanceled??(0,O.defaultDeploymentExpiration)().expirationDaysCanceled,onChange:U,loading:P}),(0,t.jsx)(z,{title:"Errored Deployments",selectedDays:E.expirationDaysErrored??(0,O.defaultDeploymentExpiration)().expirationDaysErrored,onChange:q,loading:P}),(0,t.jsx)(z,{title:"Pre-Production Deployments",selectedDays:E.expirationDays??(0,O.defaultDeploymentExpiration)().expirationDays,onChange:A,loading:P}),(0,t.jsx)(z,{title:"Production Deployments",selectedDays:E.expirationDaysProduction??(0,O.defaultDeploymentExpiration)().expirationDaysProduction,onChange:G,loading:P})]})})}var K=e.i(9185154),J=e.i(3387593),Z=e.i(9981955),Q=e.i(6596840),ee=e.i(1766200),et=e.i(6014267),en=e.i(1832150),el=e.i(2567082),eo=e.i(2774739),es=e.i(1628584),ei=e.i(2930751);function ea(e){let{deployment:n}=e,o=(n?.deleted??Date.now())+(0,el.default)("30d"),s=Math.max(Math.floor((o-Date.now())/864e5),0),i=(0,eo.useDaysLeft)(o),a="";return s<=7?a=ei.default.textAlert:s>7&&s<=14?a=ei.default.textWarn:s>14&&(a=ei.default.textUsual),(0,t.jsxs)(l.Stack,{className:ei.default.daysLeftContainer,children:[n?(0,t.jsx)(h.Text,{className:a,children:i}):(0,t.jsx)(m.Skeleton,{className:ei.default.daysLeftSkeleton}),n?(0,t.jsx)(es.CreatorAvatar,{deployment:n,showProviderIcon:!0,size:16}):(0,t.jsx)(m.Skeleton,{className:ei.default.avatarSkeleton})]})}var er=e.i(9244225),ed=e.i(4385503);function ec(e){let{deployment:n}=e;return(0,t.jsx)(t.Fragment,{children:n?(0,t.jsx)(h.Text,{className:ed.default.env,children:null!==n.target?(0,er.default)(n.target):"Preview"}):(0,t.jsx)(m.Skeleton,{className:ed.default.envSkeleton})})}var eu=e.i(5124754),em=e.i(587741),ex=e.i(8461940);function eh(e){let{deployment:n,handleUndeleteDeployment:l,canUpdateDeployment:o}=e,s=(0,em.useDeploymentLink)(n);if(!n)return(0,t.jsx)(V.MenuContainer,{children:(0,t.jsx)(q.MenuButton,{"aria-label":"Menu",className:ex.default.menuButton,disabled:!0,svgOnly:!0,typeName:"button",children:(0,t.jsx)(eu.MoreHorizontal,{})})});let i="deleted"in n&&"state"in n?()=>l?.((0,O.getDeploymentId)(n)??""):void 0;return(0,t.jsxs)(V.MenuContainer,{children:[(0,t.jsx)(q.MenuButton,{"aria-label":"Menu",className:ex.default.menuButton,svgOnly:!0,typeName:"button",children:(0,t.jsx)(eu.MoreHorizontal,{})}),(0,t.jsxs)(U.Menu,{className:ex.default.menu,children:[(0,t.jsx)(W.MenuItem,{children:(0,t.jsx)(j.Link,{external:!0,href:s,children:"View Source"})}),o?(0,t.jsx)(W.MenuItem,{onClick:i,children:"Restore"}):null,null]})]})}var ep=e.i(9385465),ey=e.i(869010),ej=e.i(4812394),ef=e.i(8025298),eg=e.i(5938635),e_=e.i(8054295);function eS(e){let n,{deployment:o,deploymentsMap:s}=e,i=o?.meta?.originalDeploymentId,r=i?String(i):void 0;r&&(n=s?.get(r));let{data:d,isLoading:c}=(0,eg.default)(n?void 0:r,{revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!1});d&&(n=d);let u=(0,em.useDeploymentLink)(n),x=(0,a.useMemo)(()=>n?(0,ef.default)(n).hash:"",[n]);if(!o)return(0,t.jsxs)(l.Stack,{className:`${e_.default.deploymentSource} ${e_.default.hiddenOnMobile}`,children:[(0,t.jsx)(m.Skeleton,{className:e_.default.branchSkeleton}),(0,t.jsx)(m.Skeleton,{className:e_.default.commitSkeleton})]});if(r){let e=o.meta?.action==="promote"||"production"===o.target&&n?.target!=="production";return(0,t.jsx)(l.Stack,{className:`${e_.default.deploymentSource} ${e_.default.hiddenOnMobile}`,children:(0,t.jsx)(l.Stack,{className:e_.default.line,children:c?(0,t.jsx)(m.Skeleton,{className:e_.default.branchSkeleton}):(0,t.jsxs)(l.Stack,{className:e_.default.nonOriginal,children:[e?(0,t.jsx)(ey.ArrowCircleUp,{className:e_.default.icon}):(0,t.jsx)(ep.RotateCounterClockwise,{className:e_.default.icon}),(0,t.jsxs)(h.Text,{className:e_.default.rebuild,children:[e?"Production Rebuild":"Redeploy"," of"," ",n?(0,t.jsx)(j.Link,{className:e_.default.link,href:u,title:n.host||"",variant:"secondary",children:x?(0,t.jsx)(_.default,{children:x}):n.host||""}):"a deleted deployment"]})]})})})}return(0,t.jsx)(l.Stack,{className:`${e_.default.deploymentSource} ${e_.default.hiddenOnMobile}`,children:(0,t.jsx)(ej.DeploymentSourceLinks,{deployment:o})})}var eb=e.i(1083513);function ev(e){let{deployment:n}=e,l=(0,em.useDeploymentLink)(n);return(0,t.jsx)(t.Fragment,{children:n?(0,t.jsx)(j.Link,{className:eb.default.link,href:l,title:n.url,children:(0,t.jsx)(h.Text,{size:14,truncate:!0,weight:600,children:n.url.startsWith(n.name)?n.url.replace(`${n.name}-`,"").split(/[^a-zA-Z0-9]/)[0]:n.url})}):(0,t.jsx)(m.Skeleton,{className:eb.default.skeleton})})}function ek(e){let{deployment:n,deploymentsMap:o,handleUndeleteDeployment:s,alternate:i}=e,{can:a}=(0,f.default)(),r=n?.target!==null?g.Resource.Deployment:g.Resource.DeploymentPreview,d=a(g.Action.Update,r);return(0,t.jsxs)(l.Stack,{className:i?en.default.altBackground:en.default.regBackground,children:[(0,t.jsxs)(l.Stack,{className:en.default.titleColumn,children:[(0,t.jsx)(ev,{deployment:n}),(0,t.jsx)(ec,{deployment:n})]}),(0,t.jsx)(eS,{deployment:n,deploymentsMap:o}),(0,t.jsxs)(l.Stack,{className:en.default.daysLeftColumn,children:[(0,t.jsx)(ea,{deployment:n}),(0,t.jsx)(eh,{canUpdateDeployment:d,deployment:n,handleUndeleteDeployment:()=>s?.(n?.uid??"xxx")})]})]})}function eT(){let{project:e}=(0,n.useParams)()||{},{data:i}=(0,b.useProject)(String(e),{fetchParams:{includeDeleted:!0,isDeleted:!0}}),{data:r}=(0,s.useUser)(),{team:d,isReady:c}=(0,o.useTeam)(),{can:u,isLoading:x}=(0,f.default)(),p=!i||!c||!r||x,[y,_]=(0,a.useState)(void 0),{deployments:S,isLoadingMore:k,isReachingEnd:T,isEmpty:D,initialDataLoaded:C,loadMore:w,mutate:N}=(0,ee.useDeploymentsInfinite)({limit:30,project:i,requireProject:!0,state:"DELETED"},{refreshInterval:5e3})[1],M=S.filter(e=>(0,O.isDeleted)(e)),P=(0,a.useRef)(new Map);for(let e of S)P.current.set(e.uid,e);let L=u(g.Action.Write,g.Resource.Deployment);return(0,t.jsx)(v.ProjectSettingsFieldset,{description:(0,t.jsxs)(h.Text,{as:"span",children:["These deployments have been deleted based on your"," ",(0,t.jsx)(j.Link,{href:"#deployment-retention-policy",children:"defined retention policy."})," ","Deployments can be restored within 30 days of their initial deletion."]}),disabled:p||!L,highlightNote:!p&&!L,note:p?(0,t.jsx)(m.Skeleton,{className:et.default.permissionSkeleton}):L?(0,t.jsxs)(h.Text,{className:et.default.permissionText,children:["Learn more about"," ",(0,t.jsx)(j.Link,{external:!0,href:"/docs/security/deployment-retention",type:"highlight",children:"Recently Deleted Deployments"})]}):(0,t.jsx)(h.Text,{className:et.default.permissionText,children:"You need additional permissions to manage your project's Recently Deleted Deployments."}),title:"Recently Deleted Deployments",type:"default",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("hr",{className:et.default.line}),p||!C?(0,t.jsxs)(l.Stack,{className:et.default.deletedBox,children:[(0,t.jsxs)(l.Stack,{className:et.default.deletedRows,children:[(0,t.jsx)(ek,{alternate:!0},"loading-deployment-1"),(0,t.jsx)(ek,{},"loading-deployment-2"),(0,t.jsx)(ek,{alternate:!0},"loading-deployment-3"),(0,t.jsx)(ek,{},"loading-deployment-4")]}),(0,t.jsx)(l.Stack,{className:et.default.loadMore,children:(0,t.jsx)(m.Skeleton,{className:et.default.loadMoreSkeleton})})]}):(0,t.jsxs)(l.Stack,{className:et.default.deletedBox,children:[(0,t.jsx)(l.Stack,{className:et.default.deletedRows,children:D&&0===M.length?(0,t.jsxs)(l.Stack,{className:et.default.noDeletedBox,children:[(0,t.jsx)(Z.ArrowGlobe,{className:et.default.noDeletedIcon}),(0,t.jsx)(h.Text,{className:et.default.noDeletedText,children:"No recently deleted deployments were found."})]}):(0,t.jsx)(J.Scroller,{className:et.default.deletedRowScroll,overflow:"y",children:M.map((e,n)=>(0,t.jsx)(ek,{alternate:n%2==0,deployment:e,deploymentsMap:P.current,handleUndeleteDeployment:()=>_(e.uid)},e.uid))})}),(0,t.jsx)(l.Stack,{className:et.default.loadMore,children:T||D&&0===M.length?null:(0,t.jsx)(K.LoadMoreButton,{loading:k,onClick:async()=>{await w()}})})]}),(0,t.jsx)(Q.default,{active:!!y,deploymentId:y,onClose:async()=>{await N(),_(void 0)},teamId:d?.id})]})})}let eD=function(){let{project:e}=(0,n.useParams)()??{},{data:a,isLoading:r}=(0,b.useProject)(e),{team:d,isLoading:c}=(0,o.useTeam)(),{user:u,isLoading:m}=(0,s.useUser)(),x=!a?.publicSource&&!r&&!c&&!m&&!!(u||d)&&!!a&&"hobby"!==(d?.billing?.plan||u?.billing?.plan);return(0,t.jsxs)(l.Stack,{gap:8,children:[(0,t.jsx)(i.HeadTitle,{title:`${e||""} â€“ Security`,titlePostfix:!0}),(0,t.jsx)(T,{}),x?(0,t.jsx)(M,{}):null,(0,t.jsx)(w,{}),(0,t.jsx)(R,{}),(0,t.jsx)(X,{}),(0,t.jsx)(eT,{})]})}}}]);

//# sourceMappingURL=682ea6528e985ebd.js.map
//# debugId=4738882f-5979-510f-8294-2f25198463a9
