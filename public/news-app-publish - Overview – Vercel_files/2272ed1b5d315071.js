
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="232d6aef-19c0-5acf-8b46-c023c1a25402")}catch(e){}}();
(globalThis.TURBOPACK=globalThis.TURBOPACK||[]).push(["object"==typeof document?document.currentScript:void 0,{212250:e=>{"use strict";e.s({useDeploymentOverviewProject:()=>r});var t=e.i(5535439),n=e.i(3345839),i=e.i(8935741),a=e.i(44994);function r(e){let{teamSlug:r}=(0,t.useParams)()??{};return(0,n.useIsomorphicSWR)(e?(0,a.getProjectKey)(e,{apiVersion:"v10",teamId:r,activeBranches:!0,latestDeployments:10,fetchParams:{rollbackInfo:!0}}):null,async(e,t)=>{try{let n=await t(e);return(0,a.transformDeploymentOverviewProject)(n)}catch(e){if((0,i.isAPIErrorForbidden)(e)||(0,i.isAPIErrorNotFound)(e))return null;throw e}})}},1095083:e=>{"use strict";e.s({DeploymentOverviewMetadata:()=>s},1095083);var t=e.i(6645307),n=e.i(5535439),i=e.i(5355940),a=e.i(5665687),r=e.i(2729985);let l={QUEUED:`${r.favIconFolder}/queued.ico`,BUILDING:`${r.favIconFolder}/building.ico`,READY:`${r.favIconFolder}/success.ico`,ERROR:`${r.favIconFolder}/error.ico`,CANCELED:`${r.favIconFolder}/queued.ico`,DELETED:`${r.favIconFolder}/building.ico`,INITIALIZING:`${r.favIconFolder}/building.ico`,UPLOADING:`${r.favIconFolder}/building.ico`,DEPLOYING:`${r.favIconFolder}/building.ico`};var o=e.i(212250);function s(){let e=(0,n.useParams)(),{data:r,isLoading:s}=(0,i.useDashboardDeployment)({deploymentId:e?.id,projectName:e?.project,teamSlug:e?.teamSlug}),{data:c}=(0,o.useDeploymentOverviewProject)(e?.project),{areChecksRunning:d,areDomainsAssigning:u}=(0,a.getDeploymentStatus)(r),p=(e=>{let{readyState:t,otherBitsRunning:n,hasFailure:i}=e;return n?l.BUILDING:i?l.ERROR:t&&l[t]?l[t]:void 0})({readyState:r?.readyState,otherBitsRunning:d||u,hasFailure:r?.checksConclusion==="failed"||!!r?.aliasError});return(!s||r)&&p?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("title",{children:c?.name?`${c.name} – Deployment Overview`:"Deployment Overview"}),(0,t.jsx)("link",{href:p,rel:"icon shortcut",type:"image/x-icon"},"active-favicon")]}):null}},3789090:e=>{"use strict";e.s({DeploymentActions:()=>a});var t=e.i(6530772),n=e.i(5535439),i=e.i(9415891);function a(){let{teamSlug:e,project:a}=(0,n.useParams)()??{},{data:r}=(0,i.useDeploymentInterval)(),l=(0,n.useRouter)(),o=(0,n.useSearchParams)(),s=(0,t.useRef)(!1),c=o?.get("redirect");return(0,t.useEffect)(()=>{r?.project&&r.project.name!==a&&l.replace(`/${e}/${r.project.name}/${r.id.replace(/^dpl_/,"")}`)},[r,e,a,l]),(0,t.useEffect)(()=>{c&&!s.current&&r&&"READY"===r.readyState&&!r.public&&(s.current=!0,l.push(`https://${r.host}`))},[r,c,l]),null}},6765412:e=>{"use strict";e.s({ProjectFeatures:()=>m,ProjectFeaturesSkeleton:()=>p},6765412);var t=e.i(6645307),n=e.i(5535439),i=e.i(3921802),a=e.i(8084653),r=e.i(9802771),l=e.i(7573892),o=e.i(3514588),s=e.i(2362802),c=e.i(6967562),d=e.i(212250),u=e.i(9415891);function p(){return(0,t.jsx)("div",{className:"tailwind-preflight",children:(0,t.jsx)("div",{className:"flex w-full flex-col items-stretch gap-3 [@media(min-width:1070px)]:flex-row",children:c.ProjectFeatureList.map(e=>(0,t.jsx)(h,{feature:e},e.name))})})}function m(){let{project:e}=(0,n.useParams)()??{},{data:i}=(0,u.useDeploymentInterval)(),{team:a}=(0,o.useTeam)(),{data:r}=(0,d.useDeploymentOverviewProject)(e),l=a?.billing?.plan;return(0,t.jsx)("div",{className:"tailwind-preflight",children:(0,t.jsx)("div",{className:"flex w-full flex-col items-stretch gap-3 [@media(min-width:1070px)]:flex-row",children:c.ProjectFeatureList.map(e=>(0,t.jsx)(x,{billingPlan:l,enabled:e.isEnabled(i),feature:e,hasData:e.hasData(i,r||void 0),isNew:e.isNew,loading:!i||!r,projectId:i?.projectId},e.name))})})}function h(e){let{feature:n}=e;return(0,t.jsxs)("div",{className:"flex flex-1 items-center gap-1.5 rounded bg-background-100 box-decoration-clone py-2.5 pl-4 pr-2 no-underline shadow-md transition-shadow hover:shadow-lg",style:{height:"auto",flex:1},children:[(0,t.jsx)(c.IconWrapper,{className:"-ml-2 [@media(min-width:1070px)]:hidden",variant:"secondary",children:n.icon}),(0,t.jsxs)("div",{className:"mb-0.5 w-full flex-1 flex-col",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(a.Text,{className:"flex-1",weight:600,children:n.name}),(0,t.jsx)("div",{className:"h-6"})]}),(0,t.jsx)(a.Text,{className:"whitespace-normal",color:"gray-700",variant:"copy-13",children:n.descriptionShort||n.description})]})]})}function x(e){let{feature:o,enabled:d,projectId:u,loading:p,hasData:m,isNew:h,billingPlan:x}=e,y=function(e){let t=(0,n.usePathname)();return`${t?t.split("/").slice(0,3).join("/"):""}${e.link}`}(o);return(0,t.jsxs)(s.Link,{className:"flex flex-1 items-center gap-1.5 rounded bg-background-100 box-decoration-clone py-2.5 pl-4 pr-2 no-underline shadow-md transition-shadow hover:shadow-lg",href:y,onClick:()=>{u&&l.analytics.track(r.AnalyticsEvent.DEPLOYMENT_PROJECT_FEATURE_CTA_CLICKED,{enabled:d,feature:o.id,projectId:u,plan:x})},style:{height:"auto",flex:1},children:[(0,t.jsx)(c.IconWrapper,{className:"-ml-2 [@media(min-width:1070px)]:hidden",variant:"secondary",children:o.icon}),(0,t.jsxs)("div",{className:"mb-0.5 w-full flex-1 flex-col",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(a.Text,{className:"flex-1",weight:600,children:o.name}),(p?null:h?(0,t.jsx)(i.Badge,{variant:"blue-subtle",children:"New"}):d?m?null:(0,t.jsx)(i.Badge,{variant:"amber-subtle",children:"No Data"}):(0,t.jsx)(i.Badge,{className:"!bg-gray-alpha-100",variant:"gray-subtle",children:"Not Enabled"}))||(0,t.jsx)("div",{className:"h-6"})]}),(0,t.jsx)(a.Text,{className:"whitespace-normal",color:"gray-700",variant:"copy-13",children:o.descriptionShort||o.description})]})]})}},5371095:e=>{"use strict";e.s({DeploymentSteps:()=>c,DeploymentStepsSkeleton:()=>s});var t=e.i(6645307),n=e.i(4965453),i=e.i(5535439);e.i(4944618);var a=e.i(2417313),r=e.i(9415891),l=e.i(4293922),o=e.i(6382903);function s(e){return(0,t.jsx)(n.Root,{defaultValue:[],disabled:!0,className:"rounded bg-background-100 shadow-sm",type:"multiple",children:(0,t.jsx)(l.DeployStepsSkeleton,{...e})})}function c(e){let{microfrontendsSupportEnabled:n}=e,{data:l,mutate:s}=(0,r.useDeploymentInterval)(),{teamSlug:c}=(0,i.useParams)()??{},{expandedSteps:d,setExpandedSteps:u}=(0,o.useExpandedSteps)(l);return(0,t.jsx)(a.DeploySteps,{creationFlow:!1,deployment:l,enableLineHighlighting:!0,expandedSteps:d,microfrontendsSupportEnabled:n,mutateDeployment:s,onExpandedStepsChange:u,teamSlug:c})}},7889764:[e=>{"use strict";e.s({useCurrentDashboardDeploymentOverviewProject:()=>i},7889764);var t=e.i(5535439),n=e.i(5990478);function i(e){let{project:i,teamSlug:a}=(0,t.useParams)()??{};if(!a||!i)throw Error("Missing params");return(0,n.useDashboardDeploymentOverviewProject)({projectSlug:i,teamSlug:a},e)}e.s({useIsCurrentProductionDeployment:()=>r},4355978);var a=e.i(3184563);function r(e){let{project:n}=(0,t.useParams)()??{},{deployment:i}=(0,a.useProjectProductionDeployment)(n);return!!(e&&i?.id===(e.id||e.uid))}},[4355978]],4714386:[e=>{"use strict";e.s({DeploymentModalsProvider:()=>N,useDeploymentModals:()=>L},4714386);var t=e.i(6645307),n=e.i(6530772),i=e.i(2763735),a=e.i(7889764),r=e.i(1124439),l=e.i(1915950),o=e.i(1213995),s=e.i(1562781),c=e.i(2362802),d=e.i(1917237),u=e.i(8934201),p=e.i(8811733),m=e.i(8084653),h=e.i(584439),x=e.i(1164214),y=e.i(1183506),g=e.i(9336536),j=e.i(3514588),b=e.i(9630325),f=e.i(6859825),v=e.i(5535439),k=e.i(2448773),w=e.i(212250);let C=(0,n.memo)(function(e){let{active:i,onClose:a,deployment:r,teamId:l}=e,[o,s]=(0,n.useState)(!1),c=(0,v.useRouter)(),{teamSlug:d,project:p}=(0,v.useParams)()??{},{data:m}=(0,w.useDeploymentOverviewProject)(p),h=(0,n.useCallback)(async()=>{s(!0);let e=l?`?teamId=${l}`:"";await (0,y.fetchAPI)(`${(0,g.API_DEPLOYMENTS)("v2")}/${r.id}${e}`,{throwOnHTTPError:!0,method:"DELETE"}),c.replace(`/${d??""}/${encodeURIComponent(m?.name||"")}?deploymentDeleted=1`),s(!1)},[r,l,c,m,d]);return(0,t.jsxs)(u.Modal.Modal,{active:i,onClickOutside:a,width:"500px",children:[(0,t.jsxs)(u.Modal.Body,{children:[(0,t.jsx)(u.Modal.Header,{children:(0,t.jsx)(u.Modal.Title,{children:"Delete Deployment"})}),(0,t.jsxs)(k.default,{preset:"body-2",children:[(0,t.jsx)("b",{children:"NOTE:"})," Deployments that are not actively receiving any traffic do not generate any costs nor count towards any limits."]}),(0,t.jsx)(k.default,{preset:"body-2",children:"Deleting this deployment will prevent you from instantly reverting and might break links used in integrations, such as the ones in the pull requests of your Git provider."}),(0,t.jsx)(k.default,{preset:"body-2",style:{marginBottom:0},children:"Are you sure you want to continue?"})]}),(0,t.jsxs)(u.Modal.Actions,{children:[(0,t.jsx)(u.Modal.Action,{loading:!1,onClick:a,type:"secondary",children:"Cancel"}),(0,t.jsx)(u.Modal.Action,{disabled:o,loading:o,onClick:h,children:"Delete"})]})]})});e.s({useDeploymentPermissions:()=>I},3428813);var D=e.i(7753619),S=e.i(3585235),A=e.i(5785123);function I(e){let{project:t,deployment:n}=e,{can:i,isLoading:a}=(0,S.default)({projectIdOrName:t?.name}),{isLoggedOut:r}=(0,D.useIsLoggedIn)(),l=n?.target!==null?A.Resource.DeploymentFromProductionBranch:A.Resource.DeploymentPreview,o=i(A.Action.Create,l),s=i(A.Action.Update,l),c=i(A.Action.Read,l)||!!(r&&n?.public),d=i(A.Action.Delete,l);return{isLoading:a,permissions:{canCreateDeployment:o,canUpdateDeployment:s,canReadDeployment:c,canDeleteDeployment:d,canPromoteToProduction:i(A.Action.Create,A.Resource.Deployment),canUpdateSkewProtection:i(A.Action.Update,A.Resource.SkewProtection)}}}var T=e.i(4355978);let E=(0,n.createContext)(void 0);function N(e){let{children:i}=e,[a,r]=(0,n.useState)(!0),[l,o]=(0,n.useState)({openRedeployModal:()=>{},openCancelDeploymentModal:()=>{},openPromoteToProductionModal:()=>{},openInstantRollbackModal:()=>{},openSkewProtectionModal:()=>{},openDeleteDeploymentModal:()=>{},canRollbackDeployment:!1,isLoadingModals:a});return(0,t.jsxs)(E.Provider,{value:l,children:[i,(0,t.jsx)(n.Suspense,{fallback:null,children:(0,t.jsx)(P,{setIsLoadingModals:r,setModalsContext:o})})]})}function P(e){let{setIsLoadingModals:n,setModalsContext:i}=e,{data:r}=(0,a.useCurrentDashboardDeploymentOverviewProject)();return r?(0,t.jsx)(M,{project:r,setIsLoadingModals:n,setModalsContext:i}):null}function M(e){let{setIsLoadingModals:a,setModalsContext:v,project:k}=e,{data:w,mutate:D}=(0,i.useCurrentDashboardDeploymentInterval)(),{permissions:S}=I({project:k,deployment:w}),A=(0,T.useIsCurrentProductionDeployment)(),{modal:E,open:N}=(0,r.default)(k),{canRollbackDeployment:P,rollbackModal:M,openRollbackModal:L}=(0,o.useInstantRollbackModal)(k),{modal:R,open:O}=function(e){let[i,a]=(0,n.useState)(!1),[r,l]=(0,n.useState)(!1),[o,s]=(0,n.useState)(null),[v,k]=(0,n.useState)(null),w=(0,h.useToasts)(),{team:C}=(0,j.useTeam)(),D=C?.id,S=(0,f.getGitMeta)(o?.meta),A=(0,n.useCallback)(e=>{s(e),a(!0)},[]),I=(0,n.useCallback)(()=>{a(!1)},[]),T=(0,n.useCallback)(()=>{l(!1),s(null),k(null)},[]),E=(0,n.useCallback)(()=>{if(!e)throw k({message:"projectIdOrName is required to save skew protection"}),Error("projectIdOrName is required to save skew protection");if(!o)throw k({message:"deployment is required to save skew protection"}),Error("deployment is required to save skew protection");l(!0),k(null),(0,y.fetchAPI)(`${(0,g.API_PROJECTS_VERSION)("v9")}/${encodeURIComponent(e)}${D?`?teamId=${D}`:""}`,{method:"PATCH",body:JSON.stringify({skewProtectionBoundaryAt:o.createdAt}),throwOnHTTPError:!0}).then(e=>{e&&(w.success("Successfully configured Skew Protection."),I())}).catch(e=>{k(e)}).finally(()=>{l(!1)})},[e,o,D,w,I]);return{modal:(0,n.useMemo)(()=>(0,t.jsxs)(u.Modal.Modal,{active:i,"data-testid":(0,x.tid)("skew-protection-modal","modal"),onAnimationDone:T,onClickOutside:I,width:"500px",children:[(0,t.jsxs)(u.Modal.Body,{children:[(0,t.jsx)(u.Modal.Header,{children:(0,t.jsx)(u.Modal.Title,{children:"Skew Protection Threshold"})}),(0,t.jsx)(p.Spacer,{y:1}),(0,t.jsxs)(m.Text,{children:["Deployments created before"," ",S?(0,t.jsx)(c.Link,{external:!0,href:S.commitUrl,title:"Open git commit in a new window",type:"highlight",children:S.sha.slice(0,7)}):"the selected deployment"," ","(",(0,t.jsx)("em",{children:(0,b.formatDateAndTime)(new Date(o?.createdAt??0))}),")"," ","will no longer use Skew Protection."]}),(0,t.jsx)(p.Spacer,{y:1}),(0,t.jsx)(m.Text,{children:"This overrides the maximum age set in your project settings to define a specific deployment as the cutoff."}),(0,t.jsx)(p.Spacer,{y:1}),(0,t.jsx)(m.Text,{children:"While uncommon, this may be necessary if there is a specific problematic deployment you want to ensure no longer resolves requests from any other active clients."}),(0,t.jsx)(p.Spacer,{y:1}),v?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.Error,{error:v}),(0,t.jsx)(p.Spacer,{y:1})]}):null,(0,t.jsxs)(m.Text,{children:["Learn more about"," ",(0,t.jsx)(c.Link,{external:!0,href:"https://vercel.com/docs/skew-protection",type:"highlight",children:"Skew Protection"})]})]}),(0,t.jsxs)(u.Modal.Actions,{children:[(0,t.jsx)(u.Modal.Action,{loading:!1,onClick:I,type:"secondary",children:"Cancel"}),(0,t.jsx)(u.Modal.Action,{"data-testid":(0,x.tid)("skew-protection-modal","save-button"),loading:r,onClick:E,children:"Set"})]})]}),[I,T,i,r,v,E,o,S]),close:I,open:A}}(k.id),B=(0,n.useCallback)(()=>{D()},[D]),{modal:F,open:_}=(0,s.default)(w.projectId,k,{onDeploymentPromoted:B}),[U,z]=(0,n.useState)(!1),[H,$]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{a(!1),v({openRedeployModal:()=>N(w),openCancelDeploymentModal:()=>z(!0),openPromoteToProductionModal:()=>_(w),openInstantRollbackModal:()=>L(w),openSkewProtectionModal:()=>O(w),openDeleteDeploymentModal:()=>$(!0),canRollbackDeployment:P,isLoadingModals:!1})},[P,w,A,L,_,N,O,v,a]),(0,t.jsxs)(t.Fragment,{children:[M,R,F,E,(0,t.jsx)(l.default,{active:U,deployment:w,onClose:()=>z(!1),teamId:w.team?w.team.id:null}),S.canDeleteDeployment?(0,t.jsx)(C,{active:H,deployment:w,onClose:()=>$(!1),teamId:w.team?.id}):null]})}E.displayName="DeploymentModalsContext";let L=()=>{let e=(0,n.useContext)(E);if(!e)throw Error("useDeploymentRedeployModal must be used within a DeploymentModalsProvider");return e}},[3428813]],9245086:e=>{"use strict";e.s({DeploymentMetadataMenuSkeleton:()=>R,DeploymentMoreMenu:()=>L});var t=e.i(6645307),n=e.i(6530772),i=e.i(5535439),a=e.i(1164214),r=e.i(9385465),l=e.i(869010),o=e.i(5124754),s=e.i(889716),c=e.i(5163670),d=e.i(5674541),u=e.i(8084653),p=e.i(555528),m=e.i(653558),h=e.i(1190215),x=e.i(2733203),y=e.i(4105925),g=e.i(4646240),j=e.i(6192985),b=e.i(584439),f=e.i(7573892),v=e.i(9802771),k=e.i(8328767),w=e.i(7753619),C=e.i(2362802),D=e.i(8188445),S=e.i(2722014),A=e.i(4714386),I=e.i(8232065),T=e.i(3428813),E=e.i(8554037),N=e.i(1316720),P=e.i(1562781),M=e.i(1213995);function L(e){let{project:c,deployment:d}=e,{permissions:C,isLoading:L}=(0,T.useDeploymentPermissions)({project:c,deployment:d}),{data:B}=(0,k.useRollingRelease)({teamIdOrSlug:c?.accountId,projectSlug:c?.name}),F=(0,E.useCiChecksAndPoliciesFlag)(),{data:_}=(0,I.useFeatureFlag)("enable-team-deployments-page"),{isLoggedOut:U}=(0,w.useIsLoggedIn)(),z=(0,S.useIsViewingPublicDeployment)(),H=(0,b.useToasts)(),{openRedeployModal:$,openPromoteToProductionModal:V,openSkewProtectionModal:q,openInstantRollbackModal:G,openDeleteDeploymentModal:Y,canRollbackDeployment:W,isLoadingModals:K}=(0,A.useDeploymentModals)(),Q=(0,n.useCallback)(e=>{(0,D.copyToClipboard)(e),H.message("Copied to clipboard!"),f.analytics.track(v.AnalyticsEvent.DEPLOYMENT_OVERVIEW_COPIED_DEPLOYMENT_URL,{projectId:d.projectId,deploymentId:d.id,deploymentTarget:d.target})},[d,H]),J=Object.values(C).every(e=>!e),X=Object.values(C).every(e=>e),{teamSlug:Z,project:ee}=(0,i.useParams)()??{},et=(0,n.useMemo)(()=>{if(!Z||!ee)return null;let e=new URLSearchParams,t=d.gitSource?.ref;return t?(e.set("filterBranch",t),`/${Z}/${ee}/deployments?${e.toString()}`):null},[Z,ee,d]),en=(0,n.useMemo)(()=>{if(!Z)return null;let e=new URLSearchParams,t=d.gitSource?.ref;return t?(e.set("filterBranch",t),`/${Z}/~/deployments?${e.toString()}`):null},[Z,d]),ei=_&&en?en:et,ea=!!(c?.link?.type==="github"&&c.link.org&&c.link.repo&&d.meta.githubCommitSha),{data:er}=(0,N.useProjectCheckRuns)({deploymentId:d.id,enableCiChecksAndPolicies:F}),el=!!ea&&!!er&&!er.runs.every(e=>"succeeded"===e.conclusion&&"completed"===e.status),eo=(0,P.usePromoteTooltip)(d),es=(0,M.useRollbackTooltip)(d);if(J)return(0,t.jsx)(O,{});if(!z&&L&&!U)return(0,t.jsx)(R,{});let ec=null;W&&(ec=es?(0,t.jsx)(s.Stack,{children:(0,t.jsx)(p.Tooltip,{position:"top",boxAlign:"center",style:{width:"100%"},text:es,children:(0,t.jsx)(y.MenuItem,{disabled:!0,style:{width:"100%"},suffix:(0,t.jsx)(r.RotateCounterClockwise,{color:"gray-600"}),children:(0,t.jsx)(s.Stack,{align:"center",direction:"row",gap:2,children:(0,t.jsx)(u.Text,{as:"span",style:{fontSize:"inherit",color:"inherit"},children:"Instant Rollback"})})})})}):(0,t.jsx)(y.MenuItem,{onClick:G,suffix:(0,t.jsx)(r.RotateCounterClockwise,{color:"gray-900"}),title:es,children:(0,t.jsx)(s.Stack,{align:"center",direction:"row",gap:2,children:(0,t.jsx)(u.Text,{as:"span",style:{fontSize:"inherit",color:"inherit"},children:"Instant Rollback"})})}));let ed=null;if(C.canPromoteToProduction){let e=!!eo,n="production"===d.target,i=e?"Promote":B?.rollingRelease?.state==="ACTIVE"?"Queue for Promotion":n&&el&&F?"Force Promote":n?"Promote":el?"Force Promote to Production":"Promote to Production";ed=e?(0,t.jsx)(s.Stack,{children:(0,t.jsx)(p.Tooltip,{boxAlign:"center",position:"top",style:{width:"100%"},text:eo,children:(0,t.jsx)(y.MenuItem,{disabled:!0,style:{width:"100%"},suffix:(0,t.jsx)(l.ArrowCircleUp,{color:"gray-600"}),children:(0,t.jsx)(s.Stack,{align:"center",direction:"row",gap:2,children:(0,t.jsx)(u.Text,{as:"span",style:{fontSize:"inherit",color:"inherit"},children:i})})})})}):(0,t.jsx)(y.MenuItem,{disabled:K,onClick:V,suffix:(0,t.jsx)(l.ArrowCircleUp,{color:"gray-900"}),children:i})}return(0,t.jsxs)(h.MenuContainer,{position:"bottom-end",children:[(0,t.jsx)(x.MenuButton,{"aria-label":"Deployment Actions","data-testid":(0,a.tid)("deployment-actions","more-button"),disabled:!d,shape:"square",svgOnly:!0,type:"secondary",children:(0,t.jsx)(o.MoreHorizontal,{})}),(0,t.jsxs)(m.Menu,{width:"auto",children:[z?null:(0,t.jsxs)(t.Fragment,{children:[ec,ed,C.canCreateDeployment?(0,t.jsx)(y.MenuItem,{disabled:z||K,onClick:$,children:"Redeploy"}):null]}),C.canReadDeployment?(0,t.jsx)(y.MenuItem,{onClick:()=>Q(`https://${d.host}`),children:"Copy URL"}):null,!z&&ei?(0,t.jsx)(y.MenuItem,{href:ei,isLink:!0,children:"View All Branch Deployments"}):null,!z&&C.canUpdateSkewProtection?(0,t.jsx)(y.MenuItem,{disabled:K||!c?.skewProtectionMaxAge,onClick:q,children:"Skew Protection Threshold"}):null,!z&&C.canDeleteDeployment?(0,t.jsx)(y.MenuItem,{disabled:!function(e){let{readyState:t}=e;return"QUEUED"!==t&&"BUILDING"!==t}(d)||K,onClick:Y,type:"error",children:"Delete"}):null,!X&&!U&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(j.MenuDivider,{}),z?null:(0,t.jsxs)(t.Fragment,{children:[W?null:(0,t.jsx)(g.MenuItemLocked,{children:"Instant Rollback"}),C.canPromoteToProduction?null:(0,t.jsx)(g.MenuItemLocked,{children:"Promote"}),C.canCreateDeployment?null:(0,t.jsx)(g.MenuItemLocked,{children:"Redeploy"})]}),C.canReadDeployment?null:(0,t.jsx)(g.MenuItemLocked,{children:"Copy URL"}),z||C.canUpdateSkewProtection?null:(0,t.jsx)(g.MenuItemLocked,{children:"Skew Protection Threshold"}),z||C.canDeleteDeployment?null:(0,t.jsx)(g.MenuItemLocked,{children:"Delete"})]})]})]})}function R(){return(0,t.jsx)(c.Skeleton,{children:(0,t.jsx)(O,{})})}function O(){return(0,t.jsx)(p.Tooltip,{position:"bottom",text:(0,t.jsxs)(t.Fragment,{children:["Additional permissions are required to manage Deployment."," ",(0,t.jsx)(C.Link,{href:"/docs/deployments",variant:"highlight",children:"Learn More →"})]}),children:(0,t.jsx)(d.Button,{"aria-label":"Deployment Actions","data-testid":(0,a.tid)("deployment-actions","more-button"),disabled:!0,shape:"square",svgOnly:!0,type:"secondary",children:(0,t.jsx)(o.MoreHorizontal,{})})})}},8196175:e=>{"use strict";e.s({useCurrentDashboardDeploymentDomains:()=>r},8196175);var t=e.i(5535439),n=e.i(646572),i=e.i(6579240),a=e.i(1049058);function r(e){let{teamSlug:r,id:l}=(0,t.useParams)()??{};if(!r||!l)throw Error("Missing params");let o=(0,i.getDashboardDeploymentDomainsEndpoint)({deploymentId:l,teamSlug:r});return(0,n.useIsomorphicSuspenseSWR)(o,async(e,t)=>{let n=await t(e);return{...n,aliases:n.aliases.sort(a.domainStringCompare)}},e)}},55414:e=>{"use strict";e.s({ActionSkeleton:()=>tO,CurrentDeploymentActionButton:()=>tB,CurrentDeploymentMoreMenu:()=>tF},55414);var t=e.i(6645307),n=e.i(5163670),i=e.i(2763735),a=e.i(7889764),r=e.i(9245086),l=e.i(5610210),o=e.i(5674541),s=e.i(555528),c=e.i(503726),d=e.i(3558962),u=e.i(9385465),p=e.i(2722014),m=e.i(5665687),h=e.i(4714386),x=e.i(6530772),y=e.i(9435431),g=e.i(8418504),j=e.i(14479),b=e.i(3821772),f=e.i(8934201),v=e.i(4418725),k=e.i(6859825),w=e.i(9242048),C=e.i(8673823),D=e.i(8761340),S=e.i(8196175),A=e.i(429041);let I=e=>{let{team:t,user:n,projectName:i}=e,a=t?.slug||n?.username;return a&&i?`/${a}/${i}/settings/deployment-protection`:""};var T=e.i(3921802),E=e.i(653558),N=e.i(2733203),P=e.i(1190215),M=e.i(4105925),L=e.i(8158100),R=e.i(3387593),O=e.i(889716),B=e.i(8084653),F=e.i(584439),_=e.i(2362802),U=e.i(5485417),z=e.i(9948746),H=e.i(4237550),$=e.i(3138389),V=e.i(5154216),q=e.i(5140160),G=e.i(5495572),Y=e.i(8483852),W=e.i(5706131),K=e.i(2537276),Q=e.i(7573892),J=e.i(9802771),X=e.i(2781454),Z=e.i(854226),ee=e.i(604868),et=e.i(3585235),en=e.i(5785123),ei=e.i(5535439),ea=e.i(3813724);e.i(7901367);var er=e.i(540570),el=e.i(5304032),eo=e.i(7267582),es=e.i(5168763),ec=e.i(1157778),ed=e.i(4203388),eu=e.i(2615772),ep=e.i(5165976),em=e.i(2555983),eh=e.i(5090795),ex=e.i(6192985),ey=e.i(6700141),eg=e.i(1389821),ej=e.i(5196742),eb=e.i(2769324),ef=e.i(4839320),ev=e.i(2198335);let ek={visible:{opacity:1,scale:1},hidden:{opacity:0,scale:.5}};function ew(e){let{"aria-label":n,children:i,classNameSuccess:a,textToCopy:r,onClick:s,...c}=e,d=(0,F.useToasts)(),[u,p]=(0,x.useState)(!1),[m,h]=(0,x.useState)(!1),y=(0,x.useRef)(null);return(0,x.useEffect)(()=>{u&&r&&(p(!1),y.current&&clearTimeout(y.current),h(!0),navigator.clipboard.writeText(r).catch(()=>d.error("Failed to copy to clipboard")),y.current=setTimeout(()=>{h(!1)},1e3))},[d,r,u]),(0,t.jsx)(o.Button,{"aria-label":n,disabled:c.disabled||u,onClick:()=>{p(!0),s?.()},...c,className:(0,l.clsx)(c.className,{[a||""]:m}),children:(0,t.jsx)(ef.MotionConfig,{transition:{duration:.15},children:(0,t.jsx)(eb.AnimatePresence,{initial:!1,mode:"wait",children:m?(0,t.jsx)(ev.motion.div,{animate:"visible",exit:"hidden",initial:"hidden",variants:ek,children:i(m)},"check"):(0,t.jsx)(ev.motion.div,{animate:"visible",exit:"hidden",initial:"hidden",variants:ek,children:i(m)},"copy")})})})}var eC=e.i(3153829);function eD(e){let{alias:t,protectionBypass:n,protectionEnabledForDeployment:i}=e;if(!t)return;let a=(0,eC.domainToUrl)(t);return n&&i?(0,eo.createShareableLink)(a,n):a}var eS=e.i(3673671);function eA(e){let{alias:n,deployment:i,isLoading:a,previewCommentsEnabledForDeployment:r,protectionBypass:l,protectionEnabledForDeployment:s,git:d,onCreateShareableLink:u,onDeleteShareableLink:p,onRegenerateShareableLink:m,openUpgradeModal:h,canUpdateShareableLink:y,viewAndCommentDescription:g}=e,j=(0,ee.useIsMobile)(),f=(0,ee.useMediaQuery)(430),{team:v,account:k}=(0,c.useAccount)(),w=(0,eg.useProjectIdOrName)(),C=k?.billing?.plan==="hobby",[D,S]=(0,x.useState)(l?"anyone":"team"),[A,I]=(0,x.useState)(!1),T=n&&eD({alias:n,protectionBypass:l,protectionEnabledForDeployment:s}),N=f?"Link":"Copy Link",L=!s&&!r,R=(0,t.jsx)(ew,{"aria-label":"Copy Link",className:"!h-8 !w-auto !justify-start !px-1",classNameSuccess:"!text-white !bg-blue-900",disabled:a||!n||A,onClick:()=>Q.analytics.track(J.AnalyticsEvent.DEPLOYMENT_SHARE_COPY_LINK,{projectId:w,deploymentType:"alias"}),textToCopy:T||"",type:"secondary",children:e=>(0,t.jsxs)(O.Stack,{align:"center",direction:"row",gap:2,justify:"start",children:[(a||A?(0,t.jsx)(b.Spinner,{}):e&&(0,t.jsx)(z.Check,{}))||(0,t.jsx)(ed.Copy,{}),e?"Copied!":N]})}),F=(0,ej.getGitInfoFromDeployment)(i),U=(0,ey.useNewFeedbackSharingModal)().value||!1,H=F&&!F.isPublic,$=!!(U&&H&&C),V=(0,x.useCallback)(()=>{Q.analytics.track(J.AnalyticsEvent.DEPLOYMENT_SHARE_UPGRADE_TO_PRO_CLICKED,{projectId:w,isHobbyPrivate:$}),h()},[$,h,w]),q=(0,x.useCallback)(e=>{if("anyone"===e&&C||S(e),"anyone"!==e||l)l&&p();else{if(C)return void I(!0);u()}},[C,l,u,p]);(0,x.useEffect)(()=>{A&&l&&I(!1)},[A,I,l,D]),(0,x.useEffect)(()=>{a||S(l?"anyone":"team")},[l,a]);let G=U&&$&&!!v&&(0,t.jsxs)(t.Fragment,{children:["To allow external collaborators to comment on the Hobby plan, the repository"," ",(0,t.jsx)("span",{style:{display:"inline-block",transform:"scale(0.85) translateY(2px)"},children:d?.logo})," ",F?.repoName," ",(0,t.jsx)(ep.LockClosed,{size:12})," visibility must be public."]}),Y=(0,x.useMemo)(()=>{if(!y)return"You need additional permissions to manage sharing"},[y]),W="Only people with access",K=s?"Anyone with the link":"Publicly accessible",X=(l||a)&&s;return L?(0,t.jsxs)(eI,{notActionable:!0,children:[(0,t.jsxs)(O.Stack,{align:"center",direction:"row",gap:2.5,children:[(0,t.jsx)(eN,{}),(0,t.jsx)(B.Text,{align:"left",className:"text-pretty [&_svg]:align-text-top",children:"Publicly accessible"})]}),R]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(P.MenuContainer,{children:["team"===D?(0,t.jsxs)(eI,{disabled:a||A,notActionable:!!Y,children:[(0,t.jsx)(eE,{disabled:a||A,isActionable:!Y,children:(0,t.jsxs)(O.Stack,{align:"center",direction:"row",gap:2.5,children:[(0,t.jsx)(eN,{}),(0,t.jsx)(eT,{forceHide:!Y,text:Y,children:(0,t.jsxs)(B.Text,{align:"left",className:"flex flex-nowrap items-center gap-1 text-pretty",children:[W,f?null:` can ${g}`,Y?null:(0,t.jsx)(ec.ChevronDownSmall,{})]})})]})}),R]}):(0,t.jsxs)(eI,{disabled:a,notActionable:!!Y,children:[(0,t.jsx)(eE,{disabled:a,isActionable:!Y,children:(0,t.jsxs)(O.Stack,{align:"center",direction:"row",gap:2.5,children:[(0,t.jsx)(eN,{success:s}),(0,t.jsx)(eT,{forceHide:!Y,text:Y,children:(0,t.jsxs)(O.Stack,{align:"start",children:[(0,t.jsxs)(B.Text,{align:"left",className:"text-pretty [&_svg]:align-text-top",color:Y?"gray-800":void 0,children:[K,s&&!f?` can ${g}`:null,Y?null:(0,t.jsxs)(t.Fragment,{children:[" ",(0,t.jsx)(ec.ChevronDownSmall,{})]})]}),r?(0,t.jsxs)(B.Text,{color:Y?"gray-800":"gray-900",size:13,children:["Visitors must"," ",(0,t.jsx)("span",{className:"geist-hide-on-mobile",children:"be logged in"})," ",(0,t.jsx)("span",{className:"geist-show-on-mobile",children:"log in"})," to comment"]}):null]})})]})}),R]}),(0,t.jsxs)(E.Menu,{width:300,children:[(0,t.jsx)(eT,{forceHide:!Y,text:Y,children:(0,t.jsx)(M.MenuItem,{disabled:a||!!Y,onClick:()=>q("team"),prefix:(0,t.jsx)(ep.LockClosed,{}),style:{width:"100%"},suffix:"team"===D?(0,t.jsx)(z.Check,{}):null,children:W})}),(0,t.jsx)(eT,{forceHide:!(Y||G),text:Y||G,children:(0,t.jsx)(M.MenuItem,{disabled:a||$||!!Y||A,innerMenuItemClassName:"!pointer-events-auto",onClick:()=>{q("anyone")},prefix:(0,t.jsx)(em.LockOpen,{}),style:{width:"100%"},suffix:"anyone"===D?(0,t.jsx)(z.Check,{}):null,children:(0,t.jsxs)(O.Stack,{align:"center",direction:"row",gap:2,justify:"space-between",style:{width:"100%"},children:[K,$?(0,t.jsx)(o.Button,{onClick:V,size:"small",style:{cursor:"pointer",background:"var(--geist-foreground)",color:"var(--geist-background)"},children:"Upgrade"}):null]})})}),X?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ex.MenuDivider,{}),(0,t.jsx)(eT,{text:"Regenerate shareable link",children:(0,t.jsx)(M.MenuItem,{onClick:m,prefix:(0,t.jsx)(eh.RefreshClockwise,{}),style:{width:"100%"},children:"Reset link"})})]}):null]})]}),(0,t.jsx)(eS.ToastMobileAware,{actionText:"Confirm",active:A,cancelActionText:"Cancel",onAction:()=>{S("anyone"),u()},onCancelAction:()=>{I(!1)},preserve:!0,toastKey:"create-shareable-link-hobby-confirmation",children:(0,t.jsxs)(O.Stack,{direction:"column",gap:3,children:[(0,t.jsxs)(B.Text,{children:["You can only have 1 shareable link at a time on Hobby."," ",(0,t.jsx)(_.Link,{external:!0,icon:!1,onClick:()=>{I(!1),V()},underline:!j||void 0,variant:j?"highlight":void 0,children:"Upgrade to Pro"})," ","for unlimited shareable links."]}),(0,t.jsx)(B.Text,{children:"Continuing will revoke any existing shareable links."})]})})]})}function eI(e){let{disabled:n=!1,children:i,notActionable:a}=e;return(0,t.jsx)(O.Stack,{className:"w-full",children:(0,t.jsx)(O.Stack,{style:{width:"100%"},children:(0,t.jsx)(O.Stack,{className:(0,l.clsx)("w-full py-2.5 pl-0.5 pr-2",{"cursor-not-allowed":n,"cursor-default":a&&!n}),children:(0,t.jsx)(O.Stack,{direction:"row",justify:"space-between",style:{width:"100%"},children:i})})})})}function eT(e){let{children:n,forceHide:i,text:a}=e;return(0,t.jsx)(s.Tooltip,{desktopOnly:!0,forceHide:i,maxWidth:350,padding:10,style:{width:"100%"},text:a,children:n})}function eE(e){let{isActionable:n,children:i,disabled:a}=e;return n?(0,t.jsx)(N.MenuButton,{disabled:a,variant:"unstyled",children:i}):(0,t.jsx)(O.Stack,{paddingLeft:1.5,children:i})}function eN(e){let{success:n}=e;return(0,t.jsx)(O.Stack,{align:"center",direction:"row",gap:{sm:2,md:3,lg:3},children:(0,t.jsx)(O.Stack,{align:"center",className:(0,l.clsx)("size-8 shrink-0 rounded-full text-white",{"bg-blue-900":n,"bg-gray-700":!n}),justify:"center",children:(0,t.jsx)(eu.Link,{})})})}var eP=e.i(5175803),eM=e.i(3979315),eL=e.i(6465700),eR=e.i(2726686),eO=e.i(980475),eB=e.i(5261442),eF=e.i(3863591);function e_(){return(0,t.jsx)(O.Stack,{align:"center",className:"max-w-max overflow-hidden rounded-full border border-gray-400 bg-gray-700 p-2 font-bold text-white",justify:"center",children:(0,t.jsx)(eF.Email,{size:16})})}var eU=e.i(5754894);function ez(e){let{target:n,canUpdateProtectionBypass:i=!0,hideStaticTeamMembersBanner:a=!1,onUpgradeClick:r,project:l,revalidateAlias:o,branchAliasId:s,branchName:c}=e;return n?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eH,{branchAliasId:s,branchName:c,canUpdateProtectionBypass:i,filter:"requests",onUpgradeClick:r,project:l,revalidateAlias:o,target:n}),(0,t.jsx)(eH,{canUpdateProtectionBypass:i,filter:"granted",hideStaticTeamMembersBanner:a,onUpgradeClick:r,project:l,revalidateAlias:o,target:n})]}):null}function eH(e){let{target:n,canUpdateProtectionBypass:i=!0,filter:a,hideStaticTeamMembersBanner:r=!1,onUpgradeClick:l,project:o,revalidateAlias:d,branchAliasId:u,branchName:p}=e,{team:m,user:h}=(0,c.useAccount)(),{data:y}=(0,eO.default)({limit:1},{revalidateIfStale:!1,revalidateOnFocus:!1}),g=(0,x.useMemo)(()=>Object.entries(n.protectionBypass??{}).map(e=>{let[t,n]=e;return"user"===n.scope?{...n,userId:t}:"email_invite"===n.scope?{...n,email:t}:void 0}).filter(e=>void 0!==e).sort((e,t)=>t.createdAt>e.createdAt?1:-1),[n.protectionBypass]),j=a?g.filter(e=>("user"===e.scope&&"requested"===e.access)==("requests"===a)):g,b=(0,x.useCallback)(async e=>{await (0,ea.updateAliasProtectionBypass)({aliasId:n.id,teamId:m?.id,body:e}),await d()},[n.id,m?.id,d]),f=(0,x.useMemo)(()=>{if(u&&n.id.startsWith("dpl_"))return async e=>{await (0,ea.insertInviteToAliasProtectionBypass)({aliasId:u,teamId:m?.id,inviteeEmails:[e],message:""}),await d()}},[u,d,n.id,m?.id]);if(0===j.length&&!("granted"===a&&!r))return null;let v=y?.members.length;return(0,t.jsxs)(O.Stack,{gap:2,children:[(0,t.jsx)(B.Text,{size:16,weight:500,children:"requests"===a?"Access requests":"People with access"}),(0,t.jsx)(O.Stack,{gap:4,children:(0,t.jsxs)(O.Stack,{gap:3,children:[r||"granted"!==a?null:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eV,{thumbnail:(0,t.jsx)(eP.Avatar,{size:32,teamId:m?.id,username:m?void 0:h?.username}),title:(0,t.jsxs)(O.Stack,{as:"span",direction:"row",gap:1,children:[(0,t.jsx)(B.Text,{as:"span",weight:500,children:m?.name||"You"}),m?(0,t.jsx)(t.Fragment,{children:/\bteam\b/i.test(m.name)?" members":" team members"}):null,v?(0,t.jsx)(s.Tooltip,{text:"Excluding contributors without access to this project.",children:(0,t.jsx)(eL.InformationFillSmall,{})}):null]})}),v?(0,t.jsx)(eV,{thumbnail:(0,t.jsx)(eW,{project:o}),title:(0,t.jsxs)(B.Text,{as:"span",children:[(0,t.jsx)(B.Text,{as:"span",weight:500,children:o.name})," ",(0,t.jsx)(B.Text,{as:"span",children:"project contributors"})]})}):null]}),j.map(e=>(0,t.jsx)(e$,{branchName:p,canUpdateProtectionBypass:i,onUpgradeClick:l,targetUrl:n.url,updateBranchAccess:f,updateUserAccess:b,user:e},"user"===e.scope?e.userId:e.email))]})})]})}function e$(e){let{canUpdateProtectionBypass:n,onUpgradeClick:i,user:a,updateUserAccess:r,updateBranchAccess:l,branchName:o,targetUrl:s}=e,d=(0,F.useToasts)(),{account:u}=(0,c.useAccount)(),[p,m]=(0,x.useState)(void 0),h=u?.billing?.plan==="hobby",[y,g]=(0,x.useState)(!1),j="user"===a.scope,b=async(e,t)=>{m(e);try{let n=j?{scope:{userId:a.userId,access:e}}:{scope:{email:a.email,access:"denied"}};await Promise.all([r(n),a.email&&t&&l&&"granted"===e?l(a.email):void 0])}catch(e){d.error("An error occured, please try again later.")}finally{m(void 0)}},f=async e=>{if(h)return void g(!0);await b("granted",e)},v=void 0!==p;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eV,{actions:(0,t.jsx)(eq,{branchName:o,canUpdateProtectionBypass:n,isAccessRequested:!!j&&"requested"===a.access,isInvitationFlagEnabled:!0,isLoading:v,isUpdating:p,onAccessGranted:f,showBranchOption:!!(l&&a.email)&&!h,showHobbyLimitAction:y,targetUrl:s,updateAccess:b}),description:j?a.email:void 0,thumbnail:"user"===a.scope?(0,t.jsx)(eP.Avatar,{size:32,username:j?a.username:void 0}):(0,t.jsx)(e_,{}),title:j?a.username??a.userId:a.email}),(0,t.jsx)(eG,{isInvitationFlagEnabled:!0,isLoading:v,onUpgradeClick:i,setShowHobbyLimitAction:g,showHobbyLimitAction:y,updateAccess:b})]})}function eV(e){let{actions:n,description:i,thumbnail:a,title:r}=e;return(0,t.jsxs)(O.Stack,{align:"center",className:"h-9",direction:"row",gap:2,justify:"space-between",children:[(0,t.jsxs)(O.Stack,{align:"center",direction:"row",gap:2,children:[a,(0,t.jsxs)(O.Stack,{children:[(0,t.jsx)(B.Text,{lineHeight:20,size:14,children:r}),(0,t.jsx)(B.Text,{color:"gray-900",lineHeight:16,size:13,children:i})]})]}),n]})}function eq(e){let{canUpdateProtectionBypass:n=!0,isAccessRequested:i,isInvitationFlagEnabled:a,isLoading:r,isUpdating:l,onAccessGranted:c,showHobbyLimitAction:d,updateAccess:u,showBranchOption:p,branchName:m,targetUrl:h}=e,x=(0,t.jsx)(eM.Cross,{}),y=(0,t.jsx)(z.Check,{}),g=n?void 0:"You need additional permissions to manage access requests",j=d||!n,f=p?(0,t.jsxs)(P.MenuContainer,{children:[(0,t.jsx)(N.MenuButton,{"aria-label":"Approve",disabled:j,shape:"square",size:"small",svgOnly:!0,type:"tertiary",children:y}),(0,t.jsxs)(E.Menu,{width:"auto",children:[(0,t.jsx)(M.MenuItem,{innerMenuItemClassName:"h-auto py-2",onClick:()=>void c(),prefix:(0,t.jsx)(V.GitCommit,{}),children:(0,t.jsxs)(O.Stack,{direction:"column",gap:1,children:[(0,t.jsx)(B.Text,{children:"Approve for Deployment"}),(0,t.jsx)(B.Text,{color:"gray-900",size:13,children:h})]})}),(0,t.jsx)(M.MenuItem,{innerMenuItemClassName:"h-auto py-2",onClick:()=>void c(!0),prefix:(0,t.jsx)($.GitBranch,{}),children:(0,t.jsxs)(O.Stack,{direction:"column",gap:1,children:[(0,t.jsx)(B.Text,{children:"Approve for Deployment and Branch"}),(0,t.jsx)(B.Text,{color:"gray-900",size:13,children:m})]})})]})]}):(0,t.jsx)(o.Button,{"aria-label":"Approve",disabled:j,onClick:()=>void c(),shape:"square",size:"small",svgOnly:!0,type:"tertiary",children:y});return(0,t.jsxs)(O.Stack,{align:"center",direction:"row",gap:1,children:[(0,t.jsx)(s.Tooltip,{desktopOnly:!0,text:g??(i?"Decline":"Revoke"),children:r?(0,t.jsx)(O.Stack,{className:"mx-2",children:"denied"===l?(0,t.jsx)(b.Spinner,{size:16}):x}):(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(o.Button,{"aria-label":"Decline",disabled:!n,onClick:()=>void u("denied"),shape:"square",size:"small",svgOnly:!0,type:"tertiary",children:x})})}),i?(0,t.jsx)(s.Tooltip,{desktopOnly:!0,text:g??"Approve",children:r?(0,t.jsx)(O.Stack,{className:"mx-2",children:"granted"===l?(0,t.jsx)(b.Spinner,{size:16}):y}):f}):null]})}function eG(e){let{isInvitationFlagEnabled:n,isLoading:i,onUpgradeClick:a,setShowHobbyLimitAction:r,showHobbyLimitAction:l,updateAccess:o}=e;return n&&a?(0,t.jsx)(eU.HobbyLimitAction,{onUpgradeClick:a,setShowHobbyLimitAction:r,showHobbyLimitAction:l,updateAccess:o}):(0,t.jsx)(eY,{isLoading:i,setShowHobbyLimitAction:r,showHobbyLimitAction:l,updateAccess:o})}function eY(e){let{isLoading:n,setShowHobbyLimitAction:i,showHobbyLimitAction:a,updateAccess:r}=e;return(0,t.jsx)(eb.AnimatePresence,{children:a&&!n?(0,t.jsx)(eR.m.div,{animate:{height:"auto"},className:"relative box-border rounded border border-gray-400 bg-gray-100 dark:bg-gray-100",exit:{height:0},initial:{height:0},style:{padding:0},transition:{ease:"easeInOut"},children:(0,t.jsxs)(O.Stack,{align:"center",className:"px-4",direction:"row",gap:2,justify:"space-between",children:[(0,t.jsx)(B.Text,{color:"gray-900",size:13,children:"Hobby plans have a limit of 1 external collaborator at a time. Confirm to remove any existing user access."}),(0,t.jsxs)(O.Stack,{align:"center",direction:"row",gap:1,children:[(0,t.jsx)(s.Tooltip,{desktopOnly:!0,text:"Cancel",children:(0,t.jsx)(o.Button,{"aria-label":"Cancel",onClick:()=>{i(!1)},shape:"square",size:"small",svgOnly:!0,type:"tertiary",children:(0,t.jsx)(eM.Cross,{})})}),(0,t.jsx)(s.Tooltip,{desktopOnly:!0,text:"Confirm",children:(0,t.jsx)(o.Button,{"aria-label":"Confirm",onClick:()=>{i(!1),r("granted")},shape:"square",size:"small",svgOnly:!0,type:"tertiary",children:(0,t.jsx)(z.Check,{})})})]})]})},"hobby-limit-actions"):null})}function eW(e){let{size:i=32,style:a,project:r,title:l}=e,{data:o,isLoading:s}=(0,eB.default)({project:r}),c=(0,eg.useFramework)(r);return!s&&(c||o)?(0,t.jsx)(eP.Avatar,{size:i,src:o?.src||c?.logo,style:a,title:l??c?.name}):(0,t.jsx)(n.Skeleton,{height:i,rounded:!0,style:{flexShrink:0},width:i})}var eK=e.i(7315479),eQ=e.i(1917237),eJ=e.i(7918027),eX=e.i(8968847),eZ=e.i(9572024),e0=e.i(5599793),e1=e.i(8025298);function e5(e){let{inputText:n,navIndex:i,onPicked:a,setNavIndex:r,suggestions:l}=e;return n?(0,t.jsxs)(O.Stack,{gap:3,children:[(0,t.jsx)(e3,{index:-1,isSelected:-1===i,onClick:()=>{a({label:n,value:n})},onMouseMove:()=>{r(-1)},option:{label:n,value:n}}),l?.map((e,n)=>(0,t.jsx)(e3,{index:n,isSelected:n===i,onClick:()=>{a(e)},onMouseMove:()=>{r(n)},option:e},e.value))]}):null}function e3(e){let{index:n,isSelected:i,onClick:a,onMouseMove:r,option:o}=e,{member:s}=o,c=(0,x.useRef)(null);(0,x.useEffect)(()=>{c.current&&i&&c.current.scrollIntoView({behavior:"smooth",block:-1===n?"end":"nearest"})},[n,i]);let d=s?.name||s?.username,u=d||o.value;return(0,t.jsxs)(O.Stack,{align:"center",className:(0,l.clsx)("relative cursor-default rounded-md transition-colors duration-150 hover:bg-gray-100",{'after:content-["_"] after:box-content after:absolute after:-left-2 after:bg-gray-alpha-100 after:w-full after:h-full after:rounded after:p-2':i}),direction:"row",gap:2,onClick:a,onMouseMove:r,ref:c,children:[s?(0,t.jsx)(eP.Avatar,{size:32,username:s.username}):(0,t.jsx)(e_,{}),(0,t.jsxs)(O.Stack,{style:{overflow:"hidden"},children:[(0,t.jsx)(B.Text,{lineHeight:20,size:14,truncate:!0,children:u}),d?(0,t.jsx)(B.Text,{color:"gray-900",lineHeight:16,size:13,children:o.value}):null]})]})}var e2=e.i(3071175),e4=e.i(4411143),e6=e.i(7511151);e.i(8236606),e.i(2536010),e.i(6264552),e.i(3075593);var e7=e.i(1674548);e.i(4515855);var e8=e.i(2260194);e.i(3553477),e.i(763603),e.i(5742391),e.i(2250501),e.i(8605927);var e9=e.i(9149342),te=e.i(6663484),tt=e.i(4272821),tn=["allowCreateWhileLoading","createOptionPosition","formatCreateLabel","isValidNewOption","getNewOptionData","onCreateOption","options","onChange"],ti=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,i=String(e).toLowerCase(),a=String(n.getOptionValue(t)).toLowerCase(),r=String(n.getOptionLabel(t)).toLowerCase();return a===i||r===i},ta={formatCreateLabel:function(e){return'Create "'.concat(e,'"')},isValidNewOption:function(e,t,n,i){return!(!e||t.some(function(t){return ti(e,t,i)})||n.some(function(t){return ti(e,t,i)}))},getNewOptionData:function(e,t){return{label:t,value:e,__isNew__:!0}}},tr=(0,x.forwardRef)(function(e,t){var n,i,a,r,l,o,s,c,d,u,p,m,h,y,g,j,b,f,v,k,w,C,D,S,A,I,T,E,N=(a=void 0!==(i=(n=(0,te.u)(e)).allowCreateWhileLoading)&&i,l=void 0===(r=n.createOptionPosition)?"last":r,s=void 0===(o=n.formatCreateLabel)?ta.formatCreateLabel:o,d=void 0===(c=n.isValidNewOption)?ta.isValidNewOption:c,p=void 0===(u=n.getNewOptionData)?ta.getNewOptionData:u,m=n.onCreateOption,y=void 0===(h=n.options)?[]:h,g=n.onChange,f=void 0===(b=(j=(0,e8.default)(n,tn)).getOptionValue)?e9.g:b,k=void 0===(v=j.getOptionLabel)?e9.b:v,w=j.inputValue,C=j.isLoading,D=j.isMulti,S=j.value,A=j.name,I=(0,x.useMemo)(function(){return d(w,(0,tt.H)(S),y,{getOptionValue:f,getOptionLabel:k})?p(w,s(w)):void 0},[s,p,k,f,w,d,y,S]),T=(0,x.useMemo)(function(){return(a||!C)&&I?"first"===l?[I].concat((0,e7.default)(y)):[].concat((0,e7.default)(y),[I]):y},[a,l,C,I,y]),E=(0,x.useCallback)(function(e,t){if("select-option"!==t.action)return g(e,t);var n=Array.isArray(e)?e:[e];if(n[n.length-1]===I){if(m)m(w);else{var i=p(w,w);g((0,tt.D)(D,[].concat((0,e7.default)((0,tt.H)(S)),[i]),i),{action:"create-option",name:A,option:i})}return}g(e,t)},[p,w,D,A,I,m,g,S]),(0,e6.default)((0,e6.default)({},j),{},{options:T,onChange:E}));return x.createElement(e9.S,(0,e4.default)({ref:t},N))}),tl=e.i(4968913),to=e.i(318846),ts=e.i(1235226);let tc={control:e=>(0,ts.twMerge)("w-full border border-solid border-gray-alpha-400 bg-white rounded min-h-10 transition-colors duration-200",e.isFocused&&"hover:border-gray-alpha-600 bg-white shadow-focus-border",e.isDisabled&&"bg-gray-100"),valueContainer:()=>"px-2 py-1.5",input:()=>"py-0.5 m-0.5 text-gray-1000 text-base lg:text-sm",placeholder:()=>"mx-0.5 text-gray-600",indicatorsContainer:()=>"flex items-center px-2",indicatorSeparator:()=>"hidden",dropdownIndicator:()=>"text-gray-600 hover:text-gray-800 transition-colors duration-150",clearIndicator:()=>"text-gray-600 hover:text-gray-800 transition-colors duration-150 cursor-pointer",menu:()=>"bg-white border border-gray-alpha-400 rounded-md shadow-lg mt-1 z-50",menuList:()=>"py-1 max-h-60 overflow-auto",option:e=>(0,ts.twMerge)("px-3 py-2 text-sm cursor-pointer transition-colors duration-150 text-gray-1000 hover:bg-gray-100",e.isFocused&&"bg-gray-alpha-100",e.isSelected&&"bg-blue-500 text-white"),multiValue:()=>"inline-flex items-center bg-gray-200 rounded text-sm",multiValueLabel:()=>"pl-1 pr-0 py-1 flex font-medium text-xs",multiValueRemove:()=>"pl-0.5 pr-1 cursor-pointer rounded-xs flex items-center text-inherit box-border hover:bg-transparent hover:text-inherit"},td=(0,x.forwardRef)(function(e,n){let{disabled:i,disabledText:a,inputText:r,invitationFocused:l,invitees:o,onInputBlur:c,onInputChangeHandler:d,onInputFocused:u,onKeyDown:p,placeholder:m,setInvitees:h}=e,y=(0,x.useCallback)((e,t)=>{e&&Array.isArray(e)&&h(e)},[h]),g=(0,t.jsx)(tr,{autoFocus:l,classNames:tc,components:{MultiValue:tu,MultiValueRemove:tm,Option:th,NoOptionsMessage:tg,DropdownIndicator:()=>null},formatCreateLabel:e=>e,inputValue:r,isClearable:!1,isDisabled:i,isLoading:!1,isMulti:!0,isSearchable:!0,menuIsOpen:!1,onBlur:()=>c(),onChange:y,onFocus:()=>u(),onInputChange:d,onKeyDown:p,openMenuOnClick:!1,placeholder:m,ref:n,value:o,unstyled:!0});return i?(0,t.jsx)(s.Tooltip,{desktopOnly:!0,style:{width:"100%",display:"block"},text:a,children:g}):g});function tu(e){let n=e.data,i=!(0,eZ.default)(n.value),a={...{innerProps:{className:(0,l.clsx)(e.className,"m-0.5 flex min-h-6 items-center overflow-hidden rounded-full leading-none",{"bg-red-300 hover:bg-red-400 text-red-900 [&_span>div>svg]:hover:stroke-red-500":i,"bg-gray-300 text-gray-1000 hover:bg-gray-400":!i})}},...e};return(0,t.jsx)(e2.components.MultiValue,{...a,children:(0,t.jsx)(tp,{isEmailInvalid:i,option:n})})}function tp(e){let{isEmailInvalid:n,option:i}=e;return n?(0,t.jsx)(s.Tooltip,{text:"Not a valid email address",children:(0,t.jsxs)(O.Stack,{align:"center",direction:"row",gap:.5,children:[(0,t.jsx)(ty,{}),i.value]})}):(0,t.jsxs)(O.Stack,{align:"center",className:(0,l.clsx)({"ml-0.5":!i.member}),direction:"row",gap:1,children:[i.member?(0,t.jsx)(eP.Avatar,{className:"border-none",size:16,username:i.member.username}):null,i.value]})}function tm(e){let{innerProps:n}=e;return(0,t.jsx)("div",{...n,children:(0,t.jsx)(to.CrossSmall,{})})}function th(e){let n=e.data;return(0,t.jsx)(e2.components.Option,{...e,children:(0,t.jsx)(tx,{text:n.label})})}function tx(e){let{text:n}=e;return(0,t.jsxs)(O.Stack,{align:"center",direction:"row",gap:2,children:[(0,t.jsx)(e_,{}),(0,t.jsx)(B.Text,{children:n})]})}function ty(){return(0,t.jsx)(tl.Stop,{"aria-hidden":!0,className:"fill-red-900 stroke-red-300",size:19})}function tg(){return(0,t.jsx)(O.Stack,{align:"center",className:"flex min-h-[70px] items-center justify-center text-sm text-gray-600",children:(0,t.jsx)(B.Text,{color:"gray-700",children:"No options ..."})})}function tj(e){let{canUpdateProtectionBypass:n,git:i,header:a,branchAliasId:r,selectedTarget:l,invitationFocused:d,onCancel:u,onFinished:p,onFocus:m,openUpgradeModal:h,previewCommentsEnabledForDeployment:y,revalidateAlias:g,teamId:j,viewAndCommentDescription:v,deployment:k}=e,{track:w}=(0,Z.useTrackActivity)(),C=(0,F.useToasts)(),D=(0,ee.useIsMobile)(),{account:S}=(0,c.useAccount)(),A=(0,eg.useProjectIdOrName)(),I=S?.billing?.plan==="hobby",[T,E]=(0,x.useState)(!1),N=(0,x.useRef)(null),[P,M]=(0,x.useState)(!1),[R,z]=(0,x.useState)(""),[H,q]=(0,x.useState)([]),[G,Y]=(0,x.useState)(""),[W,K]=(0,x.useState)(null),et=I&&H.length>1,en=H.some(e=>!(0,eZ.default)(e.value)),ei=G.length>250,er=(0,x.useMemo)(()=>ei||en?"Please correct the form input errors to continue":H.length?et?"Upgrade your plan to invite multiple external collaborators":void 0:"Input must not be empty",[en,H.length,et,ei]),el=(0,x.useCallback)(()=>{Q.analytics.track(J.AnalyticsEvent.DEPLOYMENT_SHARE_UPGRADE_TO_PRO_CLICKED,{projectId:A}),h()},[h,A]),eo=()=>{N.current&&N.current.focus()},es=(0,x.useCallback)(async()=>{w(X.VercelActivityAction.DeploymentInviteSent,{count:H.length,teamMemberCount:H.filter(e=>void 0!==e.member).length}),K(null),M(!0);try{await (0,ea.insertInviteToAliasProtectionBypass)({aliasId:l.id,teamId:j,inviteeEmails:H.map(e=>e.value),message:G});let e=1===H.length?"Invite was sent":"Invites were sent";C.message({text:e}),q([]),Y(""),p(),await g()}catch(e){K((0,eK.normalizeError)(e))}M(!1)},[l.id,H,G,p,g,j,C,w]),[,{isLagging:ec,members:ed}]=(0,e0.useMembersInfinite)({revalidateIfStale:!1},{search:R},!0),eu=(0,x.useMemo)(()=>ed.map(e=>({label:e.name,value:e.email,member:e})).filter(e=>!H.some(t=>t.value===e.value)),[H,ed]),ep=function(e){let[t,n]=(0,x.useState)(-1);return{lowBorder:-1,highBorder:e-1,navIndex:t,resetNavIndex:()=>n(-1),setNavIndex:n}}(eu.length),{navIndex:em,resetNavIndex:eh,setNavIndex:ex}=ep,ey=(0,x.useCallback)((e,t)=>{"input-change"===t.action&&!(e.length>320)&&(H.length>50||(z(e),K(null)))},[H.length]),ej=(0,x.useCallback)(()=>{R||H.length||u()},[R,H.length,u]),ef=(0,x.useCallback)(()=>{if(!R&&!H.length)return void u();z(""),eo(),eh()},[R,H.length,u,eh]),ev=(0,x.useCallback)(e=>{H.some(t=>t.value===e.value)||(q([...H,e.member?e:eu.find(t=>t.value===e.value)||e]),z(""),eo(),eh())},[H,eh,eu]),{onInputKeyDownHandler:ek}=function(e){let{inputText:t,navIndexState:n,onEscape:i,onPicked:a,suggestions:r}=e,{lowBorder:l,highBorder:o,navIndex:s,setNavIndex:c}=n;return{onInputKeyDownHandler:e=>{switch(e.key){case"Escape":e.stopPropagation(),i();break;case"Enter":case"Tab":if(!t)break;e.preventDefault(),-1===s?a({label:t,value:t}):a(r[s]);break;case"ArrowUp":e.preventDefault(),c(s>l?s-1:o);break;case"ArrowDown":e.preventDefault(),c(s<o?s+1:l)}}}}({inputText:R,navIndexState:ep,onEscape:ef,onPicked:ev,suggestions:eu});(0,x.useEffect)(()=>{R||eh()},[R,eh]);let ew=l.id===k.id?(0,e1.default)(k).hash:void 0;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(tb,{header:a,invitationFocused:d,children:[(0,t.jsxs)(O.Stack,{gap:3,children:[(0,t.jsxs)(B.Text,{as:"span",children:[n?"Choose":"People"," who can"," ",(0,t.jsx)(B.Text,{as:"span",weight:500,children:v})," ",y?"on":null," ",l.id===r&&i?.branchName?(0,t.jsxs)(_.Link,{className:"mt-1 flex flex-nowrap items-start gap-1 pb-2 pt-1",href:i.branchUrl,title:"Git Branch",children:[(0,t.jsx)($.GitBranch,{className:"mb-[-3px]"})," ",(0,t.jsx)(B.Text,{truncate:!0,as:"span",style:{lineHeight:"13px",fontFamily:"var(--font-mono)",fontSize:"13px",fontWeight:"500"},children:i.branchName})]}):(0,t.jsx)(B.Text,{as:"span",weight:500,children:ew?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(V.GitCommit,{className:"align-sub"})," ",(0,t.jsx)(B.Text,{as:"span",monospace:!0,size:13,children:ew})]}):l.url})]}),(0,t.jsx)("form",{children:(0,t.jsx)(td,{disabled:!n,disabledText:"You need additional permissions to invite collaborators",inputText:R,invitationFocused:d,invitees:H,onInputBlur:ej,onInputChangeHandler:ey,onInputFocused:m,onKeyDown:ek,placeholder:"Add team members or emails...",ref:N,setInvitees:q})}),(0,t.jsx)(eb.AnimatePresence,{children:et?(0,t.jsx)(eR.m.div,{animate:{height:"auto"},exit:{height:0},initial:{height:0},style:{padding:0},transition:{ease:"easeInOut"},children:(0,t.jsx)(L.Note,{action:(0,t.jsx)(o.Button,{"aria-label":"Upgrade your plan to invite multiple external collaborators.",onClick:()=>{E(!1),el()},shape:"square",size:"tiny",svgOnly:!0,type:"tertiary",children:(0,t.jsx)(U.ArrowRight,{})}),className:"rounded-md !px-1 !py-0 !pl-2 !text-[13px]",fill:!0,label:!1,size:"small",type:"secondary",children:"Upgrade your plan to invite multiple external collaborators."})},"hobby-limit-actions"):null})]}),d?(0,t.jsxs)(O.Stack,{className:"h-[132px]",gap:3,children:[(0,t.jsx)(e5,{inputText:R,navIndex:em,onPicked:ev,setNavIndex:ex,suggestions:eu}),R||H.length?null:(0,t.jsxs)(O.Stack,{align:"center",className:"px-6 py-8 text-gray-600",gap:4,children:[(0,t.jsx)(O.Stack,{align:"center",className:"size-8 overflow-hidden rounded-sm border border-solid border-gray-300 font-bold text-gray-600",justify:"center",children:(0,t.jsx)(eX.UserPlus,{})}),(0,t.jsx)(B.Text,{color:"inherit",children:"Search team members or enter an email to invite collaborators."})]}),R&&ec?(0,t.jsx)(O.Stack,{align:"center",children:(0,t.jsx)(b.Spinner,{})}):null,!R&&H.length?(0,t.jsx)(eJ.Textarea,{onChange:e=>{Y(e.target.value)},placeholder:"Add an optional message",resize:"vertical",rows:3,value:G}):null,ei?(0,t.jsx)(eQ.Error,{error:`The message should be 250 characters or less (current length: ${G.length})`,size:"small"}):null,W?(0,t.jsx)(eQ.Error,{error:W}):null]}):null,(0,t.jsx)(eS.ToastMobileAware,{actionText:"Confirm",active:T,cancelActionText:"Cancel",onAction:()=>{es(),E(!1)},onCancelAction:()=>{E(!1)},preserve:!0,toastKey:"invite-hobby-confirmation",children:(0,t.jsxs)(O.Stack,{direction:"column",gap:3,children:[(0,t.jsxs)(B.Text,{children:["You can only share with 1 external collaborator at a time on Hobby."," ",(0,t.jsx)(_.Link,{external:!0,icon:!1,onClick:()=>{E(!1),el()},underline:!D||void 0,variant:D?"highlight":void 0,children:"Upgrade to Pro"})," ","for unlimited external collaborators."]}),(0,t.jsx)(B.Text,{children:"Continuing will remove any existing user access."})]})})]}),d?(0,t.jsxs)(f.Modal.Actions,{children:[(0,t.jsx)(f.Modal.Action,{onClick:()=>{if(T)return void E(!1);K(null),q([]),Y(""),u()},type:"secondary",children:"Cancel"}),(0,t.jsx)(f.Modal.Action,{disabled:et||T||P||en||ei||!H.length,loading:P||T,onClick:()=>{if(I)return void E(!0);es()},children:(0,t.jsx)(s.Tooltip,{text:er,children:"Invite"})})]}):null]})}function tb(e){let{children:n,header:i,invitationFocused:a}=e;return a?(0,t.jsx)(f.Modal.Body,{className:"px-0 py-3.5",padding:!1,children:(0,t.jsx)(R.Scroller,{overflow:"y",scrollerClassName:"px-1 py-2.5",children:(0,t.jsxs)(O.Stack,{className:"min-h-[285px] px-5",gap:6,children:[i,n]})})}):(0,t.jsx)(t.Fragment,{children:n})}var tf=e.i(8188445);function tv(e){let{targets:n,branchAliasId:i,deployment:a,git:r,isLoading:l,isPreviewDeployment:o,modalClose:s,previewCommentsEnabledForBranch:c,previewCommentsEnabledForDeployment:d,productionProtectionEnabled:u,project:p,protectionEnabledForDeployment:m,protectionEnabledForProject:h,revalidateAlias:y,setIsLoading:g,team:j,user:b,branchAlias:v}=e,{track:k}=(0,Z.useTrackActivity)(),{teamSlug:w,project:C}=(0,ei.useParams)()??{},[D,S]=(0,x.useState)(()=>n.find(e=>e.pendingRequests>0)?.id??n.find(e=>!(e.url.endsWith("vercel.app")||j?.previewDeploymentSuffix&&e.url.endsWith(j.previewDeploymentSuffix)))?.id??(i?n.find(e=>e.id===i)?.id:void 0)??n.find(e=>e.id!==a.id)?.id??a.id),A=n.find(e=>e.id===D),T=(0,eo.getProtectionBypass)(A??{},"shareable-link");(0,x.useEffect)(()=>{k(X.VercelActivityAction.DeploymentShareOpened,{})},[k]);let[E,N]=(0,x.useState)(!1);(0,x.useEffect)(()=>{E&&k(X.VercelActivityAction.DeploymentInviteScreenOpened,{})},[E,k]);let P=(0,x.useMemo)(()=>(e=>{let{previewCommentsEnabledForDeployment:t,protectionEnabledForDeployment:n}=e;return!t&&n?"view":t&&!n?"comment":"view and comment"})({previewCommentsEnabledForDeployment:d,protectionEnabledForDeployment:!!m}),[d,m]),M=(0,F.useToasts)(),z=(0,x.useCallback)(async e=>{if(!l&&A&&("create"===e||T)){switch(e){case"create":Q.analytics.track(J.AnalyticsEvent.DEPLOYMENT_SHARE_GENERATE_EXTERNAL_LINK,{projectId:p.id});break;case"delete":Q.analytics.track(J.AnalyticsEvent.DEPLOYMENT_SHARE_DISABLE_EXTERNAL_LINK,{projectId:p.id});break;case"regenerate":Q.analytics.track(J.AnalyticsEvent.DEPLOYMENT_SHARE_REGENERATE_EXTERNAL_LINK,{projectId:p.id})}g(!0);try{let t=await (0,ea.updateAliasProtectionBypass)({teamId:j?.id,aliasId:A.id,body:"create"!==e?{revoke:{secret:T||"",regenerate:"regenerate"===e}}:{}});if("create"===e){let e=eD({alias:A.url,protectionBypass:(0,eo.getProtectionBypass)(t,"shareable-link"),protectionEnabledForDeployment:!0});e&&(0,tf.copyToClipboard)(e),M.success("A shareable link was generated and copied to your clipboard.")}}catch(e){M.error("An error occured, please try again later.")}await y(),g(!1)}},[A,l,p.id,T,y,M,j?.id,g]),{can:H}=(0,et.default)(),V=H(en.Action.Update,"production"===a.target?en.Resource.ProductionAliasProtectionBypass:en.Resource.AliasProtectionBypass),q=(0,er.useOpenUpgradeModal)(),Y=(0,el.getAliasDeploymentProtectionException)(A?.protectionBypass),W=(0,t.jsx)(tk,{branchAliasId:i,canUpdateProtectionBypass:V,getLinkToProtectionSettingsInner:()=>I({team:j,user:b,projectName:p.name}),isPreviewDeployment:o,productionProtectionEnabled:u,protectionBypass:T,protectionEnabledForDeployment:m,selectedTargetId:D,setSelectedTargetId:S,targets:n}),K=w&&C&&v?.deploymentId?(0,es.getDashboardHref)(`/${C}/${v.deploymentId.replace("dpl_","")}`,w):void 0,ee=D===a.id&&v?.deploymentId&&v.deploymentId!==a.id&&K?(0,t.jsxs)(L.Note,{action:(0,t.jsx)(_.ButtonLink,{"aria-label":"Go to latest branch deployment",href:K,shape:"square",size:"small",svgOnly:!0,children:(0,t.jsx)(U.ArrowRight,{})}),className:"!text-gray-1000",fill:!0,type:"secondary",children:["There is a newer deployment for"," ",r?.branchName?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)($.GitBranch,{className:"mr-0.5 align-middle",size:14}),(0,t.jsx)(B.Text,{as:"span",monospace:!0,children:r.branchName})]}):"this branch",". To share it go to the latest."]}):null;return E&&(d||m)&&A?(0,t.jsx)(tj,{branchAliasId:i,canUpdateProtectionBypass:V,deployment:a,git:r,header:W,invitationFocused:E,onCancel:()=>N(!1),onFinished:()=>N(!1),onFocus:()=>void 0,openUpgradeModal:()=>{s(),q({source:"Hobby account email invite limit call to upgrade",trialBehavior:"choose"})},previewCommentsEnabledForDeployment:d,revalidateAlias:y,selectedTarget:A,teamId:j?.id,viewAndCommentDescription:P}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.Modal.Body,{className:"px-5 py-6",padding:!1,children:(0,t.jsx)(R.Scroller,{overflow:"y",scrollerClassName:"px-1 max-h-[80vh]",children:(0,t.jsxs)(O.Stack,{gap:6,children:[W,ee,Y?(0,t.jsxs)(L.Note,{fill:!0,type:"warning",variant:"contrast",children:["This domain is listed in"," ",(0,t.jsx)(_.Link,{href:`${I({team:j,user:b,projectName:p.name})}#deployment-protection-exceptions`,variant:"underline",children:"Deployment Protection Exceptions"}),", making it is currently"," ",(0,t.jsx)(B.Text,{as:"span",color:"inherit",weight:600,children:"unprotected"})," ","and"," ",(0,t.jsx)(B.Text,{as:"span",color:"inherit",weight:600,children:"publicly available"}),"."]}):null,d||m?A&&(0,t.jsx)(tj,{branchAliasId:i,canUpdateProtectionBypass:V,deployment:a,git:r,header:W,invitationFocused:E,onCancel:()=>void 0,onFinished:()=>void 0,onFocus:()=>N(!0),openUpgradeModal:()=>{s(),q({source:"Hobby account email invite limit call to upgrade",trialBehavior:"choose"})},previewCommentsEnabledForDeployment:d,revalidateAlias:y,selectedTarget:A,teamId:j?.id,viewAndCommentDescription:P}):null,(0,t.jsx)(ez,{branchAliasId:i,branchName:r?.branchName,canUpdateProtectionBypass:V,hideStaticTeamMembersBanner:!m&&!d,onUpgradeClick:()=>{s(),Q.analytics.track(J.AnalyticsEvent.DEPLOYMENT_SHARE_UPGRADE_TO_PRO_CLICKED,{projectId:p.id}),q({source:"Hobby account approve request limit call to upgrade",trialBehavior:"choose"})},project:p,revalidateAlias:y,target:A}),!d&&o?(0,t.jsx)(t.Fragment,{children:c?(0,t.jsx)(L.Note,{className:"rounded-md !px-1 !py-0 !pl-2 !text-[13px]",fill:!0,size:"small",type:"secondary",children:"Comments will be available for new builds."}):(0,t.jsx)(L.Note,{action:(0,t.jsx)(_.ButtonLink,{"aria-label":"Enable Comments",href:(e=>{let{team:t}=e;return t?`/${t.slug}/~/settings/general#toolbar`:"/account/general#toolbar"})({team:j}),onClick:()=>{Q.analytics.track(J.AnalyticsEvent.DEPLOYMENT_SHARE_CLICK_ON_ENABLE_PREVIEW_COMMENTS,{projectId:p.id})},shape:"square",size:"tiny",svgOnly:!0,tab:!0,type:"tertiary",children:(0,t.jsx)(G.SettingsGear,{})}),className:"rounded-md !px-1 !py-0 !pl-2 !text-[13px]",fill:!0,label:!1,size:"small",type:"secondary",children:"Enable comments for this deployment."})}):null,h?null:(0,t.jsx)(L.Note,{action:(0,t.jsx)(_.ButtonLink,{"aria-label":"Enable Deployment Protection",href:I({team:j,user:b,projectName:p.name}),onClick:()=>{Q.analytics.track(J.AnalyticsEvent.DEPLOYMENT_SHARE_CLICK_ON_ENABLE_VERCEL_AUTHENTICATION,{projectId:p.id})},shape:"square",size:"tiny",svgOnly:!0,type:"tertiary",children:(0,t.jsx)(U.ArrowRight,{})}),className:"rounded-md !px-1 !py-0 !pl-2 !text-[13px]",fill:!0,label:!1,size:"small",type:"secondary",children:"Enable Deployment Protection for this project."})]})})}),(0,t.jsx)(f.Modal.Actions,{children:(0,t.jsx)(eA,{alias:A?.url,canUpdateShareableLink:V,deployment:a,git:r,isLoading:l,onCreateShareableLink:()=>void z("create"),onDeleteShareableLink:()=>void z("delete"),onRegenerateShareableLink:()=>void z("regenerate"),openUpgradeModal:()=>{s(),q({source:"Hobby account shareable link limit call to upgrade",trialBehavior:"choose"})},previewCommentsEnabledForDeployment:d??!1,protectionBypass:T,protectionEnabledForDeployment:m,viewAndCommentDescription:P})})]})}function tk(e){let{canUpdateProtectionBypass:n,getLinkToProtectionSettingsInner:i,isPreviewDeployment:a,productionProtectionEnabled:r,protectionBypass:l,protectionEnabledForDeployment:o,targets:s,selectedTargetId:c,setSelectedTargetId:d,branchAliasId:u}=e,p=s.some(e=>e.pendingRequests>0&&e.id!==c);return(0,t.jsxs)(O.Stack,{align:"center",direction:"row",justify:"space-between",children:[(0,t.jsxs)(O.Stack,{align:"center",direction:"row",gap:2,children:[(0,t.jsx)(B.Text,{size:24,weight:600,children:"Share"}),s.length>1?(0,t.jsxs)(P.MenuContainer,{children:[(0,t.jsxs)(N.MenuButton,{"aria-label":"Select URL",shape:"square",size:"tiny",svgOnly:!0,type:"tertiary",children:[(0,t.jsx)(H.ChevronDown,{}),p?(0,t.jsx)("div",{className:"absolute -right-0.5 -top-0.5 size-2 rounded-full bg-green-500"}):null]}),(0,t.jsx)(E.Menu,{width:"auto",children:s.map(e=>{var n,i;let a=(n=e,i=u,n.id===i?$.GitBranch:n.id.startsWith("dpl_")?V.GitCommit:q.Globe);return(0,t.jsx)(M.MenuItem,{onClick:()=>{d(e.id)},prefix:(0,t.jsx)(a,{}),suffix:e.id===c?(0,t.jsx)(z.Check,{}):null,children:(0,t.jsxs)(O.Stack,{align:"center",direction:"row",gap:2,children:[e.url,e.pendingRequests>0?(0,t.jsx)(T.Badge,{className:"min-w-5",size:"sm",variant:"blue",children:e.pendingRequests}):null]})},e.id)})})]}):null]}),n&&(a||o)?(0,t.jsx)(tw,{getLinkToProtectionSettingsInner:i,isProtectionBypassShareableLink:!!l,productionProtectionEnabled:r,protectionEnabledForDeployment:o}):null]})}function tw(e){let{getLinkToProtectionSettingsInner:n,productionProtectionEnabled:i,isProtectionBypassShareableLink:a,protectionEnabledForDeployment:r}=e,l=(0,ee.useIsMobile)(),o=a?"Deployment Protection can be bypassed with the Shareable Link":`${i?"All":"Preview"} deployments ${!l?"in this project ":""}are protected`,c=a?(0,t.jsx)(W.ShieldGlobe,{}):(0,t.jsx)(Y.Shield,{}),d=r?c:(0,t.jsx)(K.ShieldOff,{});return(0,t.jsx)(s.Tooltip,{desktopOnly:!0,text:r?o:"Deployment Protection is not enabled and deployments are publicly accessible",children:(0,t.jsx)(_.ButtonLink,{align:"center","aria-label":"Settings",href:n(),label:"Settings",shape:"circle",size:"small",svgOnly:!0,type:"tertiary",children:d})})}function tC(e){let{deployment:i,project:a,mutateDeployment:r,...l}=e,{user:s,team:d,account:u}=(0,c.useAccount)(),p=u?.billing?.plan==="hobby",m=!!i.buildSkipped,{targets:h,branchAliasId:I,branchAlias:T,isLoading:E,mutate:N}=function(e){let{data:t}=(0,S.useCurrentDashboardDeploymentDomains)({revalidateIfStale:!1,revalidateOnFocus:!1}),n=(0,v.useTeamSlug)(),{data:i,mutate:a,isLoading:r}=(0,C.useAliasesV2)({deploymentId:e?.id,teamId:n??void 0}),l=t.branch??e?.meta.branchAlias??(e?.alias?e.alias[e.alias.length-1]:void 0),o=(0,x.useMemo)(()=>{let n,a=e?[{id:e.id,url:e.url,protectionBypass:e.protectionBypass,pendingRequests:tD(e)}]:[];if(!i)return{targets:a};for(let e of i.aliases)e.redirect||(e.alias===l&&(n=e.uid),a.push({id:e.uid,url:e.alias,protectionBypass:e.protectionBypass,pendingRequests:tD(e)}));let r=[t.commit,t.branch??"",...t.aliases].filter(Boolean);return a.sort((e,t)=>r.indexOf(e.url)-r.indexOf(t.url)),{targets:a,branchAliasId:n}},[l,i,e,t]),s=l&&!o.branchAliasId,{data:c,mutate:d,isLoading:u}=(0,D.default)({domain:s?l:void 0});return{isLoading:r||u,mutate:async()=>{await a(),await d()},targets:o.targets,branchAliasId:o.branchAliasId||c?.uid,branchAlias:c}}(i),P=(0,k.getGitMeta)(i.meta),M=(0,x.useMemo)(()=>h.some(e=>e.pendingRequests>0),[h]),L="production"!==i.target,{value:R}=(0,A.useArePreviewCommentsEnabled)({target:L?"preview":"production",branch:P?.branchName}),[O,B]=(0,x.useState)(!1),{protectionEnabledForDeployment:F,protectionEnabledForProject:_,isLoading:U,productionProtectionEnabled:z}=(e=>{let{deployment:t,project:n,isProjectLoading:i=!1}=e;if(!t||!n)return i?{isLoading:!0,protectionEnabledForDeployment:null,protectionEnabledForProject:null,productionProtectionEnabled:null}:{isLoading:!1,protectionEnabledForDeployment:!1,protectionEnabledForProject:!1,productionProtectionEnabled:!1};let{passwordProtection:a,ssoProtection:r,trustedIps:l}=n,o="production"!==t.target,s=["preview","prod_deployment_urls_and_all_previews","all_except_custom_domains"],c=a?.deploymentType==="all"||o&&a?.deploymentType&&s.includes(a.deploymentType),d=r?.deploymentType==="all"||o&&r?.deploymentType&&s.includes(r.deploymentType),u=l?.deploymentType==="all"||!o&&l?.deploymentType==="production"||o&&l?.deploymentType&&s.includes(l.deploymentType);return{productionProtectionEnabled:a?.deploymentType==="all"||r?.deploymentType==="all"||l?.deploymentType==="all",protectionEnabledForProject:!!(a||r||l),protectionEnabledForDeployment:!!(c||d||u),isLoading:!1}})({deployment:i,project:a}),H=(0,A.useCommentsEnabledForDeployment)(i),$=(0,x.useMemo)(()=>O?(0,t.jsx)(b.Spinner,{}):F?p?(0,t.jsx)(y.User,{}):(0,t.jsx)(g.Users,{}):(0,t.jsx)(j.Share,{}),[F,p,O]),[V,q,G]=(()=>{let[e,t]=(0,x.useState)(!1);return[e,(0,x.useCallback)(()=>t(!0),[]),(0,x.useCallback)(()=>t(!1),[])]})();return((0,w.default)("openSharing",()=>{q()}),E||U)?L||H?(0,t.jsx)(n.Skeleton,{className:l.className,height:40,width:"100%"}):null:H||F?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(o.Button,{disabled:m||0===h.length,onClick:q,prefix:$,style:{color:m||0===h.length?void 0:"gray-900"},type:"secondary",typeName:"button",...l,children:["Share",M?(0,t.jsx)("div",{className:"absolute -right-0.5 -top-0.5 size-2 rounded-full bg-geist-success"}):null]}),(0,t.jsx)(f.Modal.Modal,{active:V,disableFocusTrap:!0,onClickOutside:G,children:(0,t.jsx)(tv,{branchAlias:T,branchAliasId:I,deployment:i,git:P,isLoading:O,isPreviewDeployment:L,modalClose:G,previewCommentsEnabledForBranch:R??H,previewCommentsEnabledForDeployment:H,productionProtectionEnabled:z,project:a,protectionEnabledForDeployment:F,protectionEnabledForProject:_,revalidateAlias:async()=>{await N(),await r()},setIsLoading:B,targets:h,team:d,user:s})})]}):null}function tD(e){return Object.values(e?.protectionBypass??{}).filter(e=>"user"===e.scope&&"requested"===e.access).length}var tS=e.i(2964099),tA=e.i(3076719),tI=e.i(3929647),tT=e.i(3428813);function tE(e){let{className:n,...i}=e;return(0,t.jsx)(_.ButtonLink,{className:(0,l.clsx)(n,"min-w-[80px] flex-1"),...i})}function tN(e){let{className:n,...i}=e;return(0,t.jsx)(o.Button,{className:(0,l.clsx)(n,"min-w-[96px] flex-1"),...i})}function tP(e){let{deployment:n,project:i}=e,{user:a,team:r}=(0,c.useAccount)(),{areChecksRunning:l,areDomainsAssigning:o}=(0,m.getDeploymentStatus)(n),s=(0,tI.useShouldVisitWithTheToolbar)(n),{permissions:d}=(0,tT.useDeploymentPermissions)({project:i,deployment:n}),u=n.readyState,h=(0,p.useIsViewingPublicDeployment)(),{onClick:x,...y}=(0,tS.useWrappedToolbarAuthLinkHandler)({via:"deployment-visit-button",deployment:h?void 0:n});return l?(0,t.jsx)(tN,{disabled:!0,children:"Waiting for Checks"}):o?(0,t.jsx)(tN,{disabled:!0,children:"Waiting for Domains"}):(a||r)&&d.canUpdateDeployment&&!["READY","ERROR","CANCELED"].includes(n.readyState)?null:"READY"===u?s&&"production"===n.target?(0,t.jsx)(tI.VisitWithToolbarButton,{Component:tE,buttonProps:{href:(0,tA.withDefaultRoute)((0,eC.domainToUrl)(n.url),n.defaultRoute),onClick:()=>{Q.analytics.track(J.AnalyticsEvent.DEPLOYMENT_OVERVIEW_CLICKED_VISIT_BUTTON,{projectId:n.projectId||i?.id,deploymentId:n.id,deploymentTarget:n.target})},passthroughOnClick:x,...y,target:"_blank"},className:"flex-1",page:n.defaultRoute?.startsWith("/")?n.defaultRoute:`/${n.defaultRoute??""}`,url:(0,tA.withDefaultRoute)((0,eC.domainToUrl)(n.url),n.defaultRoute),via:"deployment-visit-button",children:"Visit"}):(0,t.jsx)(tE,{href:(0,tA.withDefaultRoute)((0,eC.domainToUrl)(n.url),n.defaultRoute),onClick:()=>{Q.analytics.track(J.AnalyticsEvent.DEPLOYMENT_OVERVIEW_CLICKED_VISIT_BUTTON,{projectId:n.projectId||i?.id,deploymentId:n.id,deploymentTarget:n.target})},passthroughOnClick:x,...y,target:"_blank",children:"Visit"}):(0,t.jsx)(tE,{disabled:!0,href:`https://${n.host}`,...y,children:"Visit"})}let tM="min-w-[96px] flex-1 px-[10px]";function tL(e){let{className:n,...i}=e;return(0,t.jsx)(o.Button,{className:(0,l.clsx)(tM,n),...i})}function tR(e){let{deployment:n,project:i,mutateDeployment:a}=e,{user:r,team:l}=(0,c.useAccount)(),{areChecksRunning:o,areDomainsAssigning:x}=(0,m.getDeploymentStatus)(n),{permissions:y}=(0,tT.useDeploymentPermissions)({project:i,deployment:n}),{openRedeployModal:g,openCancelDeploymentModal:j,isLoadingModals:b}=(0,h.useDeploymentModals)(),f=n.readyState,v=(0,p.useIsViewingPublicDeployment)();return o?(0,t.jsx)(tL,{disabled:!0,children:"Waiting for Checks"}):x?(0,t.jsx)(tL,{disabled:!0,children:"Waiting for Domains"}):"ERROR"===f?v||!y.canCreateDeployment?(0,t.jsx)(s.Tooltip,{className:"min-w-x[96px] flex-1",position:"top",text:"You are not the owner of this deployment. In turn, you cannot re-deploy it.",children:(0,t.jsx)(tL,{disabled:!0,prefix:(0,t.jsx)(u.RotateCounterClockwise,{}),type:"secondary",children:"Redeploy"})}):(0,t.jsx)(tL,{disabled:b,onClick:g,prefix:(0,t.jsx)(u.RotateCounterClockwise,{}),type:"secondary",children:"Redeploy"}):(r||l)&&y.canUpdateDeployment&&!["READY","ERROR","CANCELED"].includes(n.readyState)?(0,t.jsx)(tL,{onClick:j,prefix:(0,t.jsx)(d.StopCircle,{}),style:{paddingInline:6},type:"secondary",children:"Cancel"}):(0,t.jsxs)(t.Fragment,{children:[i?(0,t.jsx)(tC,{className:tM,deployment:n,mutateDeployment:a,project:i}):null,(0,t.jsx)(tP,{deployment:n,project:i})]})}function tO(){return(0,t.jsx)(n.Skeleton,{className:"min-w-[96px] flex-1 px-[10px]",height:40,width:"100%"})}function tB(){let{data:e,mutate:n}=(0,i.useCurrentDashboardDeploymentInterval)(),{data:r}=(0,a.useCurrentDashboardDeploymentOverviewProject)();return(0,t.jsx)(tR,{deployment:e,mutateDeployment:n,project:r})}function tF(){let{data:e}=(0,i.useCurrentDashboardDeploymentInterval)(),{data:n}=(0,a.useCurrentDashboardDeploymentOverviewProject)();return(0,t.jsx)(r.DeploymentMoreMenu,{deployment:e,project:n})}},8742733:e=>{"use strict";e.s({CurrentDeploymentScreenshot:()=>s});var t=e.i(6645307),n=e.i(6530772),i=e.i(5163670),a=e.i(2763735),r=e.i(6559527);function l(){let{data:e}=(0,a.useCurrentDashboardDeploymentInterval)();return(0,t.jsx)("div",{className:"aspect-[16/10] lg:w-[400px] md:w-[320px] w-full overflow-hidden ",children:(0,t.jsx)(r.ScreenshotOrStatus,{deployment:e,ignoreAliasWarning:!1,placeholder:!1,showError:!0,toolbarVia:"deployment-screenshot",useDeploymentUrl:!0})})}function o(){return(0,t.jsx)(i.Skeleton,{autoSize:!0,className:"aspect-[16/10] lg:w-[400px] md:w-[320px] w-full border border-solid rounded-sm overflow-hidden border-gray-alpha-400"})}function s(){return(0,t.jsx)(n.Suspense,{fallback:(0,t.jsx)(o,{}),children:(0,t.jsx)(l,{})})}},7092175:e=>{"use strict";e.s({CurrentDeploymentConfiguration:()=>r});var t=e.i(6645307),n=e.i(6530772),i=e.i(5535439),a=e.i(3240325);function r(){return(0,t.jsx)(n.Suspense,{fallback:(0,t.jsx)(a.DeploymentConfigurationSkeleton,{className:"rounded-b"}),children:(0,t.jsx)(l,{})})}function l(){let{id:e=""}=(0,i.useParams)()??{};return(0,t.jsx)(a.DeploymentConfiguration,{className:"rounded-b",deploymentId:e})}},5933646:e=>{"use strict";e.s({CurrentDeploymentCreator:()=>en,CurrentDeploymentDomains:()=>ei,CurrentDeploymentDuration:()=>X,CurrentDeploymentEnvironment:()=>et,CurrentDeploymentSource:()=>ee,CurrentDeploymentStatus:()=>Z},5933646);var t=e.i(6645307),n=e.i(6530772),i=e.i(5535439),a=e.i(555528),r=e.i(1164214),l=e.i(2774739),o=e.i(7696797),s=e.i(3900584);function c(e){let{deployment:n,...i}=e,{createdAt:c,createdAgo:d}=function(e){let t=e.undeleted||e.deleted||e.createdAt||e.created;return{createdAt:t?new Date(t).toLocaleDateString(void 0,{hour:"numeric",minute:"2-digit",second:"2-digit",year:"numeric",month:"short",day:"numeric",timeZoneName:"short"}):"",createdAgo:(0,l.useAgo)(t)}}(n);return(0,t.jsxs)(o.Attribute.Item,{"data-testid":(0,r.tid)("deployment","creator"),...i,children:[(0,t.jsx)("span",{className:"flex-none",children:(0,t.jsx)(s.DeploymentCreatorAvatar,{deployment:n,iconBackground:!1,showIcon:!1,size:18})}),(0,t.jsx)("span",{className:"text-label-14 -ml-px shrink truncate",children:(0,s.getDeploymentCreatorUsername)({deployment:n})}),(0,t.jsx)(a.Tooltip,{className:"flex-none",text:c,children:(0,t.jsx)("span",{className:"text-gray-900",children:d})})]})}var d=e.i(2357051),u=e.i(3821772),p=e.i(1635827),m=e.i(2597732),h=e.i(5617310);function x(e){let{deployment:n,icon:s,onlyBuild:c=!1,...h}=e,{deleted:x,inProgress:g,finishedAgo:j,ageSinceBuilding:b,deploymentDuration:f,finishedAgoTitle:v}=function(e,t){let{teamSlug:n}=(0,i.useParams)()??{},a=(0,l.useAge)(e.buildingAt||void 0,{includeSeconds:!0}),r="id"in e?e.id:e.uid,o="READY"===e.readyState&&e.checksState,{checks:s}=(0,m.default)({deploymentId:o?r:void 0,teamId:n}),c=y(e,s,t)||0,u=c&&e.buildingAt?e.buildingAt+c:void 0,p=void 0!==e.deleted,h=u?new Date(u).toLocaleDateString(void 0,{hour:"numeric",minute:"2-digit",second:"2-digit",year:"numeric",month:"short",day:"numeric",timeZoneName:"short"}):"",x=(0,l.useAgo)(u,{suffix:" ago",alwaysRelative:!0}),g="readyState"in e?e.readyState:e.state,j=e.checksState&&!e.checksConclusion,b=!!("BUILDING"===g||"READY"===g&&!e.aliasAssigned&&j);return{ageSinceBuilding:a,deploymentDuration:function(e,t,n){let i=y(e,t,n);return(0,d.age)(i,{includeSeconds:!0})}(e,s,t)||"—",finishedAgo:x,finishedAgoTitle:h,inProgress:b,finishedAt:u,deleted:p}}(n,c),k=null;return s&&!g&&(k=(0,t.jsx)(p.ClockDashed,{color:"gray-900"})),g&&(k=(0,t.jsx)(u.Spinner,{size:16})),(0,t.jsxs)(o.Attribute.Item,{"aria-label":v,"data-testid":(0,r.tid)("deployment","duration"),...h,children:[k,x?j:(0,t.jsxs)(t.Fragment,{children:[g?b:f,!g&&j?(0,t.jsx)(a.Tooltip,{text:v,children:(0,t.jsx)("span",{className:"text-gray-900",children:j})}):null]})]})}function y(e,t,n){if(!e||"BUILDING"===("readyState"in e?e.readyState:e.state)||!("buildingAt"in e))return;let i="readyStateAt"in e?e.readyStateAt:e.ready;if(!i||!e.buildingAt)return;let a=i-e.buildingAt;if(n)return a;let r=t?.length?(0,h.getChecksTimes)(t,e):void 0,l=r?.checksFinishedAt&&r.checksStartedAt?r.checksFinishedAt-r.checksStartedAt:0,o=e.aliasAssignedAt??("number"==typeof e.aliasAssigned?e.aliasAssigned:void 0),s=0;if(o){let e=r?.checksFinishedAt?o-r.checksFinishedAt:o-i;e<18e5&&(s=e)}return a+l+s}var g=e.i(5505645),j=e.i(2362802),b=e.i(5154216),f=e.i(3138389),v=e.i(5140160),k=e.i(1093245),w=e.i(3921802),C=e.i(3583950),D=e.i(2964099),S=e.i(2722014),A=e.i(3076719),I=e.i(3153829),T=e.i(3799021),E=e.i(3805480),N=e.i(1922196);function P(e){let i,{url:a,defaultRoute:r}=e,[l,o]=(0,n.useState)(!1),s=(0,E.default)(a),c=(0,N.default)(a);return(0,t.jsx)(t.Fragment,{children:c?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(j.Link,{as:"button",className:"hover:underline",onClick:()=>o(!0),children:a}),(0,t.jsx)(T.default,{active:l,onCancel:()=>{o(!1)},url:s})]}):(0,t.jsx)(j.Link,{className:"hover:underline",href:(i=(0,I.domainToUrl)(a),(0,A.withDefaultRoute)(i,r)),children:a})})}var M=e.i(4589373),L=e.i(106479),R=e.i(226017);function O(e){let{deploymentDomains:n,deployment:r}=e,l=(0,S.useIsViewingPublicDeployment)(),s=(0,D.useWrappedToolbarAuthLinkHandler)({via:"deployment-domains-list",deployment:l?void 0:r}),{branch:c,commit:d,aliases:u,defaultRoute:p}=n,m=e=>(0,A.withDefaultRoute)(e,p),h=(0,L.useDomainConfigs)(u.filter(e=>!e.endsWith(".vercel.app")).slice(0,10),{strict:!1,projectIdOrName:r.projectId}),x=(0,R.useServerFlag)("enable-ip-diff-alerts",!1)&&!!h.data?.some(e=>{if(!e.isOk())return!1;let t=e.value,n=!!(t.recommendedIPv4||t.recommendedCNAME);return"required-change"===t.ipStatus&&!!n}),y=(0,i.useParams)(),g=(0,M.getQueryParam)(y?.teamSlug),T=(0,M.getQueryParam)(y?.project),E=`/${g}/${T}/settings/domains`;return(0,t.jsxs)(t.Fragment,{children:[u.length>0?(0,t.jsxs)(o.Attribute.Item,{Icon:v.Globe,children:[(0,t.jsx)(P,{defaultRoute:p,url:u[0]}),u.length>1&&(0,t.jsx)(C.ContextCard.Trigger,{content:(0,t.jsxs)("div",{className:"text-label-13 flex flex-col gap-2",children:[(0,t.jsx)("span",{className:"text-gray-900",children:"Assigned Domains"}),(0,t.jsx)("div",{className:"flex flex-col gap-1.5 hover:[&>a]:underline",children:u.slice(1).map(e=>(0,t.jsx)(P,{defaultRoute:p,url:e},e))})]}),children:(0,t.jsxs)(w.Badge,{size:"sm",variant:"gray-subtle",children:["+",u.length-1]})}),x?(0,t.jsx)(a.Tooltip,{text:(0,t.jsxs)("div",{children:["To avoid downtime, you must change your DNS records for one or more of these domains. Visit the"," ",(0,t.jsx)(j.Link,{href:E,tab:!0,variant:"highlight",children:"domains settings"})," ","for this project for more information."]}),position:"top",children:(0,t.jsx)(k.WarningFill,{color:"red-700",size:"sm"})}):null]}):null,c?(0,t.jsxs)(o.Attribute.Item,{children:[(0,t.jsx)(a.Tooltip,{className:"flex-none",position:"left",text:"Latest deployment on branch—updates automatically",children:(0,t.jsx)(f.GitBranch,{color:"gray-900"})}),(0,t.jsx)(j.Link,{...s,className:"hover:underline",href:m((0,I.domainToUrl)(c)),children:c})]}):null,(0,t.jsxs)(o.Attribute.Item,{children:[(0,t.jsx)(a.Tooltip,{className:"flex-none",position:"left",text:"Deployment associated with this commit",children:(0,t.jsx)(b.GitCommit,{color:"gray-900"})}),(0,t.jsx)(j.Link,{...s,className:"hover:underline",href:m((0,I.domainToUrl)(d)),children:d})]})]})}var B=e.i(9385465),F=e.i(869010);e.i(9389778);var _=e.i(1310591),U=e.i(5168763),z=e.i(3741818),H=e.i(9945435),$=e.i(8328767),V=e.i(6054209),q=e.i(4355978),G=e.i(5690638);function Y(e){let{deployment:n,project:i}=e,r=(0,q.useIsCurrentProductionDeployment)(n),{teamSlug:l,projectSlug:s}=(0,_.useProjectAndTeamSlug)(),c=r&&i?.lastAliasRequest?.type==="rollback"&&i.lastAliasRequest.toDeploymentId===n.id||!1,{deploymentTargetConfigurationUrl:d,deploymentTargetLabel:u}=(0,V.useDeploymentEnvironmentLabel)({deployment:n}),{data:p}=(0,$.useRollingRelease)({teamIdOrSlug:l,projectSlug:s}),m=p?.rollingRelease,h=m?.canaryDeployment?.id===n.id,x=n.aliasAssignedAt,y=x?(0,t.jsx)(G.DeploymentAliasToolTipText,{datetime:x,eventName:c?"rollback":"promote",showAgo:!0}):null,g="production"!==n.target||"STAGED"!==n.readySubstate||r?null:(0,t.jsx)("span",{className:"text-label-14 text-gray-900",children:" Staged"}),b=null;if(h){let{activeStage:e}=m;e?.targetPercentage&&(g=null,b=(0,t.jsx)(a.Tooltip,{text:m.startedAt?(0,t.jsx)(G.DeploymentAliasToolTipText,{datetime:m.startedAt,eventName:"rollingRelease",showAgo:!0}):null,children:(0,t.jsx)(w.Badge,{size:"sm",variant:"blue-subtle",children:(0,t.jsx)(j.Link,{className:"hover:underline",href:(0,U.getDashboardHref)(`/${s}/deployments/rolling-release`,l||void 0),children:"Canary"})})}))}(r||c)&&(b=(0,t.jsx)(a.Tooltip,{text:y,children:(0,t.jsxs)(w.Badge,{size:"sm",variant:c?"amber-subtle":"blue-subtle",children:[c?(0,t.jsx)(B.RotateCounterClockwise,{size:12}):null,(0,t.jsx)("span",{style:{paddingLeft:c?.5:void 0},children:"Current"})]})}));let f=z.Layers;return"production"===u.toLowerCase()&&(f=F.ArrowCircleUp),"preview"===u.toLowerCase()&&(f=H.PreviewEye),(0,t.jsxs)(o.Attribute.Item,{Icon:f,className:"flex-wrap",children:[d?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(j.Link,{className:"hover:underline",href:d,children:u}),g]}):(0,t.jsxs)(t.Fragment,{children:[u,g]}),b]})}var W=e.i(8804902),K=e.i(2763735),Q=e.i(8196175),J=e.i(7889764);function X(){let{data:e}=(0,K.useCurrentDashboardDeploymentInterval)();return(0,t.jsx)(x,{deployment:e,icon:!0,onlyBuild:!0})}function Z(){let e=(0,i.useParams)(),{data:n}=(0,K.useCurrentDashboardDeploymentInterval)();return(0,t.jsx)(g.DeploymentStatus,{deployment:n,hint:!0,label:!0,projectSlug:e?.project,teamSlug:e?.teamSlug})}function ee(){let{data:e}=(0,K.useCurrentDashboardDeploymentInterval)();return(0,t.jsx)(W.DeploymentSource,{deployment:e})}function et(){let{data:e}=(0,K.useCurrentDashboardDeploymentInterval)(),{data:n}=(0,J.useCurrentDashboardDeploymentOverviewProject)();return(0,t.jsx)(Y,{deployment:e,project:n})}function en(){let{data:e}=(0,K.useCurrentDashboardDeploymentInterval)();return(0,t.jsx)(c,{deployment:e})}function ei(){let{data:e}=(0,K.useCurrentDashboardDeploymentInterval)(),{data:i,mutate:a}=(0,Q.useCurrentDashboardDeploymentDomains)(),{status:r,readySubstate:l}=e;return(0,n.useEffect)(()=>{"READY"===r&&a()},[l,r,a]),(0,t.jsx)(O,{deployment:e,deploymentDomains:i})}},7049638:e=>{"use strict";e.s({DeploymentSWRConfig:()=>a});var t=e.i(6645307),n=e.i(3521787);let i=new Set([400,403,404]);function a(e){let{children:a}=e;return(0,t.jsx)(n.SWRConfig,{value:{shouldRetryOnError:e=>!("status"in e)||!i.has(e.status)},children:a})}}}]);

//# sourceMappingURL=a952f5648489ede1.js.map
//# debugId=232d6aef-19c0-5acf-8b46-c023c1a25402
