
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="52b9f358-5d57-5517-bf9d-7fc36a588ab5")}catch(e){}}();
(globalThis.TURBOPACK=globalThis.TURBOPACK||[]).push(["object"==typeof document?document.currentScript:void 0,{4329388:e=>{"use strict";e.s({FeedbackButton:()=>l});var t=e.i(6645307),r=e.i(3250594),a=e.i(6530772),s=e.i(5454140),n=e.i(3514588);let i=["hobby","pro","enterprise"];function l(e){let{buttonType:l}=e,{user:o}=(0,s.useUser)(),{teams:c}=(0,n.useTeam)(),d=(0,a.useMemo)(()=>i[Math.max(0,...(c??[]).map(e=>i.indexOf(e.billing?.plan??"hobby")))],[c]);return(0,t.jsx)(r.Feedback,{buttonType:l,email:o?.email??void 0,label:"front",planName:d,showTopics:!0})}},6863557:e=>{"use strict";e.s({NotificationsButton:()=>s});var t=e.i(6645307),r=e.i(5535439),a=e.i(331812);function s(){let e=(0,r.usePathname)();return e?.startsWith("/account")||e?.startsWith("/domains")?null:(0,t.jsx)(a.NotificationsProviderAndPopover,{})}},7720967:e=>{e.v(e.b(["static/chunks/130d6a4c0046409f.js","static/chunks/turbopack-915a5e4d2e194d7f.js"]))},931049:e=>{"use strict";e.s({FindModal:()=>q},931049);var t=e.i(6645307),r=e.i(5610210),a=e.i(6530772),s=e.i(5535439),n=e.i(2362802),i=e.i(4985295),l=e.i(8424492),o=e.i(225464),c=e.i(4564279),d=e.i(6031903),u=e.i(6649026),p=e.i(5917059);let m=async(e,t,r)=>{let a=(0,p.getPermutationKey)(e);if(t.knownPermutations.has(a))return;t.knownPermutations.add(a),t.pendingPermutations.add(a);let{string:s,type:n}=e;try{await h[n](s,t,r)}catch(e){t.knownPermutations.delete(a),console.log(e)}finally{t.pendingPermutations.delete(a),r()}},h={account:async(e,t)=>{},team:async(e,t)=>{},repository:async(e,t)=>{},project:async(e,t,r)=>{if(!(await Promise.allSettled([(0,d.fetchApi)(`/api/v2/dashboard/projects${(0,u.encode)({search:e,teamId:t.params.team,limit:10})}`,{throwOnHTTPError:!0}).then(e=>{if(!e||"object"!=typeof e)throw Error("Invalid projects API response");for(let r of e.projects||[])(0,p.addProject)(t,r);r()}),(0,d.fetchApi)(`/api/dashboard/find/projects${(0,u.encode)({query:e,limit:10})}`,{throwOnHTTPError:!0}).then(e=>{if(!e||"object"!=typeof e)throw Error("Invalid projects API response");for(let r of e.projects)(0,p.addProject)(t,r);r()})])).some(e=>"fulfilled"===e.status))throw Error("Failed to fetch projects")},deployment:async(e,t)=>{let r=await (0,d.fetchApi)(`/api/v1/dashboard/find/branches${(0,u.encode)({query:e,teamId:t.params.team})}`,{throwOnHTTPError:!0});if(!r||"object"!=typeof r)throw Error("Invalid projects API response");for(let e of r.branches){if("CANCELED"===e.project.deployment.status)continue;let r=t.projects.get(e.project.id)?.name;if(!r)continue;let a=e.project.deployment.id.replace("dpl_","");t.deployments.set(a,{id:a,readyState:e.project.deployment.status,meta:{githubDeployment:"1",gitCommitRef:e.branch},createdAt:0,url:""}),t.activeBranches.set(`${e.project.id}_${e.branch}`,{projectId:e.project.id,project:r,branch:e.branch,deployment:a})}}};var g=e.i(5175803),f=e.i(8382218),x=e.i(3821772),y=e.i(7358004),v=e.i(5485417),j=e.i(2824080),b=e.i(1202246),w=e.i(6157709),N=e.i(3979315);let k=(0,e.i(6895406).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M8 16C12.4183 16 16 12.4183 16 8C16 3.58172 12.4183 0 8 0C3.58172 0 0 3.58172 0 8C0 12.4183 3.58172 16 8 16ZM7.53033 4.71967L7 4.18934L5.93934 5.25L6.46967 5.78033L8.68934 8L6.46967 10.2197L5.93934 10.75L7 11.8107L7.53033 11.2803L10.1036 8.70711C10.4941 8.31658 10.4941 7.68342 10.1036 7.29289L7.53033 4.71967Z" fill="currentColor"/>');var S=e.i(1933128),A=e.i(6859825);let E=(e,t)=>{let r={type:(0,p.detectScopeType)(e.route),search:"",hash:"",...e};return{type:"dash",score:0,page:r,params:t,href:(0,p.createHref)(r,t)}},I=e=>({type:"prompt",score:0,href:`prompt:${e}`,query:e}),C=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;for(let r=t;r--;)e.sort(()=>Math.sign(Math.random()-.5));return e},L=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,r=new Set,a=[],s=0,n=0;for(let i=0;;++i){let l=i%e.length,o=e[l].shift();if(!o){if(++n===e.length)break;continue}let c=a[l];if(c||(c=[],a[l]=c),n=0,r.has(o.href)){--i;continue}if(r.add(o.href),c.push(o),++s===t)break}return a.flat()};var T=e.i(1593531),P=e.i(854226),R=e.i(2781454);function q(){let{isOpen:e}=(0,l.useFind)();return e?(0,t.jsx)(z,{}):null}function z(){let{open:r}=(0,T.useNavDocs)(),{close:n,refresh:o,refreshRef:c,memoryRef:d,fromRef:u,modalRef:h,prompt:g}=(0,l.useFind)(),{track:y}=(0,P.useTrackActivity)(),v=(0,a.useMemo)(()=>{let e=u.current;if(!e)return"32px";let t=Math.max(32,16+window.innerWidth-384-e.getBoundingClientRect().left);return`${Math.round(t)}px`},[u]),b=(0,a.useMemo)(()=>{var e;let t;return L((t=e=d.current,[(e=>{let t=[];e:for(let r of e.recentPreviews)for(let a of r.previews){if(e.params.project&&a.project!==e.params.project)continue;let r=E({route:"/[teamSlug]/[project]/[id]"},{team:e.params.team,project:a.project,id:a.deployment});if(6===t.push(r))break e}return t})(e),(e=>{let t=[];{let r=e.frecency.scopes.find(e=>!e.includes("/")),a="";e.params.team&&"/[teamSlug]"!==e.route?a=e.params.team:r&&(a=r);let s=e.frecency.scopes.find(e=>e.includes("/")),n="",i="";for(let r of(e.params.project?(n=e.params.project,i=e.params.team||a):s&&([i,n]=s.split("/")),e.frecency.routes)){let s;if(r in e.routes){if(r.startsWith("/[teamSlug]/[project]")){if(!n)continue;s={team:i,project:n}}else{if(!a)continue;s={team:a}}t.push(E({route:r},s))}}}if(e.params.project)"/[teamSlug]/[project]"!==e.route?t.push(E({route:"/[teamSlug]/[project]"},{team:e.params.team,project:e.params.project})):t.push(E({route:"/[teamSlug]/[project]/deployments"},{team:e.params.team,project:e.params.project}));else for(let[r]of Array.from(e.projectWeights.entries()).sort((e,t)=>t[1]-e[1])){let a=e.projects.get(r);if(!a||a.owner!==e.params.team)continue;let s=E({route:"/[teamSlug]/[project]"},{team:e.params.team,project:a.name});if(6===t.push(s))break}return e.params.team&&"/[teamSlug]"!==e.route&&t.push(E({route:"/[teamSlug]"},{team:e.params.team})),t})(e),(e=>{let t=[];for(let[r,a]of Object.entries(e.routes)){let s={},n=(0,p.detectScopeType)(r);if("project"===n){if(!e.params.project)continue;s.project=e.params.project,s.team=e.params.team}else if("team"===n){if(!e.params.team)continue;s.team=e.params.team}else if("account"!==n)continue;for(let[e,n]of(a.promote&&t.push(E({route:r},s)),Object.entries(a.search||{})))n.promote&&t.push(E({route:r,search:e},s));for(let[s,n]of Object.entries(a.hash||{}))n.promote&&t.push(E({route:r,hash:s},e.params))}return C(t)})(e),(e=>{let t=e.routes[e.route],r=t?.docs;return r?[{type:"docs",title:t.label,href:`/docs${r}`,score:0}]:[]})(e),(e=>{let t=[],{project:r,team:a}=e.params;if(a){let a=new Set,s=new Set;for(let t of(r&&(a.add(r),s.add(""),s.add(r)),e.recentPreviews))for(let e of t.previews)a.add(e.project),s.add(e.project);for(let[t,r]of e.projectWeights){if(r<1.1)continue;let n=e.projects.get(t)?.name;n&&(a.add(n),s.add(n))}for(let e of s)t.push(`${e} visitors this week`.trim(),`${e} bounce rate last week`.trim(),`failed requests${e?` on ${e}`:""}`,`finished builds${e?` for ${e}`:""}`,`How do I add another domain${e?` to ${e}`:""}`,`${e} production deployments`.trim(),`${e} visits this morning`.trim()),e&&t.push(`${e} usage`);r&&t.push("how do I set up oidc?","how do I turn on fluid compute?"),t.push("successful production deployments","failing production deployments","queued production deployments","what did we deploy today?","how do I add a domain?")}else t.push("What teams am I on?");return C(t).slice(0,1).map(I)})(e)].map(e=>e.filter(e=>e.href!==t.href))))},[d]),[w,k]=(0,a.useState)([]),[S,A]=(0,a.useState)(0),q=(0,a.useRef)(S);q.current=S;let z=(0,a.useRef)(0),$=(0,a.useRef)(0),F=(0,a.useRef)(void 0);(0,a.useEffect)(()=>{let t,r=new Worker(e.r("7720967"));F.current=r;let a="";return r.addEventListener("message",e=>{let r=e.data;if(r.requestId<$.current)return;$.current=r.requestId;let{results:s,permutations:n}=r,i=s;if(a===r.query&&t){i=t.slice();let e=t.filter((e,t)=>t!==q.current&&!s.some(t=>t.href===e.href)),r=s.filter(e=>!t?.some(t=>t.href===e.href));for(let a=0;a<s.length;++a){let s=t[a];if(!s||e.includes(s)){let e=r.shift();if(!e)break;i[a]=e}}}a=r.query,t=i,k(i);let l=()=>{for(let e of n)m(e,d.current,o)};(0,p.normalizeParam)(String(r.query.at(-1))).length?D.current=setTimeout(l,250):l()}),()=>{F.current?.terminate(),F.current=void 0}},[d,o]),(0,a.useEffect)(()=>{let e=e=>{"Escape"===e.key&&n()},t=!1,r=e=>{t=!h.current?.contains(e.target)},a=e=>{if(e.metaKey||e.ctrlKey||e.button)return;let r=e.target;if(!h.current?.contains(r)){t&&setTimeout(()=>n());return}r.closest("a[href],button")&&setTimeout(()=>n())};return window.addEventListener("keydown",e),window.addEventListener("pointerdown",r,!0),window.addEventListener("click",a,!0),()=>{window.removeEventListener("keydown",e),window.removeEventListener("pointerdown",r,!0),window.removeEventListener("click",a,!0)}},[n,h]);let D=(0,a.useRef)(0),B=(0,a.useCallback)(e=>{let t=e.target.value;if(!t.trim()){c.current=void 0,$.current=++z.current,k([]);return}clearTimeout(D.current),c.current=()=>{let e={requestId:++z.current,query:t,memory:d.current};F.current?.postMessage(e)},o(),A(0)},[d,c,o]),O=(0,i.useOnNavigate)(),_=(0,s.useRouter)();(0,a.useEffect)(()=>{let e=!1,t=-1,a=()=>{e=!0,-1!==t&&(A(t),t=-1)},s=r=>{let a=r.target;if(!h.current?.contains(a))return;let s=a.closest("a[href],button");if(!s)return;let n=Number(s.dataset.index||-1);-1!==n&&S!==n&&(e?(A(n),e=!1):t=n)},i=e=>{let{key:t}=e;if("Enter"===t){e.preventDefault(),e.stopPropagation();let t=(w.length?w:b)[S];y(R.VercelActivityAction.FindModalResultSelected,{resultType:t.type,route:"dash"===t.type?t.page.route:void 0,via:"keyboard"}),"prompt"===t.type?g.start(t.query):"docs"===t.type&&window.innerWidth>=960?r(t.href):(O(t.href),_.push(t.href)),n();return}let a=Number("ArrowDown"===t)-Number("ArrowUp"===t);a&&(e.preventDefault(),e.stopPropagation(),A(Math.max(0,Math.min(S+a,(w.length||b.length)-1))))};return window.addEventListener("pointermove",a),window.addEventListener("pointerover",s),window.addEventListener("keydown",i),()=>{window.removeEventListener("pointermove",a),window.removeEventListener("pointerover",s),window.removeEventListener("keydown",i)}},[_,n,w,b,S,h,g,r,O,y]),(0,a.useEffect)(()=>()=>{c.current=void 0},[c]),(0,a.useLayoutEffect)(()=>{if(window.innerWidth<=960||matchMedia("(prefers-reduced-motion: reduce)").matches)return;let e=u.current,t=h.current;if(e&&t){let r=t.closest("[data-backdrop]");r&&r.animate([{backgroundColor:"transparent"},{}],{duration:300,easing:"ease"}),(()=>{let r=e.querySelector("[data-search-icon] > *"),a=t.querySelector("[data-search-icon] > *");if(!r||!a||a.getAnimations().length)return;let s=r.getBoundingClientRect(),n=a.getBoundingClientRect();a.animate([{transform:`translateX(${s.left-n.left}px)`},{transform:"none"}],{duration:150,easing:"ease"})})(),(()=>{let r=t.querySelector("[data-bg-layer]");if(!r||r.getAnimations().length)return;let a=e.getBoundingClientRect(),s=r.getBoundingClientRect();r.animate([{transform:`translate(${a.left-s.left}px,${a.top-s.top}px) scale(${a.width/s.width},${a.height/s.height})`},{transform:"none"}],{duration:150,easing:"ease"})})(),(()=>{let r=e.querySelector("[data-placeholder]"),a=t.querySelector("input");if(!r||!a||a.getAnimations().length)return;let s=r.getBoundingClientRect(),n=a.getBoundingClientRect();a.animate([{transform:`translateX(${s.left-n.left}px)`},{transform:"none"}],{duration:150,easing:"ease"})})(),(()=>{let e=t.querySelector("label");e&&(e.getAnimations().length||e.animate([{borderBottomColor:"transparent"},{}],{delay:50,duration:250,easing:"ease",fill:"backwards"}))})(),(()=>{let e=t.querySelector("[data-results-list]");e&&(e.getAnimations().length||e.animate([{opacity:"0"},{}],{delay:50,duration:250,easing:"ease",fill:"backwards"}))})(),(()=>{let e=t.querySelector("kbd");e&&(e.getAnimations().length||e.animate([{opacity:"0",transform:"translateX(-20%) scale(0.95)"},{}],{delay:50,duration:250,easing:"ease",fill:"backwards"}))})()}},[u,h]);let W=!!(w.length&&d.current.pendingPermutations.size);return(0,t.jsx)("div",{className:"fixed inset-0 z-[10000] bg-background-100/60","data-backdrop":!0,children:(0,t.jsx)("div",{className:"fixed inset-0 flex flex-col items-center justify-start md:items-end md:pr-[var(--x-offset)] md:pt-2",style:{"--x-offset":v},children:(0,t.jsx)("div",{className:"h-screen w-screen p-2 md:h-[384px] md:max-w-96 md:p-0",children:(0,t.jsxs)("div",{className:"relative flex flex-col",ref:h,children:[(0,t.jsx)("div",{className:"material-modal absolute -inset-px origin-top-left","data-bg-layer":!0}),(0,t.jsxs)("label",{className:"relative flex flex-row items-center border-0 border-b border-solid border-gray-300",children:[(0,t.jsx)("div",{className:"grid size-12 place-content-center","data-search-icon":!0,children:(0,t.jsx)(j.MagnifyingGlass,{color:"gray-900"})}),(0,t.jsx)("input",{className:"text-copy-14 h-12 flex-1 border-0 border-none bg-transparent py-4 pl-0 pr-4 outline-none",onChange:B,placeholder:"Find…",ref:e=>{e?.focus()},width:"100%"}),(0,t.jsx)("button",{"aria-label":"Close",className:"grid size-12 cursor-pointer place-content-center border-none bg-transparent outline-none",onClick:()=>n(),type:"button",children:W?(0,t.jsx)(x.Spinner,{className:"animate-partial-fade-in"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.Kbd,{className:"!ml-0 mr-1.5 pointer-coarse:hidden",small:!0,children:"Esc"}),(0,t.jsx)(N.Cross,{className:"pointer-fine:hidden",color:"gray-900"})]})})]}),(0,t.jsx)("div",{className:"relative h-[18.5rem] overflow-y-auto overflow-x-clip md:overflow-y-clip","data-results-list":!0,children:(0,t.jsxs)("div",{className:"flex flex-col p-1",children:[(w.length?w:b).map((e,r)=>(0,t.jsx)(M,{index:r,result:e,memory:d.current},e.href)),(0,t.jsx)("div",{className:"pointer-events-none absolute inset-x-1 top-1 h-12 rounded bg-gray-alpha-100",style:{transform:`translateY(${3*S}rem)`,transition:"transform 0.1s ease"}})]})})]})})})})}function M(e){let{index:r,memory:a,result:s}=e,{label:n,icon:i,prefix:l,avatar:o}=B(s,a),c=O(s,a);return(0,t.jsxs)($,{className:"flex h-12 flex-none flex-row items-center rounded p-0 active:bg-gray-100",index:r,result:s,children:[(0,t.jsx)("span",{"aria-hidden":!0,className:"grid size-11 flex-none place-content-center",children:(0,t.jsxs)("div",{className:"relative",children:[l||(0,t.jsx)(i,{color:"gray-900"}),o?(0,t.jsx)("div",{className:"absolute left-full top-full -ml-2 -mt-2 grid size-auto place-content-center rounded-full bg-background-100 p-0.5",children:o}):null]})}),(0,t.jsxs)("div",{className:"flex flex-1 select-none flex-col overflow-hidden pr-2",children:[(0,t.jsx)("div",{className:"text-label-13 h-4 truncate",children:(0,t.jsx)("strong",{children:n})}),(0,t.jsx)("div",{className:"text-label-13 h-4 truncate text-gray-900",children:c})]})]})}function $(e){let{className:r,index:a,result:s,children:n}=e;return"prompt"===s.type?(0,t.jsx)(D,{className:r,index:a,result:s,children:n}):(0,t.jsx)(F,{className:r,index:a,result:s,children:n})}function F(e){let{className:r,index:s,result:i,children:l}=e,{open:o}=(0,T.useNavDocs)(),{track:c}=(0,P.useTrackActivity)(),d="dash"===i.type?i.page.route:void 0,u=(0,a.useCallback)(e=>{c(R.VercelActivityAction.FindModalResultSelected,{resultType:i.type,route:d,via:"pointer"}),"docs"!==i.type||e.button||e.ctrlKey||e.metaKey||window.innerWidth<960||(o(i.href),e.preventDefault())},[o,i.href,i.type,c,d]);return(0,t.jsx)(n.Link,{className:r,"data-index":s,href:i.href,onClick:u,tab:"docs"===i.type,children:l})}function D(e){let{className:s,index:n,result:i,children:o}=e,{prompt:c}=(0,l.useFind)(),{track:d}=(0,P.useTrackActivity)(),u=(0,a.useCallback)(()=>{d(R.VercelActivityAction.FindModalResultSelected,{resultType:i.type,via:"pointer"}),c.start(i.query)},[i.query,i.type,c,d]);return(0,t.jsx)("button",{className:(0,r.clsx)("cursor-pointer border-none bg-transparent text-left outline-none",s),"data-index":n,onClick:u,type:"button",children:o})}let B=(e,r)=>{let a;switch(e.type){case"prompt":return{icon:w.Sparkles,label:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"text-gray-900",children:"“"}),e.query,(0,t.jsx)("span",{className:"text-gray-900",children:"”"})]})};case"docs":return{icon:b.File,label:e.title};case"dash":{let s,n=o.Routes[e.page.route],i=n;e.page.search&&(i=i.search[e.page.search]),e.page.hash&&(i=i.hash[e.page.hash]);let l="",d=e.params.team===r.params.team,u=e.params.project===r.params.project,p=d&&(u||!e.params.project),m=r.teams.get(e.params.team||"");m&&(a=e=>(0,t.jsx)(g.Avatar,{hash:m.avatar,size:e,teamId:m.id}));let h=e.params.project||"",f=r.slugs.get(e.params.team||"")?.get(h);if(f&&(a=r=>(0,t.jsx)(S.ProjectAvatar,{error:(0,t.jsx)(k,{size:Math.min(r,16),color:"gray-900"}),teamId:e.params.team,project:{id:f,name:h},size:r})),"/[teamSlug]"===e.page.route)m&&(l=m.name);else if("/[teamSlug]/[project]"===e.page.route)f&&(l=h);else if("deployment"===e.page.type){let n=e.params.id||"",i=r.deployments.get(n);if(i&&(a&&!p?(s=a(21),a=()=>(0,t.jsx)(y.StatusDot,{className:"*:size-2",state:i.readyState})):s=(0,t.jsx)(y.StatusDot,{state:i.readyState})),"/[teamSlug]/[project]/[id]"===e.page.route){if(_(e,r))l="Production Deployment";else if(i){let e=(0,A.getGitMeta)(i.meta);e?.branchName&&(l=e.branchName)}}}return a&&(i?.label==="Overview"?(s=a(21),a=void 0):p&&(a=void 0)),{avatar:a?.(12),icon:c.RouteIcons[i?.label||""]??c.RouteIcons[n?.label||""]??c.RouteIcons[i?.group||""]??c.RouteIcons[n?.group||""]??(a?k:v.ArrowRight),prefix:s,label:l||i?.label||W(e.page.route)}}}},O=(e,t)=>(0,a.useMemo)(()=>{switch(e.type){case"prompt":return"Navigation Assistant";case"docs":return"Documentation"}let r=[],a=!1,s=e.params.team||"",n=e.params.project||"";if(s&&s===t.params.team||"/[teamSlug]"===e.page.route?r.push("Team"):e.params.team&&(r.push(t.teams.get(s)?.name||"Team"),a=!0),n&&n===t.params.project?(r.splice(0),r.push("Project")):"/[teamSlug]/[project]"===e.page.route?a||(r.splice(0),r.push("Project")):n&&(s===t.params.team&&r.splice(0),r.push(n),a=!0),"deployment"===e.page.type)if(_(e,t)||a);else if("/[teamSlug]/[project]/[id]"===e.page.route)r.splice(0),r.push("Latest Deployment");else{let a=t.deployments.get(e.params.id||""),s=(0,A.getGitMeta)(a?.meta);r.splice(0),s?.branchName?r.push(s.branchName):r.push("Deployment")}else e.params.id&&(r.splice(0),r.push("Deployment"));if(!a){let t=o.Routes[e.page.route];t&&((e.page.search||e.page.hash)&&r.push(t.label),t.group&&t.group!==t.label&&r.push(t.group))}return r.join(" / ")||""},[e,t]),_=(e,t)=>"dash"===e.type&&t.projectDeployments.get(e.params.project||"")?.id.replace("dpl_","")===e.params.id,W=e=>{let t=e.split("/").pop();return!t||t.startsWith("[")?"":t.replace(/(?:^|-)(?<word>.*?)(?=-|$)/g,(e,t)=>`${t.substring(0,1).toUpperCase()}${t.substring(1)}`)}},3988167:e=>{"use strict";e.s({FindBar:()=>u});var t=e.i(6645307),r=e.i(6530772),a=e.i(5610210),s=e.i(8382218),n=e.i(3821772),i=e.i(2824080),l=e.i(3558962),o=e.i(8424492),c=e.i(854226),d=e.i(2781454);function u(){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m,{}),(0,t.jsx)(p,{})]})}function p(){let{isOpen:e,toggle:u,open:p,prompt:m}=(0,o.useFind)(),h=(0,r.useRef)(null),{track:g}=(0,c.useTrackActivity)();return(0,r.useEffect)(()=>{let t=t=>{let r=t.metaKey||t.ctrlKey;r&&"p"===t.key.toLowerCase()?(t.preventDefault(),t.stopPropagation(),e||g(d.VercelActivityAction.FindModalOpened,{via:"keyboard"}),u(h.current)):r||"f"!==t.key.toLowerCase()||(()=>{let e=document.activeElement;return!!e&&!!("INPUT"===e.tagName||"TEXTAREA"===e.tagName||"VERCEL-LIVE-FEEDBACK"===e.tagName||e.getAttribute("contenteditable"))})()||(t.preventDefault(),t.stopPropagation(),e||g(d.VercelActivityAction.FindModalOpened,{via:"keyboard"}),p(h.current))};return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}},[p,u,g,e]),(0,t.jsxs)("button",{className:(0,a.clsx)("relative z-[calc(var(--header-zindex)_+_1)] mr-px size-[30px] cursor-pointer overflow-visible border-0 bg-transparent p-0 [webkit-tap-highlight-color:transparent] lg:m-0 lg:h-8 lg:w-40 xl:w-48",!m.cancel&&"lg:cursor-text",!e&&"pointer-events-auto",e&&"invisible"),onClick:()=>{m.cancel?m.cancel():(e||g(d.VercelActivityAction.FindModalOpened,{via:"pointer"}),p(h.current))},ref:h,type:"button",children:[(0,t.jsx)("span",{className:"absolute inset-0 origin-top-left rounded-full border-none bg-background-100 outline outline-1 outline-gray-alpha-300 lg:rounded","data-bg-layer":!0}),(0,t.jsxs)("span",{className:"relative flex flex-row items-center",children:[(0,t.jsx)("span",{className:"grid size-[30px] place-content-center text-gray-1000 lg:size-8 lg:text-gray-900","data-search-icon":!0,children:"idle"===m.status?(0,t.jsx)(i.MagnifyingGlass,{className:"animate-partial-fade-in"}):(0,t.jsx)(n.Spinner,{className:"animate-partial-fade-in"})}),(0,t.jsx)("span",{className:"text-copy-14 hidden flex-1 animate-partial-fade-in text-left text-gray-800 lg:flex","data-placeholder":!0,children:"idle"===m.status?"Find…":"thinking"===m.status?"Thinking…":"Navigating…"},m.status),(0,t.jsx)("span",{className:"hidden size-8 place-content-center pointer-coarse:hidden lg:grid",children:"idle"===m.status?(0,t.jsx)(s.Kbd,{className:"!m-0 animate-partial-fade-in",small:!0,children:"F"}):(0,t.jsx)(l.StopCircle,{className:"animate-partial-fade-in",color:"gray-900"})})]})]})}function m(){let{prompt:e}=(0,o.useFind)();return"thinking"===e.status?(0,t.jsx)("div",{className:"pointer-events-none fixed inset-x-0 top-0 z-[calc(var(--header-zindex)_+_1)] overflow-hidden",style:{height:32},children:(0,t.jsx)("div",{className:"absolute bottom-0 left-1/2 w-full -translate-x-1/2",style:{height:32},children:(0,t.jsx)("div",{className:"absolute inset-0 bg-background-100",style:{mask:"radial-gradient(ellipse at 50% -20%, #000 16%, transparent 72%)"},children:(0,t.jsx)("div",{className:"absolute inset-0 overflow-hidden",children:(0,t.jsx)("div",{className:"pointer-events-none absolute -inset-2.5 overflow-hidden text-white blur-2xl invert transition-opacity duration-500 dark:text-black dark:opacity-70 dark:invert-0",style:{transform:"translate3d(0, 0, 0)","--background-color":"var(--ds-background-200)","--duration":"23s","--gaps":"repeating-linear-gradient(110deg, var(--background-color) 0%, var(--background-color) 7%, transparent 10%, transparent 12%, var(--background-color) 19%)","--lights":"repeating-linear-gradient(110deg, var(--ds-teal-500) 10%, var(--ds-blue-700) 15%, var(--ds-purple-700) 20%, var(--ds-pink-700) 25%, var(--ds-amber-700) 30%)",backgroundImage:"var(--gaps), var(--lights)",backgroundSize:"120%, 200%",backgroundPosition:"50% 50%, 50% 50%"},children:(0,t.jsx)("div",{className:"absolute h-full w-[300%] mix-blend-difference motion-safe:animate-northern-lights",style:{backgroundImage:"var(--gaps), var(--lights)",backgroundSize:"100%, 100%",backgroundPosition:"50% 50%"}})})})})})}):null}},1650839:e=>{"use strict";e.s({SearchMemorySync:()=>N},1650839);var t=e.i(6530772),r=e.i(5535439),a=e.i(3521787),s=e.i(6031903),n=e.i(6649026),i=e.i(3514588),l=e.i(1661537),o=e.i(4651050),c=e.i(6859825),d=e.i(8424492),u=e.i(5649203),p=e.i(5917059);e.i(442955);class m{name;onInit;version;constructor({name:e,init:t,version:r}){this.name=e,this.onInit=t,this.version=r}open(){return"indexedDB"in globalThis?new Promise((e,t)=>{let r=globalThis.indexedDB.open(this.name,this.version);r.addEventListener("upgradeneeded",e=>{let t=e.target;this.onInit(t.result,e)}),r.addEventListener("error",e=>{let r=e.target;t(Error(r.error?.message))}),r.addEventListener("success",t=>{e(t.target.result)})}):Promise.resolve({})}async store(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"readwrite";return(await this.open()).transaction(e,t).objectStore(e)}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((r,a)=>{if("object"==typeof t)return void this.getAll(e,{...t,limit:1}).then(e=>r(e[0]));this.store(e,"readonly").then(e=>{let s=e.get(t);s.addEventListener("success",e=>{r(e.target.result)}),s.addEventListener("error",e=>{let t=e.target;a(Error(t.error?.message))})})})}getKey(e,t){return new Promise((r,a)=>{this.store(e,"readonly").then(e=>{let s=e.index(t.index).getKey(t.query);s.addEventListener("success",e=>{r(e.target.result)}),s.addEventListener("error",e=>{let t=e.target;a(Error(t.error?.message))})})})}getAll(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((r,a)=>{(async()=>{let s,n=await this.store(e,"readonly");t.index&&(n=n.index(t.index)),(s=t.query?n.getAll(t.query,t.limit):n.getAll(null,t.limit)).addEventListener("success",e=>{r(e.target.result)}),s.addEventListener("error",e=>{let t=e.target;a(Error(t.error?.message))})})()})}async iterateOver(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=await this.store(e,"readonly");return r.index&&(a=a.index(r.index)),new Promise((e,s)=>{let n;(n=r.query?a.openCursor(r.query,r.direction):a.openCursor(null,r.direction)).addEventListener("success",async r=>{let a=r.target?.result;if(!a||!1===await t(a.value))return void e();a.continue()}),n.addEventListener("error",e=>{let t=e.target;s(Error(t.error?.message))})})}async take(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=[];return await this.iterateOver(e,e=>r.push(e)!==t.limit,t),r}add(e,t){return new Promise((r,a)=>{this.store(e).then(e=>{let s=e.add(t);s.addEventListener("success",e=>{r(e.target.result)}),s.addEventListener("error",e=>{let t=e.target;a(Error(t.error?.message))})})})}put(e,t){return new Promise((r,a)=>{this.store(e).then(e=>{let s=e.put(t);s.addEventListener("success",e=>{r(e.target.result)}),s.addEventListener("error",e=>{let t=e.target;a(Error(t.error?.message))})})})}async set(e,t){let r=t[(await this.store(e)).keyPath];if(!r)throw Error(`Cannot set an object in store "${e}" without an id`);if(await this.get(e,r))return void await this.put(e,t);await this.add(e,t)}delete(e,t){return new Promise((r,a)=>{this.store(e).then(e=>{let s=e.delete(t);s.addEventListener("success",()=>{r()}),s.addEventListener("error",e=>{let t=e.target;a(Error(t.error?.message))})})})}clear(){return indexedDB.deleteDatabase(this.name)}}let h=(e,t)=>{g(e.createObjectStore(t.name,{keyPath:t.keyPath??"id"}),t.props)},g=(e,t)=>{for(let r of t)e.createIndex(r,r)},f=()=>new m({name:"vcf-frecency",version:1,init:(e,t)=>{t.oldVersion<1&&(h(e,{name:"Routes",props:["route","visits","updatedAt"],keyPath:"route"}),h(e,{name:"Scopes",props:["scope","team","project","visits","updatedAt"],keyPath:"scope"}))}});var x=e.i(225464);let y="requestIdleCallback"in globalThis?requestIdleCallback:setTimeout,v=async(e,t,r)=>{try{let a=f(),s=new Date,n=await a.get("Routes",e);n||(n={route:e,visits:0,updatedAt:s}),++n.visits,n.updatedAt=s,await a.set("Routes",n);let i=r?`${t}/${r}`:t,l=await a.get("Scopes",i);l||(l={scope:i,team:t,project:r,visits:0,updatedAt:s}),++l.visits,l.updatedAt=s,await a.set("Scopes",l)}catch(e){}},j=(e,t)=>{let r=e.reduce((e,t)=>e+t.visits,0),a=new Map;for(let e of t)a.set(e,e.updatedAt.valueOf());let s=e.map(e=>[e,Math.round(3*e.visits/r)]);return s.sort((e,t)=>t[1]-e[1]||(a.get(t[0])||0)-(a.get(e[0])||0)||t[0].visits-e[0].visits),s.map(e=>e[0])},b=async()=>{try{let e=f(),[t,r,a,s]=await Promise.all([e.take("Routes",{index:"visits",direction:"prev",limit:10}),e.take("Routes",{index:"updatedAt",direction:"prev",limit:10}),e.take("Scopes",{index:"visits",direction:"prev",limit:10}),e.take("Scopes",{index:"updatedAt",direction:"prev",limit:10})]),n=j(t,r).map(e=>e.route),i=j(a,s).map(e=>e.scope);return{routes:n,scopes:i}}catch(e){return{routes:[],scopes:[]}}},w=e=>{switch(e){case"teamSlug":return 0;case"project":return 1;default:return 2}};function N(){let{memoryRef:e,refresh:m}=(0,d.useFind)(),h=(0,r.useParams)(),g=h?.teamSlug;(0,t.useEffect)(()=>{if(!g)return;let t=e.current;t.mfe.clear(),(async()=>{let e=await (0,s.fetchApi)(`/api/v2/dashboard/projects${(0,n.encode)({favorites:1,teamId:g,limit:25})}`,{throwOnHTTPError:!1});if(e&&"object"==typeof e){for(let r of e.projects||[])(0,p.addProject)(t,r),t.projectWeights.set(r.id,1.01);for(let r of e.favorites||[])t.inferred.project||(t.inferred.project=r.name),(0,p.addProject)(t,r),t.projectWeights.set(r.id,1.1);t.inferred.project||(t.inferred.project=e.projects?.[0]?.name),m()}})()},[e,m,g]);let f=(0,t.useCallback)(async()=>{e.current.frecency=await b()},[e]);(0,t.useEffect)(()=>void f(),[f]);let j=(e=>{let r=(0,t.useRef)(e);r.current=e;let a=(0,t.useRef)(void 0),s=(0,t.useRef)(0);return(0,t.useCallback)(function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(clearTimeout(s.current),!(e=>{if(!(e in x.Routes)||e.startsWith("/[teamSlug]/~/account"))return!1;let t=new Set(Array.from(e.matchAll(/\[(?<param>.*?)\]/g)).map(e=>e[1]));if(!t.size)return!1;for(let e of t)if("teamSlug"!==e&&"project"!==e)return!1;return!0})(t[0])){let e=a.current;if(!e)return;a.current=void 0,y(()=>{v(...e).then(()=>r.current?.())});return}a.current=t,s.current=setTimeout(()=>{v(...t).then(()=>r.current?.()),a.current=void 0},3e4)},[])})(f),N=(0,r.usePathname)(),k=(0,r.useSearchParams)();(0,t.useEffect)(()=>{if(!N||!h)return;let t=N;for(let[e,r]of Array.from(Object.entries(h)).sort((e,t)=>w(e[0])-w(t[0])))t=t.replace(r,`[${e}]`);let r="/"!==e.current.href&&e.current.route!==t;e.current.route=t,e.current.href=`${location.pathname}${location.search}${location.hash}`;let a=u.RouteFilters[t];a&&k?e.current.filters=a.decode(Object.fromEntries(k.entries())):e.current.filters={},m(),r&&j(t,h.teamSlug,h.project||null)},[N,h,k,e,m,j]);let S=(0,i.useSortedTeams)();(0,t.useEffect)(()=>{for(let t of S){let r=e.current;r.teams.set(t.slug,t),r.teamIds.set(t.id,t.slug)}m()},[e,m,S]);let A=function(e){let{data:r}=(0,a.default)(e?(0,l.swrRequest)(`/api/recents${(0,n.encode)({type:"preview",teamId:e,hydrateLimit:30,limit:7})}`):"",async e=>{if(!e)return[];let t=await (0,s.fetchApi)(e);return"object"==typeof t&&t?t.filter(e=>e.payload.items.length>0):[]},{revalidateIfStale:!1,revalidateOnFocus:!0});return(0,t.useMemo)(()=>r||[],[r])}(g);(0,t.useEffect)(()=>{let t=e.current;for(let e of(t.recentPreviews.splice(0),A)){let r=e.payload.items,a=r[0];if(!a)continue;let s=(0,c.getGitMeta)(a.deployment.meta),n={branch:s?.branchName||"",commit:s?.commitMessage||"",pr:a.prMetadata,previews:[]};for(let e of(t.recentPreviews.push(n),r)){if(e!==a&&"CANCELED"===e.deployment.readyState)continue;let r=e.deployment.id.replace("dpl_","");n.previews.push({project:e.project.name,deployment:r}),t.deployments.set(r,e.deployment),t.projects.has(e.project.name)||(0,p.addProject)(t,e.project);let s={projectId:e.project.id,project:e.project.name,branch:n.branch,deployment:r};t.activeBranches.set(`${e.project.id}_${n.branch}`,s)}}},[e,m,A]);let{data:E}=(0,o.useMicrofrontendsGroups)();return(0,t.useEffect)(()=>{if(!E)return;let t=e.current,r=t.params.team;if(r){for(let{group:e,projects:a}of E.groups)for(let s of(t.mfe.set(e.name,a.map(e=>e.name)),a))t.projects.set(s.id,{owner:r,name:s.name});m()}},[e,m,E]),(0,t.useEffect)(()=>{if(!h)return;let t=e.current;t.params.team=h.teamSlug,t.params.project=h.project,t.params.id=h.id,t.inferred.team=h.teamSlug,h.project&&(t.inferred.project=h.project),m()},[e,h,m]),null}},8252013:e=>{"use strict";e.s({InvestigationsMenu:()=>ec},8252013);var t=e.i(6645307),r=e.i(5610210),a=e.i(5674541),s=e.i(653558),n=e.i(2733203),i=e.i(1190215),l=e.i(4105925),o=e.i(3821772),c=e.i(1009688),d=e.i(5528554),u=e.i(8679640),p=e.i(7343647);function m(e){let{active:r}=e;return(0,t.jsx)("div",{className:"absolute -inset-px animate-spin rounded-full p-px",style:{background:r?"conic-gradient(from 0deg, transparent, transparent 240deg, var(--ds-blue-600))":void 0,animationDuration:"2500ms"},children:(0,t.jsx)("div",{className:"size-full rounded-full bg-background-100"})})}function h(){return(0,t.jsx)("div",{className:"pointer-events-none absolute z-0 translate-x-[-87.5%] opacity-50",children:(0,t.jsxs)("div",{className:"relative z-0 size-16",children:[(0,t.jsx)("div",{className:"absolute size-12 -translate-x-1/2 -translate-y-1/2 animate-[northern-lights-float_6s_ease-in-out_infinite]",style:{background:"radial-gradient(circle at 40% 40%, var(--ds-amber-400), var(--ds-amber-600) 50%, transparent 70%)"}}),(0,t.jsx)("div",{className:"absolute size-14 -translate-x-1/2 -translate-y-1/2 animate-[northern-lights-float_7s_ease-in-out_infinite]",style:{background:"radial-gradient(circle at 60% 40%, var(--ds-pink-500), var(--ds-pink-700) 50%, transparent 70%)"}}),(0,t.jsx)("div",{className:"absolute size-10 -translate-x-1/2 -translate-y-1/2 animate-[northern-lights-float_5.5s_ease-in-out_infinite]",style:{background:"radial-gradient(circle at 50% 60%, var(--ds-purple-200), var(--ds-purple-400) 50%, transparent 70%)"}})]})})}var g=e.i(6530772),f=e.i(9491348),x=e.i(4910081),y=e.i(5175803),v=e.i(3979315),j=e.i(8252206),b=e.i(9443759),w=e.i(4586940),N=e.i(8551999),k=e.i(1863837),S=e.i(400453),A=e.i(8880357),E=e.i(5163670),I=e.i(8084653);function C(e){let{widget:r}=e,a=(0,g.useRef)(null),s=(0,A.useIntersectionObserver)(a,{threshold:.1,freezeOnceVisible:!0});return(0,t.jsxs)("div",{className:"flex flex-col gap-2",ref:a,children:[(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsx)(I.Text,{className:"break-all",variant:"heading-16",children:r.title})}),s?.isIntersecting?(0,t.jsx)(S.ResultsChart,{hideTableSearch:!0,horizontal:!0,query:r.query,chartHeight:200}):(0,t.jsx)(E.Skeleton,{height:200,style:{width:"100%"}})]})}let L=(0,e.i(6895406).withNewIcon)('<path fill="currentColor" d="M5.5 12.5a2 2 0 1 0-4 0 2 2 0 0 0 4 0Zm9 0a2 2 0 1 0-4 0 2 2 0 0 0 4 0ZM4.145 0l.133.054L7.894 1.5h.212L11.722.054 11.855 0h1.335l.5 6H16v1.5H0V6h2.31l.5-6h1.335Zm4.383 2.946L8.395 3h-.79l-.133-.054L4.179 1.63 3.814 6h8.372l-.366-4.371-3.292 1.317ZM16 12.5a3.5 3.5 0 1 1-7 0 .713.713 0 0 0-.713-.713h-.574A.713.713 0 0 0 7 12.5a3.5 3.5 0 1 1-.521-1.838 2.205 2.205 0 0 1 1.234-.375h.574c.457 0 .881.138 1.234.375A3.5 3.5 0 0 1 16 12.5Z"/>');var T=e.i(4965453),P=e.i(1268665);function R(e){let{widget:r}=e;return r.searches.findLast(e=>"analysis-completed"!==e.state),(0,t.jsx)(T.Root,{className:"group border-b border-gray-alpha-200 bg-background-100 px-8 py-2.5",type:"single",collapsible:!0,children:(0,t.jsxs)(T.Item,{value:"summary",children:[(0,t.jsx)(T.Trigger,{className:(0,b.cn)("group flex w-full items-center justify-between bg-transparent transition-transform ease-in-out px-0",{"pointer-events-none":0===r.searches.length}),children:(0,t.jsxs)("div",{className:"text-label-14 flex items-center gap-3 tabular-nums",children:[(0,t.jsx)(L,{color:"gray-900",size:16}),0===r.searches.length?(0,t.jsx)("span",{className:"text-label-14 flex items-center gap-2 text-gray-800 group-data-[state=open]:hidden",children:"Starting investigation..."}):(0,t.jsxs)("div",{children:["Investigated"," ",(0,t.jsxs)("span",{className:"font-medium",children:[r.searches.length," chart",1===r.searches.length?"":"s"]})," ",void 0!==r.startTime?(0,t.jsxs)(t.Fragment,{children:["in"," ",(0,t.jsx)(q,{startTime:r.startTime,endTime:r.endTime})]}):null]})]})}),(0,t.jsx)(T.Content,{children:(0,t.jsx)("ol",{className:"mt-4 space-y-2",children:r.searches.map(e=>(0,t.jsxs)("li",{className:"text-label-14 flex list-none flex-row items-center gap-3 px-1.5",children:["analysis-completed"===e.state?(0,t.jsx)(d.CheckCircleFill,{}):(0,t.jsx)("span",{className:"flex size-4 items-center",children:(0,t.jsx)(P.LoadingDots,{size:3})}),(0,t.jsx)("p",{children:e.summary})]},e.summary))})})]})})}function q(e){let{startTime:r,endTime:a}=e,[s,n]=(0,g.useState)(a||Date.now());return(0,g.useEffect)(()=>{if(a)return;let e=setInterval(()=>n(Date.now()),500);return()=>clearInterval(e)},[a]),(0,t.jsxs)("span",{children:[Math.floor((s-r)/1e3)," seconds"]})}var z=e.i(3921802),M=e.i(2362802),$=e.i(7916122),F=e.i(8483852),D=e.i(4480965),B=e.i(8079677),O=e.i(1238354),_=e.i(6753602),W=e.i(6168641);function K(e){let{widget:r}=e;return(0,t.jsxs)("div",{className:"flex gap-8 border-y border-gray-200 bg-background-200 px-8 py-4",children:[(0,t.jsx)("div",{className:"text-label-13 grow",children:(0,t.jsxs)("div",{className:"flex w-full max-w-lg flex-col gap-4",children:[r.thinkingMarkdown?(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-heading-14 flex flex-col gap-1",children:"Thinking"}),(0,t.jsx)(W.default,{className:"prose prose-sm max-w-none dark:prose-invert",children:r.thinkingMarkdown})]}):null,(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-heading-14 flex flex-col gap-1",children:"Investigation Summary"}),r.summary?(0,t.jsx)("p",{children:r.summary}):(0,t.jsx)(E.Skeleton,{className:"h-4 w-32"})]}),r.affectedResources.length>0?(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("p",{className:"text-heading-14",children:"Affected Resources"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:r.affectedResources.map(e=>(0,t.jsx)(V,{value:e},e.value))})]}):null]})}),r.recommendedAction?(0,t.jsxs)("div",{className:"flex max-h-[300px] min-h-[150px] w-[300px] flex-col gap-2.5 rounded border border-gray-200 bg-background-100 px-4 py-5",children:[(0,t.jsx)("p",{className:"text-heading-14",children:"Recommended Action"}),(0,t.jsxs)("div",{className:"grow space-y-3",children:[(0,t.jsxs)("p",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-label-12 text-gray-900",children:"Firewall Rule"}),(0,t.jsx)(z.Badge,{size:"sm",variant:"red-subtle",capitalize:!0,children:r.recommendedAction.rule.resource})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,t.jsx)(D.WindowGlobe,{color:"gray-900"}),(0,t.jsxs)("p",{children:[(0,t.jsx)("span",{className:"font-medium",children:"IP Address"})," equals"," ",(0,t.jsx)("span",{className:"font-medium",children:1===r.recommendedAction.value.length?r.recommendedAction.value[0]:`${r.recommendedAction.value.length} IP Addresses`})]})]})]}),r.recommendedAction.firewallRuleUrl?(0,t.jsx)(M.ButtonLink,{prefix:(0,t.jsx)(F.Shield,{color:"gray-100"}),href:r.recommendedAction.firewallRuleUrl,children:"Enable Firewall Rule"}):null]}):null]})}function U(e){let{value:r}=e;return(0,t.jsx)("div",{className:"inline-flex size-4 items-center justify-center rounded-full bg-gray-300 font-mono text-[11px] font-medium text-gray-800",children:r})}function V(e){let{value:r,referenceNumber:s}=e,n=(0,O.useSlugScope)(r.scope),i=_.AllDimensions[r.dimension]?.label;return(0,t.jsxs)("div",{className:"inline-flex items-center justify-between rounded border border-gray-200 bg-background-100 p-2",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,t.jsxs)("p",{className:"text-gray-800",children:[i," ",void 0!==s?(0,t.jsx)(U,{value:s}):null]}),(0,t.jsx)(H,{transparent:!0,children:r.value})]}),(0,t.jsx)(a.Button,{svgOnly:!0,"aria-label":"Investigate Affected Resources",size:"small",type:"secondary",className:"ml-4 !shadow-none",href:n?(0,B.computeResourceLink)(n,r):void 0,children:(0,t.jsx)($.ChevronRight,{})})]})}function H(e){let{children:r,subtle:a,transparent:s}=e;return(0,t.jsx)("div",{className:(0,b.cn)("my-px inline-flex min-h-4 min-w-4 items-center justify-center gap-1.5 rounded font-mono font-medium",{"text-gray-800":a,"bg-gray-300 px-1 py-0.5":!s}),children:r})}var Z=e.i(2273091),G=e.i(8279544),X=e.i(8185977),Q=e.i(2238549);function Y(e){let{query:r,result:a,height:s,rollup:n,shareTitle:i}=e,l=(0,k.getRollup)(r,n)??{name:"value",measure:"count",aggregation:"sum"},o=(0,G.labelForMeasure)(r.event,l.measure),c=(0,N.getFormatter)(l.aggregation,_.AllMeasures[l.measure].unit),d=(0,g.useMemo)(()=>0===r.groupBy.length?{singleCategoryName:o,rollupName:l.name}:1===r.groupBy.length?{category:r.groupBy[0]}:{category:e=>r.groupBy.map(t=>e[t]).join(", ")},[r.groupBy,o,l.name]),u=(0,X.useTimeseriesData)(a,d);return(0,t.jsx)("div",{className:"w-full",children:(0,t.jsx)(E.Skeleton,{show:void 0===a,children:(0,t.jsx)(Q.ShareDomCopy,{title:i??o,children:(0,t.jsx)("div",{style:{height:s??"230px"},children:(0,t.jsx)(Z.LineChart,{data:u??[],disableLegend:!0,disableZoom:!0,emptyState:"No data in this time range",formatValue:c,maxLines:J,title:null,xTickCount:5})})})})})}let J=25;var ee=e.i(4237550);function et(e){let{widget:r}=e;return(0,t.jsx)(T.Root,{type:"single",collapsible:!0,className:"flex flex-col bg-background-200",value:r.collapsed?void 0:"item-1",children:(0,t.jsxs)(T.Item,{value:"item-1",children:[(0,t.jsxs)(T.Trigger,{className:"group text-label-14 sticky top-0 z-50 flex w-full list-none flex-row items-center justify-between gap-3 bg-background-200 px-8 py-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:["analysis-completed"===r.state?(0,t.jsx)(d.CheckCircleFill,{}):(0,t.jsx)("span",{className:"flex size-4 items-center",children:(0,t.jsx)(P.LoadingDots,{size:3})}),(0,t.jsx)("p",{children:r.tagline})]}),(0,t.jsx)(ee.ChevronDown,{className:"transition-transform ease-in-out group-data-[state='open']:-rotate-180"})]}),(0,t.jsx)(T.Content,{className:"overflow-y-clip data-[state=closed]:animate-content-close data-[state=open]:animate-content-open",children:(0,t.jsxs)("div",{className:"flex flex-row gap-8 px-8 py-2 pb-4",children:[void 0!==r.query?(0,t.jsx)("div",{className:"grow self-start rounded-md border border-gray-200 p-2 min-w-24",children:(0,t.jsx)(Y,{query:r.query,result:r.result,height:200})}):null,(0,t.jsx)(W.default,{className:"prose prose-sm max-h-[400px] w-[60ch] overflow-y-auto dark:prose-invert",children:r.analysis??""})]})})]})})}function er(e){let{widget:r}=e;switch(r.type){case"query-visualization":return(0,t.jsx)(C,{widget:r});case"investigation-steps":return(0,t.jsx)(R,{widget:r});case"investigation-digest":return(0,t.jsx)(K,{widget:r});case"analyzed-query":return(0,t.jsx)(et,{widget:r});default:return null}}var ea=e.i(7153877);let es=e=>!!(e.activeSheet&&e.investigations.has(e.activeSheet)),en=e=>e.activeSheet&&e.investigations.has(e.activeSheet)?e.investigations.get(e.activeSheet)??null:null;function ei(){let e=(0,ea.useAIInvestigationsStore)(es),r=(0,ea.useAIInvestigationsStore)(en),s=(0,ea.useAIInvestigationsStore)(e=>e.closeSheet),{getChatMessages:n,getChatStatus:i}=(0,f.useAIInvestigations)(),l=(0,g.useMemo)(()=>(function(e){let t,r,a,s,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"complete",i=e.filter(e=>"assistant"===e.role),l=[],o=[],c=[],d=[],u=0;for(let e of i)for(let i of e.parts){let e=function(e){if("tool-query"===e.type||"tool-queryFirewallTraffic"===e.type){let t=e.output;return{result:void 0===t?void 0:(0,k.fromApiSonarResult)(t),query:e.output?.query,tagline:e.input?.tagline}}if("data-query-results"===e.type){let t=e.data.results;return{result:void 0===t?void 0:(0,k.fromApiSonarResult)(t),query:e.data?.query,tagline:e.data?.tagline}}}(i);if(e&&(l.push({type:"analyzed-query",id:`widget-${u++}`,query:e.query,result:e.result,tagline:e.tagline,state:"analysis-started",collapsed:!1}),e.query&&o.push({type:"query-visualization",id:`widget-${u++}`,query:(0,N.fromSonarQuery)(e.query),title:e.tagline??""}),c.push({summary:e.tagline??"",state:"streaming"===n?"analysis-started":"analysis-completed"})),"data-start-time"===i.type&&(r=i.data.startTime),"data-end-time"===i.type&&(a=i.data.endTime),"data-query-summary"===i.type&&(c.length>0&&(c[c.length-1].state="analysis-completed"),c.push({summary:i.data.summary,state:"streaming"===n?"analysis-started":"analysis-completed"})),"data-related-resource"===i.type&&d.push(i.data),"data-summary"===i.type&&(t=i.data.summary),"data-rule-recommendation"===i.type&&(s=i.data),"text"===i.type){let e=l[l.length-1];"analyzed-query"===e.type&&void 0===e.analysis&&(e.analysis=i.text)}}let p=void 0!==t||d.length>0||void 0!==s;p&&(l.push({type:"investigation-digest",id:"widget-investigation-digest",summary:t,affectedResources:d,recommendedAction:s}),l.push(...o)),l.unshift({id:"widget-investigation-steps",type:"investigation-steps",startTime:r,endTime:a,searches:c});let m=l.findLastIndex(e=>"analyzed-query"===e.type&&(void 0!==e.query||void 0!==e.analysis));for(let e=0;e<l.length;e++){let t=l[e];"analyzed-query"===t.type&&(e<m||p)&&(t.collapsed=!0)}let h=l.findLastIndex(e=>"analyzed-query"===e.type);for(let e=0;e<l.length;e++){let t=l[e];"analyzed-query"===t.type&&(e<h||p)&&(t.state="analysis-completed")}return{widgets:l,messages:e,status:n}})(n(r?.chatId??""),"ready"===i(r?.chatId??"")?"complete":"streaming"),[n,i,r]),[o,c]=(0,g.useMemo)(()=>{let e=[],t=[];return l.widgets.forEach(r=>{"investigation-digest"===r.type||"investigation-steps"===r.type||"analyzed-query"===r.type?e.push(r):t.push(r)}),[e,t]},[l]);return r?(0,t.jsx)(x.Sheet,{open:e,children:(0,t.jsx)(x.SheetContent,{className:(0,b.cn)("m-3 h-[calc(100%-1.5rem)] w-[calc(100%-1.5rem)] overflow-y-auto rounded-[1rem] bg-white p-0 lg:w-2/3 sm:max-w-[auto]"),side:"right",children:(0,t.jsxs)("main",{className:"flex h-full shrink-0 grow-0 flex-col",children:[(0,t.jsxs)("header",{className:"sticky top-0 z-50 bg-background-100 pt-7",children:[(0,t.jsxs)("section",{className:"flex items-center justify-between px-8",children:[(0,t.jsx)("p",{className:"text-heading-24",children:r.title}),(0,t.jsx)("div",{children:(0,t.jsx)(a.Button,{svgOnly:!0,"aria-label":"dismiss notebook",shape:"circle",size:"tiny",onClick:()=>s(),className:"!border-0 !bg-transparent",children:(0,t.jsx)(v.Cross,{color:"gray-1000"})})})]}),(0,t.jsxs)("div",{className:"text-label-14 flex items-center justify-start gap-0 border-b border-gray-200 px-8 pb-12",children:[(0,t.jsx)("span",{children:(0,w.getWorkflowContext)(r.workflow)}),(0,t.jsx)(j.SlashForward,{color:"gray-700"}),(0,t.jsx)("span",{children:(0,w.getInvestigationTimeRange)({startTime:r.input.startTime,endTime:r.input.endTime})}),(0,t.jsx)(j.SlashForward,{color:"gray-700"}),(0,t.jsx)("span",{children:(0,w.formatInvestigationDateRange)(r.input.startTime,r.input.endTime)}),(0,t.jsx)(j.SlashForward,{color:"gray-700"}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:["Triggered by"," ",(0,t.jsx)(y.Avatar,{size:16,uid:r.createdBy.uid,title:r.createdBy.username}),r.createdBy.username]})]}),o.map(e=>(0,t.jsx)("div",{children:(0,t.jsx)(er,{widget:e})},e.id))]}),(0,t.jsx)("div",{className:"grow bg-background-200",children:c.map(e=>(0,t.jsx)("div",{className:"px-8 py-4",children:(0,t.jsx)(er,{widget:e})},e.id))})]})})}):null}let el=e=>e.investigations.some(e=>e.isInProgress),eo=e=>e.investigations.some(e=>e.isUnread);function ec(){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ed,{}),(0,t.jsx)(ei,{})]})}function ed(){let e=(0,ea.useAIInvestigationsStore)(e=>e.updateInvestigation),g=(0,ea.useAIInvestigationsStore)(e=>e.openSheet),f=(0,ea.useAIInvestigationsStore)(e=>e.investigations),x=(0,ea.useAIInvestigationsStore)(eo),y=(0,ea.useAIInvestigationsStore)(el);return(0,t.jsxs)(i.MenuContainer,{onClose:()=>{if(x)for(let[t]of f.filter(e=>e.isUnread))e(t,{isUnread:!1})},children:[(0,t.jsxs)(n.MenuButton,{svgOnly:!0,"aria-label":"open investigations",shape:"circle",size:"small",type:"secondary",className:(0,r.clsx)("relative",{"animate-[northern-lights-undulate_ease-in-out_infinite]":x&&!y}),style:{animationDuration:"3000ms"},children:[(0,t.jsx)(m,{active:y}),(0,t.jsx)("div",{className:"relative z-10 flex h-full items-center",children:(0,t.jsx)(L,{color:"gray-1000"})})]}),(0,t.jsxs)(s.Menu,{width:300,style:{"--geist-space-gap-quarter":0},children:[(0,t.jsxs)("header",{className:"flex items-center justify-between px-4 py-2",children:[(0,t.jsx)("p",{className:"text-label-14 m-0 font-medium",children:"Agent Tasks"}),(0,t.jsx)(a.Button,{svgOnly:!0,"aria-label":"archive tasks",shape:"circle",size:"small",type:"tertiary",children:(0,t.jsx)(c.Archive,{color:"gray-800"})})]}),f.size?f.collect(e=>(0,t.jsxs)(l.MenuItem,{innerMenuItemClassName:"flex h-auto gap-3 px-4 py-3 items-center  bg-transparent border-0 border-t border-solid border-gray-300 !rounded-none hover:bg-gray-alpha-100 overflow-hidden relative",onClick:()=>g(e.id),children:[e.isUnread?(0,t.jsx)(h,{}):null,e.isInProgress?(0,t.jsx)(o.Spinner,{color:"var(--ds-gray-900)"}):(0,t.jsx)(d.CheckCircleFill,{color:"gray-900"}),(0,t.jsxs)("section",{className:"flex grow flex-col  *:m-0",children:[(0,t.jsx)("p",{className:"text-label-14 !h-auto font-medium",children:e.title}),(0,t.jsxs)("div",{className:"text-label-14 flex items-center gap-0.5  text-gray-800",children:[(0,t.jsxs)("p",{className:"m-0",children:[e.isInProgress?"Active for":"Finished ·"," "]}),(0,t.jsx)(p.TimeAgo,{date:e.createdAt})]})]}),(0,t.jsx)(u.ChevronRightSmall,{color:"gray-900"})]},e.id)):(0,t.jsx)("div",{className:"grid h-28 place-items-center",children:(0,t.jsx)("p",{className:"text-copy-13 text-gray-700",children:"No active tasks"})})]})]})}}}]);

//# sourceMappingURL=9ce4aa11188eee1d.js.map
//# debugId=52b9f358-5d57-5517-bf9d-7fc36a588ab5
