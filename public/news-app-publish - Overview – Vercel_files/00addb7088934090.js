
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="ba7b534e-d5ce-5fdf-834d-aae91ae229ca")}catch(e){}}();
(globalThis.TURBOPACK=globalThis.TURBOPACK||[]).push(["object"==typeof document?document.currentScript:void 0,{6454972:e=>{e.v({header:"leave-modal-module__I3nMuG__header"})},8373995:e=>{e.v({accessGroupEntity:"project-members-table-module__O6bDqq__accessGroupEntity",memberEntity:"project-members-table-module__O6bDqq__memberEntity",summaryEntity:"project-members-table-module__O6bDqq__summaryEntity"})},6316524:e=>{e.v({empty:"access-module__63i2AW__empty"})},3730629:e=>{"use strict";e.s({default:()=>eP},3730629);var s=e.i(6645307),t=e.i(674684),i=e.i(8811733),r=e.i(889716),a=e.i(8084653),l=e.i(2362802),n=e.i(1985209),o=e.i(3514588),c=e.i(9959972),d=e.i(557317),m=e.i(6530772),u=e.i(3713927),h=e.i(8418504),j=e.i(5175803),x=e.i(7230222),p=e.i(5674541),g=e.i(8247297),b=e.i(9185154),y=e.i(4105925),f=e.i(6921100),v=e.i(5163670),S=e.i(555528),M=e.i(584439),C=e.i(7315479),T=e.i(6937468),w=e.i(6649026),E=e.i(1183506),A=e.i(9336536),P=e.i(3585235),R=e.i(5785123),k=e.i(4162978),N=e.i(6216539),I=e.i(4663960),L=e.i(2075095),O=e.i(7337588),_=e.i(2145411),z=e.i(3604170),G=e.i(9773896),D=e.i(9215445),B=e.i(980475),$=e.i(2240289),U=e.i(2013047),V=e.i(7057043),F=e.i(5599793),H=e.i(896448),q=e.i(6420096);let J=(0,e.i(6895406).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M5.75 0C3.95507 0 2.5 1.45507 2.5 3.25V3.75C2.5 5.54493 3.95507 7 5.75 7H6.25C8.04493 7 9.5 5.54493 9.5 3.75V3.25C9.5 1.45507 8.04493 0 6.25 0H5.75ZM4 3.25C4 2.2835 4.7835 1.5 5.75 1.5H6.25C7.2165 1.5 8 2.2835 8 3.25V3.75C8 4.7165 7.2165 5.5 6.25 5.5H5.75C4.7835 5.5 4 4.7165 4 3.75V3.25ZM10.5 5.75H15.5V7.25H10.5V5.75ZM1.5 13.1709V14.5H10.5V13.1709C9.68042 11.5377 8.00692 10.5 6.17055 10.5H5.82945C3.99308 10.5 2.31958 11.5377 1.5 13.1709ZM0.0690305 12.6857C1.10604 10.4388 3.35483 9 5.82945 9H6.17055C8.64517 9 10.894 10.4388 11.931 12.6857L12 12.8353V13V15.25V16H11.25H0.75H0V15.25V13V12.8353L0.0690305 12.6857Z" fill="currentColor"/>');var Z=e.i(6465700),W=e.i(5454140),Y=e.i(1933128),X=e.i(2165676);function K(){return(0,s.jsxs)(s.Fragment,{children:["Additional permissions are required to manage Project Members."," ",(0,s.jsx)(l.Link,{href:"/docs/accounts/team-members-and-roles",variant:"highlight",children:"Learn More â†’"})]})}var Q=e.i(1917237),ee=e.i(8934201),es=e.i(6454972);function et(e){let{active:r,setActive:l}=e,n=(0,t.useRouter)(),{user:c}=(0,W.useUser)(),{team:d}=(0,o.useTeam)(),u=(0,M.useToasts)(),[h,j]=(0,m.useState)(!1),[x,p]=(0,m.useState)(null),{project:g}=n.query,{data:b}=(0,$.useProject)(g),[{mutate:y}]=(0,B.useProjectMembersInfinite)(),f=()=>{l(!1)};return(0,s.jsxs)(ee.Modal.Modal,{active:r,onAnimationDone:()=>{p(null)},onClickOutside:f,width:"500px",children:[(0,s.jsxs)(ee.Modal.Body,{children:[(0,s.jsxs)("header",{className:es.default.header,children:[(0,s.jsx)(a.Text,{as:"h2",size:16,children:"Remove Project Member"}),(0,s.jsxs)(a.Text,{as:"p",children:["You are about to remove yourself from the project"," ",(0,s.jsx)("b",{children:b?.name}),"."]}),(0,s.jsx)(a.Text,{as:"p",children:"Are you sure you want to continue?"})]}),x?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.Spacer,{y:.5}),(0,s.jsx)(Q.Error,{error:x})]}):null]}),(0,s.jsxs)(ee.Modal.Actions,{children:[(0,s.jsx)(ee.Modal.Action,{onClick:f,type:"secondary",children:"Cancel"}),(0,s.jsx)(ee.Modal.Action,{loading:h,onClick:async()=>{if(d&&c&&b){j(!0);try{await (0,E.fetchAPI)(`${(0,A.API_PROJECTS_MEMBERS)(b.id)}/${c.uid}${(0,w.encode)({teamId:d.id})}`,{throwOnHTTPError:!0,method:"DELETE"}),await y(),u.success("You have successfully removed yourself from the Project."),j(!1),l(!1),n.push(`/${d.slug}`)}catch(e){p((0,C.normalizeError)(e)),j(!1)}}},children:"Confirm"})]})]})}var ei=e.i(8373995);function er(e){let{projectMember:t,teamMember:i,selected:l,setSelected:n,remove:o,onManageTeamAccess:c,onManageProjectAccess:d,canUpdateProjectMember:u,canDeleteProjectMember:h,project:x}=e,{user:b}=(0,W.useUser)(),f=(0,k.usePlaceholder)(),v=t.uid===b?.uid,M=t.name||t.username||"",[C,T]=(0,m.useState)(!1);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(O.Entity,{checkbox:(0,s.jsx)(S.Tooltip,{delayTime:300,disableTriggers:h,position:"bottom",text:(0,s.jsx)(K,{}),children:(0,s.jsx)(g.Checkbox,{checked:!!l[t.uid||""],disabled:!h,onChange:()=>n(e=>{if(!t.uid)return e;let s={...e};return s[t.uid]?delete s[t.uid]:s[t.uid]=!0,s})})}),className:ei.default.memberEntity,disabledDotMenuTooltip:(0,s.jsx)(K,{}),isDotMenuDisabled:!h,menuItems:(0,s.jsxs)(s.Fragment,{children:[v?null:(0,s.jsx)(S.Tooltip,{disableTriggers:h,position:"bottom",style:{display:"inline-flex"},text:(0,s.jsx)(K,{}),children:(0,s.jsx)(y.MenuItem,{disabled:!u,onClick:()=>c(),children:(0,s.jsxs)(r.Stack,{align:"center",direction:"row",gap:2,paddingX:1,children:[(0,s.jsx)(q.UserSettings,{}),"Manage Team Member"]})})}),(0,s.jsx)(S.Tooltip,{disableTriggers:h,position:"bottom",style:{display:"inline-flex"},text:(0,s.jsx)(K,{}),children:v?(0,s.jsx)(y.MenuItem,{disabled:!h,onClick:()=>T(!0),type:"error",children:(0,s.jsxs)(r.Stack,{align:"center",direction:"row",gap:2,paddingX:1,children:[(0,s.jsx)(J,{}),"Remove Project Access"]})}):(0,s.jsx)(y.MenuItem,{disabled:!h,onClick:()=>o([t]),type:"error",children:(0,s.jsxs)(r.Stack,{align:"center",direction:"row",gap:2,paddingX:1,children:[(0,s.jsx)(J,{}),"Remove Project Access"]})})})]}),placeholder:f,thumbnail:(0,s.jsx)(z.EntityThumbnail,{size:32,children:(0,s.jsx)(j.Avatar,{size:32,username:t.username})}),children:[(0,s.jsx)(_.EntityField,{description:t.email,title:(0,s.jsx)("span",{className:"geist-inline-center",children:(0,s.jsx)("span",{className:"geist-ellipsis",children:M})})}),(0,s.jsxs)("div",{className:"flex flex-col items-start gap-4 pt-4 md:flex-row md:items-center md:pt-0",children:[(0,s.jsxs)("div",{className:"flex flex-1 items-center gap-1",children:[i?(0,s.jsx)(X.ProjectAccessBadges,{config:{expanded:!0},projectAccess:{accessGroups:i.accessGroups}}):null,(0,s.jsxs)(S.Tooltip,{text:(0,s.jsx)("div",{className:"tailwind-preflight",children:(0,s.jsxs)("div",{className:"flex flex-col gap-1 text-left",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(a.Text,{weight:600,children:"Role"}),ea[t.computedProjectRole]]}),t.computedProjectRole!==t.role&&(0,s.jsxs)("div",{children:[(0,s.jsx)(a.Text,{weight:600,children:"Directly Assigned"}),(0,s.jsx)(a.Text,{children:ea[t.role]})]})]})}),children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(Y.ProjectAvatar,{project:x,size:16}),(0,s.jsx)(a.Text,{color:"gray-900",children:ea[t.computedProjectRole]})]}),(0,s.jsx)(Z.InformationFillSmall,{color:"gray-900",size:16})]})]}),(0,s.jsx)(p.Button,{onClick:d,size:"small",type:"secondary",children:"Manage Access"})]})]}),(0,s.jsx)(et,{active:C,setActive:T})]})}let ea={PROJECT_VIEWER:"Viewer",PROJECT_DEVELOPER:"Developer",ADMIN:"Admin"};var el=e.i(2254575),en=e.i(8981169);function eo(e){let{active:r,setActive:a,members:l,onRemoved:n}=e,[c,d]=(0,m.useState)(null),[u,h]=(0,m.useState)(!1),x=(0,M.useToasts)(),{project:p}=(0,t.useRouter)().query,{data:g}=(0,$.useProject)(p),[{mutate:b}]=(0,B.useProjectMembersInfinite)(),{team:y}=(0,o.useTeam)();async function f(){if(g){h(!0);try{await (0,E.fetchAPI)(`${(0,A.API_PROJECTS_MEMBERS)(g.id)}/batch${(0,w.encode)({teamId:y?.id})}`,{method:"DELETE",body:{members:l.map(e=>e.uid)},throwOnHTTPError:!0}),await b(),x.success(`Removed ${(0,T.pluralize)("user",l.length)} from the Project successfully.`),a(!1),n?.()}catch(e){d((0,C.normalizeError)(e))}h(!1)}}return(0,s.jsxs)(ee.Modal.Modal,{active:r,onAnimationDone:()=>{h(!1),d(null)},onClickOutside:()=>a(!1),children:[(0,s.jsxs)(ee.Modal.Body,{children:[(0,s.jsxs)(ee.Modal.Title,{children:["Remove Project Member",l.length>1?"s":""]}),(0,s.jsx)(i.Spacer,{y:.5}),(0,s.jsxs)(ee.Modal.Subtitle,{children:["You are about to remove the following Project Member",l.length>1?"s":"",".",(0,s.jsx)(i.Spacer,{y:.5}),"Are you sure you want to continue?"]}),(0,s.jsx)(i.Spacer,{}),(0,s.jsx)(el.Entity.List,{children:l.map(e=>(0,s.jsx)(el.Entity,{left:(0,s.jsx)(j.Avatar,{size:32,username:e.username}),right:(0,s.jsx)(el.Entity.Content,{description:en.projectRoles.find(s=>s.role===e.role)?.label}),children:(0,s.jsx)(el.Entity.Content,{description:e.email||"",title:e.name||e.username})},e.username))}),c?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.Spacer,{}),(0,s.jsx)(Q.Error,{error:c})]}):null]}),(0,s.jsxs)(ee.Modal.Actions,{children:[(0,s.jsx)(ee.Modal.Action,{onClick:()=>a(!1),type:"secondary",children:"Cancel"}),(0,s.jsx)(ee.Modal.Action,{loading:u,onClick:f,children:"Confirm"})]})]})}var ec=e.i(6316524);function ed(e){let{search:t}=e;return(0,s.jsxs)(r.Stack,{align:"center",className:ec.default.empty,gap:2,justify:"center",children:[(0,s.jsx)(a.Text,{weight:500,children:"No Results Found"}),(0,s.jsxs)(a.Text,{align:"center",color:"gray-900",children:['Your search for "',t,'" did not return any results.']}),(0,s.jsx)(i.Spacer,{})]})}var em=e.i(1209519),eu=e.i(4789498),eh=e.i(7329332),ej=e.i(5617834),ex=e.i(8968847),ep=e.i(9572024);function eg(e){let{active:a,setActive:l,members:n,onAdded:c,revalidateData:d}=e,[u,x]=(0,m.useState)(null),[p,g]=(0,m.useState)(!1),{project:b}=(0,t.useRouter)().query,{data:y}=(0,$.useProject)(b),{team:f}=(0,o.useTeam)(),v=n.filter(e=>!!e.id);async function S(){if(y&&f){try{x(null),g(!0);let e=(0,E.fetchAPI)(`${(0,A.API_PROJECTS_MEMBERS)(y.id)}/batch${(0,w.encode)({teamId:f.id})}`,{method:"POST",body:{members:v.filter(e=>"email"!==e.type).map(e=>({..."member"===e.type?{uid:e.id}:{accessGroupId:e.id},role:e.role}))},throwOnHTTPError:!0}),s=await Promise.allSettled([e,...v.filter(e=>"email"===e.type&&(0,ep.default)(e.id)).map(async e=>(0,E.fetchAPI)(`${A.API_TEAMS_MEMBERS}/${f.id}/members`,{method:"POST",body:JSON.stringify({email:e.email,role:e.teamRole,projects:[{projectId:y.id,role:e.role}]}),throwOnHTTPError:!0}))]);await d(),s.forEach(e=>{if("rejected"===e.status)throw e.reason}),l(!1),c?.()}catch(e){x((0,C.normalizeError)(e))}g(!1)}}return(0,s.jsxs)(ee.Modal.Modal,{active:a,onAnimationDone:()=>{g(!1),x(null)},onClickOutside:()=>l(!1),children:[(0,s.jsxs)(ee.Modal.Body,{children:[(0,s.jsx)(ee.Modal.Title,{children:"Assign Project Role"}),(0,s.jsx)(i.Spacer,{y:.5}),(0,s.jsxs)(ee.Modal.Subtitle,{children:["You are about to add the following team members, access groups or emails to the ",(0,s.jsx)("b",{children:y?.name})," Project.",(0,s.jsx)(i.Spacer,{y:.5}),"Invited users will be assigned the Contributor role once they join the team. Invites can be managed from the team settings page.",(0,s.jsx)(i.Spacer,{y:.5}),"Are you sure you want to continue?"]}),(0,s.jsx)(i.Spacer,{}),(0,s.jsx)(el.Entity.List,{className:"tailwind-preflight",children:v.map(e=>(0,s.jsx)(el.Entity,{left:(0,s.jsx)(r.Stack,{className:"truncate",direction:"row",gap:2,justify:"center",children:(0,s.jsxs)(r.Stack,{align:"center",direction:"row",gap:2,children:["member"===e.type?(0,s.jsx)(j.Avatar,{hash:e.avatar,size:24}):(0,s.jsx)(r.Stack,{paddingLeft:1,style:{width:"24px"},children:"email"===e.type?(0,s.jsx)(ex.UserPlus,{size:"16"}):(0,s.jsx)(h.Users,{size:"16"})}),e.name]})}),right:en.projectRoles.find(s=>s.role===e.role)?.label},e.id))}),u?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.Spacer,{}),(0,s.jsx)(Q.Error,{error:u})]}):null]}),(0,s.jsxs)(ee.Modal.Actions,{children:[(0,s.jsx)(ee.Modal.Action,{onClick:()=>l(!1),type:"secondary",children:"Cancel"}),(0,s.jsx)(ee.Modal.Action,{loading:p,onClick:S,children:"Add"})]})]})}var eb=e.i(3921802),ey=e.i(3621043),ef=e.i(3821772),ev=e.i(323659);function eS(e){let{alreadySelected:t,project:i,onClear:l,onMemberChange:n}=e,o=(0,m.useRef)(new Map),[c,d]=(0,m.useState)(void 0),[u,x]=(0,m.useState)(""),[p,g]=(0,F.useMembersInfinite)({},{search:u||void 0,limit:10,eligibleMembersForProjectId:u?void 0:i?.id,sort:"name_asc"}),{accessGroups:b,isLoading:y}=(0,V.useAccessGroups)({limit:100}),{isLoading:f,can:v}=(0,P.default)(),S=v(R.Action.Update,R.Resource.AccessGroup),M=!f&&S,C=g.members.filter(e=>e.confirmed).map(e=>{let s={id:e.uid,type:"member",name:e.name||e.username,email:e.email,avatar:e.avatar,role:e.role,hasAccess:t.includes(e.uid)||"CONTRIBUTOR"!==e.role&&"DEVELOPER"!==e.role,badge:ej.rolesMeta[e.role].label};return o.current.set(s.id,s),s}),T=M&&b?b.filter(e=>!t.includes(e.accessGroupId)).filter(e=>!p.isLoading&&(g.isReachingEnd||g.isEmpty)||(C.at(-1)?.name.toLowerCase()??"")>e.name.toLowerCase()).map(e=>{let s={id:e.accessGroupId,type:"access-group",name:e.name,role:"CONTRIBUTOR",badge:`${e.membersCount} members`};return o.current.set(s.id,s),s}):[],w=[...C,...T].sort((e,s)=>e.name.toLowerCase()>s.name.toLowerCase()?1:-1);if(c&&!w.some(e=>e.id===c)){let e=o.current.get(c);e&&w.push(e)}let E=(0,ev.useIntersectionObserverRef)(()=>{g.isLoadingMore||g.loadMore()},{rootMargin:"100px 0px"}),A=w.some(e=>"email"in e&&e.email===u);return(0,s.jsxs)(ey.Combobox,{className:"w-full",onChange:e=>{x("");let s=w.find(s=>s.id===e);if(s){if(s.hasAccess){d(""),x(""),l();return}n(s),d(s.id);return}if(M){let s=g.members.find(s=>s.email.toLowerCase()===e?.toLowerCase());if(s){let e=w.find(e=>e.id===s.uid);e&&(n(e),d(e.id));return}e&&(0,ep.default)(e)&&(n({id:e,type:"email",name:e,email:e,role:"CONTRIBUTOR",badge:""}),d(e))}},onClear:()=>{x(""),l()},placeholder:M?"Add member, access group or email...":"Select member...",value:c,children:[(0,s.jsx)(ey.Combobox.Input,{loading:p.isLoading||y,onChange:e=>{x(e.target.value)}}),(0,s.jsx)(ey.Combobox.List,{className:"tailwind-preflight",hideOnEmpty:!0,children:(0,s.jsxs)(s.Fragment,{children:[w.map(e=>(0,s.jsxs)(ey.Combobox.Option,{disabled:e.hasAccess,label:`${e.name}${"email"in e?` (${e.email})`:""}`,prefix:"avatar"in e?(0,s.jsx)(j.Avatar,{hash:e.avatar,size:24}):(0,s.jsx)(r.Stack,{align:"center",style:{width:"24px"},children:(0,s.jsx)(h.Users,{size:"16"})}),suffix:e.hasAccess?null:(0,s.jsx)(r.Stack,{className:"pl-4",children:(0,s.jsx)(eb.Badge,{size:"sm",children:e.badge})}),value:e.id,children:[(0,s.jsxs)(a.Text,{as:"span",className:"truncate",color:"email"in e?"gray-900":"gray-1000",children:[(0,s.jsx)(a.Text,{as:"span",color:"gray-1000",children:e.name}),"email"in e?(0,s.jsxs)(a.Text,{as:"span",color:"gray-900",children:[" ",e.email]}):""]}),e.hasAccess?(0,s.jsx)(a.Text,{as:"span",className:"whitespace-nowrap",color:"gray-900",children:"Â already has access"}):null]},e.id)),g.isEmpty||g.isReachingEnd||p.isLoading?null:(0,s.jsx)(ey.Combobox.Option,{className:"tailwind-preflight",disabled:!0,displayLast:!0,label:"Load more",value:"load-more",children:(0,s.jsx)(r.Stack,{align:"center",className:"w-full",ref:g.isLoadingMore?void 0:E,children:(0,s.jsx)(ef.Spinner,{})})},"load-more"),M&&c&&(0,ep.default)(c)?(0,s.jsx)(ey.Combobox.Option,{displayLast:!0,label:c,prefix:(0,s.jsx)(r.Stack,{align:"center",style:{width:"24px"},children:(0,s.jsx)(ex.UserPlus,{size:"16"})}),value:c,children:c},"invite-selected-email"):null,M&&u&&u!==c&&!A?(0,s.jsx)(ey.Combobox.Option,{disabled:!(0,ep.default)(u),displayLast:!0,label:u,prefix:(0,s.jsx)(r.Stack,{align:"center",style:{width:"24px"},children:(0,s.jsx)(ex.UserPlus,{size:"16"})}),value:u,children:u&&(0,ep.default)(u)?u:"Continue typing email to invite..."},"invite-new-member"):null]})})]})}function eM(e){let{disabled:n=!1,members:c,accessGroups:d,revalidateData:u}=e,{team:h}=(0,o.useTeam)(),j=h?.id,x=(0,M.useToasts)(),{project:g}=(0,t.useRouter)().query,{data:b}=(0,$.useProject)(g),{isLoading:y,can:f}=(0,P.default)(),S=void 0===b||y,C=n||S||!f(R.Action.Create,R.Resource.ProjectMember),w=f(R.Action.List,R.Resource.TeamFellowMembership),{isValidRoleCombination:E,getDefaultProjectRole:A}=(0,ej.useRoleUtils)(),[k,N]=(0,m.useState)([I()]);function I(){return{key:Date.now(),id:"",type:"member",name:"",email:"",avatar:"",role:"PROJECT_VIEWER",teamRole:"CONTRIBUTOR"}}let[L,O]=(0,m.useState)(null),[_,z]=(0,m.useState)(!1),G=(0,m.useRef)(null);function D(){if(!h||!G.current)return;O(null);let e=!1;for(let s of k.filter(e=>!!e.id))"member"!==s.type||E(s.teamRole,s.role)||O(`Please enter a valid role combination for "${s.name}".`),e=!0;if(!e)return void O("Please complete the fields above.");z(!0)}let B=[...d.map(e=>e.accessGroupId),...c.map(e=>e.uid)];return(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),D()},ref:G,children:[(0,s.jsxs)(eh.EntityForm,{className:"tailwind-preflight",disabled:S||!w,footerNote:n?(0,s.jsxs)("span",{children:["This feature is available on the"," ",(0,s.jsx)(l.Link,{external:!0,href:"/pricing",tab:!0,type:"highlight",children:"Enterprise plan"}),"."]}):(0,s.jsx)(v.Skeleton,{show:S,children:S||w?(0,s.jsxs)(a.Text,{as:"span",color:"gray-900",children:["Learn more about"," ",(0,s.jsx)(l.Link,{external:!0,href:"/docs/accounts/team-members-and-roles",variant:"highlight",children:"Project Roles"})]}):(0,s.jsxs)(a.Text,{as:"span",className:"geist-disabled-skip",color:"gray-900",children:["Additional permissions are required to manage ",(0,s.jsx)(l.Link,{external:!0,href:"/docs/accounts/team-members-and-roles",variant:"highlight",children:"Project Members"})]})}),footerSeparator:!0,primaryAction:n?(0,s.jsx)(l.ButtonLink,{href:"/pricing",size:"small",target:"_blank",children:"Upgrade"}):w?(0,s.jsx)(p.Button,{disabled:C,onClick:D,size:"small",typeName:"submit",children:"Assign Role"}):null,title:"Assign project role",children:[(0,s.jsxs)(a.Text,{color:"gray-900",children:["Team members with the ",(0,s.jsx)("strong",{children:"Developer"})," or"," ",(0,s.jsx)("strong",{children:"Contributor"})," role can have Project Roles assigned. You can also map Access Groups to this project and invite new team members with access to only this project as Contributors."]}),(0,s.jsx)(i.Spacer,{}),(0,s.jsx)(r.Stack,{children:(0,s.jsxs)(r.Stack,{className:"tailwind-preflight",direction:"column",children:[(0,s.jsxs)(r.Stack,{className:"geist-hide-on-mobile",direction:"row",gap:4,children:[(0,s.jsx)(eu.Label,{bypassCasing:!0,value:"Team Member, Access Group or Email",wrapperClassName:"w-1/2"}),(0,s.jsx)(eu.Label,{value:"Project Role",wrapperClassName:"w-1/2"})]}),(0,s.jsx)(r.Stack,{direction:"column",gap:4,children:k.map(e=>(0,s.jsxs)(r.Stack,{direction:{sm:"column",md:"row",lg:"row"},gap:4,children:[j&&b?(0,s.jsxs)(r.Stack,{className:"md:row md:w-1/2",children:[(0,s.jsx)(eu.Label,{bypassCasing:!0,value:"Team Member, Access Group or Email",wrapperClassName:"md:hidden"}),(0,s.jsx)(eS,{alreadySelected:[...B,...k.filter(s=>s.id!==e.id).map(e=>e.id)],onClear:()=>{N(k.map(s=>s.key===e.key?{...I(),role:e.role}:s))},onMemberChange:s=>{N(k.map(t=>t.key===e.key?{...t,id:s.id,teamRole:s.role,type:s.type,role:E(s.role,t.role)?t.role:A(s.role)??"PROJECT_VIEWER",email:"email"in s?s.email:"",name:s.name,avatar:"avatar"in s?s.avatar:""}:t))},project:b})]}):(0,s.jsx)(v.Skeleton,{height:40,width:"100%"}),(0,s.jsxs)(r.Stack,{className:"md:row md:w-1/2",children:[(0,s.jsx)(eu.Label,{value:"Project Role",wrapperClassName:"md:hidden"}),(0,s.jsx)(en.ProjectRoleSelector,{disabled:C,menuButtonWidth:"100%",menuWidth:"100%",onChange:s=>{N(k.map(t=>t.key===e.key?{...t,role:s}:t))},teamRole:e.teamRole,value:e.role})]}),(0,s.jsx)("hr",{className:"geist-hr-reset md:hidden"})]},e.key))})]})}),(0,s.jsx)(i.Spacer,{y:2/3}),(0,s.jsx)(p.Button,{disabled:C,onClick:()=>{N([...k,I()])},prefix:(0,s.jsx)(em.PlusCircle,{}),size:"small",type:"secondary",typeName:"button",children:"Add another"}),L?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.Spacer,{}),(0,s.jsx)(Q.Error,{error:L})]}):null]}),(0,s.jsx)(eg,{active:_,members:k,onAdded:()=>{x.success(`Successfully added ${(0,T.pluralize)("Project Member",k.length)}`),N([I()])},revalidateData:u,setActive:z})]})}let eC=[,,,,,].fill({});function eT(e){let{disabled:a}=e,[l,n]=(0,m.useState)(""),c=(0,t.useRouter)(),d=(0,M.useToasts)(),{isReady:h,team:j}=(0,o.useTeam)(),{project:x}=c.query,{data:p}=(0,$.useProject)(x),{data:T}=(0,B.useProjectMembersSummary)(x),{accessGroupsWithRole:O,isLoading:_,mutate:z}=(0,V.useAccessGroups)({membersLimit:2,projectId:p?.id??null}),[U,q]=(0,m.useState)(null),[J,Z]=(0,m.useState)(null),{data:W}=(0,B.default)({limit:B.PROJECT_MEMBERS_LIMIT}),{isLoading:Y,can:X}=(0,P.default)(),Q=X(R.Action.Delete,R.Resource.ProjectMember),ee=X(R.Action.Update,R.Resource.ProjectMember),es=X(R.Action.Update,R.Resource.TeamFellowMembership),et=X(R.Action.List,R.Resource.TeamFellowMembership),ei=X(R.Action.Update,R.Resource.AccessGroup),[ea,el]=(0,F.useMembersInfinite)({},{filterByUserIds:W?.members.map(e=>e.uid)}),[{mutate:en},{members:ec,initialDataLoaded:em,loadMore:eu,isLoadingMore:eh,isReachingEnd:ej,isLagging:ex}]=(0,B.useProjectMembersInfinite)({search:W?.pagination.hasNext&&l||void 0},{},!0,!1),ep=!em||_,eg=Y||void 0===p||!h,eb=a||eg||!Q,[ey,ef]=(0,m.useState)({}),ev=Object.keys(ey).length,[eS]=(0,m.useState)(()=>new Set),[eT,eA]=(0,m.useState)(""),eP=(0,m.useRef)(null),[eR,ek]=(0,m.useState)("date"),eN=(0,m.useMemo)(()=>{let e=[...ec];switch(!W?.pagination.hasNext&&(e=(0,G.matchSorter)([...ec],eT,{keys:["name","username","email"]})),eR){case"name-a":e=e.sort((e,s)=>e.name&&s.name?e.name.localeCompare(s.name):e.username&&s.username&&s.name?e.username.localeCompare(s.name):0);break;case"name-z":e=e.sort((e,s)=>e.name&&s.name?e.name.localeCompare(s.name):e.username&&s.username&&s.name?e.username.localeCompare(s.name):0).reverse()}return[...e].sort()},[ec,eT,eR,W]),eI=(0,m.useMemo)(()=>!!eN.length&&eN.every(e=>ey[e.uid]),[eN,ey]),[eL,eO]=(0,m.useState)([]),[e_,ez]=(0,m.useState)(!1);function eG(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.length||(e=eN.filter(e=>!!ey[e.uid])),eO(e),ez(!0)}async function eD(e,s){try{let t=await (0,E.fetchAPI)(`${(0,A.API_PROJECTS_MEMBERS)(p?.id??"")}${(0,w.encode)({teamId:j?.id})}`,{method:"PATCH",body:{members:e.map(e=>({uid:e,role:s}))}});if(t?.error)throw Error(t.error.message);await en(),d.success("Changed Project role successfully.")}catch(e){d.error((0,C.errorToString)(e))}}return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eM,{accessGroups:O||[],disabled:a,members:eN,revalidateData:async()=>{await Promise.all([en(),z()])}}),a?null:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.Spacer,{}),(0,s.jsxs)(r.Stack,{direction:{sm:"column",md:"row",lg:"row"},gap:{sm:4,md:2,lg:2},children:[(0,s.jsx)(r.Stack,{flex:"75%",children:(0,s.jsx)(v.Skeleton,{show:!em,children:(0,s.jsx)(L.default,{disabled:eg||0===eN.length&&!eT,loading:ex&&eT.length>0,onChange:e=>{let{value:s}=e.target;eS.add(""),eA(s),eP.current&&clearTimeout(eP.current),eS.has(s)?(n(s),eS.add(s)):eP.current=setTimeout(()=>{n(s),eS.add(s)},100)},placeholder:"Filter...",value:eT,width:"100%"})})}),(0,s.jsx)(r.Stack,{children:(0,s.jsx)(v.Skeleton,{show:!em,children:(0,s.jsxs)(f.Select,{disabled:eg||0===eN.length&&!eT,onChange:e=>ek(e.target.value),prefix:(0,s.jsx)(u.SortDescending,{}),value:eR,children:[(0,s.jsx)("option",{value:"default",children:"Default"}),(0,s.jsx)("option",{value:"name-a",children:"Name (A-Z)"}),(0,s.jsx)("option",{value:"name-z",children:"Name (Z-A)"})]})})})]}),(0,s.jsx)(i.Spacer,{y:.5}),!(em&&0===eN.length)&&(0,s.jsx)(N.EntityHeader,{children:(0,s.jsxs)(r.Stack,{align:"center",direction:"row",flex:"1",justify:"space-between",children:[(0,s.jsx)(v.Skeleton,{show:!em,children:(0,s.jsx)(S.Tooltip,{delayTime:300,disableTriggers:!eb,position:"bottom",text:(0,s.jsx)(K,{}),children:(0,s.jsx)(g.Checkbox,{"aria-label":"Select all",checked:eI,className:"flex gap-1 text-sm text-gray-900",disabled:eb||!ep&&0===eN.length,onChange:()=>{eI?ef({}):ef(e=>{let s={...e};return eN.forEach(e=>{s[e.uid]=!0}),s})},children:0===ev?"Select all":`${ev} selected`})})}),(0,s.jsx)(v.Skeleton,{show:!em,children:(0,s.jsx)(I.EntityMenu,{disabledDotMenuTooltip:(0,s.jsx)(K,{}),isDotMenuDisabled:eb,children:(0,s.jsxs)(y.MenuItem,{disabled:0===ev,onClick:()=>eG(),type:"error",children:["Remove Project-level Role (",ev,")"]})})})]})}),(0,s.jsxs)(k.PlaceholderContext.Provider,{value:ep,children:[T?(0,s.jsx)(ew,{canListMembers:et,canManageMembers:es,roles:T}):null,O?.map(e=>(0,s.jsx)(eE,{accessGroup:e,canUpdateAccessGroup:ei,onPromptEdit:()=>q(e)},e.accessGroupId)),(ep?eC:eN).map(e=>{let t="uid"in e?e:void 0,i=t&&el.members.find(e=>e.uid===t.uid);return t?(0,s.jsx)(er,{canDeleteProjectMember:Q,canUpdateProjectMember:ee,onManageProjectAccess:()=>{i&&p&&Z({member:i,project:p})},onManageTeamAccess:()=>{i&&Z({member:i})},onUpdateProjectRole:eD,project:p,projectMember:t,remove:eG,selected:ey,setSelected:ef,teamMember:i},t.uid):null}),0===eN.length&&em&&eT?(0,s.jsx)(ed,{search:eT}):null,!ep&&!ej&&(0,s.jsx)(b.LoadMoreButton,{disabled:ep,loading:eh,onClick:eu})]}),(0,s.jsx)(eo,{active:e_,members:eL,onRemoved:()=>{ef({})},setActive:ez}),J?(0,s.jsx)(H.ManageRoleModal,{accessGroupsData:O,member:J.member,onClearProject:()=>{Z({member:J.member})},onClose:()=>{Z(null)},project:J.project,revalidateAccessGroups:async()=>{await z(),await en()},revalidateSearch:ea.mutate}):null,U?(0,s.jsx)(D.EditAccessGroupModal,{accessGroup:U,canUpdateAccessGroup:ei,mutate:z,onClose:()=>q(null)}):null]})]})}function ew(e){let{canManageMembers:i,canListMembers:a,roles:l}=e,{team:n}=(0,o.useTeam)(),c=(0,t.useRouter)(),d=Object.values(l).reduce((e,s)=>e+s,0),m=Object.entries(l).map(e=>{let[s,t]=e;return 0!==t?`${t} ${(0,U.default)((0,T.pluralize)(s.toLowerCase(),t))}`:""}).filter(Boolean).join(", ");return(0,s.jsxs)(O.Entity,{className:ei.default.summaryEntity,menuItems:a?(0,s.jsx)(y.MenuItem,{onClick:()=>n?c.push(`/${n.slug}/~/settings/members`):null,children:i?"Manage Team Members":"View Team Members"}):null,thumbnail:(0,s.jsx)(z.EntityThumbnail,{size:32,children:(0,s.jsx)(r.Stack,{paddingLeft:8,children:(0,s.jsx)(j.Avatar,{size:32,teamId:n?.id})})}),children:[(0,s.jsx)(_.EntityField,{description:m,title:(0,s.jsxs)("span",{className:"geist-inline-center",children:[(0,s.jsxs)("span",{className:"geist-ellipsis geist-hide-on-mobile",children:[d," ",n?.name," team members have access to this project"]}),(0,s.jsxs)("span",{className:"geist-ellipsis geist-hide-on-desktop",children:[d," team members have access"]})]})}),a?(0,s.jsx)(r.Stack,{className:"geist-hide-on-mobile",justify:"center",children:(0,s.jsx)(p.Button,{onClick:()=>n?c.push(`/${n.slug}/~/settings/members`):null,size:"small",type:"secondary",children:i?"Manage Team Members":"View Team Members"})}):null]})}function eE(e){let{accessGroup:t,canUpdateAccessGroup:i,onPromptEdit:a}=e,l=(0,k.usePlaceholder)();return(0,s.jsxs)(O.Entity,{className:ei.default.accessGroupEntity,menuItems:(0,s.jsx)(y.MenuItem,{onClick:a,children:i?"Edit Access Group":"View Access Group"}),placeholder:l,thumbnail:t.members?.length?(0,s.jsx)(z.EntityThumbnail,{size:32,children:(0,s.jsx)(r.Stack,{align:"end",style:{width:64},children:(0,s.jsx)(x.AvatarGroup,{members:t.members.map(e=>({uid:e})),size:32})})}):(0,s.jsx)(r.Stack,{align:"end",style:{width:64,height:32},children:(0,s.jsx)(z.EntityThumbnail,{circular:!0,size:32,children:(0,s.jsx)(h.Users,{})})}),children:[(0,s.jsx)(_.EntityField,{description:`${t.membersCount} Contributors`,title:(0,s.jsx)("span",{className:"geist-inline-center",children:(0,s.jsx)("span",{className:"geist-ellipsis",children:t.name})})}),(0,s.jsx)(r.Stack,{className:"geist-hide-on-mobile",justify:"center",children:(0,s.jsx)(p.Button,{onClick:a,size:"small",type:"secondary",children:i?"Edit Access Group":"View Access Group"})})]})}function eA(){let{teamSlug:e}=(0,o.useTeam)();return(0,s.jsxs)(r.Stack,{gap:4,children:[(0,s.jsx)(a.Text,{as:"h1",size:24,children:"Project Members"}),(0,s.jsxs)(a.Text,{color:"gray-1000",children:["Manage and assign roles on this project. Team members can be managed from"," ",(0,s.jsxs)(l.Link,{className:"inline-flex items-center gap-1",href:`/${String(e)}/~/settings/members`,variant:"highlight",children:["Team Settings",(0,s.jsx)(n.ArrowCircleRight,{align:"middle"})]})]})]})}let eP=function(){let e=(0,t.useRouter)(),{teamSlug:r,isReady:a}=(0,o.useTeam)(),{value:l,isReady:n}=(0,c.useEntitlement)("project-rbac-access-groups"),{project:m}=e.query,u=!!(e.isReady&&a&&n&&!l&&r&&e.query.project);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.HeadTitle,{title:`${m||""} â€“ Project Members`,titlePostfix:!0}),(0,s.jsx)(eA,{}),(0,s.jsx)(i.Spacer,{}),(0,s.jsx)(eT,{disabled:u})]})}}}]);

//# sourceMappingURL=eb1cfd4ccbc25fca.js.map
//# debugId=ba7b534e-d5ce-5fdf-834d-aae91ae229ca
