
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="cd728747-6f4e-5fc3-8ce0-5b63b0bd6318")}catch(e){}}();
(globalThis.TURBOPACK=globalThis.TURBOPACK||[]).push(["object"==typeof document?document.currentScript:void 0,{3153829:e=>{"use strict";function t(e){return`https://${e}`}e.s({domainToUrl:()=>t})},3076719:e=>{"use strict";function t(e,t){return t?`${e}${t.startsWith("/")?t:`/${t}`}`:e}e.s({withDefaultRoute:()=>t})},6025740:e=>{"use strict";e.s({useOnDemandConcurrentBuilds:()=>i});let t={enabled:!0,disabledReason:void 0},n=e=>({enabled:!1,disabledReason:e});function i(e,i){if(!e||!e.billing)return n("other");if("enterprise"===e.billing.plan)return"unbundled"===e.billing.planIteration?i?t:n("no-permission"):n("enterprise-non-unbundled");if("pro"===e.billing.plan)return"active"===e.billing.status?i?t:n("no-permission"):n("pro-non-active");return n("hobby-plan")}},1201680:e=>{"use strict";e.s({getDeploymentKey:()=>l,getFinishedState:()=>i,getUrl:()=>r,transform:()=>a});var t=e.i(6649026),n=e.i(9336536);let i=e=>{let t=e?.readyState==="CANCELED",n=e?.readyState==="READY",i=e?.readyState==="ERROR";return t||n||i};function r(e){if(!e)return"";let i=e;return(i=i.replace(/^https?:\/\//,"")).startsWith("dpl_")?`${(0,n.API_DEPLOYMENTS)("v13")}/${i}`:`${(0,n.API_DEPLOYMENTS)("v13")}/get${(0,t.encode)({url:i})}`}function l(e,n,i){let l=r(e);if(l){let e={projectId:i?.projectId,withAutomaticAliases:i?.automaticAliases?1:null},r=l.includes("?url");r||(e.teamId=n,e.withGitRepoInfo=i?.gitRepo?"true":null),l+=(0,t.encode)(e,!r)}return l}function a(e){return e&&(e.host=e.url,e.isPrivate=e.public),e}},5938635:e=>{"use strict";e.s({default:()=>l});var t=e.i(3521787),n=e.i(5535439),i=e.i(1183506),r=e.i(1201680);function l(e,i,l){let{teamSlug:o}=(0,n.useParams)()??{};return(0,t.default)((0,r.getDeploymentKey)(e,o,l),a,i)}async function a(e){let t=await (0,i.fetchAPI)(e,{throwOnHTTPError:!0});return(0,r.transform)(t)}},7117133:e=>{"use strict";e.s({useIsomorphicSWRInfinite:()=>s});var t=e.i(6530772),n=e.i(7095283),i=e.i(1497618),r=e.i(7631057),l=e.i(1902201),a=e.i(6168322),o=e.i(7244164);function s(e,s,d){let{isServer:u,config:c,fetcher:m,fallbackSource:h}=(0,i.useIsomorphicSwrContext)(!0),f=(0,t.useMemo)(()=>"function"==typeof s?(e,t)=>s(e,t):(e,t)=>t(e),[s]),p=(0,t.useMemo)(()=>e=>{if(u)throw Error("useSWR: swrFetcher is not available on server");return f(e,m)},[u,f,m]),g="object"==typeof s?s:d,{ssr:x,...y}=g??{},v=(0,r.mergeConfig)(c,g),j=e(0,null),b=h(j??null,f,v,!1),{data:T,isLoading:w,error:C}=(0,l.useAsyncValue)(u,b),A=(0,n.default)((t,n)=>{let i=e(t,n);return w&&!u?null:i},p,{...y,suspense:!1,fallback:{[(0,n.unstable_serialize)(e)]:T?[T]:void 0},revalidateOnMount:!u&&(y.revalidateOnMount??(!T&&!w))}),{mutate:S,data:I,isLoading:L}=A,D=(0,t.useMemo)(()=>(0,a.withThrottle)(j,()=>{(0,o.debug)(`Client fallback data fetch for ${j}`),S()},2e3),[j,S]);return(0,t.useEffect)(()=>{!C||L||I||D()},[C,D,I,L]),{...A,isLoading:A.isLoading&&void 0===A.data||w||u}}},1766200:e=>{"use strict";e.s({default:()=>g,useDeploymentsInfinite:()=>p},1766200);var t=e.i(6530772),n=e.i(3521787),i=e.i(6649026),r=e.i(1183506),l=e.i(9336536),a=e.i(3514588),o=e.i(1782286),s=e.i(5454140),d=e.i(5535439),u=e.i(7117133),c=e.i(3326412),m=e.i(6700141),h=e.i(8285977),f=e.i(6676545);function p(e){let{limit:n,project:r,projectId:p,requireProject:g,users:x,target:y,state:v,meta:j,rollbackCandidate:b,since:T,until:w,subscribeToUpdates:C,branch:A,ignoreProjectSlug:S}=e,{refreshInterval:I,...L}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},D=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"v6",{isReady:P,team:R}=(0,a.useTeam)(),{user:E}=(0,s.useUser)(),[k,N]=(0,t.useState)(()=>I),M=x&&x.length>0?x.map(e=>e.uid).join(","):null,O=r?.id||p,{value:_}=(0,m.useInstantRollbackHobbyRestrictionFlag)(),{value:$}=(0,c.useInstantRollbackHobbyRestrictionTeamFlag)(),{teamSlug:B,project:F}=(0,d.useParams)()??{},H={projectId:O,limit:n,teamId:R?.id,target:y||null,users:M,state:v,meta:j,rollbackCandidate:b,since:T,until:w,branch:A},U=g||(_||$)&&void 0!==b&&(!R||R.billing?.plan==="hobby"),W=(0,u.useIsomorphicSWRInfinite)((e,t)=>{if(B&&F&&!S){if(!e)return`${(0,l.API_DEPLOYMENTS)(D)}${(0,i.encode)({...H,teamId:B,projectId:F})}`;let r=t&&t.deployments.length>=n?t.deployments[t.deployments.length-1].created-1:null;return r?`${(0,l.API_DEPLOYMENTS)(D)}${(0,i.encode)({...H,teamId:B,projectId:F,from:r})}`:null}if(U&&!O)return null;if(!e)return P?`${(0,l.API_DEPLOYMENTS)(D)}${(0,i.encode)(H)}`:null;let r=t&&t.deployments.length>=n?t.deployments[t.deployments.length-1].created-1:null;return r&&P?`${(0,l.API_DEPLOYMENTS)(D)}${(0,i.encode)({...H,from:r})}`:null},{...L,refreshInterval:k,ssr:{timeout:1e3}}),{mutate:z}=W,V=(0,t.useMemo)(()=>(0,o.default)(()=>{z()},100),[z]),{isListening:Z}=function(e,t){let n=e?`${e.accountId}-${e.id}`:void 0;return(0,h.usePusherEvent)("deployments",n,"deployment-created",t)}(C?r:void 0,V);Z||I===k?Z&&3e4!==k&&N(3e4):N(I);let Y=(0,t.useMemo)(()=>W.data?W.data.flatMap(e=>e.deployments):[],[W.data]),G=R?R.id:E?.uid,K=(0,t.useMemo)(()=>C&&G?Y.map(e=>({id:e.uid,readyState:e.readyState??e.state,aliasAssigned:!!e.aliasAssigned,ownerId:G})):[],[Y,C,G]);(0,f.useDeploymentsStatusPing)(K,V);let J=!!W.data,q=J&&0===Y.length,X=J&&W.data&&W.size>W.data.length,Q=J&&W.data&&W.data[W.data.length-1]?.deployments.length<n;return[W,{deployments:Y,initialDataLoaded:J,isEmpty:q,loadMore:()=>W.setSize(e=>e+1),isLoadingMore:X,isReachingEnd:Q,mutate:W.mutate}]}function g(e){let{limit:t,projectId:o,project:s,from:d,target:u,users:c=[],...m}=e,h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"v6",{isReady:p,team:g}=(0,a.useTeam)(),x=c.length>0?c.map(e=>e.uid).join(","):null,y=!!o||!!s?.id;return(0,n.default)(p&&y&&t>0?`${(0,l.API_DEPLOYMENTS)(f)}${(0,i.encode)({projectId:o||s?.id,limit:t,from:d||null,teamId:g?.id,target:u,users:x,...m})}`:null,e=>(0,r.fetchAPI)(e,{throwOnHTTPError:!0}),h)}},5154216:e=>{"use strict";e.s({GitCommit:()=>t});let t=(0,e.i(6895406).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M8 10.5C9.38071 10.5 10.5 9.38071 10.5 8C10.5 6.61929 9.38071 5.5 8 5.5C6.61929 5.5 5.5 6.61929 5.5 8C5.5 9.38071 6.61929 10.5 8 10.5ZM8 12C9.95279 12 11.5787 10.6006 11.9298 8.75H15.25H16V7.25H15.25H11.9298C11.5787 5.39935 9.95279 4 8 4C6.04721 4 4.42125 5.39935 4.0702 7.25H0.75H0V8.75H0.75H4.0702C4.42125 10.6006 6.04721 12 8 12Z" fill="currentColor"/>')},2293621:e=>{"use strict";e.s({RelativeTimeCard:()=>l,useShortTimeAgo:()=>u});var t=e.i(6645307),n=e.i(6530772),i=e.i(8084653),r=e.i(3583950);function l(e){let{date:n,children:i,...l}=e,s=void 0===i?(0,t.jsx)(a,{date:n}):i;return n?(0,t.jsx)(r.ContextCard.Trigger,{content:(0,t.jsx)(o,{date:n}),...l,children:s}):s}function a(e){let{date:n}=e,r=u(n);return(0,t.jsx)(i.Text,{as:"span",color:"gray-900",variant:"label-14",children:r})}function o(e){let{date:i}=e,r=Intl.DateTimeFormat().resolvedOptions().timeZone,l=function(e){let[t,i]=(0,n.useState)("");return(0,n.useEffect)(()=>{let t=()=>{let t=function(e){let t=Math.abs(e),n=[];for(let{unit:e,ms:i}of d){let r=Math.floor(t/i);if((r>0||n.length>0)&&(n.push(`${r} ${e}${1!==r?"s":""}`),t%=i),3===n.length)break}return n.join(", ")}(new Date().getTime()-e);i(t?`${t} ago`:"Just now")};t();let n=setInterval(t,1e3);return()=>clearInterval(n)},[e]),t}(i);return(0,t.jsxs)("div",{className:"flex flex-col gap-3 min-w-[300px] ",children:[(0,t.jsx)("div",{className:"flex flex-col gap-3",children:(0,t.jsx)("span",{className:"tabular-nums text-label-13 text-gray-900",children:l})}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)(s,{date:i,zone:"UTC"}),(0,t.jsx)(s,{date:i,zone:r})]})]})}function s(e){let{date:n,zone:i}=e,r=new Date(n),l=new Intl.DateTimeFormat("en-US",{timeZone:i,timeZoneName:"short"}).formatToParts(r).find(e=>"timeZoneName"===e.type)?.value||i,a=r.toLocaleString("en-US",{timeZone:i,year:"numeric",month:"long",day:"numeric"}),o=r.toLocaleTimeString("en-US",{timeZone:i,hour:"2-digit",minute:"2-digit",second:"2-digit"});return(0,t.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)("div",{className:"flex items-center justify-center h-4 px-1.5 bg-gray-200 rounded-xs",children:(0,t.jsx)("span",{className:"text-label-12-mono text-gray-900",children:l})}),(0,t.jsx)("span",{className:"text-label-13",children:a})]}),(0,t.jsx)("span",{className:"tabular-nums text-label-12-mono text-gray-900",children:o})]})}let d=[{unit:"year",ms:31536e6},{unit:"month",ms:2628e6},{unit:"day",ms:864e5},{unit:"hour",ms:36e5},{unit:"minute",ms:6e4},{unit:"second",ms:1e3}];function u(e){let[t,i]=(0,n.useState)("");return(0,n.useEffect)(()=>{if(!e)return void i("");let t=()=>{let t=new Date().getTime()-e,n=Math.floor(t/864e5),r=Math.floor(t/36e5),l=Math.floor(t/6e4);n>0?i(`${n} day${n>1?"s":""} ago`):r>0?i(`${r} hour${r>1?"s":""} ago`):l>0?i(`${l} minute${l>1?"s":""} ago`):i("Just now")};t();let n=setInterval(t,6e4);return()=>clearInterval(n)},[e]),t}},9945435:e=>{"use strict";e.s({PreviewEye:()=>t});let t=(0,e.i(6895406).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M4.02174 4.76932C6.11625 2.33698 9.8838 2.33698 11.9783 4.76932L14.7603 7.99999L13.6664 9.27031L14.6934 10.3764L16.3184 8.48938V7.5106L13.115 3.79054C10.422 0.663244 5.57803 0.663247 2.88509 3.79054L-0.318298 7.5106V8.48938L2.88509 12.2094C4.7342 14.3568 7.59749 15.0297 10.0822 14.2281L8.9183 12.9747C7.16767 13.2832 5.28865 12.7019 4.02174 11.2307L1.23978 7.99999L4.02174 4.76932ZM8 6C6.89543 6 6 6.89543 6 8C6 9.10457 6.89543 10 8 10C9.10457 10 10 9.10457 10 8C10 6.89543 9.10457 6 8 6ZM4.5 8C4.5 6.067 6.067 4.5 8 4.5C9.933 4.5 11.5 6.067 11.5 8C11.5 8.63488 11.331 9.23028 11.0354 9.74364L14.0496 12.9897L14.5599 13.5393L13.4607 14.5599L12.9504 14.0103L10.0223 10.857C9.4512 11.262 8.7534 11.5 8 11.5C6.067 11.5 4.5 9.933 4.5 8Z" fill="currentColor"/>')},1635827:e=>{"use strict";e.s({ClockDashed:()=>t});let t=(0,e.i(6895406).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M5.35066 2.06247C5.96369 1.78847 6.62701 1.60666 7.32351 1.53473L7.16943 0.0426636C6.31208 0.1312 5.49436 0.355227 4.73858 0.693033L5.35066 2.06247ZM8.67651 1.53473C11.9481 1.87258 14.5 4.63876 14.5 8.00001C14.5 11.5899 11.5899 14.5 8.00001 14.5C4.63901 14.5 1.87298 11.9485 1.5348 8.67722L0.0427551 8.83147C0.459163 12.8594 3.86234 16 8.00001 16C12.4183 16 16 12.4183 16 8.00001C16 3.86204 12.8589 0.458666 8.83059 0.0426636L8.67651 1.53473ZM2.73972 4.18084C3.14144 3.62861 3.62803 3.14195 4.18021 2.74018L3.29768 1.52727C2.61875 2.02128 2.02064 2.61945 1.52671 3.29845L2.73972 4.18084ZM1.5348 7.32279C1.60678 6.62656 1.78856 5.96348 2.06247 5.35066L0.693033 4.73858C0.355343 5.4941 0.131354 6.31152 0.0427551 7.16854L1.5348 7.32279ZM8.75001 4.75V4H7.25001V4.75V7.875C7.25001 8.18976 7.3982 8.48615 7.65001 8.675L9.55001 10.1L10.15 10.55L11.05 9.35L10.45 8.9L8.75001 7.625V4.75Z" fill="currentColor"/>')},9533270:e=>{"use strict";function t(e){let{commandForIgnoringBuildStep:t}=e||{};return"string"==typeof t&&t.trim().length>0}function n(e){let{project:n,deployment:i}=e;return t(n)||t(i?.projectSettings)}e.s({useShowIgnoreBuildStep:()=>n})},869010:e=>{"use strict";e.s({ArrowCircleUp:()=>t});let t=(0,e.i(6895406).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M7.25 10.75V11.5H8.75V10.75V6.56066L10.2197 8.03033L10.75 8.56066L11.8107 7.5L11.2803 6.96967L8.53033 4.21967C8.23744 3.92678 7.76256 3.92678 7.46967 4.21967L4.71967 6.96967L4.18934 7.5L5.25 8.56066L5.78033 8.03033L7.25 6.56066V10.75ZM14.5 8C14.5 11.5899 11.5899 14.5 8 14.5C4.41015 14.5 1.5 11.5899 1.5 8C1.5 4.41015 4.41015 1.5 8 1.5C11.5899 1.5 14.5 4.41015 14.5 8ZM8 16C12.4183 16 16 12.4183 16 8C16 3.58172 12.4183 0 8 0C3.58172 0 0 3.58172 0 8C0 12.4183 3.58172 16 8 16Z" fill="currentColor"/>')},8371532:e=>{"use strict";e.s({DEFAULT_USE_IGNORE_BUILD_STEP_PROMOTE:()=>n,DEFAULT_USE_IGNORE_BUILD_STEP_REDEPLOY:()=>t,DeploymentOverviewParams:()=>i});let t=!0,n=!1,i={automaticAliases:!0}},3799021:e=>{"use strict";e.s({default:()=>s});var t=e.i(6645307),n=e.i(6530772),i=e.i(7415104),r=e.i(631755),l=e.i(8934201),a=e.i(8811733),o=e.i(3153829);let s=(0,n.memo)(e=>{let{active:s,url:d,onCancel:u}=e,[c,m]=(0,n.useState)(""),h=(0,n.useMemo)(()=>!c||c.includes(".")||!(0,i.isValid)(`${c}.${d}`),[c,d]),f=(0,n.useCallback)(()=>{m(""),u()},[u]),p=(0,n.useCallback)(e=>{e.preventDefault(),window.open((0,o.domainToUrl)(`${c}.${d}`),"_blank","noopener"),f()},[c,d,f]);return d?(0,t.jsx)(l.Modal,{active:s,onClickOutside:f,children:(0,t.jsxs)("form",{onSubmit:p,children:[(0,t.jsxs)(l.Modal.Body,{children:[(0,t.jsx)(l.Modal.Title,{children:"Wildcard Domain"}),(0,t.jsx)(a.Spacer,{}),(0,t.jsx)(l.Modal.Subtitle,{children:"Enter a subdomain to visit below."}),(0,t.jsx)(a.Spacer,{y:.75}),(0,t.jsx)(r.Input,{autoFocus:!0,id:"hostname",label:"Hostname",onChange:e=>m(e.target.value),suffix:`.${d}`,value:c})]}),(0,t.jsxs)(l.Modal.Actions,{children:[(0,t.jsx)(l.Modal.Action,{onClick:u,children:"Cancel"}),(0,t.jsx)(l.Modal.Action,{buttonType:"submit",disabled:h,children:"Visit"})]})]})}):null})},3805480:e=>{"use strict";e.s({default:()=>n});var t=e.i(1922196);function n(e){return(0,t.default)(e)?e.slice(2):e}},4760712:e=>{"use strict";e.s({default:()=>u});var t=e.i(6645307),n=e.i(6530772),i=e.i(2362802),r=e.i(3799021),l=e.i(7039668),a=e.i(3805480),o=e.i(1922196),s=e.i(3153829),d=e.i(3076719);let u=(0,n.memo)(function(e){let{url:u,truncate:c,defaultRoute:m,...h}=e,[f,p]=(0,l.default)("#wildcard"),[g,x]=(0,n.useState)(null),[y,v]=(0,n.useState)(!1),j=(0,n.useCallback)(()=>{x((0,a.default)(u)),p(!0)},[x,p,u]);return u?(0,o.default)(u)?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.Link,{className:"pt-px leading-[16px] hover:underline",onClick:j,...h,onMouseEnter:()=>v(!0),style:{minWidth:0,maxWidth:c?"100%":void 0},children:c?(0,t.jsx)("span",{className:"geist-ellipsis",children:u}):u}),y||f?(0,t.jsx)(r.default,{active:f,onCancel:()=>{p(!1)},url:g}):null]}):(0,t.jsx)(i.Link,{className:"pt-px leading-[16px] hover:underline",external:!0,href:(0,d.withDefaultRoute)((0,s.domainToUrl)(u),m),...h,style:{minWidth:0,maxWidth:c?"100%":void 0},children:c?(0,t.jsx)("span",{className:"geist-ellipsis",children:u}):u}):null})},1424159:e=>{"use strict";e.s({decode:()=>h,default:()=>x,encode:()=>f,toASCII:()=>g,toUnicode:()=>p,ucs2decode:()=>d,ucs2encode:()=>u});let t=/^xn--/,n=/[^\0-\x7F]/,i=/[\x2E\u3002\uFF0E\uFF61]/g,r={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},l=Math.floor,a=String.fromCharCode;function o(e){throw RangeError(r[e])}function s(e,t){let n=e.split("@"),r="";return n.length>1&&(r=n[0]+"@",e=n[1]),r+(function(e,t){let n=[],i=e.length;for(;i--;)n[i]=t(e[i]);return n})((e=e.replace(i,".")).split("."),t).join(".")}function d(e){let t=[],n=0,i=e.length;for(;n<i;){let r=e.charCodeAt(n++);if(r>=55296&&r<=56319&&n<i){let i=e.charCodeAt(n++);(64512&i)==56320?t.push(((1023&r)<<10)+(1023&i)+65536):(t.push(r),n--)}else t.push(r)}return t}let u=e=>String.fromCodePoint(...e),c=function(e,t){return e+22+75*(e<26)-((0!=t)<<5)},m=function(e,t,n){let i=0;for(e=n?l(e/700):e>>1,e+=l(e/t);e>455;i+=36)e=l(e/35);return l(i+36*e/(e+38))},h=function(e){let t=[],n=e.length,i=0,r=128,a=72,s=e.lastIndexOf("-");s<0&&(s=0);for(let n=0;n<s;++n)e.charCodeAt(n)>=128&&o("not-basic"),t.push(e.charCodeAt(n));for(let u=s>0?s+1:0;u<n;){let s=i;for(let t=1,r=36;;r+=36){var d;u>=n&&o("invalid-input");let s=(d=e.charCodeAt(u++))>=48&&d<58?26+(d-48):d>=65&&d<91?d-65:d>=97&&d<123?d-97:36;s>=36&&o("invalid-input"),s>l((0x7fffffff-i)/t)&&o("overflow"),i+=s*t;let c=r<=a?1:r>=a+26?26:r-a;if(s<c)break;let m=36-c;t>l(0x7fffffff/m)&&o("overflow"),t*=m}let c=t.length+1;a=m(i-s,c,0==s),l(i/c)>0x7fffffff-r&&o("overflow"),r+=l(i/c),i%=c,t.splice(i++,0,r)}return String.fromCodePoint(...t)},f=function(e){let t=[],n=(e=d(e)).length,i=128,r=0,s=72;for(let n of e)n<128&&t.push(a(n));let u=t.length,h=u;for(u&&t.push("-");h<n;){let n=0x7fffffff;for(let t of e)t>=i&&t<n&&(n=t);let d=h+1;for(let f of(n-i>l((0x7fffffff-r)/d)&&o("overflow"),r+=(n-i)*d,i=n,e))if(f<i&&++r>0x7fffffff&&o("overflow"),f===i){let e=r;for(let n=36;;n+=36){let i=n<=s?1:n>=s+26?26:n-s;if(e<i)break;let r=e-i,o=36-i;t.push(a(c(i+r%o,0))),e=l(r/o)}t.push(a(c(e,0))),s=m(r,d,h===u),r=0,++h}++r,++i}return t.join("")},p=function(e){return s(e,function(e){return t.test(e)?h(e.slice(4).toLowerCase()):e})},g=function(e){return s(e,function(e){return n.test(e)?"xn--"+f(e):e})},x={version:"2.3.1",ucs2:{decode:d,encode:u},decode:h,encode:f,toASCII:g,toUnicode:p}},7415104:e=>{"use strict";var{m:t,e:n}=e,i=e.r(1424159),r={};r.rules=e.r(7012812).map(function(e){return{rule:e,suffix:e.replace(/^(\*\.|\!)/,""),punySuffix:-1,wildcard:"*"===e.charAt(0),exception:"!"===e.charAt(0)}}),r.endsWith=function(e,t){return -1!==e.indexOf(t,e.length-t.length)},r.findRule=function(e){var t=i.toASCII(e);return r.rules.reduce(function(e,n){return(-1===n.punySuffix&&(n.punySuffix=i.toASCII(n.suffix)),r.endsWith(t,"."+n.punySuffix)||t===n.punySuffix)?n:e},null)},n.errorCodes={DOMAIN_TOO_SHORT:"Domain name too short.",DOMAIN_TOO_LONG:"Domain name too long. It should be no more than 255 chars.",LABEL_STARTS_WITH_DASH:"Domain name label can not start with a dash.",LABEL_ENDS_WITH_DASH:"Domain name label can not end with a dash.",LABEL_TOO_LONG:"Domain name label should be at most 63 chars long.",LABEL_TOO_SHORT:"Domain name label should be at least 1 character long.",LABEL_INVALID_CHARS:"Domain name label can only contain alphanumeric characters or dashes."},r.validate=function(e){var t,n=i.toASCII(e);if(n.length<1)return"DOMAIN_TOO_SHORT";if(n.length>255)return"DOMAIN_TOO_LONG";for(var r=n.split("."),l=0;l<r.length;++l){if(!(t=r[l]).length)return"LABEL_TOO_SHORT";if(t.length>63)return"LABEL_TOO_LONG";if("-"===t.charAt(0))return"LABEL_STARTS_WITH_DASH";if("-"===t.charAt(t.length-1))return"LABEL_ENDS_WITH_DASH";if(!/^[a-z0-9\-]+$/.test(t))return"LABEL_INVALID_CHARS"}},n.parse=function(e){if("string"!=typeof e)throw TypeError("Domain name must be a string.");var t=e.slice(0).toLowerCase();"."===t.charAt(t.length-1)&&(t=t.slice(0,t.length-1));var l=r.validate(t);if(l)return{input:e,error:{message:n.errorCodes[l],code:l}};var a={input:e,tld:null,sld:null,domain:null,subdomain:null,listed:!1},o=t.split(".");if("local"===o[o.length-1])return a;var s=function(){return/xn--/.test(t)&&(a.domain&&(a.domain=i.toASCII(a.domain)),a.subdomain&&(a.subdomain=i.toASCII(a.subdomain))),a},d=r.findRule(t);if(!d)return o.length<2?a:(a.tld=o.pop(),a.sld=o.pop(),a.domain=[a.sld,a.tld].join("."),o.length&&(a.subdomain=o.pop()),s());a.listed=!0;var u=d.suffix.split("."),c=o.slice(0,o.length-u.length);return d.exception&&c.push(u.shift()),a.tld=u.join("."),c.length&&(d.wildcard&&(u.unshift(c.pop()),a.tld=u.join(".")),c.length&&(a.sld=c.pop(),a.domain=[a.sld,a.tld].join("."),c.length&&(a.subdomain=c.join(".")))),s()},n.get=function(e){return e&&n.parse(e).domain||null},n.isValid=function(e){var t=n.parse(e);return!!(t.domain&&t.listed)}},8673823:e=>{"use strict";e.s({useAliases:()=>u,useAliasesInfinite:()=>c,useAliasesV2:()=>d},8673823);var t=e.i(6530772),n=e.i(3521787),i=e.i(7095283),r=e.i(3345839),l=e.i(6649026),a=e.i(1183506),o=e.i(9336536),s=e.i(3514588);function d(e,t){let{deploymentId:n,teamId:i}=e;return(0,r.useIsomorphicSWR)(n?function(e){let{deploymentId:t,teamId:n}=e;return`${(0,o.API_DEPLOYMENTS)("v2")}/${t}/aliases${(0,l.encode)({teamId:n})}`}({deploymentId:n,teamId:i}):null,t)}function u(e,t){return(0,n.default)(()=>{if(!e)return null;let{team:t,id:n,teamId:i}=e;return`${(0,o.API_DEPLOYMENTS)("v2")}/${n}/aliases${(0,l.encode)({teamId:i??(t?t.id:null)})}`},e=>(0,a.fetchAPI)(e,{throwOnHTTPError:!0}),t)}function c(e,n){let{limit:r=20,domains:l,rollbackDeploymentId:d}=e,{isReady:u,team:c}=(0,s.useTeam)(),h=(0,i.default)((e,t)=>{if(!u)return null;let n=`${o.API_ALIASES}`,i=l?.map(e=>`domain=${encodeURIComponent(e)}`).join("&")||null;if(!e)return`${n}${m({limit:r+1,teamId:c?.id,rollbackDeploymentId:d},i)}`;let a=t?.aliases&&t.aliases.length>r?t.aliases[r-1].createdAt:null;return a?`${n}${m({limit:r+1,teamId:c?.id,until:a},i)}`:null},e=>(0,a.fetchAPI)(e,{throwOnHTTPError:!0}),n),f=(0,t.useMemo)(()=>h.data?[].concat(...h.data.filter(Boolean).map(e=>e.aliases.slice(0,r))):[],[h.data,r]),p=!!h.data&&!h.error,g=!!(h.data&&0===f.length),x=!!(h.data&&h.size>h.data.length),y=!!(h.data&&h.data[h.data.length-1]?.aliases.length<=r);return[h,{aliases:f,initialDataLoaded:p,isEmpty:g,loadMore:()=>h.setSize(e=>e+1),isLoadingMore:x,isReachingEnd:y}]}function m(e,t){let n=(0,l.encode)(e,!1),i=t?`&${t}`:"";return n?`?${n}${i}`:`?${i}`}},7039668:e=>{"use strict";e.s({default:()=>n});var t=e.i(6530772);function n(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",[n,i]=(0,t.useState)(!1),r=window.location.hash,l=e.startsWith("#")?e:`#${e}`;return(0,t.useEffect)(()=>{let e=()=>{window.location.hash!==l||n||i(!0)};return window.addEventListener("hashchange",e),()=>{window.removeEventListener("hashchange",e)}},[n,l]),r!==l||n||(i(!0),window.history.replaceState(null,""," ")),r!==l&&n&&(window.location.hash=l),[n,i]}},8328767:e=>{"use strict";e.s({useRollingRelease:()=>r,useSuspenseRollingRelease:()=>i});var t=e.i(3521787),n=e.i(1654051);function i(e){let{teamIdOrSlug:t,projectSlug:n}=e;return r({teamIdOrSlug:t,projectSlug:n},{suspense:!0,revalidateOnMount:!1})}function r(e,i){let{teamIdOrSlug:r,projectSlug:l}=e,a=!r||!l,o=(0,t.default)(()=>a?null:(0,n.getRollingReleaseEndpoint)(r,l),n.rollingReleaseFetcher,i);return{...o,skipped:a,isLoading:!a&&o.isLoading}}},8271524:e=>{"use strict";e.s({useIsActive:()=>n});var t=e.i(6530772);function n(){let{timeout:e=3e4,debounce:n=100}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[i,r]=(0,t.useState)(!0),l=(0,t.useRef)(void 0);return(0,t.useEffect)(()=>{var t;let i,a=()=>r(!1),[o,s]=(t=()=>{r(!0),clearTimeout(l.current),l.current=setTimeout(a,e)},[function(){for(var e=arguments.length,r=Array(e),l=0;l<e;l++)r[l]=arguments[l];i&&clearTimeout(i),i=setTimeout(()=>t(...r),n)},()=>{i&&clearTimeout(i)}]),d=new AbortController,{signal:u}=d;return l.current=setTimeout(a,e),window.addEventListener("focusin",o,{signal:u}),window.addEventListener("mousemove",o,{signal:u,passive:!0}),window.addEventListener("touchstart",o,{signal:u,passive:!0}),window.addEventListener("keydown",o,{signal:u}),()=>{d.abort(),s(),clearTimeout(l.current)}},[e,n]),i}},4896100:e=>{"use strict";e.s({DEPLOYMENTS_PROJECT_API_PARAMS:()=>n,useDeploymentsPageRefreshInterval:()=>i});var t=e.i(8271524);let n={apiVersion:"v10",latestDeployments:10,activeBranches:!0,fetchParams:{rollbackInfo:!0}};function i(){return(0,t.useIsActive)()?8e3:3e4}},7696797:e=>{"use strict";e.s({Attribute:()=>l});var t=e.i(6645307),n=e.i(1235226),i=e.i(5163670),r=e.i(5610210);function l(e){let{title:n,children:i,className:a,...o}=e;return(0,t.jsxs)("div",{className:(0,r.clsx)("flex flex-col gap-1",a),...o,children:[n?(0,t.jsx)(l.Title,{children:n}):null,i]})}l.Title=function(e){let{children:n}=e;return(0,t.jsx)("span",{className:"text-label-14 text-gray-900",children:n})},l.Item=function(e){let{children:i,Icon:r,mono:l=!1,className:a,...o}=e;return(0,t.jsxs)("div",{className:(0,n.twMerge)("flex h-5 items-center gap-2 whitespace-nowrap [&>*]:text-ellipsis",l?"text-label-13-mono":"text-label-14",a),...o,children:[r?(0,t.jsx)(r,{className:"flex-none",color:"gray-900"}):null,i]})},l.ItemSkeleton=function(e){let{width:n=128}=e;return(0,t.jsx)(l.Item,{children:(0,t.jsx)(i.Skeleton,{height:16,width:n})})}},6858714:[e=>{"use strict";e.s({ChooseDeploymentList:()=>E,REASON_MAX_CHARACTER_LENGTH:()=>N,RollbackDescriptionCard:()=>R,RollbackDescriptionTextarea:()=>M,defaultDeploymentExpiration:()=>w,generateDeploymentRetentionRequestBody:()=>I,getDaysFromOption:()=>A,getDeploymentId:()=>D,getMostRecentlyPromotedDeployment:()=>k,isDeleted:()=>P,retentionOptions:()=>C,useIsUndoRollback:()=>L},6858714);var t=e.i(6645307),n=e.i(8084653),i=e.i(5674541),r=e.i(7918027),l=e.i(1766200);e.s({DeploymentCardSmall:()=>j},1000863);var a=e.i(3921802),o=e.i(889716),s=e.i(2362802),d=e.i(869010),u=e.i(3920197),c=e.i(3138389),m=e.i(9385465),h=e.i(2774739),f=e.i(5610210),p=e.i(587741),g=e.i(5196742),x=e.i(1628584),y=e.i(6700141);function v(e){let{isForm:n,children:i,className:r}=e;return n?(0,t.jsx)("label",{className:r,children:i}):(0,t.jsx)("div",{className:r,children:i})}function j(e){let{deployment:i,isForm:r,isPromote:l,isPreviousDeployment:j,isProductionDeployment:b,isRolledBackDeployment:T,selectedDeployment:w,setSelectedDeployment:C,ariaLabel:A="Rollback Deployment"}=e,S=(0,h.useAgo)(i.createdAt||0),I="number"==typeof i.aliasAssigned?i.aliasAssigned:0,L=I>0,D=(0,h.useAgo)(I),P=(0,p.useDeploymentLink)(i),R=(0,g.getGitInfoFromDeployment)(i),{value:E}=(0,y.useEnableNewInstantRollbackFlow)();E||(T=!1);let k=b||j||T;j&&T&&(j=!1);let N="Preview";if("target"in i)switch(i.target){case"staging":N="Staging";break;case"production":N="Production";break;default:N="Preview"}else N="Production";let M="uid"in i?i.uid:i.id,O=null;l?R?.commitRef&&(O=(0,t.jsxs)(o.Stack,{align:"center",direction:"row",gap:.5,children:[(0,t.jsx)(c.GitBranch,{color:"gray-900"}),(0,t.jsx)(n.Text,{as:"span",color:"gray-900",monospace:!0,style:{marginRight:"4px",maxWidth:120,textOverflow:"ellipsis",overflowX:"hidden",minWidth:0},title:R.commitRef,truncate:!0,wrap:!1,children:R.commitRef}),(0,t.jsxs)(n.Text,{as:"span",className:"flex items-center gap-1",color:"gray-900",style:{flexBasis:"50%",flexShrink:0,flexGrow:1,textOverflow:"ellipsis",overflowX:"hidden",minWidth:0,maxWidth:260},truncate:!0,wrap:!1,children:["Staged"," ",S," by"," ",(0,t.jsx)("span",{children:(0,t.jsx)(x.CreatorAvatar,{deployment:i,showProviderIcon:!0,size:24})}),(0,t.jsx)("span",{className:"font-medium",children:!i.meta?.originalDeploymentId&&i.creator?.username?`@${i.creator.username}`:R.commitAuthorLogin})]})]})):O=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"inline-flex flex-row items-center",children:[(0,t.jsx)(n.Text,{as:"span",color:"gray-900",size:14,style:{marginRight:"4px"},children:N}),R?.commitRef?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.GitBranch,{color:"gray-900",size:14}),(0,t.jsx)(n.Text,{as:"span",className:"max-w-[100px] truncate whitespace-nowrap px-1 text-center text-sm leading-5 text-gray-900",monospace:!0,title:R.commitRef,children:R.commitRef}),(0,t.jsx)(n.Text,{as:"span",color:"gray-900",children:"by"}),(0,t.jsxs)("div",{className:"ml-1 inline-flex flex-row items-center gap-1",children:[(0,t.jsx)(x.CreatorAvatar,{deployment:i,size:20}),(0,t.jsx)(n.Text,{as:"span",className:"max-w-[140px] truncate",color:"gray-900",truncate:!0,weight:500,children:!i.meta?.originalDeploymentId&&i.creator?.username?`@${i.creator.username}`:R.commitAuthorLogin})]})]}):null]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(n.Text,{as:"span",color:"gray-900",size:14,children:["Deployed"," "]}),(0,t.jsx)(n.Text,{as:"span",color:"gray-900",size:14,children:S}),(0,t.jsxs)(n.Text,{as:"span",color:"gray-900",size:14,children:[","," "]}),L?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.Text,{as:"span",color:"gray-900",size:14,children:["promoted"," "]}),(0,t.jsx)(n.Text,{as:"span",color:"gray-900",size:14,children:D})]}):(0,t.jsx)(n.Text,{as:"span",color:"gray-900",size:14,children:"never promoted"})]})]});let _=null;return r||(_=l?(0,t.jsx)(d.ArrowCircleUp,{className:"mr-4 hidden self-center sm:block",style:{flexShrink:0}}):b?(0,t.jsx)(u.CrossCircle,{className:"mr-4 hidden self-center sm:block",style:{flexShrink:0}}):(0,t.jsx)(m.RotateCounterClockwise,{className:"mr-4 hidden self-center sm:block",color:"gray-1000",style:{flexShrink:0}})),(0,t.jsxs)(v,{className:(0,f.clsx)("flex w-full items-end justify-start px-4 py-3","rounded border border-solid border-[var(--accents-2)]","rounded-b-none","last:rounded-b","[&+&]:rounded-t-none [&+&]:border-t-0",{"bg-[var(--accents-1)] shadow-none":b,"bg-[var(--geist-background)]":!b}),isForm:r,children:[r?(0,t.jsx)("input",{"aria-label":A,checked:w?.uid===M,className:`
            relative m-0 mr-4 size-4 shrink-0 appearance-none
            self-center rounded-[1000px] border
            border-solid border-[var(--geist-foreground)] after:absolute after:inset-[3px]
            after:rounded-[1000px] after:bg-[var(--geist-foreground)]
            after:content-none checked:after:content-['']
          `,name:"rollbackDeployment",onChange:()=>{"uid"in i&&"type"in i&&C&&C(i)},type:"radio",value:M}):_,(0,t.jsxs)("div",{style:{width:k?"initial":"100%",minWidth:0},children:[(0,t.jsx)(s.Link,{className:"flex w-[calc(100%-1ch)] items-center gap-0.5 break-all text-sm font-bold leading-5",href:P,target:"_blank",children:(0,t.jsx)(n.Text,{as:"span",title:i.url,truncate:1,weight:500,children:i.url})}),R?.commitMessage?(0,t.jsxs)(n.Text,{as:"p",className:"break-words",color:"gray-900",size:14,title:R.commitMessage,truncate:1,children:[R.commitSha.substring(0,7)," ",R.commitMessage]}):null,O]}),b?(0,t.jsx)(a.Badge,{className:"ml-auto hidden self-start text-xs font-medium sm:inline-flex",variant:"inverted",children:"Current"}):null,j?(0,t.jsx)(a.Badge,{className:"ml-auto hidden self-start text-xs font-medium sm:inline-flex",variant:"gray-subtle",children:"Previous"}):null,T?(0,t.jsx)(a.Badge,{className:"ml-auto hidden self-start text-xs font-medium sm:inline-flex",variant:"red-subtle",children:"Rolled back"}):null]})}var b=e.i(5300522),T=e.i(5378884);function w(){return{expirationDays:36500,expirationDaysProduction:36500,expirationDaysCanceled:30,expirationDaysErrored:36500}}let C=[{days:36500,label:"Unlimited",value:"unlimited"},{days:365,label:"1 year",value:"1y"},{days:180,label:"180 days",value:"6m"},{days:90,label:"90 days",value:"3m"},{days:60,label:"60 days",value:"2m"},{days:30,label:"30 days",value:"1m"},{days:7,label:"1 week",value:"1w"},{days:1,label:"1 day",value:"1d"}];function A(e){for(let{days:t}of C)if(t===e)return t;return null}function S(e){if("number"!=typeof e)return null;for(let{days:t,value:n}of C)if(t===e)return n;return null}function I(e){let t={},n=S(e.expirationDays);n&&(t.expiration=n);let i=S(e.expirationDaysCanceled);i&&(t.expirationCanceled=i);let r=S(e.expirationDaysErrored);r&&(t.expirationErrored=r);let l=S(e.expirationDaysProduction);return l&&(t.expirationProduction=l),t}let L=e=>{let{projectId:t,deployment:n}=e,{data:i}=(0,l.default)({projectId:t,target:"production",limit:1}),r=i?.deployments[0];return void 0!==n&&r?.uid===D(n)};function D(e){return"id"in e?e.id:"uid"in e?e.uid:void 0}function P(e){return void 0!==e.deleted}function R(e){let{rollbackDescription:i,project:r}=e,l=(0,h.useAgo)(i.createdAt);return(0,t.jsxs)("div",{className:"rounded bg-background-200 px-4 py-3 shadow-border",children:[(0,t.jsx)(n.Text,{className:"break-words",color:"gray-900",children:i.description.length>0?(0,t.jsxs)(t.Fragment,{children:["“",(0,t.jsx)(b.LinkParser,{text:i.description}),"”"]}):(0,t.jsx)(n.Text,{children:"No rollback explanation provided"})}),(0,t.jsxs)("div",{className:"flex gap-1 pt-1",children:[(0,t.jsx)(n.Text,{children:"Rolled back by"}),i.username?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(T.PrincipalAvatar,{size:20,principalId:i.userId,principal:{type:"user",uid:i.userId,username:i.username}}),(0,t.jsxs)(n.Text,{weight:500,children:["@",i.username]}),r?.lastAliasRequest!==void 0&&(0,t.jsx)(n.Text,{children:l})]}):null]})]})}function E(e){let{deployments:n,previousDeployment:r,rolledBackDeploymentId:l,productionDeployment:a,selectedDeployment:o,setSelectedDeployment:s,swr:d,ariaLabel:u}=e;return(0,t.jsxs)(t.Fragment,{children:[n.map(e=>a.id!==e.uid&&(0,t.jsx)(j,{deployment:e,isForm:!0,isPreviousDeployment:r?.uid===e.uid,isRolledBackDeployment:l===e.uid,selectedDeployment:o,setSelectedDeployment:s,ariaLabel:u},e.uid)),!d.isReachingEnd&&(0,t.jsx)(i.Button,{loading:d.isLoadingMore,onClick:()=>{d.loadMore()},style:{marginTop:24},type:"secondary",width:"100%",children:"Show More"})]})}function k(e){if(0===e.length)return;let t=e.reduce((e,t)=>e.aliasAssigned&&t.aliasAssigned?e.aliasAssigned>t.aliasAssigned?e:t:t.aliasAssigned?t:e);if(t.aliasAssigned)return t}let N=250;function M(e){let{value:n,onChange:i,id:l}=e;return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(r.Textarea,{autoFocus:!0,className:"min-h-24 text-base",error:n.length>=N?`Reason cannot be longer than ${N} characters.`:void 0,id:l,onChange:e=>i(e.target.value),placeholder:"Production is not behaving as expected...",required:!0,value:n})})}},[1000863]],1562781:[e=>{"use strict";e.s({default:()=>V,usePromoteDeployment:()=>Z,usePromoteTooltip:()=>U},1562781);var t=e.i(6645307),n=e.i(6530772),i=e.i(7315479),r=e.i(5535439),l=e.i(2362802),a=e.i(8247297),o=e.i(1917237),s=e.i(1268665),d=e.i(8934201),u=e.i(8158100),c=e.i(5163670),m=e.i(8811733),h=e.i(889716),f=e.i(8084653),p=e.i(584439),g=e.i(5528554),x=e.i(8554037),y=e.i(1164214),v=e.i(6649026),j=e.i(1183506),b=e.i(9336536),T=e.i(1316720),w=e.i(5454140),C=e.i(3514588),A=e.i(7320579),S=e.i(6700141),I=e.i(878537),L=e.i(3184563),D=e.i(587741),P=e.i(9505396);function R(e){if(!e)return;if("id"in e==!1)return e;let{aliasAssigned:t,aliasError:n=null,aliasAssignedAt:i,buildingAt:r,created:l=e.createdAt,createdAt:a,creator:o,name:s,ready:d,state:u="BUILDING",readyState:c,readySubstate:m,target:h=null,uid:f=e.id,url:p,isRollbackCandidate:g="production"===e.target}=e;return{aliasAssigned:t,aliasError:n,aliasAssignedAt:i,buildingAt:r,created:l,createdAt:a,creator:{email:"",githubLogin:"",...o},name:s,ready:d,state:u,readyState:c,readySubstate:m,target:h,type:"LAMBDAS",uid:f,url:p,isRollbackCandidate:g}}e.s({asListDeployment:()=>R},594689);var E=e.i(9533270),k=e.i(6858714),N=e.i(44994),M=e.i(5300522),O=e.i(4896100),_=e.i(2782408),$=e.i(1000863),B=e.i(8371532),F=e.i(8328767),H=e.i(2240289);function U(e){let t=e?.name,{deployment:i,isLoading:r}=(0,L.useProjectProductionDeployment)(t);return(0,n.useMemo)(()=>{let t=R(e);return t?r?"Loading...":t.uid===i?.id?"This Deployment is already in Production.":"readyState"in t&&"READY"!==t.readyState?"Only Deployments that are Ready can be promoted.":"":""},[e,r,i?.id])}function W(e){let{title:n}=e;return(0,t.jsx)(d.Modal.Header,{children:(0,t.jsx)(d.Modal.Title,{center:!0,children:n})})}function z(e){let{deploymentId:n}=e,i=(0,x.useCiChecksAndPoliciesFlag)(),{data:r,isLoading:a}=(0,T.useProjectCheckRuns)({deploymentId:n,enableCiChecksAndPolicies:i});if(!i)return null;if(a)return(0,t.jsx)(c.Skeleton,{});if(r?.runs.every(e=>"succeeded"===e.conclusion))return null;let o=r?.runs.filter(e=>"succeeded"!==e.conclusion)||[];return(0,t.jsxs)(u.Note,{type:"error",fill:!0,className:"mt-6",children:["By clicking Promote, you acknowledge that you are bypassing promotion requirements:",o.length>0&&(0,t.jsx)("ul",{className:"flex flex-col gap-1 ml-4 list-disc",children:o.slice(0,5).map(e=>(0,t.jsx)("li",{children:e.externalUrl?(0,t.jsx)(l.Link,{href:e.externalUrl,external:!0,children:e.name}):(0,t.jsx)("span",{children:e.name})},e.id||e.name||`${e.conclusion}-${e.status}`))})]})}function V(e,i){let{onDeploymentPromoted:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},[c,p]=(0,n.useState)(!1),[x,v]=(0,n.useState)(null),{team:j}=(0,C.useTeam)(),b=e??x?.name,{data:T}=(0,H.useProject)(b,M.INSTANT_ROLLBACK_PROJECT_API_PARAMS),A=i??T,D=(0,E.useShowIgnoreBuildStep)({project:A,deployment:x}),[R,N]=(0,n.useState)(B.DEFAULT_USE_IGNORE_BUILD_STEP_PROMOTE),{value:O}=(0,S.useEnableNewInstantRollbackFlow)(),_=(0,n.useCallback)(()=>{p(!1)},[]),{error:U,loading:V,promote:Y,setError:G,setLoading:K}=Z({deployment:x,useIgnoreBuildStep:R,project:A,onCurrentDeploymentPromoted:(0,n.useCallback)(()=>{_(),r?.()},[_,r])}),{user:J}=(0,w.useUser)(),{data:q}=(0,F.useRollingRelease)({teamIdOrSlug:j?.slug,projectSlug:b}),X=A?.rollingRelease?.stages!==void 0&&A.rollingRelease.stages.length>0,Q=q?.rollingRelease?.state==="ACTIVE",ee=q?.rollingRelease?.canaryDeployment?.id,et=Q&&ee===x?.uid,en=X&&!Q&&x?.target==="production",ei=X&&Q&&x?.target==="production",er=en&&A.rollingRelease?.stages!==void 0?A.rollingRelease.stages[0]?.targetPercentage:null,{data:el}=(0,P.useProjectDomains)(b,{limit:11,production:"true",redirects:"false",verified:"true",order:"ASC"}),ea=(0,n.useCallback)(e=>{v(e),p(!0)},[]),eo=(0,n.useCallback)(()=>{K(!1),v(null),G(void 0)},[G,K]),{deployment:es,isLoading:ed,rollbackDescription:eu,deploymentIsStale:ec}=(0,L.useProjectProductionDeployment)(A?.name),{andMoreDomains:em,remainingDomains:eh}=(0,n.useMemo)(()=>{if(!el)return{andMoreDomains:!1,remainingDomains:[]};let e=el.length>2,t=e?el.slice(2).map(e=>e.name):[];return{andMoreDomains:e,remainingDomains:t}},[el]),ef=(0,n.useMemo)(()=>{if(!A||!x)return(0,t.jsx)(I.default,{center:!0,style:{marginTop:10},children:(0,t.jsx)(s.LoadingDots,{size:4})});let e=!!(el&&el.length>0);return(0,t.jsxs)(t.Fragment,{children:["production"===x.target?(0,t.jsx)(f.Text,{as:"p",style:{marginBottom:"16px"},weight:400,children:"Deployment to promote:"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.Text,{as:"p",style:{marginBottom:"16px"},children:"A new deployment will be built using your production environment."}),(0,t.jsx)(f.Text,{as:"p",style:{marginBottom:"16px"},weight:400,children:"Deployment to promote to production:"})]}),(0,t.jsx)("div",{children:(0,t.jsx)($.DeploymentCardSmall,{deployment:x,isPromote:!0,selectedDeployment:null})}),en?(0,t.jsxs)(f.Text,{as:"p",style:{marginBottom:16,marginTop:24},children:["This will start a new rolling release with initial traffic of"," ",er,"%."]}):null,ei?(0,t.jsx)(f.Text,{as:"p",style:{marginBottom:16,marginTop:24},children:"This will queue the deployment for promotion after the current rolling release completes."}):null,en||ei||!e?null:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.Text,{as:"p",style:{marginBottom:16,marginTop:24},weight:400,children:"It will be aliased to the following domains:"}),(0,t.jsx)(h.Stack,{gap:2,style:{paddingLeft:12},children:el?.slice(0,2).map(e=>{let{name:n}=e;return(0,t.jsx)(f.Text,{as:"p",children:(0,t.jsxs)(h.Stack,{align:"center",direction:"row",gap:3,children:[(0,t.jsx)(g.CheckCircleFill,{color:"blue-700",size:20}),(0,t.jsx)("span",{children:n.startsWith("*")?n:(0,t.jsx)(l.Link,{"data-testid":(0,y.tid)("deployments","promote-to-production-overlay","preview-link"),external:!0,href:`https://${n}`,variant:"highlight",children:n})})]})},n)})}),em?(0,t.jsxs)(f.Text,{as:"p",className:"mt-6 mb-4",children:["...and ",eh.length," more"]}):null]}),!en&&!e&&(0,t.jsxs)(f.Text,{as:"p",style:{marginBottom:"24px",marginTop:"24px"},children:["Warning: Your Project does not have a Production Domain. We recommend you"," ",(0,t.jsx)(l.Link,{href:`/${j?j.slug:J?.username}/${encodeURIComponent(A.name)}/settings/domains`,variant:"highlight",children:"add"})," ","one."]}),A.link&&x.gitSource?(0,t.jsx)(z,{deploymentId:x.id}):null,D?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.Spacer,{y:1}),(0,t.jsx)(a.Checkbox,{checked:R,fullWidth:!0,onChange:()=>{N(!R)},children:"Use project's Ignore Build Step"})]}):null,et?(0,t.jsx)(u.Note,{className:" border border-[#fde68a] bg-[#fffbeb] text-[#bd5200] dark:border-[#411d06] dark:bg-[#241005] dark:text-[#fde68a] ",fill:!0,size:"small",style:{marginTop:24},type:"warning",variant:"contrast",children:(0,t.jsx)(h.Stack,{align:"center",direction:"row",gap:4,style:{padding:1},children:(0,t.jsx)(h.Stack,{align:"start",children:(0,t.jsx)(f.Text,{as:"p",color:"inherit",children:"This will complete the rolling release for this deployment."})})})}):null,ec?(0,t.jsx)(u.Note,{className:" border border-[#fde68a] bg-[#fffbeb] text-[#bd5200] dark:border-[#411d06] dark:bg-[#241005] dark:text-[#fde68a] ",fill:!0,size:"small",style:{marginTop:24},type:"warning",variant:"contrast",children:(0,t.jsx)(h.Stack,{align:"center",direction:"row",gap:4,style:{padding:1},children:(0,t.jsx)(h.Stack,{align:"start",children:(0,t.jsx)(f.Text,{as:"p",color:"inherit",children:en?"Completing the Rolling Release will undo the current Instant Rollback":"This action will undo the current Instant Rollback"})})})}):null,O&&eu?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.Text,{as:"p",style:{marginBottom:16,marginTop:24},children:"Rollback Details:"}),(0,t.jsx)(k.RollbackDescriptionCard,{rollbackDescription:eu,project:A})]}):null]})},[em,eh,el,A,j,J,x,R,D,ec,eu,O,er,en,ei,et]),ep=(0,n.useMemo)(()=>(0,t.jsx)(d.Modal.Action,{"data-testid":(0,y.tid)("deployments","promote-to-production-overlay","confirm-button"),loading:V,onClick:Y,children:x&&"target"in x&&"production"===x.target?"Promote":"Promote to Production"}),[Y,V,x]);return{modal:(0,n.useMemo)(()=>(0,t.jsxs)(d.Modal.Modal,{active:c,"data-testid":(0,y.tid)("deployments","promote-to-production-overlay"),onAnimationDone:eo,onClickOutside:_,sticky:!0,width:"500px",children:[(0,t.jsxs)(d.Modal.Body,{children:[(0,t.jsx)(W,{title:ei?"Queue for Promotion":x&&"target"in x&&"production"!==x.target?"Promote to Production":"Promote"}),ef,U?(0,t.jsx)(o.Error,{error:U}):null]}),(0,t.jsxs)(d.Modal.Actions,{children:[(0,t.jsx)(d.Modal.Action,{"data-testid":(0,y.tid)("deployments","promote-to-production-overlay","cancel-button"),loading:!1,onClick:_,type:"secondary",children:"Cancel"}),ep]})]}),[c,eo,_,ef,U,ep,ei,x]),close:_,open:ea}}let Z=e=>{let{deployment:t,project:l,useIgnoreBuildStep:a,onCurrentDeploymentPromoted:o}=e,s=(0,p.useToasts)(),d=(0,r.useRouter)(),{team:u}=(0,C.useTeam)(),{user:c}=(0,w.useUser)(),{mutate:m}=(0,A.useSWRConfig)(),[h,f]=(0,n.useState)(!1),[g,x]=(0,n.useState)(void 0),y=(0,E.useShowIgnoreBuildStep)({project:l,deployment:t});return{promote:(0,n.useCallback)(async()=>{if(t&&l){f(!0),x(void 0);try{let e,n=u?.id,i="Promoted Deployment successfully.";if("production"===t.target)await (0,j.fetchAPI)(`${(0,b.API_DEPLOYMENT_PROMOTE)(l.id,t.uid||t.id)}${(0,v.encode)({teamId:n})}`,{method:"POST",body:{},throwOnHTTPError:!0}),e=(0,D.pathFromDeployment)(t,{user:c,team:u});else{let r=await (0,j.fetchAPI)(`${(0,b.API_DEPLOYMENTS)("v13")}${(0,v.encode)({teamId:n,skipIgnoreBuildStep:y&&!a?"1":null})}`,{method:"POST",body:JSON.stringify({deploymentId:t.uid||t.id,meta:{action:"promote"},name:l.name,target:"production"}),throwOnHTTPError:!0});e=(0,D.pathFromDeployment)(r,{user:c,team:u});let o=t.uid||t.id;i="production"===t.target?o===r.id?"Deployment is already the current Production Deployment.":"Promoted Deployment to Production successfully.":"Created Production Deployment successfully."}u&&(m((0,N.getProjectKey)(l.name,{...M.INSTANT_ROLLBACK_PROJECT_API_PARAMS,teamId:u.slug})),m((0,N.getProjectKey)(l.name,{...O.DEPLOYMENTS_PROJECT_API_PARAMS,teamId:u.slug})),await m((0,_.getProjectProductionDeploymentKey)({projectIdOrName:l.id,teamId:u.slug}))),s.success({text:i,key:"production-deployment"}),e&&(e===location.pathname?o?.():d.push(e))}catch(e){x((0,i.normalizeError)(e))}finally{f(!1)}}},[t,l,d,y,u,s,a,c,m,o]),loading:h,setLoading:f,error:g,setError:x}}},[594689]]}]);

//# sourceMappingURL=c28dcb0c5486d51e.js.map
//# debugId=cd728747-6f4e-5fc3-8ce0-5b63b0bd6318
