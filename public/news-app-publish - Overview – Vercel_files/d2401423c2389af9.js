
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="0db05f38-2a81-5348-82e7-0145faeeb3ab")}catch(e){}}();
(globalThis.TURBOPACK=globalThis.TURBOPACK||[]).push(["object"==typeof document?document.currentScript:void 0,{6114962:e=>{"use strict";e.s({BillingCardFieldset:()=>D,BillingCardSkeleton:()=>U,CardIcon:()=>G});var a=e.i(6645307),t=e.i(2531953),i=e.i(6530772),r=e.i(3921802),n=e.i(5674541),s=e.i(6531164),l=e.i(2631460),d=e.i(663357),o=e.i(8448595),c=e.i(611347),u=e.i(7238633),m=e.i(4105925),h=e.i(8934201),x=e.i(5163670),p=e.i(8350390),y=e.i(8084653),g=e.i(584439),C=e.i(1164214),b=e.i(6944370),f=e.i(9336536),j=e.i(6031903),v=e.i(6530145),T=e.i(6083415),S=e.i(7281916),w=e.i(6984098),N=e.i(9024310),k=e.i(5528554),M=e.i(5165976),A=e.i(5859416),I=e.i(2270026),_=e.i(503726),R=e.i(3585235),P=e.i(5785123);e.i(7597982);var E=e.i(9598711),B=e.i(287394),O=e.i(7857565),F=e.i(7150089),$=e.i(9551456),L=e.i(1343577);function D(){let{team:e,mutate:h}=(0,_.useAccount)(),{can:x}=(0,R.default)(),y=x(P.Action.Update,P.Resource.PaymentMethod),T=x(P.Action.Read,P.Resource.PaymentMethod),S=(0,A.useIsMobile)(),w=(0,F.useStripeSources)({enabled:!0}),B=w.data?.defaultSource,D=(0,i.useMemo)(()=>(w.data?.sources||[]).sort((e,a)=>e.id.localeCompare(a.id)),[w]),U=D.length>0,[V,z]=(0,i.useState)(!1),[q,K]=(0,i.useState)(!1),[H,W]=(0,i.useState)({active:!1,card:null,requiresNewCard:!1}),[Z,J]=(0,i.useState)(null),X=e?.billing?.awsMarketplace,Q=(0,g.useToasts)();async function ee(e){let a=e?.id?`${f.API_BILLING}/validate-payment-method-removal?teamId=${e.id}`:`${f.API_BILLING}/validate-payment-method-removal`,t=await (0,j.fetchApi)(a,{method:"GET",throwOnHTTPError:!0});return t&&"string"!=typeof t?t:{result:!1,reasons:[]}}let ea=(0,i.useMemo)(()=>async(e,a)=>{let t=1===e.length&&a?.billing?.plan!=="enterprise";if((a?.id&&a.billing?.plan==="hobby"||!a)&&1===e.length){let{reasons:e}=await ee(a);if(e.length>0)switch(e[0]){case"not-hobby-plan":Q.error("You cannot remove your last payment method, because you are not on a hobby plan.");break;case"has-open-invoice":Q.error("You cannot remove your last payment method, because you have an open invoice.");break;case"has-domains":Q.error("You cannot remove your last payment method, because you have domains.");break;case"has-marketplace-integrations":Q.error("You cannot remove your last payment method, because you have billable marketplace integrations.");break;case"has-v0-premium-sub":Q.error("You cannot remove your last payment method, because you have a v0 subscription.");break;case"has-v0-team-seats":Q.error("You cannot remove your last payment method, because you have v0 team seats.");break;case"has-draft-invoice":Q.error("You cannot remove your last payment method, because you have a draft invoice.")}t=e.length>0}return t},[Q]),et=async a=>{W({active:!0,card:a,requiresNewCard:await ea(D,e)})},ei=async()=>{await Promise.all([h(),w.mutate()]),K(!1),H.card&&(er(H.card.id,!0),W({...H,active:!1}))},er=async(a,t)=>{let i=e?`?teamId=${encodeURIComponent(e.id)}`:"";z(!0);try{let e=await (0,b.default)(`${f.API_STRIPE_PAYMENT_METHODS}${i}`,{method:t?"DELETE":"POST",body:JSON.stringify({paymentMethod:a,makeDefault:!t||void 0})});if(e.error)return J(e.error.message);await w.mutate()}finally{z(!1)}};return(0,a.jsxs)("div",{id:"payment-method",className:"jsx-efc69a07e34f3d23",children:[(0,a.jsxs)(c.Fieldset,{disabled:!y,children:[(0,a.jsxs)(s.FieldsetContent,{children:[(0,a.jsx)(L.FieldsetTitle,{id:$.PERSONAL_ACCOUNT_SETTINGS_NAVIGATION_TITLES.billing.paymentMethod,children:$.PERSONAL_ACCOUNT_SETTINGS_NAVIGATION_TITLES.billing.paymentMethod}),(0,a.jsxs)(p.FieldsetSubtitle,{children:[X?"A card will be used for purchases of items outside of your AWS Marketplace contract. ":null,"Payments for domains, add-ons, and other usage are made using the default card."]}),(0,a.jsx)("div",{className:"jsx-efc69a07e34f3d23 h-[159px]",children:U||!T?(0,a.jsx)(v.Table,{children:(0,a.jsx)(v.Table.Body,{children:T?D.map(e=>{let{card:t}=e;if(!t)return null;let i=e.id===B;return(0,a.jsxs)(v.Table.Row,{className:"border-t",children:[(0,a.jsx)(v.Table.Cell,{className:"text-gray-1000",children:(0,a.jsxs)("span",{className:"jsx-efc69a07e34f3d23 flex items-center gap-x-2",children:[(0,a.jsx)(G,{brand:t.brand}),S?`••••
                              ${t.last4}`:`${(0,O.cardBrand)(t.brand)} ${t.funding} ••••
                              ${t.last4}`,i?(0,a.jsx)(r.Badge,{icon:(0,a.jsx)(k.CheckCircleFill,{}),variant:y?"blue-subtle":"gray-subtle",children:"Default"}):null]})}),S?null:(0,a.jsxs)(v.Table.Cell,{className:"text-right text-gray-1000",children:["Valid until ",t.exp_month,"/",t.exp_year]}),(0,a.jsx)(v.Table.Cell,{className:"w-[3%]",children:(0,a.jsxs)(l.DotsMenu,{children:[i?null:(0,a.jsx)(m.MenuItem,{onClick:()=>{er(e.id).catch(I.captureError)},children:"Make Default"}),(0,a.jsx)(m.MenuItem,{onClick:()=>{et(e)},type:"error",children:"Remove"})]})})]},e.id)}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(v.Table.Row,{className:"border-t",children:[(0,a.jsx)(v.Table.Cell,{children:(0,a.jsxs)("span",{className:"jsx-efc69a07e34f3d23 flex items-center gap-x-2",children:[(0,a.jsx)(N.CreditCard,{}),"••••"]})}),(0,a.jsx)(v.Table.Cell,{className:"text-right",children:"••/••••"}),(0,a.jsx)(v.Table.Cell,{className:"w-[3%]",children:(0,a.jsx)(M.LockClosed,{})})]}),(0,a.jsxs)(v.Table.Row,{className:"border-t",children:[(0,a.jsx)(v.Table.Cell,{children:(0,a.jsxs)("span",{className:"jsx-efc69a07e34f3d23 flex items-center gap-x-2",children:[(0,a.jsx)(N.CreditCard,{}),"••••"]})}),(0,a.jsx)(v.Table.Cell,{className:"text-right",children:"••/••••"}),(0,a.jsx)(v.Table.Cell,{className:"w-[3%]",children:(0,a.jsx)(M.LockClosed,{})})]})]})})}):(0,a.jsx)(d.EmptyState.Root,{description:"No payment methods added",icon:(0,a.jsx)(d.EmptyState.Icon,{icon:(0,a.jsx)(N.CreditCard,{size:32})}),paddingY:26})})]}),(0,a.jsxs)(u.FieldsetFooter,{disabled:!1,children:[(0,a.jsx)(u.FieldsetFooter.Status,{children:Z?(0,a.jsxs)(o.ErrorText,{children:[Z," – Please try again later."]}):y?"At most, three credit cards can be added.":"You need additional permissions to manage your team's payment method."}),y?(0,a.jsx)(u.FieldsetFooter.Actions,{children:(0,a.jsx)(n.Button,{className:"add-new-card","data-testid":(0,C.tid)("account-settings","billing","add-new-card"),disabled:D.length>=3,loading:V,onClick:()=>{V||K(!0)},size:"small",children:"Add Card"})}):null]})]}),(0,a.jsx)(E.CreditCardModal,{isActive:q,onAbort:()=>{K(!1)},onContinue:()=>void ei(),paying:!1}),(0,a.jsx)(Y,{cardToRemove:H.card,isActive:H.active,onCancel:()=>W({...H,active:!1}),onCancelDone:()=>W({...H,card:null}),onContinue:()=>{H.requiresNewCard?ei():(er(H.card.id,!0),W({...H,active:!1}))},requiresNewCard:H.requiresNewCard}),(0,a.jsx)(t.default,{id:"efc69a07e34f3d23",children:".table th{text-transform:uppercase}@media (min-width:768px){.table .shown-on-mobile{display:none}}@media (max-width:768px){.table .column-brand,.table .column-type,.table .column-exp,.table .hidden-on-mobile{display:none}.table .shown-on-mobile{white-space:nowrap}}"})]})}function U(e){let{canUpdatePaymentMethod:t}=e;return(0,a.jsx)("div",{id:"payment-method",children:(0,a.jsxs)(c.Fieldset,{disabled:!t,children:[(0,a.jsxs)(s.FieldsetContent,{children:[(0,a.jsx)(L.FieldsetTitle,{id:$.PERSONAL_ACCOUNT_SETTINGS_NAVIGATION_TITLES.billing.paymentMethod,children:$.PERSONAL_ACCOUNT_SETTINGS_NAVIGATION_TITLES.billing.paymentMethod}),(0,a.jsx)(p.FieldsetSubtitle,{children:"Payments for domains, add-ons, and other usage are made using the default card."}),(0,a.jsx)("div",{className:"h-[159px]",children:(0,a.jsx)(v.Table,{children:(0,a.jsx)(v.Table.Body,{children:[,,].fill(null).map((e,t)=>(0,a.jsxs)(v.Table.Row,{className:"border-t border-t-gray-alpha-400",children:[(0,a.jsx)(v.Table.Cell,{children:(0,a.jsxs)("span",{className:"flex items-center gap-x-2",children:[(0,a.jsx)(x.Skeleton,{height:16,width:16}),(0,a.jsx)(x.Skeleton,{height:16,width:156})]})}),(0,a.jsx)(v.Table.Cell,{className:"flex justify-end text-right",children:(0,a.jsx)("span",{className:"flex h-8 items-center",children:(0,a.jsx)(x.Skeleton,{height:16,width:128})})}),(0,a.jsx)(v.Table.Cell,{className:"w-[3%]",children:(0,a.jsx)("span",{className:"flex h-8 items-center",children:(0,a.jsx)(x.Skeleton,{height:16,width:16})})})]},t))})})})]}),(0,a.jsx)(u.FieldsetFooter,{disabled:!1,children:void 0===t?(0,a.jsx)(x.Skeleton,{height:22,width:480}):t?"At most, three credit cards can be added.":"You need additional permissions to manage your team's payment method."})]})})}function Y(e){let{isActive:t,cardToRemove:i,requiresNewCard:r,onCancel:n,onCancelDone:s,onContinue:l}=e,d=i?.card;return r?(0,a.jsx)(B.default,{active:t,description:(0,a.jsxs)(a.Fragment,{children:["You cannot remove"," ",(0,a.jsxs)(y.Text,{as:"span",weight:700,children:[(0,O.cardBrand)(d?.brand)," ****",d?.last4]})," ","without adding a new payment method first."]}),onAdded:l,onAnimationDone:s,onCancel:n,title:"Remove Payment Method"}):(0,a.jsxs)(h.Modal.Modal,{active:t,onAnimationDone:s,onClickOutside:n,children:[(0,a.jsxs)(h.Modal.Body,{children:[(0,a.jsx)(h.Modal.Title,{children:"Remove Payment Method"}),(0,a.jsxs)(h.Modal.Subtitle,{children:["You are about to remove"," ",(0,a.jsxs)(y.Text,{as:"span",weight:700,children:[(0,O.cardBrand)(d?.brand)," ****",d?.last4]})," ","from your account."]}),(0,a.jsx)(h.Modal.Subtitle,{children:"Are you sure you want to continue?"})]}),(0,a.jsxs)(h.Modal.Actions,{children:[(0,a.jsx)(h.Modal.Action,{onClick:n,type:"secondary",children:"Cancel"}),(0,a.jsx)(h.Modal.Action,{onClick:l,children:"Continue"})]})]})}function G(e){let{brand:t}=e;switch(t){case"visa":return(0,a.jsx)(S.LogoVisa,{});case"mastercard":return(0,a.jsx)(w.LogoMastercard,{});case"amex":return(0,a.jsx)(T.LogoAmex,{});default:return(0,a.jsx)(N.CreditCard,{})}}},6795435:e=>{"use strict";e.s({getStripe:()=>o,withBillingContext:()=>c});var a=e.i(6645307),t=e.i(5079737),i=e.i(5206011),r=e.i(2270026),n=e.i(503726),s=e.i(604868),l=e.i(3838439);let d=new Map;function o(e){if(!e)return Promise.resolve(null);let a=d.get(e);return a||(a=(0,i.loadStripe)(e).catch(a=>((0,r.captureError)(a),d.delete(e),null)),d.set(e,a)),a}let c=e=>{function i(i){let{account:r}=(0,n.useAccount)(),d=(0,l.default)(),c=(0,s.useMediaQuery)(600),u=`${c?16:14}px`,m=r?.billing?.platform==="stripeTestMode";return(0,a.jsx)(t.Elements,{options:{loader:"always",payment_method_types:["card"],appearance:{theme:d?"stripe":"night",variables:{colorBackground:d?"#fff":"#000",colorPrimary:d?"#000":"#fff",fontSizeBase:u}},currency:"usd",mode:"setup"},stripe:o(m?"pk_test_51KWTJcBQYfoTMhVJkeKojfST4MsShve9XJ7Seqw7mgZaUCeO1DR4dR3EkrWFDqD0MG5IiZRYFygw6ZR8FnmZZKnn004vR9fkFq":"pk_live_alyEi3lN0kSwbdevK0nrGwTw"),children:(0,a.jsx)(e,{...i})})}return i.displayName=`WithBillingContext${function(e){return e.displayName||e.name||"Component"}(e)}`,i}},7543841:[e=>{"use strict";e.s({useAiCreditsBalance:()=>i},7543841);var a=e.i(3521787),t=e.i(3514588);function i(){let{team:e}=(0,t.useTeam)(),{data:i,isLoading:r,mutate:n}=(0,a.default)(e?.id?`/api/ai/ai-credits-balance?teamId=${e.id}`:null,e=>fetch(e).then(e=>e.json()));return{balance:i?.cumulativeBalance,loading:r,mutate:n}}e.s({useAddCreditsModal:()=>D},5340378);var r=e.i(6645307),n=e.i(6530772),s=e.i(631755),l=e.i(8934201),d=e.i(889716),o=e.i(8084653),c=e.i(584439),u=e.i(8774211),m=(0,u.createServerReference)("4020de9415eecd5f75fc7eb3589e1c439e6c164770",u.callServer,void 0,u.findSourceMapURL,"createTopUpPurchaseIntent"),h=e.i(5454140);e.i(501494);var x=e.i(6339279),p=e.i(503726),y=e.i(7573892),g=e.i(9802771);let C=x.z.object({amount:x.z.number().int().min(10).max(5e3)});function b(e){let{activeModalType:a,setActiveModalType:u,setPurchaseIntent:x,setProviderDetails:b}=e,{balance:f}=i(),[j,v]=(0,n.useState)("0"),[T,S]=(0,n.useState)("ready"),w=""===j||"0"===j,N=Number(j),k=w||Number.isNaN(N)?Number(f):Number(f)+Number(j),{team:M}=(0,t.useTeam)(),{user:A}=(0,h.useUser)(),{account:I}=(0,p.useAccount)(),_=(0,c.useToasts)(),R=(0,n.useCallback)(async()=>{try{if(!A||!M)return;if(S("in_progress"),!C.safeParse({amount:N}).success)return void S("invalid_amount");let e=await m({amount:j,returnUrl:window.location.href,teamIdOrSlug:M.id});S("completed"),x(e.purchaseIntent),b(e.providerDetails),u("checkout")}catch(e){_.error("We're having trouble processing your payment. Please try again."),S("ready"),x(null),b(null),u(null),y.analytics.track(g.AnalyticsEvent.AI_CREDITS_CHECKOUT_ERROR,{message:e.message})}},[j,A,M,I,u,x,b,N,_]);return(0,r.jsxs)(l.Modal.Modal,{active:"top_up"===a,onClickOutside:()=>u(null),children:[(0,r.jsxs)(l.Modal.Body,{children:[(0,r.jsxs)(l.Modal.Header,{children:[(0,r.jsx)(l.Modal.Title,{children:"Buy More AI Gateway Credits"}),(0,r.jsx)(l.Modal.Subtitle,{children:"Purchase credits as a one time top-up to use for your team's AI Gateway usage. Credits expire 1 year after purchase and are only valid for use on AI Gateway."})]}),(0,r.jsxs)(d.Stack,{direction:"column",gap:4,children:[(0,r.jsxs)(d.Stack,{direction:"row",children:[(0,r.jsxs)(d.Stack,{direction:"column",gap:2,className:"w-full items-center justify-center border-r border-gray-200 text-gray-900",children:[(0,r.jsx)(o.Text,{as:"label",className:"text-gray-900",children:"Starting Balance"}),(0,r.jsx)(o.Text,{size:32,className:"tracking-tighter",children:`$${Number(f).toFixed(2)}`})]}),(0,r.jsxs)(d.Stack,{direction:"column",gap:2,className:"w-full items-center justify-center text-gray-900",children:[(0,r.jsx)(o.Text,{as:"label",className:"text-gray-900",children:"New Balance"}),(0,r.jsx)(o.Text,{size:32,className:"tracking-tighter",children:w||Number.isNaN(k)?"—":`$${Number(k).toFixed(2)}`})]})]}),(0,r.jsxs)(d.Stack,{direction:"column",gap:2,children:[(0,r.jsx)(s.Input,{"aria-labelledby":"amount-label",label:"Purchase Credits",value:j,onChange:e=>{S("ready"),v(e.target.value)},error:"invalid_amount"===T?"Invalid amount":void 0,suffix:"USD",suffixStyling:!1}),(0,r.jsx)(o.Text,{as:"label",size:13,className:"text-gray-900",children:"Minimum of $10 and maximum of $5000."})]})]})]}),(0,r.jsxs)(l.Modal.Actions,{children:[(0,r.jsx)(l.Modal.Action,{onClick:()=>u(null),type:"secondary",children:"Cancel"}),(0,r.jsx)(l.Modal.Action,{onClick:R,disabled:w,loading:"in_progress"===T,children:"Continue to Payment"})]})]})}e.i(442955);var f=e.i(6114962),j=e.i(9934081),v=e.i(5674541),T=e.i(6921100),S=e.i(3821772),w=e.i(7857565),N=e.i(7320579),k=e.i(6795435),M=e.i(1209519),A=e.i(2362802),I=(0,u.createServerReference)("400ed4fc44d80377ba8dacd6fae2c8c2fe59e1cb83",u.callServer,void 0,u.findSourceMapURL,"completePurchaseIntent"),_=(0,u.createServerReference)("409186c62d08247745286d0c1294f7f7d37fbc07de",u.callServer,void 0,u.findSourceMapURL,"patchPaymentMethod"),R=e.i(5079737),P=e.i(7179748),E=e.i(36632);function B(e){let{confirmHandler:a,setFormStatusAction:t}=e,i=(0,R.useCheckout)(),s=(0,n.useCallback)(async()=>{try{let e=await i.confirm({redirect:"if_required"});if("error"===e.type)return{success:!1,error:e.error.message};return{success:!0}}catch(e){return{success:!1,error:(0,E.isErrorLike)(e)?e.message:"An error occurred"}}},[i]);return(0,n.useEffect)(()=>(a.current=s,()=>{a.current=null}),[a,s]),(0,r.jsx)(R.PaymentElement,{onReady:()=>{t("ready")},options:{layout:{type:"tabs",defaultCollapsed:!1},terms:{card:"never",applePay:"never",googlePay:"never"}}})}let O=(0,k.withBillingContext)(function(e){let{activeModalType:a,setActiveModalType:s,purchaseIntent:u,providerDetails:m}=e,x=(0,n.useMemo)(()=>u?u.lineItems?.map(e=>({name:e.name,amount:Number(e.unitAmount)*Number(e.quantity)}))??[]:[],[u]),[C,b]=(0,n.useState)("ready"),[S,k]=(0,n.useState)(null),{team:P}=(0,t.useTeam)(),{user:E}=(0,h.useUser)(),{mutate:B}=(0,N.useSWRConfig)(),{account:O}=(0,p.useAccount)(),{paymentMethods:F}=(0,j.useBillingPlatform)(),{balance:$}=i(),L=(0,R.useStripe)(),D=(0,c.useToasts)(),U=(0,n.useMemo)(()=>{if(F){if(!S){let e=F.defaultSource;return F.sources.find(a=>a.id===e)}return F.sources.find(e=>e.id===S)}},[F,S]),Y=(0,n.useMemo)(()=>u?u.lineItems?.filter(e=>"AI Gateway Credits"===e.name).reduce((e,a)=>e+Number(a.unitAmount)*(Number(a.quantity)||1),0):0,[u]),G=(0,n.useCallback)(async()=>{try{if(b("in_progress"),!P||!L||!U||!E||!u||!m||void 0===$||void 0===Y)return;U.billing_details.email||await _({paymentMethodId:U.id,teamIdOrSlug:P.id});let e=await L.initCheckout({fetchClientSecret:()=>Promise.resolve(m.clientSecret)}),a=await e.confirm({redirect:"if_required",paymentMethod:U.id});if("error"===a.type){y.analytics.track(g.AnalyticsEvent.AI_CREDITS_CHECKOUT_ERROR,{message:a.error.message}),D.error("Failed to add funds. Please try again."),b("ready");return}await I({purchaseIntentId:u.id,teamIdOrSlug:P.id}),D.success(`Successfully added $${Y} to your AI Gateway Credits balance!`),await B(`/api/ai/ai-credits-balance?teamId=${P.id}`,()=>({cumulativeBalance:Number($)+Y,hasEverPaid:!0}),{revalidate:!1}),b("completed"),s(null)}catch(e){D.error("We're having trouble processing your payment. Please try again."),b("ready"),s(null),y.analytics.track(g.AnalyticsEvent.AI_CREDITS_CHECKOUT_ERROR,{message:e.message})}},[E,P,O,L,U,u,B,b,m,D,s,Y,$]);return(0,r.jsxs)(l.Modal.Modal,{active:"checkout"===a,onClickOutside:()=>s(null),children:[(0,r.jsxs)(l.Modal.Body,{children:[(0,r.jsxs)(l.Modal.Header,{children:[(0,r.jsx)(l.Modal.Title,{children:"Confirm Payment Method"}),(0,r.jsx)(l.Modal.Subtitle,{children:"Your default payment method will be used for a one-time charge unless you add a new payment method below."})]}),(0,r.jsxs)(d.Stack,{direction:"column",gap:4,children:[(0,r.jsx)(T.Select,{label:"Payment method",prefix:(0,r.jsx)(f.CardIcon,{brand:U?.card?.brand??"unknown"}),value:U?.id,onChange:e=>{b("ready"),k(e.target.value)},children:F?.sources.map(e=>(0,r.jsx)("option",{value:e.id,children:`${(0,w.cardBrand)(e.card?.brand)} ${e.card?.funding} ending in •••• ${e.card?.last4} ${e.id===F.defaultSource?"(Default)":""}`},e.id))}),(0,r.jsx)(v.Button,{type:"secondary",size:"medium",prefix:(0,r.jsx)(M.PlusCircle,{}),onClick:()=>{s("add_card")},children:"Add payment method"})]})]}),(0,r.jsxs)(d.Stack,{direction:"column",paddingY:4,paddingTop:2,paddingX:6,gap:4,className:"border-t bg-background-200",children:[(0,r.jsxs)(d.Stack,{direction:"column",children:[x.map(e=>(0,r.jsxs)(d.Stack,{direction:"row",gap:4,justify:"space-between",className:"border-b",paddingY:4,children:[(0,r.jsx)(o.Text,{className:"text-gray-900",weight:500,children:e.name}),(0,r.jsx)(o.Text,{className:"text-gray-900",weight:500,children:`$${e.amount.toFixed(2)}`})]},e.name)),(0,r.jsxs)(d.Stack,{direction:"row",gap:4,justify:"space-between",className:"border-b",paddingY:4,children:[(0,r.jsx)(o.Text,{className:"text-foreground",weight:500,children:"Total"}),u?(0,r.jsx)(o.Text,{className:"text-foreground",weight:500,children:`$${u.total}`}):null]})]}),(0,r.jsxs)(o.Text,{className:"text-gray-900",children:['By pressing "Confirm and Pay" and accessing AI Gateway, you agree to'," ",(0,r.jsx)(A.Link,{href:"/legal/ai-product-terms",className:"text-foreground underline",target:"_blank",children:"Vercel's AI Product Terms."})]})]}),(0,r.jsxs)(l.Modal.Actions,{children:[(0,r.jsx)(l.Modal.Action,{onClick:()=>{s("top_up")},type:"secondary",children:"Back"}),(0,r.jsx)(l.Modal.Action,{onClick:async()=>{await G()},loading:"in_progress"===C,children:"Confirm and Pay"})]})]})});function F(e){var a,s;let{activeModalType:u,setActiveModalType:m,purchaseIntent:x,providerDetails:C}=e,b=(0,n.useMemo)(()=>x?x.lineItems?.map(e=>({name:e.name,amount:Number(e.unitAmount)*Number(e.quantity)}))??[]:[],[x]),[f,j]=(0,n.useState)("initializing"),{team:v}=(0,t.useTeam)(),{user:T}=(0,h.useUser)(),{mutate:w}=(0,N.useSWRConfig)(),{account:M}=(0,p.useAccount)(),{balance:I}=i(),_=(0,c.useToasts)(),{resolvedTheme:E}=(0,P.useTheme)(),O=(0,n.useMemo)(()=>x?x.lineItems?.filter(e=>"AI Gateway Credits"===e.name).reduce((e,a)=>e+Number(a.unitAmount)*(Number(a.quantity)||1),0):0,[x]),F=(0,n.useMemo)(()=>{let e=M?.billing?.platform==="stripeTestMode";return(0,k.getStripe)(e?"pk_test_51KWTJcBQYfoTMhVJkeKojfST4MsShve9XJ7Seqw7mgZaUCeO1DR4dR3EkrWFDqD0MG5IiZRYFygw6ZR8FnmZZKnn004vR9fkFq":"pk_live_alyEi3lN0kSwbdevK0nrGwTw")},[M]),$=(0,n.useRef)(null),L=(0,n.useCallback)(async()=>{try{if(j("in_progress"),!v||!T||!x||!C||void 0===I||void 0===O)return void j("ready");if($.current){let e=await $.current();if(e.success)_.success(`Successfully added $${O} to your AI Gateway Credits balance!`),await w(`/api/ai/ai-credits-balance?teamId=${v.id}`,()=>({cumulativeBalance:Number(I)+O,hasEverPaid:!0}),{revalidate:!1}),j("completed"),m(null);else{y.analytics.track(g.AnalyticsEvent.AI_CREDITS_CHECKOUT_ERROR,{message:e.error??"Payment checkout failed"}),_.error("Failed to add credits. Please try again."),j("ready");return}}else{y.analytics.track(g.AnalyticsEvent.AI_CREDITS_CHECKOUT_ERROR,{message:"Payment handler not initialized"}),_.error("We're having trouble processing your payment. Please try again."),j("ready");return}}catch(e){_.error("We're having trouble processing your payment. Please try again."),j("ready"),m(null),y.analytics.track(g.AnalyticsEvent.AI_CREDITS_CHECKOUT_ERROR,{message:e.message})}},[T,v,M,x,w,j,C,_,m,O,I]);return(0,r.jsxs)(l.Modal.Modal,{active:"checkout"===u,onClickOutside:()=>m(null),children:[(0,r.jsxs)(l.Modal.Body,{children:[(0,r.jsxs)(l.Modal.Header,{children:[(0,r.jsx)(l.Modal.Title,{children:"Confirm Payment Method"}),(0,r.jsx)(l.Modal.Subtitle,{children:"Your default payment method will be used for a one-time charge unless you add a new payment method below."})]}),"initializing"===f?(0,r.jsx)(d.Stack,{align:"center",direction:"column",children:(0,r.jsx)(S.Spinner,{})}):null,(0,r.jsx)(d.Stack,{direction:"column",gap:4,children:C?(0,r.jsx)(R.CheckoutProvider,{stripe:F,options:{fetchClientSecret:()=>Promise.resolve(C.clientSecret),elementsOptions:{appearance:(s={theme:"stripe"},{theme:"flat",variables:{fontSizeBase:"14px",fontSizeSm:"14px",colorTextPlaceholder:(a="dark"===E)?"hsl(240, 3.8%, 60%)":"hsl(240, 3.8%, 46.1%)",colorText:a?"white":"rgb(9, 9, 11)",colorPrimary:"var(--blue-700)",colorDanger:"hsl(0, 84.2%, 60.2%)",borderRadius:"6px",colorBackground:a?"black":"white",focusBoxShadow:a?"rgb(255, 255, 255) 0px 0px 0px 0px, rgb(161, 161, 170) 0px 0px 0px 1px, rgba(0, 0, 0, 0.05) 0px 1px 2px 0px":"rgb(0, 0, 0) 0px 0px 0px 0px, rgb(161, 161, 170) 0px 0px 0px 1px, rgba(0, 0, 0, 0.05) 0px 1px 2px 0px"},rules:{".Input":{border:a?"1px solid hsl(240, 5.9%, 30%)":"1px solid hsl(240, 5.9%, 90%)",padding:"10px 12px",transition:"all cubic-bezier(0.4, 0, 0.2, 1) 150ms"},".Label":{marginBottom:"8px",color:a?"#999999":"#666666",lineHeight:"20px",fontWeight:"400"},".AccordionItem":{backgroundColor:a?"black":"white"},".Block":{backgroundColor:a?"black":"white"}},...s}),loader:"never",savedPaymentMethod:{enableRedisplay:"auto"}}},children:(0,r.jsx)(B,{confirmHandler:$,setFormStatusAction:j})}):null})]}),(0,r.jsxs)(d.Stack,{direction:"column",paddingY:4,paddingTop:2,paddingX:6,gap:4,className:"border-t bg-background-200",children:[(0,r.jsxs)(d.Stack,{direction:"column",children:[b.map(e=>(0,r.jsxs)(d.Stack,{direction:"row",gap:4,justify:"space-between",className:"border-b",paddingY:4,children:[(0,r.jsx)(o.Text,{className:"text-gray-900",weight:500,children:e.name}),(0,r.jsx)(o.Text,{className:"text-gray-900",weight:500,children:`$${e.amount.toFixed(2)}`})]},e.name)),(0,r.jsxs)(d.Stack,{direction:"row",gap:4,justify:"space-between",className:"border-b",paddingY:4,children:[(0,r.jsx)(o.Text,{className:"text-foreground",weight:500,children:"Total"}),x?(0,r.jsx)(o.Text,{className:"text-foreground",weight:500,children:`$${x.total}`}):null]})]}),(0,r.jsxs)(o.Text,{className:"text-gray-900",children:['By pressing "Confirm and Pay" and accessing AI Gateway, you agree to'," ",(0,r.jsx)(A.Link,{href:"/legal/ai-product-terms",className:"text-foreground underline",target:"_blank",children:"Vercel's AI Product Terms."})]})]}),(0,r.jsxs)(l.Modal.Actions,{children:[(0,r.jsx)(l.Modal.Action,{onClick:()=>{m("top_up")},type:"secondary",children:"Back"}),(0,r.jsx)(l.Modal.Action,{onClick:async()=>{await L()},loading:["in_progress","initializing"].includes(f),children:"Confirm and Pay"})]})]})}function $(e){let{isUpdatedStripeElementsEnabled:a}=e;return a?(0,r.jsx)(F,{...e}):(0,r.jsx)(O,{...e})}var L=e.i(287394);function D(e){let{isUpdatedStripeElementsEnabled:a}=e,[t,i]=(0,n.useState)(null),[s,l]=(0,n.useState)(null),[d,o]=(0,n.useState)(null);return{openModal:()=>i("top_up"),closeModal:()=>i(null),modals:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(b,{activeModalType:t,setActiveModalType:i,setPurchaseIntent:l,setProviderDetails:o}),(0,r.jsx)($,{activeModalType:t,setActiveModalType:i,purchaseIntent:s,providerDetails:d,isUpdatedStripeElementsEnabled:a}),(0,r.jsx)(L.default,{active:"add_card"===t,onAdded:()=>{i("checkout")},onCancel:()=>{i("checkout")}})]})}}},[5340378]],147494:[e=>{"use strict";e.s({ViewBalanceAndPurchaseCreditsModal:()=>u},147494);var a=e.i(6645307),t=e.i(7543841),i=e.i(5674541),r=e.i(5163670),n=e.i(555528),s=e.i(6530772);e.s({Coins:()=>l},7488765);let l=(0,e.i(6895406).withNewIcon)(`<g clip-path="url(#clip0_1529_2727)">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M1.8627 7.61014C2.83103 7.22281 4.11733 7 5.5 7C6.88267 7 8.16897 7.22281 9.1373 7.61014C9.61938 7.80297 10.0598 8.05135 10.3921 8.36552C10.7258 8.68119 11 9.11499 11 9.65V13.35C11 13.8859 10.7347 14.3259 10.3979 14.6514C10.0646 14.9735 9.62194 15.226 9.1373 15.4199C8.1672 15.8079 6.88111 16.0199 5.5 16.0001C4.11889 16.0199 2.8328 15.8079 1.8627 15.4199C1.37806 15.226 0.935392 14.9735 0.602056 14.6514C0.265315 14.3259 0 13.8859 0 13.35V9.65C0 9.11499 0.274157 8.68119 0.607948 8.36552C0.940154 8.05135 1.38062 7.80297 1.8627 7.61014ZM1.5 9.65088V9.65L1.5 9.64998C1.49997 9.64935 1.49947 9.63747 1.5142 9.60866C1.53081 9.57621 1.56658 9.52347 1.63861 9.45535C1.78713 9.31489 2.04229 9.15385 2.41979 9.00285C3.17062 8.70252 4.25931 8.5 5.5 8.5C6.74069 8.5 7.82938 8.70252 8.58021 9.00285C8.95771 9.15385 9.21287 9.31489 9.36139 9.45535C9.43342 9.52347 9.46919 9.57621 9.4858 9.60866C9.50054 9.63747 9.50003 9.64935 9.5 9.64998L9.5 9.65C9.5 9.65002 9.50002 9.65031 9.5 9.65089M1.5 11.5298V13.35C1.5 13.3588 1.50052 13.4336 1.6445 13.5728C1.79189 13.7152 2.04485 13.8772 2.41979 14.0271C3.16618 14.3257 4.25066 14.519 5.48857 14.5001L5.5 14.4999L5.51143 14.5001C6.74934 14.519 7.83382 14.3257 8.58021 14.0271C8.95515 13.8772 9.20811 13.7152 9.3555 13.5728C9.49948 13.4336 9.5 13.3588 9.5 13.35V11.5298C9.38261 11.587 9.26133 11.6402 9.1373 11.6899C8.16897 12.0772 6.88267 12.3 5.5 12.3C4.11733 12.3 2.83103 12.0772 1.8627 11.6899C1.73867 11.6402 1.61739 11.587 1.5 11.5298ZM9.5 9.65089C9.49989 9.65411 9.49857 9.66636 9.4858 9.69134C9.46919 9.72379 9.43342 9.77653 9.36139 9.84465C9.21287 9.98511 8.95771 10.1461 8.58021 10.2971C7.82938 10.5975 6.74069 10.8 5.5 10.8C4.25931 10.8 3.17062 10.5975 2.41979 10.2971C2.04229 10.1461 1.78713 9.98511 1.63861 9.84465C1.56658 9.77653 1.53081 9.72379 1.5142 9.69134C1.50143 9.66636 1.50011 9.65411 1.5 9.65088" fill="currentColor" />
  <path fill-rule="evenodd" clip-rule="evenodd" d="M6.8627 0.61014C7.83103 0.222808 9.11733 0 10.5 0C11.8827 0 13.169 0.222808 14.1373 0.61014C14.6194 0.802973 15.0598 1.05135 15.3921 1.36552C15.7258 1.68119 16 2.11499 16 2.65V6.35C16 6.90413 15.746 7.35093 15.4245 7.67984C15.1106 8.00089 14.7088 8.23745 14.3171 8.41033C13.5387 8.75385 12.6231 8.92251 12 8.92251V7.42251C12.415 7.42251 13.1243 7.29715 13.7115 7.03804C14.0025 6.90961 14.2185 6.76769 14.3518 6.63129C14.4775 6.50275 14.5 6.41311 14.5 6.35V4.52982C14.3826 4.58696 14.2613 4.64025 14.1373 4.68986C13.169 5.07719 11.8827 5.3 10.5 5.3C9.11733 5.3 7.83103 5.07719 6.8627 4.68986C6.73867 4.64025 6.61739 4.58696 6.5 4.52982V5.5H5V2.65C5 2.11499 5.27416 1.68119 5.60795 1.36552C5.94015 1.05135 6.38062 0.802973 6.8627 0.61014ZM6.5 2.65088V2.65L6.5 2.64998C6.49997 2.64935 6.49947 2.63747 6.5142 2.60866C6.53081 2.57621 6.56658 2.52347 6.63861 2.45535C6.78713 2.31489 7.04229 2.15385 7.41979 2.00285C8.17062 1.70252 9.25931 1.5 10.5 1.5C11.7407 1.5 12.8294 1.70252 13.5802 2.00285C13.9577 2.15385 14.2129 2.31489 14.3614 2.45535C14.4334 2.52347 14.4692 2.57621 14.4858 2.60866C14.5005 2.63747 14.5 2.64935 14.5 2.64998L14.5 2.65C14.5 2.65002 14.5 2.65031 14.5 2.65089M6.5 2.65088C6.50011 2.65411 6.50143 2.66636 6.5142 2.69134C6.53081 2.72379 6.56658 2.77653 6.63861 2.84465C6.78713 2.98511 7.04229 3.14615 7.41979 3.29715C8.17062 3.59748 9.25931 3.8 10.5 3.8C11.7407 3.8 12.8294 3.59748 13.5802 3.29715C13.9577 3.14615 14.2129 2.98511 14.3614 2.84465C14.4334 2.77653 14.4692 2.72379 14.4858 2.69134C14.4986 2.66636 14.4999 2.65411 14.5 2.65089" fill="currentColor" />
  </g>
  <defs>
  <clipPath id="clip0_1529_2727">
  <rect width="16" height="16" fill="white" />
  </clipPath>
  </defs>`);var d=e.i(5340378),o=e.i(3585235),c=e.i(5785123);function u(e){let{type:u="inline",isUpdatedStripeElementsEnabled:m}=e,{can:h}=(0,o.default)(),x=h(c.Action.Update,c.Resource.PaymentMethod),{balance:p}=(0,t.useAiCreditsBalance)(),{openModal:y,modals:g}=(0,d.useAddCreditsModal)({isUpdatedStripeElementsEnabled:m}),C=(0,s.useCallback)(e=>void 0===e?"":e<100?Number(e).toFixed(2):e<1e3?Number(e).toFixed(0):`${(Number(e)/1e3).toFixed(0)}k`,[]);return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[void 0!==p?(0,a.jsx)(n.Tooltip,{position:"bottom",disableTriggers:x,boxAlign:"center",text:"You need additional permissions to manage your team’s AI Gateway credits.",children:(0,a.jsx)(i.Button,{type:"on-demand"===u?"default":"secondary",size:"on-demand"===u?"small":void 0,disabled:!x,onClick:y,prefix:"inline"===u?(0,a.jsx)(l,{}):void 0,children:"inline"===u?`${C(p)} Credits`:"Buy Credits"})}):(0,a.jsx)(r.Skeleton,{children:(0,a.jsx)(i.Button,{type:"on-demand"===u?"default":"secondary",size:"on-demand"===u?"small":void 0,prefix:"inline"===u?(0,a.jsx)(l,{}):void 0,children:"inline"===u?"Loading Credits":"Buy Credits"})}),g]})}},[7488765]]}]);

//# sourceMappingURL=49c07d669cf4c1b8.js.map
//# debugId=0db05f38-2a81-5348-82e7-0145faeeb3ab
