
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="cded36cc-de8b-5279-85d8-9c54b47d3b43")}catch(e){}}();
(globalThis.TURBOPACK=globalThis.TURBOPACK||[]).push(["object"==typeof document?document.currentScript:void 0,{7475425:e=>{e.v({dialog:"create-environment-variable-modal-module___Z4-JW__dialog",form:"create-environment-variable-modal-module___Z4-JW__form",modal:"create-environment-variable-modal-module___Z4-JW__modal","modal-module__active":"create-environment-variable-modal-module___Z4-JW__modal-module__active"})},6085519:e=>{"use strict";e.s({EnvironmentDetails:()=>ez},6085519);var t=e.i(6645307),n=e.i(889716),i=e.i(8084653),r=e.i(3509620),a=e.i(5333425),s=e.i(3585235),o=e.i(5785123),l=e.i(5535439),c=e.i(1164214),d=e.i(5674541),m=e.i(631755),u=e.i(8934201),h=e.i(6530772),x=e.i(4374461),p=e.i(1183506),g=e.i(9336536);function j(e,t,n){let i=`${(0,g.API_ENVIRONMENTS)(t)}/${n}?slug=${e}`;return(0,x.default)(i,async(e,t)=>{let{arg:n}=t;return(0,p.fetchAPI)(i,{method:"PATCH",body:JSON.stringify(n),throwOnHTTPError:!0})})}var v=e.i(8043229);function b(e){let{envIdOrSlug:i,teamSlug:r,project:a,environment:s,isLoading:o,canUpdateEnvironment:x,revalidateEnvironment:p}=e,[g,b]=(0,h.useState)(!1),[y,f]=(0,h.useState)(s?.slug||""),[w,S]=(0,h.useState)(null),[k,C]=(0,h.useState)(s?.description||""),E=(0,l.useRouter)(),{trigger:T,isMutating:P}=j(r,a,i);(0,h.useEffect)(()=>{s&&(f(s.slug),s.description&&C(s.description))},[s]);let A=y!==s?.slug||k!==s.description,I=!o&&!x||o;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.Button,{"data-testid":(0,c.tid)("environments","edit-environment-button"),onClick:()=>b(!0),size:"small",children:"Edit"}),(0,t.jsx)(u.Modal.Modal,{active:g,"data-testid":(0,c.tid)("environments","modal","edit"),onClickOutside:()=>b(!1),children:(0,t.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),A){let e=await T({slug:y,description:k});e.id!==i&&e.slug!==i?E.replace(`/${r}/${a}/settings/environments/${y}`):(p(),b(!1))}},children:[(0,t.jsxs)(u.Modal.Body,{children:[(0,t.jsx)(u.Modal.Header,{children:(0,t.jsx)(u.Modal.Title,{children:"Environment Details"})}),(0,t.jsxs)(n.Stack,{gap:6,children:[(0,t.jsx)(v.CustomEnvironmentSlugInput,{"data-testid":(0,c.tid)("environments","modal","edit","input","name"),disabled:I,envSlugError:w,label:"Name (slug)",onChange:e=>{!/^[a-z0-9_-]+$/.test(e)&&e.length>0?S("Only lowercase letters, digits, dashes, and underscores are allowed"):w&&S(null),f(e)},placeholder:o?"":"staging",value:y,withPrefix:!1}),(0,t.jsx)(m.Input,{"data-testid":(0,c.tid)("environments","modal","edit","input","description"),disabled:I,id:"description",label:"Description (optional)",maxLength:256,onChange:e=>{C(e.target.value)},placeholder:o?"":"This environment is used for...",value:k})]})]}),(0,t.jsxs)(u.Modal.Actions,{children:[(0,t.jsx)(u.Modal.Action,{"data-testid":(0,c.tid)("environments","modal","edit","button","cancel"),onClick:()=>b(!1),type:"secondary",children:"Cancel"}),(0,t.jsx)(u.Modal.Action,{"aria-disabled":null!==w,buttonType:"submit","data-testid":(0,c.tid)("environments","modal","edit","button","submit"),disabled:null!==w,loading:P,children:"Save"})]})]})})]})}var y=e.i(663357),f=e.i(611347),w=e.i(6531164),S=e.i(7238633),k=e.i(5163670),C=e.i(555528),E=e.i(4198558),T=e.i(595691),P=e.i(5528554),A=e.i(3138389),I=e.i(5140160),N=e.i(6155419),D=e.i(2362802),M=e.i(3514588),F=e.i(3357281),L=e.i(9505396);let B=(0,E.default)(()=>e.r(3790123)(e.i).then(e=>e.AddDomainModal),{loadableGenerated:{modules:[8097498]}});function O(e){let{environment:c,projectSlugOrId:m,revalidateEnvironment:x}=e,p=c.id===r.EnvTarget.Production,g=c.id===r.EnvTarget.Preview,j=p||g,{data:v,isLoading:b,mutate:E}=(0,L.useProjectDomains)(j?m:null,{redirects:"false",limit:50}),T=v?.filter(e=>!e.customEnvironmentId&&!e.redirect&&(e.gitBranch?g:p)),O=j?T||[]:c.domains||[],[$,_]=(0,h.useState)(!1),V=(0,l.useParams)(),{team:z}=(0,M.useTeam)(),[H,q]=(0,h.useState)(!1),G=0===O.length,U=O.length<5,{can:J,isLoading:W}=(0,s.default)({projectIdOrName:V?.project},{revalidateOnFocus:!1}),Y=b||W,Z=J(o.Action.Update,o.Resource.Project),K=J(o.Action.Create,o.Resource.Domain),Q=!Y&&Z&&K;return(0,t.jsxs)(k.Skeleton,{show:Y,children:[(0,t.jsxs)(f.Fieldset,{children:[(0,t.jsx)(w.FieldsetContent,{className:"px-6 py-5",children:(0,t.jsxs)(n.Stack,{gap:4,children:[(0,t.jsxs)(n.Stack,{direction:{xs:"column",md:"row"},gap:3,justify:{xs:"flex-start",md:"space-between"},children:[(0,t.jsxs)(n.Stack,{gap:3,children:[(0,t.jsx)(i.Text,{as:"h3",size:20,weight:600,children:"Domains"}),(0,t.jsx)(i.Text,{as:"p",className:"break-words",color:"gray-1000",children:(()=>{let e=V?.teamSlug&&V.project?(0,t.jsx)(D.Link,{external:!0,href:`/${V.teamSlug}/${V.project}/settings/domains`,variant:"highlight",children:"Project domain settings"}):"Project domain settings";return p?(0,t.jsxs)(t.Fragment,{children:["Custom domains can be assigned to production from ",e]}):g||(0,a.isCustomEnvId)(c.id)?(0,t.jsxs)(t.Fragment,{children:["Custom domains can be assigned to this environment from"," ",e]}):null})()})]}),(0,t.jsx)(C.Tooltip,{disableTriggers:Q,style:{display:"inline"},text:`Additional permissions for ${z?.name} are required to add a domain to this environment.`,children:(0,t.jsx)(d.Button,{className:"w-fit",disabled:Y||!Q,onClick:()=>{_(!0)},size:"small",children:"Add Domain"})})]}),G?(0,t.jsx)(y.EmptyState.Root,{description:"Domains can be added to environments.",icon:(0,t.jsx)(y.EmptyState.Icon,{icon:(0,t.jsx)(I.Globe,{size:32})}),title:"No Domains Attached"}):(0,t.jsxs)(n.Stack,{className:"-mx-6 overflow-x-auto px-6",children:[(0,t.jsx)(n.Stack,{className:"min-w-fit whitespace-nowrap",gap:{sm:3,md:1},children:O.map((e,n)=>(0,t.jsx)(R,{domain:e,hidden:n>8,isPreviewEnvironment:g},e.name))}),U?null:(0,t.jsx)(F.ViewAllButton,{className:"bottom-4 transition-transform duration-100 ease-in-out hover:-translate-y-0.5 hover:shadow-tooltip",onClick:()=>{q(!0)}})]})]})}),(0,t.jsx)(S.FieldsetFooter,{className:"px-6 py-3",children:(0,t.jsx)(n.Stack,{align:"center",className:"flex flex-nowrap p-0",direction:"row",gap:.5,children:(0,t.jsxs)(i.Text,{as:"p",color:"gray-900",children:["Learn more about"," ",(0,t.jsx)(D.Link,{external:!0,href:"/docs/domains/add-a-domain",type:"highlight",children:"Domains"})]})})})]}),(0,t.jsx)(B,{environmentDomains:O,environmentId:c.id,onClickOutside:()=>{_(!1)},onSuccess:async()=>{x(),await E()},open:$}),(0,t.jsxs)(u.Modal.Modal,{active:H,onClickOutside:()=>q(!1),sticky:!0,children:[(0,t.jsxs)(u.Modal.Body,{children:[(0,t.jsx)(u.Modal.Header,{children:(0,t.jsx)(u.Modal.Title,{children:"Domains"})}),(0,t.jsx)(n.Stack,{direction:"column",gap:3,children:O.map(e=>(0,t.jsxs)(n.Stack,{className:"flex-wrap",direction:{sm:"column",md:"row"},justify:"space-between",children:[(0,t.jsxs)(n.Stack,{align:"center",className:"group",direction:"row",gap:2,children:[e.verified?(0,t.jsx)(P.CheckCircleFill,{color:"blue-700"}):(0,t.jsx)(N.CrossCircleFill,{color:"red-700"}),(0,t.jsx)(D.Link,{href:e.name,children:(0,t.jsx)(i.Text,{as:"span",color:"gray-1000",monospace:!0,children:e.name})})]}),e.gitBranch&&g?(0,t.jsxs)(n.Stack,{align:"center",className:"group ml-6 w-full overflow-hidden",direction:"row",gap:2,children:[(0,t.jsx)(A.GitBranch,{className:"shrink-0",color:"gray-900"}),(0,t.jsx)(D.Link,{href:"/docs/observability/monitoring/custom-domains",children:(0,t.jsx)(i.Text,{as:"span",className:"overflow-hidden whitespace-nowrap",color:"gray-900",monospace:!0,weight:500,children:e.gitBranch})})]}):null]},e.name))})]}),(0,t.jsx)(u.Modal.Actions,{children:(0,t.jsx)("div",{children:(0,t.jsx)(u.Modal.Action,{onClick:()=>q(!1),type:"secondary",children:"Close"})})})]})]})}function R(e){let{domain:r,hidden:a,isPreviewEnvironment:s}=e;return(0,t.jsx)(n.Stack,{"aria-hidden":a?"true":"false",className:"w-full",direction:{sm:"column",md:"row"},gap:{sm:1,md:3},children:(0,t.jsx)(n.Stack,{className:"w-full",direction:{sm:"column",md:"row"},gap:2,children:(0,t.jsxs)(n.Stack,{align:"center",className:"group",direction:"row",gap:2,children:[void 0!==r.verified&&(0,t.jsx)(t.Fragment,{children:r.verified?(0,t.jsx)(P.CheckCircleFill,{className:"shrink-0",color:"blue-700"}):(0,t.jsx)(N.CrossCircleFill,{className:"shrink-0",color:"red-700"})}),(0,t.jsx)(D.Link,{href:`https://${r.name||r}`,tabIndex:a?-1:void 0,children:(0,t.jsxs)(n.Stack,{align:"center",direction:"row",gap:2,children:[(0,t.jsx)(i.Text,{as:"span",color:"gray-1000",monospace:!0,children:r.name||r}),(0,t.jsx)(T.ExternalSmall,{className:"hidden shrink-0 -translate-x-1 opacity-0 transition-opacity duration-100 ease-in-out group-hover:opacity-100 md:block"})]})}),s&&r.gitBranch?(0,t.jsxs)(n.Stack,{align:"center",className:"group sm:ml-6 md:ml-0",direction:"row",gap:2,children:[(0,t.jsx)(A.GitBranch,{color:"gray-900"}),(0,t.jsx)(i.Text,{as:"span",color:"gray-900",monospace:!0,weight:500,children:r.gitBranch})]}):null]})})})}var $=e.i(3979315),_=e.i(2306774);let V="promotion-requirements-modal",z="github";function H(){let{state:e,set:t}=(0,_.useSearchParamsState)({[V]:{defaultValue:""}}),n=e[V]===z;return{isOpen:n,open:(0,h.useCallback)(()=>{t({[V]:z})},[t]),close:(0,h.useCallback)(()=>{t({[V]:""})},[t])}}var q=e.i(3821772),G=e.i(6242507),U=e.i(465836),J=e.i(2979693),W=e.i(8554037),Y=e.i(743345);function Z(e){let{projectId:n,...r}=e,{trigger:a}=function(e){let{projectId:t,checkId:n}=e,{team:i}=(0,M.useTeam)();return(0,x.default)(`/v2/projects/${t}/checks/${n}?teamId=${i?.id}`,async e=>await (0,p.fetchAPI)(e,{method:"DELETE",throwOnHTTPError:!0}))}({projectId:n,checkId:r.id}),c=(0,W.useCiChecksAndPoliciesFlag)(),{can:m}=(0,s.default)(),u=(0,h.useMemo)(()=>m(o.Action.All,o.Resource.DeploymentCheck),[m]),{project:g,teamSlug:j}=(0,l.useParams)()??{},{mutate:v,isLoading:b}=(0,U.useProjectPromotionChecks)({teamId:j??"",projectId:g??"",enableCiChecksAndPolicies:c});return(0,t.jsxs)("li",{className:"flex w-full flex-row items-center justify-between border-x border-t bg-gray-100/40 px-4 py-2 first:rounded-t-md last:rounded-b-md last:border-b",children:[(0,t.jsx)("span",{className:"flex flex-row items-center justify-between gap-2 py-2",children:(0,t.jsx)(i.Text,{variant:"label-16",className:"font-medium",children:r.name})}),u?(0,t.jsx)(d.Button,{variant:"unstyled",onClick:()=>{(async()=>{await a(),await v()})()},className:"cursor-pointer hover:opacity-70","aria-label":"Delete requirement",disabled:b,children:b?(0,t.jsx)(q.Spinner,{size:12}):(0,t.jsx)($.Cross,{size:12})}):null]})}function K(){let{open:e}=H(),{can:n}=(0,s.default)(),i=(0,h.useMemo)(()=>n(o.Action.All,o.Resource.DeploymentCheck),[n]);return(0,t.jsx)(d.Button,{disabled:!i,type:"secondary",prefix:(0,t.jsx)(Y.LogoGithub,{}),onClick:e,children:"Import from GitHub"})}function Q(){return(0,t.jsx)(y.EmptyState.Root,{title:"Unable to connect to GitHub",description:"There was an error connecting to GitHub. Please try again later.",icon:(0,t.jsx)(y.EmptyState.Icon,{icon:(0,t.jsx)(Y.LogoGithub,{size:32})})})}function X(e){let{data:n,isGitHub:i,autoAliasingProductionDomainsEnabled:r,canUpdateDeploymentRequirements:a,open:s,teamSlug:o,projectName:l}=e;return(0,t.jsx)(et,{data:n,isGitHub:i,autoAliasingProductionDomainsEnabled:r,canUpdateDeploymentRequirements:a,contentDescription:"Set conditions that must be met for a deployment to be aliased to production.",open:s,teamSlug:o,projectName:l})}function ee(){return(0,t.jsx)(k.Skeleton,{height:332,width:"100%"})}function et(e){let{data:n,isGitHub:r,autoAliasingProductionDomainsEnabled:a,canUpdateDeploymentRequirements:s,contentDescription:o,open:l,teamSlug:c,projectName:m}=e;return a?r?n&&0!==n.checks.length?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.Text,{children:o}),s?(0,t.jsx)("span",{children:(0,t.jsx)(K,{})}):(0,t.jsx)("span",{children:(0,t.jsx)(C.Tooltip,{text:"You do not have permission to edit Promotion Requirements. Contact a Member or Admin.",children:(0,t.jsx)(K,{})})}),(0,t.jsx)("ul",{className:"mt-2",children:n.checks.sort((e,t)=>e.name.localeCompare(t.name)).map(e=>(0,t.jsx)(Z,{...e,projectId:m??""},e.id))})]}):(0,t.jsxs)(y.EmptyState.Root,{description:o,icon:(0,t.jsx)(y.EmptyState.Icon,{icon:(0,t.jsx)(Y.LogoGithub,{size:32})}),children:[(0,t.jsx)(d.Button,{onClick:l,children:"Add"}),(0,t.jsx)(D.Link,{external:!0,href:"/docs/checks/requirements",type:"secondary",children:"Learn more"})]}):(0,t.jsxs)(y.EmptyState.Root,{description:"Connect your project to GitHub to use Promotion Requirements.",icon:(0,t.jsx)(y.EmptyState.Icon,{icon:(0,t.jsx)(Y.LogoGithub,{size:32})}),children:[(0,t.jsx)(D.ButtonLink,{href:`/${c}/${m}/settings/git`,children:"Connect to GitHub"}),(0,t.jsx)(D.Link,{external:!0,href:"/docs/checks/requirements",type:"secondary",children:"Learn more"})]}):(0,t.jsxs)(y.EmptyState.Root,{description:"Enable auto-aliasing to production domains to use Promotion Requirements.",icon:(0,t.jsx)(y.EmptyState.Icon,{icon:(0,t.jsx)(Y.LogoGithub,{size:32})}),children:[(0,t.jsx)(d.Button,{disabled:!0,onClick:l,children:"Add"}),(0,t.jsx)(D.Link,{external:!0,href:"/docs/checks/requirements",type:"secondary",children:"Learn more"})]})}function en(e){let r,{autoAliasingProductionDomainsEnabled:a}=e,c=(0,W.useCiChecksAndPoliciesFlag)(),{can:d}=(0,s.default)(),{project:m,teamSlug:u}=(0,l.useParams)()??{},{data:x,isLoading:p}=(0,U.useProjectPromotionChecks)({teamId:u??"",projectId:m??"",enableCiChecksAndPolicies:c}),g=(0,h.useMemo)(()=>d(o.Action.All,o.Resource.DeploymentCheck),[d]),{isOpen:j,open:v,close:b}=H(),{data:y,isLoading:S,error:k}=(0,G.useProjectLink)(m),C=!S&&y&&"type"in y&&Object.hasOwn(y,"type")?y.type:null;return c?(r=k?(0,t.jsx)(Q,{}):p||S?(0,t.jsx)(ee,{}):(0,t.jsx)(X,{data:x,isGitHub:"github"===C,autoAliasingProductionDomainsEnabled:a,canUpdateDeploymentRequirements:g,open:v,teamSlug:u,projectName:m}),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.Fieldset,{children:(0,t.jsx)(w.FieldsetContent,{children:(0,t.jsxs)(n.Stack,{gap:3,children:[(0,t.jsx)(i.Text,{as:"h3",size:20,weight:600,id:"promotion-policies",children:"Promotion Requirements"}),r]})})}),(0,t.jsx)(J.ImportGitHubModal,{isOpen:j,onClose:b})]})):null}var ei=e.i(6921100),er=e.i(584439),ea=e.i(36632),es=e.i(4237550),eo=e.i(3156464),el=e.i(2013047),ec=e.i(8955572),ed=e.i(3447305),em=e.i(9326250),eu=e.i(1755874),eh=e.i(8350390),ex=e.i(9240532);function ep(e){let{children:n,description:i,footer:r,title:a,titleBadge:s,onSubmit:o,disabled:l,type:d}=e,m=(0,t.jsxs)(f.Fieldset,{disabled:l,type:d,"data-testid":(0,c.tid)("project-settings",a),children:[(0,t.jsxs)(w.FieldsetContent,{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(eu.FieldsetTitle,{children:(0,t.jsx)("a",{href:`#${a.toLowerCase().replaceAll(" ","-")}`,style:{color:"inherit",textDecoration:"none"},children:(0,t.jsx)(ex.SearchContextHighlighter,{children:a})})}),s]}),i?(0,t.jsx)(eh.FieldsetSubtitle,{children:i}):null,n]}),(0,t.jsx)(S.FieldsetFooter,{children:r})]});return o?(0,t.jsx)("form",{onSubmit:(0,em.promiseToCallback)(o),id:a.toLowerCase().replaceAll(" ","-"),children:m}):m}function eg(e){let{project:s,environment:o,isLoading:c,canUpdateEnvironment:m}=e,x=!c&&!m||c,[g,j]=(0,h.useState)(void 0),[v,b]=(0,h.useState)(!1),[y,f]=(0,h.useTransition)(),{data:w}=(0,eo.useCustomEnvironments)(s),S=(0,l.useParams)(),C=w?.customEnvironments??[],{mutate:E}=(0,ec.default)(s,{revalidateOnFocus:!1});if(!o||(0,r.isSystemEnvTarget)(o.id))return null;let T=g&&(0,a.isCustomEnvId)(g)?C.find(e=>e.id===g)?.slug:(0,el.default)(g??"");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ep,{description:(0,t.jsxs)(t.Fragment,{children:["By importing environment variables from another environment, Vercel will remove all existing variables in"," ",(0,t.jsx)(i.Text,{as:"code",children:(0,a.envName)(o)})," and replace them with the variables in the selected environment. Future environment variables must be added manually."]}),disabled:!c&&!m,footer:(0,t.jsxs)(n.Stack,{align:"center",className:"w-full",direction:"row",justify:"space-between",children:[(0,t.jsx)(k.Skeleton,{show:c,children:(0,t.jsx)(n.Stack,{direction:"row",justify:"space-between",children:(0,t.jsx)(i.Text,{color:"gray-900",children:m?null:(0,t.jsx)(t.Fragment,{children:"You need additional permissions to modify this environment."})})})}),m?(0,t.jsx)(d.Button,{disabled:x,loading:y,onClick:()=>{if(!g)return void er.toasts.error("Please select an environment to import from.");b(!0)},size:"small",children:"Import"}):null]}),title:"Import Variables From Another Environment",type:"default",children:(0,t.jsxs)(ei.Select,{"aria-label":"Environments",disabled:x,onChange:e=>{j(e.target.value)},placeholder:"Select an environment",prefix:(0,t.jsx)(ed.EnvironmentIcon,{id:g}),suffix:(0,t.jsx)(n.Stack,{align:"center",direction:"row",gap:3,children:(0,t.jsx)(es.ChevronDown,{})}),value:g,children:[(0,t.jsxs)("optgroup",{label:"System Environments",children:[(0,t.jsx)("option",{value:r.EnvTarget.Production,children:"Production"}),(0,t.jsx)("option",{value:r.EnvTarget.Preview,children:"Preview"}),(0,t.jsx)("option",{value:r.EnvTarget.Development,children:"Development"})]}),C.length>0?(0,t.jsx)("optgroup",{label:1===C.length?"Custom Environment":"Custom Environments",children:C.filter(e=>e.id!==o.id).sort((e,t)=>e.slug.localeCompare(t.slug)).map(e=>(0,t.jsx)("option",{value:e.id,children:(0,a.envName)(e)},e.id))}):(0,t.jsx)("option",{disabled:!0,children:"Your project has no custom environments"})]})}),(0,t.jsx)(u.Modal.Modal,{active:v,onClickOutside:()=>b(!1),children:(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),(()=>{let e=o?.id;if(!g||!e)return er.toasts.error("Please select an environment to import from.");f(async()=>{try{await function(e){let{teamSlug:t,projectIdOrSlug:n,from:i,to:r}=e,a=`/api/v1/projects/${n}/sync-environment-variables?slug=${t}`;return(0,p.fetchAPI)(a,{method:"POST",body:JSON.stringify({from:i,to:r}),throwOnHTTPError:!0})}({teamSlug:S?.teamSlug??"",projectIdOrSlug:s,from:g,to:e}),await E(),b(!1),er.toasts.success("Environment Variables imported successfully.")}catch(e){(0,ea.isErrorLike)(e)?er.toasts.error(`${e.message}`):er.toasts.error("Failed to import Environment Variables. Please try again.")}})})()},children:[(0,t.jsx)(u.Modal.Body,{children:(0,t.jsxs)(u.Modal.Header,{children:[(0,t.jsx)(u.Modal.Title,{children:"Import Variables"}),(0,t.jsxs)(u.Modal.Subtitle,{children:["This action will remove all existing variables in"," ",(0,t.jsx)(i.Text,{as:"code",children:(0,a.envName)(o)})," and replace them with the variables in ",(0,t.jsx)(i.Text,{as:"code",children:T}),"."]})]})}),(0,t.jsxs)(u.Modal.Actions,{children:[(0,t.jsx)(u.Modal.Action,{onClick:()=>b(!1),type:"secondary",children:"Cancel"}),(0,t.jsx)(u.Modal.Action,{buttonType:"submit",loading:y,children:"Remove and replace"})]})]})})]})}var ej=e.i(8247297),ev=e.i(4789498),eb=e.i(6937468),ey=e.i(6649026);function ef(e){let{envIdOrSlug:r,project:s,environment:o,isLoading:c,canUpdateEnvironment:j}=e,v=!c&&!j||c,[b,y]=(0,h.useState)(!1),[f,w]=(0,h.useState)(""),[S,E]=(0,h.useState)(""),[T,P]=(0,h.useState)(void 0),A=(0,l.useRouter)(),I=(0,l.useParams)(),{trigger:N,isMutating:D}=function(e,t,n){let{team:i}=(0,M.useTeam)(),r=(0,ey.encode)({teamId:i?.id}),a=`${(0,g.API_ENVIRONMENTS)(e)}/${t}${r}`;return(0,x.default)(a,async e=>{await (0,p.fetchAPI)(a,{method:"DELETE",throwOnHTTPError:!0,headers:{"Content-Type":"application/json"},body:JSON.stringify({deleteUnassignedEnvironmentVariables:n})})})}(s,r,T),{data:F}=(0,ec.default)(s,{revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!1}),L=F?.envs.filter(e=>(Array.isArray(e.target)?!(e.target.length>0):"string"!=typeof e.target)&&e.customEnvironmentIds?.length===1&&e.customEnvironmentIds.includes(o.id))??[],B=L.length>0;if((0,h.useEffect)(()=>{b||(w(""),E(""),P(void 0))},[b]),!(0,a.isCustomEnvironment)(o))return null;let O=f===o.slug&&"delete my environment"===S;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ep,{description:"This environment will be deleted. All deployments previously created for this environment will continue to exist.",disabled:!c&&!j,footer:(0,t.jsxs)(n.Stack,{align:"center",className:"w-full",direction:"row",justify:"space-between",children:[(0,t.jsx)(k.Skeleton,{show:c,children:(0,t.jsx)(n.Stack,{direction:"row",justify:"space-between",children:(0,t.jsx)(i.Text,{color:"gray-900",children:j?null:(0,t.jsx)(t.Fragment,{children:"You need additional permissions to delete environments."})})})}),j?(0,t.jsx)(d.Button,{disabled:v,loading:D,onClick:()=>{y(!0)},size:"small",type:"error",typeName:"button",children:"Delete"}):null]}),title:"Delete Environment",type:c||j?"error":"default",children:null}),(0,t.jsx)(u.Modal.Modal,{active:b,onClickOutside:()=>y(!1),children:(0,t.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{await N(),er.toasts.success(`Deleted environment ${(0,a.envName)(o)}`),A.push(`/${I?.teamSlug}/${s}/settings/environments`)}catch(e){"message"in e?er.toasts.error(`Failed to delete environment: ${e.message}`):er.toasts.error("Failed to delete environment. Please try again.")}},children:[(0,t.jsxs)(u.Modal.Body,{children:[(0,t.jsxs)(u.Modal.Header,{children:[(0,t.jsx)(u.Modal.Title,{children:"Delete Environment"}),(0,t.jsx)(u.Modal.Subtitle,{children:"This environment will be deleted. All deployments previously created for this environment will continue to exist."})]}),(0,t.jsx)(u.Modal.Inset,{last:!0,children:(0,t.jsxs)(n.Stack,{gap:6,children:[(0,t.jsx)(ev.Label,{bypassCasing:!0,id:"env-delete-slug",value:(0,t.jsxs)(i.Text,{children:["Enter the environment slug"," ",(0,t.jsx)(i.Text,{as:"span",weight:600,children:(0,a.envName)(o)})," ","to continue:"]}),children:(0,t.jsx)(m.Input,{"aria-labelledby":"env-delete-slug",explicitId:"env-delete-slug",name:"env-delete-slug",onChange:e=>{w(e.target.value)},required:!0,value:f})}),(0,t.jsx)(ev.Label,{bypassCasing:!0,id:"env-delete-confirm",value:(0,t.jsxs)(i.Text,{children:["To verify, type"," ",(0,t.jsx)(i.Text,{as:"span",weight:600,children:"delete my environment"})," ","below:"]}),children:(0,t.jsx)(m.Input,{"aria-labelledby":"env-delete-confirm",explicitId:"env-delete-confirm",name:"env-delete-confirm",onChange:e=>{E(e.target.value)},required:!0,value:S})}),B?(0,t.jsxs)(ej.Checkbox,{checked:!!T,containerClassName:"items-center",onChange:()=>P(!T||void 0),children:["Also delete the Environment"," ",(0,eb.pluralize)("Variable",L.length)," ",L.slice(0,3).map((e,n)=>(0,t.jsxs)(t.Fragment,{children:[2===n&&3===L.length?" and ":void 0,(0,t.jsx)(i.Text,{as:"span",weight:600,children:e.key}),n!==Math.min(3,L.length)-1?", ":void 0]})),L.length>3?(0,t.jsxs)(t.Fragment,{children:[", and"," ",(0,t.jsx)(C.Tooltip,{text:L.slice(3).map(e=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.Text,{as:"span",children:e.key}),(0,t.jsx)("br",{})]})),children:(0,t.jsxs)("u",{children:[L.length-3," ",(0,eb.pluralize)("other",L.length-3)]})}),"."]}):"."," ","As they are only assigned to"," ",(0,t.jsx)(i.Text,{as:"span",weight:600,children:(0,a.envName)(o)})," ","."]}):null]})})]}),(0,t.jsxs)(u.Modal.Actions,{children:[(0,t.jsx)(u.Modal.Action,{onClick:()=>y(!1),type:"secondary",children:"Cancel"}),(0,t.jsx)(u.Modal.Action,{"aria-disabled":!O,buttonType:"submit",loading:D,type:"error",children:"Delete"})]})]})})]})}var ew=e.i(9495609),eS=e.i(2068621),ek=e.i(5454140),eC=e.i(8975439),eE=e.i(2240289),eT=e.i(8158100),eP=e.i(674684);function eA(e){let{checked:r,setChecked:a,disabled:l}=e,c=(0,eP.useRouter)(),d="string"==typeof c.query.project?c.query.project:null,{data:m}=(0,eE.useProject)(d),{can:u}=(0,s.default)(),x=u(o.Action.Update,o.Resource.ProjectProductionBranch);return(0,h.useEffect)(()=>{m&&a(m.autoAssignCustomDomains??!0)},[m,a]),(0,t.jsxs)(n.Stack,{align:"start",direction:"column",justify:"space-between",style:{padding:"var(--geist-space-4x)",margin:"var(--geist-space-1x)",borderRadius:"var(--geist-radius)",border:"1px solid var(--accents-2)"},children:[(0,t.jsxs)(n.Stack,{align:"center",direction:"row",gap:4,justify:"space-between",style:{width:"100%"},children:[(0,t.jsxs)(n.Stack,{gap:1,children:[(0,t.jsx)(i.Text,{color:"inherit",weight:500,children:"Auto-assign Custom Production Domains"}),(0,t.jsxs)(i.Text,{color:"inherit",children:["Automatically assign custom domains after each deployment triggered by a merge to the production branch or a Vercel CLI deploy with the"," ",(0,t.jsx)(i.Text,{as:"span",color:"inherit",monospace:!0,children:"--prod"})," ","flag."]})]}),(0,t.jsx)(ew.Toggle,{checked:r,onChange:()=>{a(!r)},size:"large",children:(0,t.jsx)(i.Text,{color:"gray-800",weight:500,children:r?"Enabled":"Disabled"})})]}),r?null:(0,t.jsx)(eT.Note,{disabled:l||!x,fill:!0,style:{marginTop:"var(--geist-space-4x)",width:"100%"},type:"secondary",children:(0,t.jsx)(n.Stack,{align:"start",direction:"row",gap:3,children:(0,t.jsx)(n.Stack,{align:"start",children:(0,t.jsxs)(i.Text,{as:"p",color:"inherit",children:["Production deployments will need to be manually promoted. Learn more about"," ",(0,t.jsx)(D.Link,{external:!0,href:"/docs/deployments/managing-deployments#promote-deployment-to-production",children:"promoting staged deployments"})]})})})})]})}async function eI(e,t,n,i){let r=`/v9/projects/${encodeURIComponent(e.id)}${(0,ey.encode)({teamId:t?.id})}`;await (0,p.fetchAPI)(r,{method:"PATCH",body:{autoAssignCustomDomains:i,autoAssignCustomDomainsUpdatedBy:n.uid}});let a=i?"Enabled":"Disabled";return`${a} Auto-assign Custom Production Domains successfully.`}var eN=e.i(2408607),eD=e.i(1672766);function eM(e){let{envIdOrSlug:a,project:s,environment:o,isLoading:c,canUpdateEnvironment:m,teamSlug:u,autoAliasingProductionDomainsEnabled:v,isAutoAssignDirty:b,setAutoAliasingProductionDomainsEnabled:y}=e,{team:f}=(0,M.useTeam)(),{user:w}=(0,ek.useUser)(),S=(0,l.useRouter)(),[C,E]=(0,h.useState)(o?.branchMatcher),[T,P]=(0,h.useState)(void 0!==C),[A,I]=(0,h.useState)(!1),N=a===r.EnvTarget.Production,F=a===r.EnvTarget.Preview,{data:L,isLoading:B,mutate:O}=(0,eE.useProject)(s,{apiVersion:"v9"}),{trigger:R,isMutating:$}=j(u,s,a),{trigger:_,isMutating:V}=function(e,t){let n=`${(0,g.API_PROJECTS_VERSION)("v9")}/${e}/branch?teamId=${t}`;return(0,x.default)(n,async(e,t)=>{let{arg:i}=t,{branch:r}=i;return(0,p.fetchAPI)(n,{method:"PATCH",body:JSON.stringify({branch:r}),throwOnHTTPError:!0})})}(s,u);(0,h.useEffect)(()=>{N?L?.link?.productionBranch&&(E({type:"equals",pattern:L.link.productionBranch}),P(!0)):F?(E({type:"equals",pattern:"All unassigned branches"}),P(!L?.previewDeploymentsDisabled)):(o?.branchMatcher&&E(o.branchMatcher),P(o?.branchMatcher!==void 0))},[o,L,N,F]);let z=!1;z=N?C?.pattern!==L?.link?.productionBranch||v!==(L?.autoAssignCustomDomains??!0):F?!T!==(L?.previewDeploymentsDisabled??!1):C?.pattern!==o?.branchMatcher?.pattern||C?.type!==o?.branchMatcher?.type||T!==(o?.branchMatcher!==void 0);let H=N?c||B:c,q=!H&&!m||H,G=N?(0,t.jsxs)(t.Fragment,{children:["Every commit pushed to the"," ",L?.link?.productionBranch?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eC.default,{children:L.link.productionBranch})," ","branch"]}):(0,t.jsx)(D.Link,{external:!0,href:"https://vercel.com/docs/git#production-branch",style:{fontWeight:500},children:"production branch"})," ","will create a Production Deployment."]}):F?"When enabled, deployments will be created for any branch that doesn't match another environment. If disabled, you can still create deployments using the CLI or the Vercel API.":"When enabled, each qualifying merge will generate a deployment";return(0,t.jsx)(ep,{description:(0,t.jsx)(k.Skeleton,{show:H,children:G}),disabled:!H&&!m,footer:(0,t.jsxs)(n.Stack,{align:"center",className:"w-full",direction:"row",justify:"space-between",children:[(0,t.jsx)(k.Skeleton,{show:H,children:(0,t.jsx)(n.Stack,{direction:"row",justify:"space-between",children:(0,t.jsx)(i.Text,{color:"gray-900",children:m?(0,t.jsx)(t.Fragment,{children:N?(0,t.jsxs)(t.Fragment,{children:["Learn more about"," ",(0,t.jsx)(D.Link,{external:!0,href:"/docs/git#production-branch",target:"_blank",type:"highlight",children:"Production Branch"})]}):(0,t.jsxs)(t.Fragment,{children:["Learn more about"," ",(0,t.jsx)(D.Link,{external:!0,href:"/docs/deployments/custom-environments#branch-tracking",target:"_blank",type:"highlight",children:"Environment Branch Settings"})]})}):(0,t.jsx)(t.Fragment,{children:"You need additional permissions to manage environments."})})})}),(0,t.jsx)(d.Button,{disabled:!!(!b&&(!z||q)),loading:N?V||A:$,size:"small",typeName:"submit",children:"Save"})]}),onSubmit:async e=>{e.preventDefault();try{if(!z)return;N?C?.pattern&&(await _({branch:C.pattern}),await O()):F?(await (0,eN.updateProjectSettingsV9)(s,L?.accountId,{previewDeploymentsDisabled:!T}),await O()):(await R({branchMatcher:C||null}),S.refresh()),b&&L&&f&&w&&(I(!0),await eI(L,f,w,v),await O(),I(!1)),er.toasts.success("Branch tracking saved successfully.")}catch(e){(0,ea.isErrorLike)(e)?er.toasts.error(e.message):(er.toasts.error("Failed to save branch tracking. Please try again."),(0,eS.captureException)(e,{attributes:{project:s,envIdOrSlug:a}}))}},title:"Branch Tracking",children:(0,t.jsxs)(n.Stack,{gap:3,children:[!N&&(0,t.jsx)("div",{className:"w-fit",children:(0,t.jsx)(k.Skeleton,{show:H,children:(0,t.jsx)(ew.Toggle,{checked:T,className:"flex w-full items-center justify-between p-0",direction:"switch-first",disabled:N,onChange:()=>{P(e=>{let t=!e;return t?E(o?.branchMatcher):E(void 0),t})},size:"large",children:(0,t.jsx)("span",{className:"text-sm font-medium text-gray-1000",children:T?"Enabled":"Disabled"})})})}),T?(0,t.jsx)(eD.BranchMatcherInput,{disableInput:F,disableSelector:N||F,onChange:E,value:C}):null,N?(0,t.jsx)(n.Stack,{className:"!pt-2",children:(0,t.jsx)(k.Skeleton,{show:H,children:(0,t.jsx)(eA,{checked:v,disabled:!1,setChecked:y})})}):null]})})}var eF=e.i(3906657),eL=e.i(5610210),eB=e.i(5111663),eO=e.i(515497),eR=e.i(7475425);function e$(e){let{disabled:i,teamSlug:r,project:a,environment:s}=e,[o,l]=(0,h.useState)(!1),{mutate:c}=(0,ec.default)(a,{revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!1}),{data:m}=(0,eE.useProject)(a),{modal:x,open:p}=(0,eB.useSaveAndRedeploy)(m);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.Button,{className:"w-fit",disabled:i,onClick:()=>l(!0),size:"small",children:"Add Environment Variable"}),(0,t.jsx)(u.Modal.Modal,{active:o,drawerClassname:eR.default.modal,onClickOutside:()=>l(!1),overlayClassname:eR.default.dialog,children:(0,t.jsxs)(u.Modal.Body,{className:"p-0",children:[(0,t.jsx)(u.Modal.Header,{children:(0,t.jsx)(u.Modal.Title,{className:"px-3 pt-2",children:"Add Environment Variable"})}),(0,t.jsx)(n.Stack,{children:(0,t.jsx)(eO.ProjectEnvVariablesAddForm,{formClassName:(0,eL.clsx)("!border-0",eR.default.form),onSave:async()=>{try{await c(),l(!1),p("Added Environment Variable successfully.")}catch(e){console.error("Failed to refresh env vars:",e)}},restrictToEnvironmentIds:s?.id?[s.id]:[],teamId:r})})]})}),x]})}function e_(e){let{environment:r,project:a,isLoading:s,canCreateEnvironmentVariables:o,teamSlug:l}=e,c=!s&&!o||s;return(0,t.jsxs)(n.Stack,{gap:4,children:[(0,t.jsx)(n.Stack,{as:"hgroup",gap:2,children:(0,t.jsxs)(n.Stack,{direction:{xs:"column",md:"row"},gap:2,justify:{xs:"flex-start",md:"space-between"},children:[(0,t.jsxs)(n.Stack,{children:[(0,t.jsx)(i.Text,{as:"h4",size:20,weight:600,children:"Environment Variables"}),(0,t.jsx)(i.Text,{as:"p",className:"text-pretty",color:"gray-1000",size:14,weight:400,children:(0,t.jsxs)(t.Fragment,{children:["Environment-specific variables override Team"," ",(0,t.jsx)(D.Link,{external:!0,href:`/${l}/${a}/settings/environment-variables`,target:"_blank",type:"highlight",children:"Environment Variables"})]})})]})," ",(0,t.jsx)(e$,{disabled:c,environment:r,project:a,teamSlug:l})]})}),(0,t.jsx)(eV,{environment:r,isLoading:s})]})}function eV(e){let{environment:n,isLoading:i}=e,[r,a]=(0,h.useState)(""),[s,o]=(0,h.useState)("createdAt");return(0,t.jsx)(eF.EnvironmentVariablesTable,{environment:n,isEnvironmentLoading:i,search:r,setSearch:a,setSortTarget:o,sortTarget:s})}function ez(e){let{projectSlugOrId:d,envIdOrSlug:m,teamSlug:u,environment:x}=e,p=(0,l.useRouter)(),g=()=>p.refresh(),j=m===r.EnvTarget.Production,v=m===r.EnvTarget.Development,y=(0,r.isSystemEnvTarget)(m),{can:f,isLoading:w}=(0,s.default)(void 0,{revalidateOnFocus:!1}),S=f(o.Action.Update,o.Resource.Environments),k=f(o.Action.Update,o.Resource.ProjectProductionBranch),C=f(o.Action.Create,o.Resource.ProjectEnvVarsProduction),E=f(o.Action.Create,o.Resource.ProjectEnvVars),{autoAliasingProductionDomainsEnabled:T,isAutoAssignDirty:P,setAutoAliasingProductionDomainsEnabled:A}=(e=>{let{isProdEnv:t,project:n}=e,[i,r]=(0,h.useState)(!0),{data:a}=(0,eE.useProject)(n,{apiVersion:"v9"});return{isAutoAssignDirty:t&&(a?.autoAssignCustomDomains??!0)!==i,autoAliasingProductionDomainsEnabled:i,setAutoAliasingProductionDomainsEnabled:r}})({isProdEnv:j,project:d});return(0,t.jsxs)(n.Stack,{className:"tailwind-preflight",gap:9,children:[(0,t.jsx)(n.Stack,{as:"section",className:"pt-6",gap:9,children:(0,t.jsxs)(n.Stack,{direction:"row",justify:"space-between",children:[(0,t.jsxs)(n.Stack,{gap:3,children:[(0,t.jsx)(i.Text,{as:"h4","data-testid":(0,c.tid)("environments","environment","name"),size:20,weight:600,children:(0,a.envName)(x)}),(0,t.jsx)(i.Text,{color:"gray-900","data-testid":(0,c.tid)("environments","environment","description"),size:14,style:{wordBreak:"break-word"},children:x.description})]}),y?null:(0,t.jsx)(b,{canUpdateEnvironment:S,envIdOrSlug:m,environment:x,isLoading:w,project:d,revalidateEnvironment:g,teamSlug:u})]})}),!v&&(0,t.jsx)(eM,{canUpdateEnvironment:j?k:S,autoAliasingProductionDomainsEnabled:T,isAutoAssignDirty:P,setAutoAliasingProductionDomainsEnabled:A,envIdOrSlug:m,environment:x,isLoading:w,project:d,teamSlug:u}),j?(0,t.jsx)(en,{autoAliasingProductionDomainsEnabled:T}):null,v?null:(0,t.jsx)(O,{environment:x,projectSlugOrId:d,revalidateEnvironment:g}),(0,t.jsx)(e_,{canCreateEnvironmentVariables:j?C:E,canUpdateEnvironment:j?k:S,envIdOrSlug:m,environment:x,isLoading:w,project:d,teamSlug:u}),(0,r.isSystemEnvTarget)(m)?null:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eg,{canUpdateEnvironment:S,envIdOrSlug:m,environment:x,isLoading:w,project:d,teamSlug:u}),(0,t.jsx)(ef,{canUpdateEnvironment:S,envIdOrSlug:m,environment:x,isLoading:w,project:d,teamSlug:u})]})]},m)}}}]);

//# sourceMappingURL=9cc24b804c40b51f.js.map
//# debugId=cded36cc-de8b-5279-85d8-9c54b47d3b43
