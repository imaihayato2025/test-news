
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="876c8ebf-fdec-547a-b00c-56dc57ce2df1")}catch(e){}}();
(globalThis.TURBOPACK=globalThis.TURBOPACK||[]).push(["object"==typeof document?document.currentScript:void 0,{541360:e=>{"use strict";e.s({getConfigurationStatusByIntegrationId:()=>a,getConfigurationStatusByTeamId:()=>n,useConfigurationStatus:()=>i});var t=e.i(6530772);function a(e,t){if(!e)return{isLoading:!0};let a=e.find(e=>e.integrationId===t);return a?{isInstalled:!0,configuration:a,isLoading:!1}:{isInstalled:!1,isLoading:!1}}function n(e,t){if(!e||!t)return{isLoading:!0};let a=e.get(t);return a?{isInstalled:!0,configuration:a,isLoading:!1}:{isInstalled:!1,isLoading:!1}}function i(e){let{initialConfigurationStatus:a}=e,[n,i]=(0,t.useState)(a);return(n.isLoading||!n.isInstalled)&&a!==n&&i(a),{configurationStatus:n,onConfigurationInstalled:(e,t)=>i({isInstalled:!0,configuration:e,billingPlan:t,isLoading:!1})}}},8935578:[e=>{"use strict";e.s({ResourceModalWrapper:()=>b},8935578);var t=e.i(6645307);e.s({CheckoutActions:()=>i},3235415);var a=e.i(1553266),n=e.i(8934201);function i(e){return"modal"===(0,a.useInstallMarketplaceProductDisplayMode)()?(0,t.jsx)(n.Modal.Actions,{children:e.children}):(0,t.jsx)("footer",{className:`
         sticky bottom-0 flex shrink-0 justify-between gap-4 py-4
         before:absolute
         before:bottom-full
         before:left-0
         before:-z-10
         before:h-3
         before:w-full
         before:translate-y-[275%]
         before:bg-[rgba(0,0,0,0.075)]
         before:blur-[3px]
         before:transition-transform
         before:duration-200
         before:content-['']
         after:absolute
         after:inset-0
         after:-z-10
         after:rounded-b-[var(--modal-radius)]
         after:bg-[var(--ds-background-200)]
         after:shadow-[0_-1px_0_0_var(--ds-gray-alpha-400)]
         after:content-[''] dark:before:bg-[rgba(255,255,255,0.1)]
         dark:after:bg-[var(--ds-background-100)]
    `,children:e.children})}function r(e){return"modal"===(0,a.useInstallMarketplaceProductDisplayMode)()?(0,t.jsx)(n.Modal.Body,{children:e.children}):(0,t.jsx)("footer",{children:e.children})}e.s({CheckoutBody:()=>r},8509880),e.s({CheckoutContent:()=>s},7156688);var o=e.i(5610210);function s(e){let n,i=(0,a.useInstallMarketplaceProductDisplayMode)();n="inline"===i?"bg-transparent":"default"!==e.variant?"bg-[var(--geist-background)]":"bg-background-200";let r="py-[var(--geist-gap)] px-[var(--modal-padding)]";return"modal"===i&&("no-padding"===e.variant?r="p-0":"no-padding-no-bottom"===e.variant&&(r="mb-0 p-0")),(0,t.jsx)("div",{className:(0,o.clsx)(`
          mx-[calc(-1*var(--modal-padding))]
          mb-[calc(-1*var(--modal-padding))]
          border-x-0
          border-y
          border-solid
          border-[var(--accents-2)]
          last:border-b-0
         `,r,n),children:e.children})}e.s({CheckoutSubtitle:()=>c},6643111);var l=e.i(8084653);function c(e){return"modal"===(0,a.useInstallMarketplaceProductDisplayMode)()?(0,t.jsx)(n.Modal.Subtitle,{children:e.children}):(0,t.jsx)(l.Text,{as:"div",size:16,children:e.children})}function d(e){return"modal"===(0,a.useInstallMarketplaceProductDisplayMode)()?(0,t.jsx)(n.Modal.Title,{center:e.center,children:e.children}):(0,t.jsx)(l.Text,{align:"left",as:"h3",lineHeight:32,size:24,children:e.children})}e.s({CheckoutTitle:()=>d},1191645);var u=e.i(4325351),g=e.i(889716),p=e.i(9362924),h=e.i(5175803),m=e.i(3684557),x=e.i(9443759),j=e.i(6530772);function f(){return(0,t.jsx)(j.Suspense,{fallback:null,children:(0,t.jsx)(y,{})})}function y(){let e=(0,a.useInstallMarketplaceProductDisplayMode)(),{team:n}=(0,m.useBreadcrumbTeam)();return n?(0,t.jsxs)("div",{className:(0,x.cn)("flex items-center gap-1 ",{"justify-center":"modal"===e}),children:[(0,t.jsx)(l.Text,{className:"text-[--ds-gray-900]",children:"Installing into"}),(0,t.jsx)(h.Avatar,{teamId:n.id,size:16,hash:n.avatar}),(0,t.jsx)(l.Text,{className:"font-medium",children:n.name})]}):null}function b(e){let{cancelLabel:a,children:o,integration:l,disableCancel:h,onBack:m,SuccessAction:x,product:j,from:y,checkoutContentVariant:b}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r,{children:(0,t.jsxs)(g.Stack,{gap:6,children:[(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)(f,{}),(0,t.jsxs)(g.Stack,{gap:2,children:[(0,t.jsx)(d,{center:!0,children:(0,u.resourceModalTitle)({product:j,integration:l,from:y})}),(0,t.jsx)(c,{children:(0,u.resourceModalSubtitle)({product:j,integration:l,from:y})})]})]}),(0,t.jsx)(s,{variant:b,children:o})]})}),(0,t.jsxs)(i,{children:[(0,t.jsx)(p.DisabledContext.Provider,{value:!1,children:(0,t.jsx)(n.Modal.Action,{disabled:h,onClick:m,type:"secondary",children:a})}),x]})]})}},[3235415,8509880,7156688,6643111,1191645]],8250207:e=>{"use strict";e.s({CreateResourceModal:()=>eP},8250207);var t=e.i(6645307),a=e.i(6530772),n=e.i(8934201),i=e.i(8158100),r=e.i(3821772),o=e.i(3514588),s=e.i(9362924),l=e.i(541360),c=e.i(9147016),d=e.i(8103655),u=e.i(984909),g=e.i(4325351);e.i(3261281);var p=e.i(2985809),h=e.i(2711971),m=e.i(8935578),x=e.i(889716),j=e.i(8084653),f=e.i(2362802),y=e.i(7573892),b=e.i(9802771),k=e.i(3585235),C=e.i(5785123),S=e.i(1183506),M=e.i(9336536);async function I(e){let{integrationId:t,teamId:a,source:n,acceptedPolicies:i,metadata:r,billingPlanId:o,authorizationId:s}=e,l=new URLSearchParams;a&&l.append("teamId",a);let c=l.toString();return await (0,S.fetchAPI)(`${M.API_INTEGRATION_CONTROLLER_V2}/integration/${t}/marketplace/install${c?`?${c}`:""}`,{method:"POST",body:{acceptedPolicies:i,source:n??"marketplace",metadata:r,billingPlanId:o,authorizationId:s},throwOnHTTPError:!0})}var P=e.i(1587761),v=e.i(810713),T=e.i(6248954),w=e.i(1917237),A=e.i(1164214);e.i(6591346);var L=e.i(5037292),B=e.i(4848638),R=e.i(1985432),N=e.i(4392991);function E(e){let{integration:i,product:r,cancelLabel:o,onBack:s,onNext:l,isLoading:c=!1,isTransitioning:d}=e,{hasMetadataErrors:u,isLoading:g,metadataState:j,areMetadataChanged:f}=(0,N.useStoreIntegrationFormContext)(),{plan:y,isBillingPlanSelectionValid:b}=(0,h.useMarketplaceBillingPlansContext)(),k=(0,a.useMemo)(()=>Object.keys(i.metadataSchema?.properties??{}).length>0,[i]);return(0,t.jsx)(m.ResourceModalWrapper,{SuccessAction:(0,t.jsx)(n.Modal.Action,{"data-testid":(0,A.tid)("create-integration-button","store-modal-continue"),disabled:u||!y||!b||c,loading:g||d,onClick:()=>{y&&l(j,y)},children:"Continue"}),cancelLabel:o,checkoutContentVariant:"default",from:"installation",integration:i,onBack:s,product:r,children:(0,t.jsxs)(x.Stack,{gap:5,children:[k?(0,t.jsx)(x.Stack,{className:"border-0 border-b border-solid border-gray-alpha-400 bg-background-200 p-6 px-0",children:(0,t.jsx)(p.ResourceMetadataFieldsWithErrorBoundary,{integrationId:i.id,isLoading:c,productId:"iap_none"})}):null,(0,t.jsx)(x.Stack,{paddingY:6,children:u?(0,t.jsx)(B.BillingPlanMetadataErrors,{integrationSlug:i.slug,isInstallationLevel:!0}):(0,t.jsx)(B.MarketplaceBillingPlanSelectorWithErrorBoundary,{areMetadataChanged:f,arePermissionsLoading:!1,hasLogDrainsSupport:i.products.some(e=>(0,L.isProtocolSupported)(e,"logDrain")),integrationId:i.id,integrationName:i.name,integrationSlug:i.slug,isInstallationLevel:!0,metadata:j,type:"new-installation"})})]})})}function F(e){let{integration:a,product:i,onBack:r,onNext:o,isTransitioning:s}=e,{isLoading:l,metadataState:c,formError:d}=(0,N.useStoreIntegrationFormContext)(),{plan:u}=(0,h.useMarketplaceBillingPlansContext)();return(0,t.jsx)(m.ResourceModalWrapper,{SuccessAction:(0,t.jsxs)(n.Modal.Action,{"data-testid":(0,A.tid)("create-integration-button","store-modal-create"),loading:l||s,onClick:o,children:["Create ",(0,g.getAccountTitleBySlug)({slug:i.slug})]}),cancelLabel:"Back",checkoutContentVariant:"no-padding",from:"installation",integration:a,onBack:r,product:i,children:(0,t.jsxs)(x.Stack,{gap:4,padding:6,children:[(0,t.jsx)(j.Text,{size:16,weight:500,children:"Your Selection"}),d.form?(0,t.jsx)(w.Error,{children:d.form}):null,(0,t.jsx)(R.ReadOnlyMetadataWithErrorBoundary,{integrationId:a.id,metadata:c,metadataErrors:d.metadata,productId:i.id,target:"create"}),(0,t.jsx)(R.ReadOnlyBillingPlan,{billingPlan:u})]})})}var O=e.i(974550),D=e.i(5396709),z=e.i(2169587),U=e.i(7812637);function _(e){let{team:a,requireNew:n,paymentMethodState:i,onBack:r,onNext:o}=e;return(0,t.jsx)(U.PaymentMethodAction,{onBack:r,onNext:o,paymentMethodState:i,requireNew:n,team:a})}var V=e.i(5674541),W=e.i(3277953),$=e.i(2700425),K=e.i(4701001);function q(e){let{teamId:a,integration:i,authorizationId:r,onChangePaymentMethod:o,onBack:s,onNext:l,product:c,success:d,error:u,isTransitioning:g}=e,{authorization:p,error:h,handleUserActions:j}=(0,K.usePollAuthorization)(a,r),f=!!(h||u||p?.status==="failed"),y=p?.status==="requires_action";return(0,t.jsx)(m.ResourceModalWrapper,{SuccessAction:(0,t.jsx)(n.Modal.Action,{disabled:!d,loading:!f&&!d||g,onClick:()=>l(),children:d?"Done":"Processing"}),cancelLabel:"Back",checkoutContentVariant:"no-padding-no-bottom",disableCancel:!(f||y)||d,from:"resource",integration:i,onBack:s,product:c,children:(0,t.jsx)(x.Stack,{gap:4,padding:6,paddingBottom:0,children:(0,t.jsx)(Y,{authorization:p,error:u||(h?"Unknown error":void 0),handleUserActions:j,integration:i,onChangePaymentMethod:o,success:d})})})}function Y(e){let{authorization:a,error:n,success:i,integration:o,handleUserActions:s,onChangePaymentMethod:l}=e;return i?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(x.Stack,{align:"center",direction:"row",gap:2,children:[(0,t.jsx)($.CheckCircle,{color:"green-900",size:16}),(0,t.jsxs)(j.Text,{color:"green-900","data-testid":(0,A.tid)("create-resource-modal","successfully-created"),weight:500,children:[o.name," Account Created Successfully"]})]}),(0,t.jsxs)(j.Text,{className:"text-gray-900",children:["Your"," ",(0,t.jsx)(j.Text,{as:"span",className:"text-gray-1000",children:o.name})," ","account has been created successfully."]})]}):a?.status==="requires_action"?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(x.Stack,{align:"center",direction:"row",gap:2,children:[(0,t.jsx)(W.Warning,{color:"amber-900",size:16}),(0,t.jsx)(j.Text,{color:"amber-900",weight:500,children:"Authentication Needed"})]}),(0,t.jsx)(j.Text,{className:"text-gray-900",children:"Further action is needed. Please authenticate your payment method to continue."}),(0,t.jsx)(V.Button,{onClick:()=>{s()},children:"Authenticate"})]}):a?.status==="failed"?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(w.Error,{children:"Preauthorization Failed"}),(0,t.jsx)(j.Text,{className:"text-gray-900",children:"There was an error using your payment method. Please try again with a different payment method."}),(0,t.jsx)(V.Button,{onClick:()=>l(),children:"Change Payment Method"})]}):n?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(w.Error,{children:n}),(0,t.jsxs)(j.Text,{className:"text-gray-900",children:["There was an error creating your"," ",(0,t.jsx)(j.Text,{as:"span",className:"text-gray-1000",children:o.name})," ","account. Please try again later."]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(x.Stack,{align:"center",direction:"row",gap:2,children:[(0,t.jsx)(r.Spinner,{size:16}),(0,t.jsx)(j.Text,{size:16,weight:500,children:"Processing"})]}),(0,t.jsxs)(j.Text,{className:"text-gray-900",children:["Hold tight, we're processing your order of"," ",(0,t.jsx)(j.Text,{as:"span",className:"text-gray-1000",children:o.name}),"."]})]})}var H=e.i(8392691);function G(e){let{product:a,cancelLabel:n,integration:r,isLoading:o,onSuccess:s,onBack:l,team:c,checkoutContentVariant:d}=e,u=c.enabledInvoiceItems?.vercelMarketplace?.enabled===!0,{can:g,isLoading:p}=(0,k.default)({teamId:c.id}),h=g(C.Action.Create,C.Resource.IntegrationConfiguration),y=(0,T.isResellerCustomer)(c);return u?h||p?(0,t.jsx)(Q,{isLoading:o,cancelLabel:n,integration:r,product:a,team:c,onBack:l,onSuccess:s}):(0,t.jsx)(m.ResourceModalWrapper,{SuccessAction:(0,t.jsx)(v.InstallButton,{account:c,canInstall:!1,hasPermission:!1,onClick:()=>{},children:"Continue"}),cancelLabel:n,checkoutContentVariant:d,from:"installation",integration:r,onBack:l,product:a,children:(0,t.jsx)(x.Stack,{gap:4,children:(0,t.jsxs)(i.Note,{type:"warning",children:["You need additional permissions to install integrations to"," ",c.name||"this"," account. Please contact your account administrator to request the necessary permissions."," ",(0,t.jsx)(f.Link,{external:!0,href:"https://vercel.com/docs/accounts/team-members-and-roles",target:"_blank",children:(0,t.jsx)(j.Text,{children:"Learn more"})})]})})}):(0,t.jsx)(m.ResourceModalWrapper,{SuccessAction:(0,t.jsx)(f.ButtonLink,{href:"/contact/sales",children:"Contact Sales"}),cancelLabel:n,checkoutContentVariant:d,from:"installation",integration:r,onBack:l,product:a,children:(0,t.jsx)(x.Stack,{gap:4,style:{minHeight:0},children:(0,t.jsx)(i.Note,{type:"warning",children:y?(0,t.jsx)(t.Fragment,{children:"The Vercel Marketplace is not yet available for your Enterprise account. You will get notified as soon as it becomes available."}):(0,t.jsx)(t.Fragment,{children:"Your Enterprise account is not yet available to use the Vercel Marketplace. To gain access, contact our team to discuss an account upgrade."})})})})}function X(e){let{team:n,integration:i,product:r,isLoading:o,cancelLabel:s,onBack:l,onSuccess:c}=e,[d,u]=(0,a.useState)("policies"),{onSubmit:g,metadataState:p,formError:k,isLoading:C}=(0,N.useStoreIntegrationFormContext)(),S=i.flags?.includes(P.LaunchDarklyIntegrationFlags.MarketplaceInstallationOnlyPlan),{plan:M}=(0,h.useMarketplaceBillingPlansContext)(),[T,w]=(0,a.useState)(!1),{data:A}=(0,D.useIntegrationPaymentMethodState)(),L=(0,z.useAwaitData)(A),[B,R]=(0,a.useState)(),{createAuthorization:O}=(0,K.useMarketplaceBillingAuthorizationApi)(),V=(0,K.useAwaitAuthorization)(),[W,$]=(0,a.useState)(null),[Y,G]=(0,a.useTransition)(),[X,J]=(0,a.useState)(),{connectProjectAndReturnToV0:Q}=(0,H.useV0Marketplace)()||{},Z=e=>{if(X)return void c(X,M??void 0);let t=Q?"v0":"marketplace";y.analytics.track(b.AnalyticsEvent.MARKETPLACE_INSTALLATION_CREATE_CLICKED,{integration:{id:i.id,slug:i.slug},source:t});let a=e.paymentMethodId??B;M&&u("provisioning"),g(async()=>{let e,r={},o=new Date().toISOString();if(i.eulaDocUri&&(r.eula=o),i.privacyDocUri&&(r.privacy=o),M){let t=await O(n.id,{integrationIdOrSlug:i.id,billingPlanId:M.id,metadata:p,integrationConfigurationId:void 0,paymentMethodId:a});if($(t?.id??null),e=t?.id,t&&"succeeded"!==(await V(n.id,t.id)).status)return}let s=await I({integrationId:i.id,teamId:n.id,acceptedPolicies:r,metadata:p,billingPlanId:M?.id,authorizationId:e,source:t});J(s),a&&await (0,D.updateInstallationPaymentMethod)(n.id,s.id,a),c(s,M??void 0)})};switch(d){case"policies":return(0,t.jsx)(m.ResourceModalWrapper,{SuccessAction:(0,t.jsx)(v.InstallButton,{account:n,canInstall:!0,hasPermission:!0,loading:o||Y||C,onClick:()=>{S?u("select-plan"):Z({paymentMethodId:void 0})},children:S?"Accept and Continue":"Accept and Create"}),cancelLabel:s,checkoutContentVariant:"default",from:"installation",integration:i,onBack:l,product:r,children:(0,t.jsxs)(x.Stack,{gap:4,children:[(0,t.jsxs)(x.Stack,{gap:1,children:[(0,t.jsx)(j.Text,{weight:500,children:"Accept Terms & Conditions"}),(0,t.jsx)(j.Text,{color:"gray-900",children:'By clicking "Accept and Create", you agree to:'})]}),(0,t.jsxs)(x.Stack,{gap:1,children:[(0,t.jsxs)(j.Text,{children:[(0,t.jsx)("span",{className:"pr-1",children:"• "}),(0,t.jsx)(f.Link,{external:!0,href:"/legal/integration-marketplace-end-users-addendum",type:"primary",children:"Vercel Integration Marketplace End User Addendum"})]}),(0,t.jsxs)(j.Text,{children:[(0,t.jsx)("span",{className:"pr-1",children:"• "}),(0,t.jsxs)(f.Link,{external:!0,href:i.eulaDocUri,type:"primary",children:[i.name," EULA"]})]}),(0,t.jsxs)(j.Text,{children:[(0,t.jsx)("span",{className:"pr-1",children:"• "}),(0,t.jsxs)(f.Link,{external:!0,href:i.privacyDocUri,type:"primary",children:[i.name," Privacy Policy"]})]})]}),(0,t.jsxs)(x.Stack,{gap:1,children:[(0,t.jsxs)(j.Text,{className:"text-xs",children:["Vercel may share certain information from your account such as your ",(0,t.jsx)("span",{className:"font-medium",children:"Vercel ID"}),","," ",(0,t.jsx)("span",{className:"font-medium",children:"email address"}),", or"," ",(0,t.jsx)("span",{className:"font-medium",children:"usage data"})," with"," ",i.name,"."]}),(0,t.jsxs)(j.Text,{className:"text-xs",children:["See"," ",(0,t.jsxs)(f.Link,{href:i.privacyDocUri,external:!0,target:"_blank",type:"primary",children:[i.name,"'s Privacy Policy"]})," ","for how your information may be used."]})]})]})});case"select-plan":return(0,t.jsx)(E,{cancelLabel:"Back",integration:i,isLoading:o,isTransitioning:Y,onBack:()=>u("policies"),onNext:function(){G(async()=>{if(M?.paymentMethodRequired){let e=await L;if((0,U.getIsPaymentMethodStepNeeded)(n,e,M))return void u("payment-method")}u("confirm-plan")})},product:r});case"confirm-plan":return(0,t.jsx)(F,{integration:i,isTransitioning:Y,onBack:()=>u("select-plan"),onNext:function(){y.analytics.track(b.AnalyticsEvent.MARKETPLACE_INSTALLATION_PLAN_SELECTED,{integration:{id:i.id,slug:i.slug}}),Z({paymentMethodId:B})},product:r});case"payment-method":return A?(0,t.jsx)(_,{onBack:()=>u("confirm-plan"),onNext:e=>{R(e),w(!1),u("confirm-plan")},paymentMethodState:A,requireNew:T,team:n}):null;case"provisioning":return(0,t.jsx)(q,{authorizationId:W,error:k.form??void 0,integration:i,isTransitioning:Y,onBack:()=>u("confirm-plan"),onChangePaymentMethod:()=>{w(!0),u("payment-method")},onNext:()=>{X&&M&&c(X,M)},product:r,success:!!X,teamId:n.id})}}let J={type:"object",properties:{},additionalProperties:!1,required:[]},Q=(0,O.withStripe)(function(e){return(0,t.jsx)(h.MarketplaceInstallationBillingPlansProvider,{target:"create",children:(0,t.jsx)(p.ResourceFormProvider,{metadataSchema:e.integration.metadataSchema??J,resourceTitle:"Account",target:"create",children:(0,t.jsx)(X,{...e})})})});var Z=e.i(584439),ee=e.i(5535439),et=e.i(6606445),ea=e.i(3326412),en=e.i(2159371),ei=e.i(5425186),er=e.i(8924545),eo=e.i(5610210),es=e.i(5440190),el=e.i(9495609),ec=e.i(3625326),ed=e.i(1553266),eu=e.i(9443759);function eg(e){let{product:a,integration:n,installationId:i,cancelLabel:r,onBack:o,onNext:s,isLoading:l,isTransitioning:c,...d}=e;return(0,t.jsx)(ep,{cancelLabel:r,installationId:i,integration:n,isLoading:l,isTransitioning:c,onBack:o,onNext:s,product:a,...d})}function ep(e){let{product:i,integration:r,installationId:o,cancelLabel:s,onBack:l,onNext:c,isLoading:d,isTransitioning:u,...g}=e,y=r.flags?.includes(P.LaunchDarklyIntegrationFlags.MarketplaceInstallationOnlyPlan),{hasMetadataErrors:b,isLoading:k,metadataState:C,areMetadataChanged:S,target:M}=(0,N.useStoreIntegrationFormContext)(),{plan:I,isSelectedPlanValid:v,isBillingPlanPreselected:T}=(0,h.useMarketplaceBillingPlansContext)(),w=(0,a.useMemo)(()=>Object.keys(i.metadataSchema.properties).length>0,[i]),R=r.supportsInstallationBillingPlans??!1,{protocolSettings:E,protocolSettingsForm:F}=function(e){let[n,i]=(0,a.useState)(void 0);return{protocolSettingsForm:(0,a.useMemo)(()=>{if("protocols"in e&&e.protocols.experimentation?.edgeConfigSyncingSupport){let e=n?.experimentation?.edgeConfigSyncingEnabled??!1;return(0,t.jsx)(x.Stack,{gap:2,children:(0,t.jsx)(ec.IntegrationResourceFormControlWithDescription,{controlKey:"",description:(0,t.jsxs)(t.Fragment,{children:["Synchronizes integration data with Edge Config for ultra-low latency resolution. Additional costs may apply for Edge Config usage."," ",(0,t.jsx)(f.Link,{external:!0,href:"https://vercel.com/docs/integrations/marketplace-flows#experimentation-edge-config-syncing",variant:"highlight",children:"Learn more"})]}),children:(0,t.jsxs)(x.Stack,{align:"center",direction:"row",gap:3,children:[(0,t.jsx)(el.Toggle,{checked:e,onChange:e=>{i(t=>({...t,experimentation:{...t?.experimentation,edgeConfigSyncingEnabled:e}}))},size:"large"}),(0,t.jsx)(j.Text,{color:"gray-900",weight:500,children:"Enable Edge Config Syncing"})]})})})}return null},[e,n,i]),protocolSettings:n}}(i),{data:O}=(0,es.default)(o),D=y||I&&v,z=(0,ed.useInstallMarketplaceProductDisplayMode)();return(0,t.jsx)(m.ResourceModalWrapper,{SuccessAction:(0,t.jsx)(n.Modal.Action,{"data-testid":(0,A.tid)("create-integration-button","store-modal-create"),disabled:b||!D||d,loading:k||u,onClick:()=>{let e=I??(R?O?.billingPlan:void 0);e&&c(C,e,E)},children:"create"===M?"Continue":"Save"}),cancelLabel:s,checkoutContentVariant:"no-padding",from:"resource",integration:r,onBack:l,product:i,children:(0,t.jsxs)(x.Stack,{gap:5,children:[w?(0,t.jsx)(x.Stack,{className:(0,eu.cn)("border-0 border-b border-solid border-gray-alpha-400 bg-background-200",{"p-6":"modal"===z,"pb-6":"inline"===z}),children:(0,t.jsx)(p.ResourceMetadataFieldsWithErrorBoundary,{integrationId:r.id,isLoading:d,productId:i.id})}):null,F?(0,t.jsx)(x.Stack,{className:(0,eo.clsx)("border-0 border-b border-solid border-gray-alpha-400 bg-background-200 px-6",{"pb-6 pt-0":w,"py-6":!w},"inline"===z?" !px-0 pt-0":""),children:F}):null,T||y?null:(0,t.jsx)(x.Stack,{padding:6*("modal"===z),children:b?(0,t.jsx)(B.BillingPlanMetadataErrors,{integrationSlug:r.slug,isInstallationLevel:R}):(0,t.jsx)(B.MarketplaceBillingPlanSelectorWithErrorBoundary,{areMetadataChanged:S,arePermissionsLoading:d,hasLogDrainsSupport:(0,L.isProtocolSupported)(i,"logDrain"),installationId:o,integrationId:r.id,integrationName:r.name,integrationSlug:r.slug,isInstallationLevel:R,metadata:C,productId:i.id,...g})})]})})}var eh=e.i(631755),em=e.i(604868),ex=e.i(6032772);function ej(e){let{integration:r,installationBalance:o,product:s,onBack:l,onNext:c,source:d}=e,u=(0,g.getResourceNameLabelByProduct)(s),{name:p,setName:f,resourceNameError:k}=(0,ex.useResourceName)({product:s,defaultName:`${s.slug.toLowerCase()}-${(0,ex.generateRandomName)()}`}),C=r.flags?.includes(P.LaunchDarklyIntegrationFlags.MarketplaceInstallationOnlyPlan),{isLoading:S,formError:M,metadataState:I}=(0,N.useStoreIntegrationFormContext)(),{plan:v,defaultPlan:T,topUpForm:L,shouldAddTopUpFormStep:B}=(0,h.useMarketplaceBillingPlansContext)(),E=(0,a.useRef)(null),[F,O]=(0,a.useState)(!1),D=(0,em.useIsMobile)();(0,a.useEffect)(()=>{D||setTimeout(()=>{E.current?.focus(),E.current?.select()},0)},[D]);let z=!!(T&&v?.id!==T.id),U=(0,ed.useInstallMarketplaceProductDisplayMode)();return(0,t.jsx)(m.ResourceModalWrapper,{SuccessAction:(0,t.jsx)(n.Modal.Action,{"data-testid":(0,A.tid)("create-resource-modal","confirm-create"),disabled:!p,loading:S,onClick:()=>{if(O(!0),k)return;let e={integration:{id:r.id,slug:r.slug},productSlug:s.slug},t=d?{...e,source:d}:e;y.analytics.track(b.AnalyticsEvent.MARKETPLACE_RESOURCE_PROVISION_CLICKED,t),c({resourceName:p})},children:(0,g.createResourceConfirmationStepLabel)(s)}),cancelLabel:"Back",checkoutContentVariant:"no-padding",from:"resource",integration:r,onBack:l,product:s,children:(0,t.jsxs)(x.Stack,{gap:5,children:[(0,t.jsxs)(x.Stack,{className:"inline"===U?"bg-background-200":"border-0 border-b border-solid border-gray-alpha-400 bg-background-200 p-6",gap:2.5,children:[(0,t.jsx)(eh.Input,{"aria-label":`${u} Name`,disabled:S,error:F?k:void 0,label:`${u} Name (*)`,maxLength:ex.MAX_RESOURCE_NAME_LENGTH,onChange:e=>{f(e.currentTarget.value)},placeholder:`${u.toLowerCase().replace(" ","-")}-name`,ref:E,value:p,width:"100%"}),(0,t.jsxs)(j.Text,{color:"gray-900",size:13,children:["This is how we call your ",u," in the Vercel dashboard and in ",r.name,"."]})]}),(0,t.jsxs)(x.Stack,{gap:4,paddingX:6*("inline"!==U),paddingY:6,children:[(0,t.jsx)(j.Text,{size:16,weight:500,children:"Your Selection"}),z?(0,t.jsx)(i.Note,{fill:!0,type:"secondary",children:"You have selected to upgrade your plan. This upgrade will apply at the installation level."}):null,M.form?(0,t.jsx)(w.Error,{children:M.form}):null,(0,t.jsx)(R.ReadOnlyMetadataWithErrorBoundary,{integrationId:r.id,metadata:I,metadataErrors:M.metadata,productId:s.id,target:"create"}),B&&void 0!==L.getAmountToAdd()?(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(R.ReadOnlyPanel,{title:"Manage Funds",children:[(0,t.jsx)(R.ReadOnlyPanelRecord,{title:"Initial credit balance",children:(0,t.jsx)(j.Text,{children:L.formatCurrency(L.addFundsForm.getValues().amountToAdd)})}),L.rechargeSettingsForm.getValues().autoRecharge?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(R.ReadOnlyPanelRecord,{align:"center",title:"Auto recharge",titleWrap:!1,children:(0,t.jsxs)(j.Text,{color:"gray-900",align:"right",className:"text-balance",children:["add"," ",(0,t.jsx)(j.Text,{as:"span",children:L.formatCurrency(L.rechargeSettingsForm.getValues().topUpAmount)})," ","when balance falls below"," ",(0,t.jsx)(j.Text,{as:"span",children:L.formatCurrency(L.rechargeSettingsForm.getValues().topUpThreshold)}),", up to"," ",(0,t.jsx)(j.Text,{as:"span",children:L.formatCurrency(L.rechargeSettingsForm.getValues().periodSpendMaximum)})," ","per month"]})})}):null]})}):(0,t.jsx)(t.Fragment,{children:o?.currencyValueInCents!==void 0?(0,t.jsx)(R.ReadOnlyPanel,{title:(0,t.jsx)(j.Text,{weight:500,children:"Current balance"}),children:(0,t.jsx)(R.ReadOnlyPanelRecord,{title:"Current installation balance",children:(0,t.jsx)(j.Text,{children:L.formatCurrency((o.currencyValueInCents/100).toFixed(2))})})}):null}),C?null:(0,t.jsx)(R.ReadOnlyBillingPlan,{billingPlan:v})]})]})})}function ef(e){let{team:a,configuration:n,requireNew:i,paymentMethodState:r,onBack:o,onNext:s}=e;return(0,t.jsx)(U.PaymentMethodInstallationAction,{installationId:n.id,onBack:o,onNext:s,paymentMethodState:r,requireNew:i,team:a})}var ey=e.i(3035340);function eb(e){let{team:a,authorizationId:i,onChangePaymentMethod:r,onBack:o,onNext:s,integration:l,product:c,resourceName:d,success:u,isTransitioning:p}=e,{authorization:h,error:x,handleUserActions:j}=(0,K.usePollAuthorization)(a.id,i),{formError:f}=(0,N.useStoreIntegrationFormContext)(),y=!!(x||f.form||h?.status==="failed"),b=h?.status==="requires_action",k=(0,g.getResourceTitleByProduct)(c),C=(0,ed.useInstallMarketplaceProductDisplayMode)();return(0,t.jsx)(m.ResourceModalWrapper,{SuccessAction:(0,t.jsx)(n.Modal.Action,{disabled:!u,loading:!y&&!u||p,onClick:()=>s(),children:u?"Done":"Processing"}),cancelLabel:"Back",checkoutContentVariant:"no-padding-no-bottom",disableCancel:!(y||b)||u,from:"resource",integration:l,onBack:o,product:c,children:(0,t.jsx)("div",{className:(0,eu.cn)('"flex flex-col gap-4 "',"inline"===C?"p-0":"p-6"),children:(0,t.jsx)(ek,{authorization:h,error:f.form||(x?`There was an error creating your ${d||k}`:void 0),handleUserActions:j,integration:l,onChangePaymentMethod:r,product:c,resourceName:d,success:u})})})}function ek(e){let{product:a,resourceName:n,authorization:o,error:s,success:l,integration:c,handleUserActions:d,onChangePaymentMethod:u}=e,p=(0,g.getResourceTitleByProduct)(a);return l?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(x.Stack,{align:"center",direction:"row",gap:2,children:[(0,t.jsx)($.CheckCircle,{color:"green-900",size:16}),(0,t.jsxs)(j.Text,{color:"green-900","data-testid":(0,A.tid)("create-resource-modal","successfully-created"),weight:500,children:[p," Created Successfully"]})]}),(0,t.jsxs)(j.Text,{className:"text-gray-900",children:["Your"," ",(0,t.jsxs)(j.Text,{as:"span",className:"text-gray-1000",children:[c.name," ",p]})," ","has been created successfully."]})]}):o?.status==="requires_action"?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(x.Stack,{align:"center",direction:"row",gap:2,children:[(0,t.jsx)(W.Warning,{color:"amber-900",size:16}),(0,t.jsx)(j.Text,{color:"amber-900",weight:500,children:"Authentication Needed"})]}),(0,t.jsx)(j.Text,{className:"text-gray-900",children:"Further action is needed. Please authenticate your payment method to continue."}),(0,t.jsx)(V.Button,{onClick:()=>{d()},children:"Authenticate"})]}):o?.status==="failed"?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(w.Error,{children:"Preauthorization Failed"}),(0,t.jsx)(j.Text,{className:"text-gray-900",children:"There was an error using your payment method. Please try again with a different payment method."}),(0,t.jsx)(V.Button,{onClick:()=>u(),children:"Change Payment Method"})]}):s?(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(i.Note,{fill:!0,type:"error",children:[(0,ey.default)(s),". Please go back and check your settings before trying again."]})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(x.Stack,{align:"center",direction:"row",gap:2,children:[(0,t.jsx)(r.Spinner,{size:16}),(0,t.jsx)(j.Text,{size:16,weight:500,children:"Processing"})]}),(0,t.jsxs)(j.Text,{className:"text-gray-900",children:["Hold tight, we're processing your order of"," ",(0,t.jsx)(j.Text,{as:"span",className:"text-gray-1000",children:n||p}),"."]})]})}var eC=e.i(5388697);function eS(e){let a=(0,h.useMarketplaceBillingPlansContext)();return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(m.ResourceModalWrapper,{SuccessAction:(0,t.jsx)(n.Modal.Action,{disabled:!1,loading:e.isTransitioning,onClick:async()=>{let t=await a.topUpForm.addFundsForm.trigger(),n=await a.topUpForm.rechargeSettingsForm.trigger();t&&n&&e.onNext()},children:"Continue"}),cancelLabel:"Back",checkoutContentVariant:"default",from:"top-up",integration:e.integration,onBack:()=>{e.onBack()},product:e.product,children:(0,t.jsx)(x.Stack,{className:"pb-6",gap:5,children:(0,t.jsx)("form",{children:(0,t.jsx)(eC.TopUpFormFields,{topUpForm:a.topUpForm,variant:"create"})})})})})}var eM=e.i(8100175);let eI=(0,O.withStripe)(function(e){let n,{arePermissionsLoading:i,isTransitioning:r,startTransition:o,team:s,integration:l,product:c,configuration:d,onBack:u,onIntegrationResourceCreate:g,cancelLabel:p,onStepChange:m}=e,x=(0,ee.useSearchParams)(),j=x?.get("external-id")||void 0,{connectProjectAndReturnToV0:f}=(0,H.useV0Marketplace)()||{};n=(0,eM.useProjectCloneContext)().projectId?"deploy-button":f?"v0":"marketplace";let{onSubmit:k}=(0,N.useStoreIntegrationFormContext)(),[C,S]=(0,a.useState)("select-plan"),{value:M}=(0,ea.useLaunchDarklyTeamFeatureFlag)("marketplace-prepayment-livemode",s.slug),{createResource:I}=(0,ei.useMutateResource)(),{data:P}=(0,en.useMarketplaceBillingBalance)(d.id),[v,T]=(0,a.useState)(),[w,A]=(0,a.useState)(null),[L,B]=(0,a.useState)(!1),{data:R}=(0,D.useInstallationPaymentMethodState)(d.id),E=(0,z.useAwaitData)(R),{createAuthorization:F}=(0,K.useMarketplaceBillingAuthorizationApi)(),O=(0,K.useAwaitAuthorization)(),[_,V]=(0,a.useState)(null),[W,$]=(0,a.useState)(null),[q,Y]=(0,a.useState)(),G=(0,h.useMarketplaceBillingPlansContext)(),X=(0,a.useCallback)((e,t)=>{if(!e.paymentMethodRequired&&!t)return void S("confirm");o(async()=>{let t=await E;if((0,U.getIsPaymentMethodStepNeeded)(s,t,e))return void S("payment-method");S("confirm")})},[E,o,s]),J=(0,a.useCallback)(()=>{v&&X(v,!0)},[v,X]),Q=(0,a.useCallback)(()=>{S("confirm"),B(!1)},[]),eo=(0,a.useCallback)(()=>{B(!0),S("payment-method")},[]),es=(0,a.useCallback)(()=>{if(!W)throw Error("Not created");o(async()=>{if(f){Z.toasts.success(`Created ${W.name} successfully. Redirecting back to v0.`);try{(0,et.track)("v0/marketplace/integration-connected",{integrationId:l.id,productId:c.id}),await f({integrationId:l.id,productId:c.id,resourceId:W.id,productSlug:c.slug})}catch(t){let e="[object Error]"===Object.prototype.toString.call(t)?t.message:String(t);(0,et.track)("v0/marketplace/integration-connect-failed",{integrationId:l.id,productId:c.id,error:e}),Z.toasts.error("Failed to connect integration to v0.")}}else await g(W)})},[W,o,f,l.id,c.id,c.slug,g]);switch(C){case"select-plan":return(0,t.jsx)(eg,{cancelLabel:p,installationId:d.id,integration:l,isLoading:i,isTransitioning:r,onBack:()=>{m?.(),u()},onNext:(e,t,a)=>{m?.(),function(e,t,a){if(y.analytics.track(b.AnalyticsEvent.MARKETPLACE_PRODUCT_PLAN_SELECTED,{integration:{id:l.id,slug:l.slug},productSlug:c.slug,source:n}),T(t),Y(a),G.shouldAddTopUpFormStep&&("installation"!==t.scope||(P?.balance?.currencyValueInCents??0)===0)){let e=P?.balance?.currencyValueInCents;G.topUpForm.setup({type:"create",billingPlan:t,currentBalance:e?(e/100).toString():void 0}),S("top-up");return}X(t,!1)}(0,t,a)},product:c,type:"product"});case"payment-method":return R?(0,t.jsx)(ef,{configuration:d,onBack:()=>{m?.(),S("select-plan")},onNext:()=>{m?.(),Q()},paymentMethodState:R,requireNew:L,team:s}):null;case"confirm":return(0,t.jsx)(ej,{cancelLabel:p,installationBalance:P?.balance,integration:l,onBack:()=>{m?.(),S("select-plan")},onNext:e=>{m?.(),function(e){let{resourceName:t}=e;A(t),k(async e=>{let{metadata:a}=e;if(S("provisioning"),!v)throw Error("Billing plan is missing");let i=M&&"prepayment"===v.type?G.topUpForm.getAmountToAdd():void 0,r=await F(s.id,{integrationIdOrSlug:l.id,productId:c.id,integrationConfigurationId:d.id,billingPlanId:v.id,metadata:a,prepaymentAmountCents:i});if(V(r?.id??null),r&&"succeeded"!==(await O(s.id,r.id)).status)return;let o=await I({metadata:a,externalId:j,billingPlanId:v.id,name:t,integrationConfigurationId:d.id,integrationProductIdOrSlug:c.id,authorizationId:r?.id??void 0,protocolSettings:q,source:n});if(y.analytics.track(b.AnalyticsEvent.MARKETPLACE_RESOURCE_INSTALL_CLICKED,{integration:{id:l.id,slug:l.slug},productSlug:c.slug,source:n}),"prepayment"===v.type){if(!M){let e=G.topUpForm.getAmountToAdd();void 0!==e&&e>0&&await (0,er.provisionPurchaseForResourceTestmode)({teamId:s.id,integrationConfigurationId:d.id,resourceId:o.id,billingPlanId:v.id,amountCents:e})}await G.topUpForm.requests.updateRechargeSettingsForResource({billingPlanId:v.id,resourceId:o.id,teamId:s.id,configurationId:d.id,metadata:a})}$(o)},{noTransition:!0,resourceName:t})}({resourceName:e.resourceName})},product:c,source:n});case"provisioning":return(0,t.jsx)(eb,{authorizationId:_,cancelLabel:p,configurationId:d.id,integration:l,isTransitioning:r,onBack:()=>{m?.(),S("confirm")},onChangePaymentMethod:eo,onNext:()=>{m?.(),es()},product:c,resourceName:w,success:!!W,team:s});case"top-up":return(0,t.jsx)(eS,{integration:l,isTransitioning:r,onBack:()=>{m?.(),S("select-plan")},onNext:()=>{m?.(),J()},product:c})}});function eP(e){let{onBack:n,onIntegrationResourceCreate:i,cancelLabel:r,product:s,integration:c,teamSlug:d,team:g,initialConfigurationStatus:p,neonIntegrationStatus:h,onStepChange:m}=e,{team:x}=(0,o.useTeam)(d),j=g??x,{pushToDetailPath:f}=(0,u.usePushToStorePath)(),{configurationStatus:y,onConfigurationInstalled:b}=(0,l.useConfigurationStatus)({initialConfigurationStatus:p}),{data:k}=(0,es.default)(!y.isLoading&&y.isInstalled?y.configuration.id:void 0),[C,S]=(0,a.useState)(!1);if((0,a.useEffect)(()=>{h.isLoading||S(!0)},[h.isLoading]),y.isLoading||!j||h.isLoading&&!C)return(0,t.jsx)(eT,{cancelLabel:r,integration:c,onBack:n,product:s});if(!y.isInstalled)return(0,t.jsx)(G,{cancelLabel:r,checkoutContentVariant:"default",integration:c,isLoading:!c,onBack:n,onSuccess:b,product:s,team:j});if(!k)return(0,t.jsx)(eT,{cancelLabel:r,integration:c,onBack:n,product:s});let M=c.supportsInstallationBillingPlans?k.billingPlan??y.configuration.billingPlan:void 0;return(0,t.jsx)(ev,{onStepChange:m,cancelLabel:r,configuration:k,installationBillingPlan:y.billingPlan??M,integration:c,onBack:n,onIntegrationResourceCreate:i,preselectedBillingPlan:y.billingPlan,product:s,team:j})}function ev(e){let{team:n,installationBillingPlan:r,preselectedBillingPlan:o,integration:l,product:u,configuration:x,onStepChange:j,onBack:f,onIntegrationResourceCreate:y,cancelLabel:b}=e,{canCreateResource:k,isLoading:C,isDeleteRequested:S}=(0,c.useInstallationPermissions)(x.id),[M,I]=(0,a.useTransition)();return S?(0,t.jsx)(m.ResourceModalWrapper,{SuccessAction:null,cancelLabel:b,checkoutContentVariant:"default",from:"resource",integration:l,onBack:f,product:u,children:(0,t.jsx)(i.Note,{type:"warning",children:`${(0,g.pendingDeletionLabel)("create",u,n.name)}`})}):C||k?(0,t.jsx)(p.ResourceFormProvider,{metadataSchema:u.metadataSchema,resourceTitle:d.storeTitle.integration,target:"create",children:(0,t.jsx)(h.MarketplaceInstallationBillingPlansProvider,{defaultPlan:o??r,isBillingPlanPreselected:!!o,target:"create",children:(0,t.jsx)(s.DisabledContext.Provider,{value:C||M,children:(0,t.jsx)(eI,{arePermissionsLoading:C,cancelLabel:b,configuration:x,integration:l,isTransitioning:M,onBack:f,onIntegrationResourceCreate:y,product:u,startTransition:I,team:n,onStepChange:j})})})}):(0,t.jsx)(m.ResourceModalWrapper,{SuccessAction:null,cancelLabel:b,checkoutContentVariant:"default",from:"resource",integration:l,onBack:f,product:u,children:(0,t.jsx)(i.Note,{type:"warning",children:`${(0,g.missingPermissionLabel)("create",u,n.name)}`})})}function eT(e){return(0,t.jsx)(m.ResourceModalWrapper,{SuccessAction:(0,t.jsx)(n.Modal.Action,{buttonType:"submit",disabled:!0,loading:!0,children:"Continue"}),from:"installation",checkoutContentVariant:"default",...e,children:(0,t.jsx)("div",{className:"flex size-full items-center justify-center py-16",children:(0,t.jsx)(r.Spinner,{})})})}},9074732:e=>{"use strict";e.s({},9074732),e.i(5804958),e.i(3649433),e.i(5602259),e.i(7978003),e.i(2007222)},2405013:[e=>{"use strict";e.s({ResourceModalsProvider:()=>v},2405013);var t,a=e.i(6645307),n=e.i(1775063),i=e.i(889716),r=e.i(8934201),o=e.i(4946541),s=e.i(6530772),l=e.i(7573892),c=e.i(9802771),d=e.i(4418725);e.i(7196151);var u=e.i(5330315),g=e.i(541360);e.i(9074732);var p=e.i(5602259),h=e.i(7555208),m=e.i(4325351),x=e.i(4862373),j=e.i(5037292),f=e.i(1310591),y=e.i(3827171),b=e.i(9199642),k=e.i(1993163),C=e.i(3331605),S=e.i(8250207),M=e.i(5535439);e.s({getIntegrationCheckoutUrl:()=>I},4871862);let I=(t=e=>`/${e.params.teamSlug}/~/integrations/checkout/${e.params.integrationSlug}`,e=>{let a=Object.entries(e.searchParams||{}).reduce((e,t)=>{let[a,n]=t;return null!=n&&(e[a]=n),e},{}),n=t(e),i=n.startsWith("/")?n.substring(1):n;if(Object.entries(a).length>0){let e=new URLSearchParams(a).toString();return`/${i}?${e}`}return`/${i}`});function P(){let e=(0,d.useTeamSlug)(),{data:t}=(0,h.useConfigurations)({type:"marketplace",skipBillingData:!0}),{hasProject:n}=(0,f.useProjectSlug)(),{state:P,onClose:v,onBack:T,onAnimationDone:w,protocolType:A,onResourceUpdated:L,maybeGoToConnectProjectStep:B,goToCreateResourceStep:R,switchTab:N}=(0,k.useResourceModalsContext)(),{data:E}=(0,u.useResourceList)({protocolType:A}),F=(0,M.useRouter)(),O=`create-connect-${P.modalKey}`,[D,z]=(0,s.useState)(),U=(0,s.useRef)(null),_=(0,s.useCallback)(()=>{z(void 0),w()},[w]),V=(0,s.useCallback)(()=>{z(void 0),v()},[v]),W=(0,s.useCallback)(e=>{L({resource:e,isConnected:!1}),B(e)},[B,L]);switch(P.type){case C.ResourceModalsActionTypes.ModalClosed:return(0,a.jsx)(r.Modal.Modal,{active:P.active,allowOverflow:!0,onAnimationDone:_,onClickOutside:v,width:620,children:(0,a.jsx)("div",{})},O);case C.ResourceModalsActionTypes.BrowseProudctsOrSelectResources:return(0,a.jsx)(r.Modal.Modal,{active:P.active,allowOverflow:!0,onAnimationDone:_,onClickOutside:v,width:"browse-new"===P.tab?540:620,children:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.Modal.Body,{className:"p-8",children:(0,a.jsxs)(i.Stack,{gap:6,ref:U,children:[(0,a.jsx)(i.Stack,{gap:2,children:(0,a.jsx)(r.Modal.Title,{center:!0,children:(0,m.browseProductsOrSelectResourcesModalTitle)(A)})}),(0,a.jsxs)(o.Switch,{name:"switch-new-existing-tab",children:[(0,a.jsx)(o.Switch.Control,{defaultChecked:"browse-new"===P.tab,label:"Create New",onChange:()=>{N("browse-new")},size:"large",value:"create",width:104}),(0,a.jsx)(o.Switch.Control,{defaultChecked:"browse-existing"===P.tab,disabled:E?.stores.length===0,label:"Select Existing",onChange:()=>{N("browse-existing")},size:"large",value:"connect",width:122})]}),"browse-new"===P.tab?(0,a.jsx)(x.BrowseProducts,{onClickProduct:e=>{z(e)},protocolType:A,selectedProduct:D}):null,"browse-existing"===P.tab?(0,a.jsx)(p.SelectResources,{hasCreateConnectButton:!1,onClickConnectStoreModal:e=>B(e),protocolType:A}):null]})}),(0,a.jsxs)(r.Modal.Actions,{children:[(0,a.jsx)(r.Modal.Action,{onClick:V,type:"secondary",children:"Cancel"}),"browse-new"===P.tab?(0,a.jsx)(r.Modal.Action,{disabled:!D,onClick:()=>{D&&("integration"===D.type?F.push(I({params:{teamSlug:e??"",integrationSlug:D.integration.slug},searchParams:{productSlug:D.product.slug,cancelUrl:`${window.location.pathname}${window.location.search}`}})):R(D))},children:"Continue"}):null]})]})},O);case C.ResourceModalsActionTypes.BrowseProducts:return(0,a.jsx)(r.Modal.Modal,{active:P.active,allowOverflow:!0,onAnimationDone:_,onClickOutside:v,width:540,children:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.Modal.Body,{className:"p-8",children:(0,a.jsxs)(i.Stack,{gap:6,ref:U,children:[(0,a.jsx)(i.Stack,{gap:2,children:(0,a.jsx)(r.Modal.Title,{center:!0,children:(0,m.browseProductsModalTitle)(A)})}),(0,a.jsx)(x.BrowseProducts,{onClickProduct:e=>{z(e)},protocolType:A,selectedProduct:D})]})}),(0,a.jsxs)(r.Modal.Actions,{children:[(0,a.jsx)(r.Modal.Action,{onClick:V,type:"secondary",children:"Cancel"}),(0,a.jsx)(r.Modal.Action,{disabled:!D,onClick:()=>{D&&("integration"===D.type?(F.push(I({params:{teamSlug:e??"",integrationSlug:D.integration.slug},searchParams:{productSlug:D.product.slug,cancelUrl:`${window.location.pathname}${window.location.search}`}})),l.analytics.track(c.AnalyticsEvent.MARKETPLACE_PRODUCT_INSTALL_CLICKED,{source:"storage",integration:{id:D.integration.id,slug:D.integration.slug},productSlug:D.product.slug})):R(D))},children:"Continue"})]})]})},O);case C.ResourceModalsActionTypes.CreateResource:{if("integration"!==P.resourceWithProduct.type)return null;let n=P.resourceWithProduct.integration;return(0,a.jsx)(r.Modal.Modal,{active:P.active,allowOverflow:!0,onAnimationDone:_,onClickOutside:v,width:540,children:(0,a.jsx)(S.CreateResourceModal,{cancelLabel:P.backOrCancelLabel,initialConfigurationStatus:(0,g.getConfigurationStatusByIntegrationId)(t,n.id),integration:n,neonIntegrationStatus:{isNeonDisabled:!1,isLoading:!1},onBack:T,onIntegrationResourceCreate:W,product:(0,j.getProductWithSupportedProtocols)(P.resourceWithProduct.product),teamSlug:e??""})},O)}case C.ResourceModalsActionTypes.CreateEnvs:if(P.connection)return(0,a.jsx)(y.UpdateResourceConnectionModal,{active:P.active,connection:P.connection,onAnimationDone:_,onClickOutside:v,onConnectionCreated:()=>L({resource:P.resource,isConnected:!0}),resourceId:P.resource.id,store:P.resource},O);if(n)return(0,a.jsx)(r.Modal.Modal,{active:P.active,allowOverflow:!0,onAnimationDone:_,onClickOutside:v,width:540,children:(0,a.jsx)(y.ConnectResourceForCurrentProjectStep,{resource:P.resource})},O);return(0,a.jsx)(y.CreateResourceConnectionModal,{active:P.active,onAnimationDone:_,onClickOutside:v,onConnectionCreated:()=>L({resource:P.resource,isConnected:!0}),resourceId:P.resource.id,store:P.resource},O);case C.ResourceModalsActionTypes.DeleteEnvs:return(0,a.jsx)(b.DeleteStoreConnectionModal,{active:P.active,connections:P.connections,onAnimationDone:_,onClickOutside:v,resourceId:P.resourceId,resourceTitle:(0,m.getResourceTitleByResource)(P.resource)},O)}}function v(e){let{children:t,protocolType:i}=e;return(0,a.jsx)(n.ResourceModalsProviderBase,{Modal:(0,a.jsx)(P,{}),protocolType:i,children:t})}},[4871862]]}]);

//# sourceMappingURL=d4c2a06c88a83c20.js.map
//# debugId=876c8ebf-fdec-547a-b00c-56dc57ce2df1
