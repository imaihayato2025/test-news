
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="205505d5-4ccd-5c9c-91d0-5f713acea01e")}catch(e){}}();
(globalThis.TURBOPACK=globalThis.TURBOPACK||[]).push(["object"==typeof document?document.currentScript:void 0,{2200343:e=>{"use strict";e.s({FluidProvider:()=>r,useFluidContext:()=>o});var i=e.i(6645307),n=e.i(6530772);let t=(0,n.createContext)(null);t.displayName="FluidContext";let o=()=>{let e=(0,n.useContext)(t);if(null===e)throw Error("useFluidContext must be used within a FluidProvider");return e};function r(e){let{isInitiallyEnabled:o,isMultiRegionFlagEnabled:r,children:l}=e,[s,a]=(0,n.useState)(o),c=(0,n.useMemo)(()=>({enabled:s,multiRegionFlagEnabled:r,setEnabled:a}),[s,r]);return(0,i.jsx)(t.Provider,{value:c,children:l})}},9017257:e=>{e.v({icon:"function-region-module__MD4iKa__icon",note:"function-region-module__MD4iKa__note"})},7703656:e=>{"use strict";e.s({FunctionRegionFieldset:()=>L});var i=e.i(6645307),n=e.i(6530772),t=e.i(7315479),o=e.i(6921100),r=e.i(3921802),l=e.i(8158100),s=e.i(5163670),a=e.i(889716),c=e.i(8084653),u=e.i(4519408),d=e.i(4357575),h=e.i(1871902),g=e.i(2362802),f=e.i(2893464),p=e.i(4583851),x=e.i(3514588),m=e.i(3585235),j=e.i(5785123),b=e.i(604868),y=e.i(5610210),v=e.i(5111663),T=e.i(2240289),S=e.i(1389821),k=e.i(2408607),C=e.i(5747252),F=e.i(2631193),w=e.i(2200343),D=e.i(6958389),A=e.i(9017257);let N=e=>{switch(e){case"hobby":default:return 1;case"pro":return 3;case"enterprise":return Number.MAX_SAFE_INTEGER}};function L(){let{multiRegionFlagEnabled:e}=(0,w.useFluidContext)();return e?(0,i.jsx)(E,{}):(0,i.jsx)(R,{})}function R(){let e=(0,S.useProjectIdOrName)(),{team:r,isReady:u}=(0,x.useTeam)(),{data:d,mutate:h}=(0,T.useProject)(e,{apiVersion:"v10"}),{modal:b,open:y}=(0,v.useSaveAndRedeploy)(d),{can:F,isLoading:w}=(0,m.default)(),[N,L]=(0,n.useState)(null),[R,E]=(0,n.useState)(!1),P=d?.serverlessFunctionRegion||"sfo1",[M,_,U]=(0,C.default)(P),I=!d||!u||w,$=M!==P,V=F(j.Action.Update,j.Resource.Project),z=!I&&V&&$,B=!!d?.connectConfigurations?.length;async function O(){E(!0);try{L(null),await (0,k.default)(e,r?.id,{serverlessFunctionRegion:M}),U(),await h(),y("Updated Function Region successfully.")}catch(e){L((0,t.errorToString)(e))}E(!1)}return(0,i.jsxs)(D.ProjectSettingsFieldset,{description:"",disabled:I||B||!V,disabledForBilling:(!!I||!V)&&void 0,error:N,highlightNote:!I&&!V,note:I?(0,i.jsx)(s.Skeleton,{height:32,width:200}):V?(0,i.jsxs)(c.Text,{children:["Learn more about"," ",(0,i.jsx)(g.Link,{external:!0,href:"/docs/serverless-functions/regions",type:"highlight",children:"Function Region"})]}):(0,i.jsx)(c.Text,{lineHeight:32,children:"You need additional permissions to manage your project's serverless function region."}),onSave:I?void 0:O,saveDisabled:!z,saveLoading:R,title:"Function Region",children:[(0,i.jsxs)(a.Stack,{className:"w-full",direction:"column",children:[(0,i.jsxs)(a.Stack,{className:"mb-4",gap:2,children:[(0,i.jsx)(c.Text,{children:"This is the region on Vercel's network that your Vercel Functions will execute in by default. It should be close to any data source that your Vercel Functions query."}),B?null:(0,i.jsx)(c.Text,{children:"You can override this in the Function's configuration. A new Deployment is required for your changes to take effect."})]}),(0,i.jsx)(s.Skeleton,{show:I,children:(0,i.jsxs)(a.Stack,{gap:4,children:[(0,i.jsx)(o.Select,{disabled:I||B,onChange:e=>_(e.target.value),value:B?void 0:M||void 0,children:Object.entries(p.groups).map(e=>{let[n,t]=e;return(0,i.jsx)("optgroup",{label:n,children:t.map(e=>"bru1"===e.key&&d?.serverlessFunctionRegion!=="bru1"?null:(0,i.jsx)("option",{value:e.key,children:`${e.name} (${e.cardinal}) â€“ ${e.key}`},`sfr-region-${e.key}`))},`sfr-group-${n}`)})}),B?(0,i.jsx)(l.Note,{className:A.default.note,label:!1,children:(0,i.jsxs)(a.Stack,{align:"center",direction:"row",gap:2,children:[(0,i.jsx)("div",{className:A.default.icon,children:(0,i.jsx)(f.Connection,{})}),(0,i.jsxs)("div",{children:["This project uses Secure Compute. Environments connected to a Secure Compute network have Function region determined by"," ",(0,i.jsx)(g.Link,{href:"https://vercel.com/docs/secure-compute#specific-region",children:"region of the network"}),"."]})]})}):null]})})]}),b]})}function E(){let e=(0,S.useProjectIdOrName)(),{team:o,isReady:w}=(0,x.useTeam)(),{openModal:L}=(0,F.useUpgradeToProButton)(),R=(0,b.useMediaQuery)(515),E=(0,b.useMediaQuery)(650),{data:P,mutate:M}=(0,T.useProject)(e,{apiVersion:"v10"}),{modal:_,open:U}=(0,v.useSaveAndRedeploy)(P),{can:I,isLoading:$}=(0,m.default)(),[V,z]=(0,n.useState)(null),[B,O]=(0,n.useState)(!1),H=o?.billing?.plan==="hobby",Y=o?.billing?.plan==="pro",q=o?.billing?.plan==="enterprise",Z=P?.resourceConfig?.functionDefaultRegions??["sfo1"],[G,K,Q]=(0,C.default)(Z),X=!o||!P||!w||$,J=G.some(e=>!Z.includes(e))||G.length!==Z.length,W=I(j.Action.Update,j.Resource.Project),ee=G.length>N(o?.billing?.plan),ei=!X&&W&&G.length>0&&J&&!ee,en=!!P?.connectConfigurations?.length;async function et(){O(!0);try{z(null),await (0,k.default)(e,o?.id,{resourceConfig:{functionDefaultRegions:G}}),Q(),await M(),U("Updated Function Regions successfully.")}catch(e){z((0,t.errorToString)(e))}O(!1)}return(0,i.jsxs)(D.ProjectSettingsFieldset,{description:"",disabled:X||en||!W,disabledForBilling:(!!X||!W)&&void 0,error:V,highlightNote:!X&&!W,note:X?(0,i.jsx)(s.Skeleton,{height:32,width:200}):W?(0,i.jsxs)(c.Text,{children:["Learn more about"," ",(0,i.jsx)(g.Link,{external:!0,href:"/docs/serverless-functions/regions",type:"highlight",children:"Function Regions"})]}):(0,i.jsx)(c.Text,{lineHeight:32,children:"You need additional permissions to manage your project's serverless function regions."}),onSave:X?void 0:et,saveDisabled:!ei,saveLoading:B,title:`Function ${Y||q?"Regions":"Region"}`,children:[(0,i.jsxs)(a.Stack,{className:"w-full",direction:"column",children:[(0,i.jsxs)(a.Stack,{className:"mb-4",gap:2,children:[(0,i.jsxs)(c.Text,{lineHeight:20,children:["These are the regions on Vercel's network that your Vercel Functions will execute in."," ",H?"You are limited to 1 region on your current Hobby plan.":null,Y?"You can use up to 3 regions on your current Pro plan.":null]}),(0,i.jsx)(c.Text,{lineHeight:20,children:"A new Deployment is required for your changes to take effect."})]}),(0,i.jsx)(s.Skeleton,{className:(0,y.clsx)(X?"overflow-hidden":""),show:X,children:(0,i.jsxs)(a.Stack,{gap:4,children:[(0,i.jsx)(u.ChoiceboxGroup,{disabled:X||en,label:"select function regions",onChange:e=>{K(e)},type:"checkbox",value:G,children:(0,i.jsx)(d.CollapseGroup,{multiple:!0,children:Object.entries(p.groups).map(e=>{let[n,t]=e,o=t.filter(e=>G.includes(e.key)),l=G.filter(e=>!Z.includes(e)),s=8;return E&&(s=4),R&&(s=3),(0,i.jsx)(h.Collapse,{size:"small",title:n,titleSuffix:(0,i.jsx)("div",{className:"-my-4 inline-flex space-x-2",children:o.length<=s?(0,i.jsx)(i.Fragment,{children:o.map(e=>(0,i.jsx)(r.Badge,{capitalize:!1,size:"sm",variant:l.includes(e.key)?"blue-subtle":"gray-subtle",children:e.key},`selected-region-${e.key}`))}):(0,i.jsx)(i.Fragment,{children:o.at(0)?(0,i.jsxs)(r.Badge,{capitalize:!1,size:"sm",variant:l.length>0?"blue-subtle":"gray-subtle",children:[o.at(0)?.key,"+",o.length-1]}):null})}),children:(0,i.jsx)("div",{className:"mb-5 grid grid-cols-2 gap-3",children:t.map(e=>"bru1"===e.key&&P?.serverlessFunctionRegion!=="bru1"?null:(0,i.jsx)(u.ChoiceboxGroup.Item,{className:"col-span-2 xl:col-span-1",title:(0,i.jsxs)("span",{children:[e.name," (",e.cardinal,")",R?(0,i.jsx)("br",{}):" - ",e.providerRegion," - ",e.key]}),value:e.key},`sfr-region-${e.key}`))})},`sfr-group-${n}`)})})}),ee?(0,i.jsx)(l.Note,{children:(0,i.jsxs)(c.Text,{children:[`Regions for ${o?.billing?.plan.charAt(0).toUpperCase()}${o?.billing?.plan.substr(1)} projects ${1===N(o?.billing?.plan)?"are limited to":"must be between 1 and"} ${N(o?.billing?.plan)}`,". ",o?.billing?.plan==="hobby"?(0,i.jsx)(g.Link,{as:"button",onClick:()=>{L({source:"project-settings-function-region-on-hobby"})},type:"highlight",children:"Upgrade to Pro."}):null,o?.billing?.plan==="pro"?(0,i.jsx)(g.Link,{external:!0,href:"/contact",type:"highlight",children:"Upgrade to Enterprise."}):null]})}):null,en?(0,i.jsx)(l.Note,{className:A.default.note,label:!1,children:(0,i.jsxs)(a.Stack,{align:"center",direction:"row",gap:2,children:[(0,i.jsx)("div",{className:A.default.icon,children:(0,i.jsx)(f.Connection,{})}),(0,i.jsxs)("div",{children:["This project uses Secure Compute. Environments connected to a Secure Compute network have Function region determined by the"," ",(0,i.jsx)(g.Link,{href:"https://vercel.com/docs/secure-compute#specific-region",children:"network region"}),"."]})]})}):null]})})]}),_]})}},5037263:e=>{"use strict";e.s({FunctionFailoverRegionFieldset:()=>C});var i=e.i(6645307),n=e.i(6530772),t=e.i(5163670),o=e.i(889716),r=e.i(9495609),l=e.i(8084653),s=e.i(8811733),a=e.i(8158100),c=e.i(2893464),u=e.i(9802771),d=e.i(7573892),h=e.i(7315479),g=e.i(3514588),f=e.i(534589),p=e.i(2362802),x=e.i(3585235),m=e.i(5785123),j=e.i(2240289),b=e.i(1389821),y=e.i(2408607),v=e.i(5747252),T=e.i(5111663),S=e.i(9017257),k=e.i(6958389);function C(){let e=(0,b.useProjectIdOrName)(),{team:C,isLoading:F}=(0,g.useTeam)(),[w,D]=(0,n.useState)(!1),[A,N]=(0,n.useState)(),{can:L,isLoading:R}=(0,x.default)(),{data:E,isLoading:P,mutate:M}=(0,j.useProject)(e,{apiVersion:"v13"}),_=!!(E?.serverlessFunctionZeroConfigFailover??E?.defaultResourceConfig?.functionZeroConfigFailover),{modal:U,open:I}=(0,T.useSaveAndRedeploy)(E),[$,V,z]=(0,v.default)(_),B=F||P||R,O=L(m.Action.Update,m.Resource.Project),H=!B&&C?.billing?.plan==="enterprise"&&O,Y=H&&$!==_,q=!!E?.connectConfigurations?.length,Z=async()=>{D(!0);try{await (0,y.default)(e,C?.id,{serverlessFunctionZeroConfigFailover:$}),z(),await M(),I("Updated Function Failover successfully")}catch(e){N((0,h.errorToString)(e))}finally{D(!1)}};return(0,i.jsxs)(k.ProjectSettingsFieldset,{description:"",disabled:!H,error:A,highlightNote:!B&&!O,note:B?(0,i.jsx)(t.Skeleton,{height:32,width:200}):C?.billing?.plan!=="enterprise"?(0,i.jsxs)(l.Text,{children:["This feature is Enterprise only."," ",(0,i.jsx)(p.Link,{external:!0,href:f.CONTACT_SALES_DASHBOARD_HREF,type:"highlight",children:"Contact Sales"})]}):O?(0,i.jsxs)(l.Text,{children:["Learn more about"," ",(0,i.jsx)(p.Link,{external:!0,href:"/docs/functions/configuring-functions/region#automatic-failover",onClick:()=>{d.analytics.track(u.AnalyticsEvent.FUNCTION_FAILOVER_CTA_CLICKED,{teamId:C.id,plan:C.billing?.plan})},type:"highlight",children:"Function Failover"})]}):(0,i.jsx)(l.Text,{children:"You need additional permissions to manage your project's serverless function failover."}),onSave:Z,saveDisabled:!Y,saveLoading:w,title:"Function Failover",children:[(0,i.jsxs)(o.Stack,{gap:2,children:[(0,i.jsxs)(l.Text,{lineHeight:20,children:["Automatically failover Vercel Functions to the nearest region. You can customize regions through ",(0,i.jsx)("code",{children:"vercel.json"}),"."]}),(0,i.jsx)(l.Text,{lineHeight:20,children:"A new Deployment is required for your changes to take effect."})]}),(0,i.jsx)(s.Spacer,{y:.5}),(0,i.jsx)(o.Stack,{align:"center",direction:"row",gap:1,children:(0,i.jsxs)(o.Stack,{align:"center",direction:"row",gap:2,children:[(0,i.jsx)(r.Toggle,{checked:$,disabled:q,onChange:()=>V(!$),size:"large"}),(0,i.jsx)(l.Text,{children:$?"Enabled":"Disabled"})]})}),q?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.Spacer,{y:.5}),(0,i.jsx)(a.Note,{className:S.default.note,label:!1,children:(0,i.jsxs)(o.Stack,{align:"center",direction:"row",gap:2,children:[(0,i.jsx)("div",{className:S.default.icon,children:(0,i.jsx)(c.Connection,{})}),(0,i.jsxs)("div",{children:["This project uses Secure Compute. Environments connected to a Secure Compute network should configure Function failover through a"," ",(0,i.jsx)(p.Link,{href:"/docs/secure-compute#region-failover",children:"passive network"}),"."]})]})})]}):null,U]})}},9609060:e=>{"use strict";e.s({FunctionResourceConfig:()=>w},9609060);var i=e.i(6645307),n=e.i(6530772),t=e.i(2240289),o=e.i(1389821),r=e.i(5163670),l=e.i(889716),s=e.i(8084653),a=e.i(631755),c=e.i(2926635),u=e.i(8158100),d=e.i(3514588),h=e.i(854226),g=e.i(2781454),f=e.i(2362802),p=e.i(3585235),x=e.i(5785123),m=e.i(2631193),j=e.i(5111663),b=e.i(2408607),y=e.i(5629469),v=e.i(1017295),T=e.i(6958389),S=e.i(6700141);function k(e){let{timeout:n,billingPlan:t}=e,o="hobby"===t?10:15;return n&&n>o?(0,i.jsx)(u.Note,{children:(0,i.jsxs)(s.Text,{children:["Modifying the ",o," seconds default can impact billing. Make sure you set it based on expected backend response times."," ",(0,i.jsx)(f.Link,{external:!0,href:"/docs/functions/configuring-functions/duration#consequences-of-changing-the-maximum-duration",type:"highlight",children:"Learn more about the impact."})]})}):null}function C(t){let o,{projectData:C,isProjectLoading:F,onRevalidateProject:w,resourceConfigState:D,onSetResourceConfigState:A}=t,{can:N,isLoading:L}=(0,p.default)(),{modal:R,open:E}=(0,j.useSaveAndRedeploy)(C),{team:P,isReady:M}=(0,d.useTeam)(),{openModal:_}=(0,m.useUpgradeToProButton)(),{track:U}=(0,h.useTrackActivity)();P?.billing?.plan==="hobby"?o="Pro":P?.billing?.plan==="pro"&&(o="Enterprise");let[I,$]=(0,n.useState)(!1),[V,z]=(0,n.useState)(""),B=!M||L||F,O=N(x.Action.Update,x.Resource.Project),H=!B&&O&&""===V&&D?.functionDefaultTimeout!==C?.resourceConfig?.functionDefaultTimeout,Y=async()=>{if(C&&D?.functionDefaultTimeout){$(!0);try{await (0,b.default)(C.id,P?.id,{resourceConfig:{functionDefaultTimeout:D.functionDefaultTimeout}}),U(g.VercelActivityAction.ProjectSettingsUpdated,{name:"function-max-duration",projectId:C.id,teamId:P?.id??"",value:D.functionDefaultTimeout}),await w(),E("Updated Function Default Max Duration setting successfully.")}catch(i){await e.r(4869406)(e.i).then(e=>{let{errorToString:n}=e;z(n(i))})}finally{$(!1)}}},q=(0,v.isFluidEnabled)(C),Z=(0,S.useNetCpuFunctionsFlag)(),G=q&&Z.isReady&&Z.value,K=(0,y.getDefaultConfig)(P?.billing?.plan,q,G);return(0,i.jsxs)(T.ProjectSettingsFieldset,{description:"",highlightNote:!B,note:B?(0,i.jsx)(r.Skeleton,{height:32,width:200}):(0,i.jsxs)(s.Text,{children:["Learn more about"," ",(0,i.jsx)(f.Link,{external:!0,href:"/docs/functions/limitations#max-duration",type:"highlight",children:"Function Max Duration"})]}),onSave:Y,saveDisabled:!H,saveLoading:I,title:"Function Max Duration",children:[(0,i.jsxs)(l.Stack,{gap:2,children:[(0,i.jsxs)(s.Text,{lineHeight:20,children:["This setting controls the default maximum duration for all Vercel Functions in this project. You can"," ",(0,i.jsx)(f.Link,{external:!0,href:"/docs/functions/configuring-functions/duration#maximum-duration-for-different-runtimes",type:"highlight",children:"optionally override"})," ","this setting at the function level."]}),(0,i.jsx)(s.Text,{lineHeight:20,children:"A new Deployment is required for your changes to take effect."}),(0,i.jsx)(r.Skeleton,{show:B,children:(0,i.jsxs)("div",{className:"mt-0.5 flex flex-col space-y-3",children:[(0,i.jsx)(c.Description,{className:"m-px [&_[data-geist-error]]:hidden",content:(0,i.jsx)(a.Input,{"aria-label":"MaxDuration",disabled:B,error:""!==V?"true":"",max:900,maxLength:48,min:0,onChange:e=>{let n=e.target.valueAsNumber;A({...D,functionDefaultTimeout:n});let t=900;t=P?.billing?.plan==="pro"?300:P?.billing?.plan==="enterprise"?900:60,q&&(t=K.maxDuration),isNaN(n)||n<1||n>t?z((0,i.jsx)(u.Note,{children:(0,i.jsxs)(s.Text,{children:[`Max duration for ${P?.billing?.plan.charAt(0).toUpperCase()}${P?.billing?.plan.substr(1)} projects must be between 1 and ${t}`,"."," ",n>t&&"Pro"===o?(0,i.jsx)(f.Link,{as:"button",onClick:()=>_({source:"project-settings-function-max-duration-on-hobby"}),type:"highlight",children:"Upgrade to Pro."}):null,n>t&&!q&&"Enterprise"===o?(0,i.jsx)(f.Link,{external:!0,href:"/contact",type:"highlight",children:"Upgrade to Enterprise."}):null]})})):z("")},placeholder:String(K.duration),step:K.duration,suffix:"seconds",typeName:"number",value:`${D?.functionDefaultTimeout}`,width:200}),title:"Default Max Duration",tooltip:"The default maximum duration for your Vercel Functions, which can be overridden on function level."}),""!==V?V:null,q?null:(0,i.jsx)(k,{billingPlan:P?.billing?.plan,timeout:D?.functionDefaultTimeout})]})})]}),R]})}var F=e.i(987190);function w(){let[e,r]=(0,n.useState)({functionDefaultTimeout:void 0,functionDefaultMemoryType:void 0}),l=(0,o.useProjectIdOrName)(),{data:s,isLoading:a,mutate:c}=(0,t.useProject)(l,{apiVersion:"v13"});(0,n.useEffect)(()=>{s?.resourceConfig&&r({functionDefaultTimeout:s.resourceConfig.functionDefaultTimeout,functionDefaultMemoryType:s.resourceConfig.functionDefaultMemoryType})},[s]);let u=e=>{r(e)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(C,{isProjectLoading:a,onRevalidateProject:c,onSetResourceConfigState:u,projectData:s,resourceConfigState:e}),(0,i.jsx)(F.FunctionDefaultMemoryType,{isProjectLoading:a,onRevalidateProject:c,onSetResourceConfigState:u,projectData:s,resourceConfigState:e})]})}},2621610:e=>{"use strict";e.s({FluidAdvancedSettings:()=>l});var i=e.i(6645307),n=e.i(8692769),t=e.i(8084653),o=e.i(7916122),r=e.i(6530772);function l(e){let{children:l}=e,[s,a]=(0,r.useState)(!1);return(0,i.jsxs)(n.Material,{className:"overflow-hidden divide-y divide-gray-alpha-400 [&_[data-geist-fieldset-footer]]:border-t-0 [&_[data-geist-fieldset-footer]]:bg-background-100 [&_[data-geist-fieldset]]:shadow-none",children:[(0,i.jsxs)("button",{className:"flex items-center bg-background-100 p-6 text-left hover:bg-gray-100",onClick:()=>a(!s),type:"button",children:[(0,i.jsxs)("span",{className:"flex grow flex-col gap-2",children:[(0,i.jsx)(t.Text,{as:"span",size:20,weight:600,children:"Advanced Settings"}),(0,i.jsx)(t.Text,{as:"span",children:"Configure detailed function settings manually."})]}),(0,i.jsx)("span",{className:"flex items-center justify-center transition-transform [&[data-open='true']]:rotate-90","data-open":s,children:(0,i.jsx)(o.ChevronRight,{})})]}),s?l:null]})}},3067035:e=>{"use strict";e.s({ToggleFieldset:()=>C});var i=e.i(6645307),n=e.i(6530772),t=e.i(8084653),o=e.i(889716),r=e.i(9495609),l=e.i(8934201),s=e.i(3921802),a=e.i(8679640),c=e.i(5535439),u=e.i(5610210),d=e.i(2362802),h=e.i(6606445),g=e.i(854226),f=e.i(2781454),p=e.i(7315479),x=e.i(6958389),m=e.i(2408607),j=e.i(2240289),b=e.i(987190),y=e.i(5111663),v=e.i(2200343),T=e.i(5629469),S=e.i(1017295),k=e.i(6700141);function C(e){let{project:l,canUpdateProject:s,isInitiallyEnabled:a,isUsingActiveCPU:u}=e,b=(0,c.useRouter)(),[k,C]=(0,n.useTransition)(),{data:w,mutate:D}=(0,j.useProject)(l.id,{apiVersion:"v13"}),{enabled:A,setEnabled:N}=(0,v.useFluidContext)(),[L,R]=(0,n.useState)(!1),[E,P]=(0,n.useState)(null),[M,_]=(0,n.useState)(!1),{modal:U,open:I}=(0,y.useSaveAndRedeploy)(w),{track:$}=(0,g.useTrackActivity)(),V=(0,S.isFluidEnabled)(w),z=async()=>{R(!0);try{await (0,m.default)(l.id,l.teamSlug,{resourceConfig:{fluid:A}}),I(`${A?"Enabled":"Disabled"} Fluid compute successfully.`),(0,h.track)(`Fluid Compute ${A?"Enabled":"Disabled"}`,{projectId:l.id,accountId:l.accountId??null,plan:l.plan}),$(f.VercelActivityAction.ProjectSettingsUpdated,{name:"fluid",projectId:l.id,teamId:l.accountId??"",value:{enabled:A,plan:l.plan}}),await D(),_(!1),C(()=>{b.refresh()})}catch(e){P((0,p.errorToString)(e))}R(!1)},B=w?.resourceConfig,O=function(e){let{plan:i,config:n,isUsingActiveCPU:t}=e,o=t?T.fluidConfig.on_active_cpu[i]:T.fluidConfig.on[i],r=T.fluidConfig.off[i],l={duration:[n?.duration??r.duration,n?.duration??o.duration],maxDuration:[r.maxDuration,o.maxDuration]};if(!n)return{...l,cpu:[r.cpu,o.cpu]};let{cpu:s}=n;return"hobby"!==i&&"standard_legacy"===s&&(l.cpu=[s,o.cpu]),"hobby"===i&&t&&(l.cpu=["standard_legacy",o.cpu]),"enterprise"!==i||n.secureCompute||n.failover||(l.failover=[!1,!0]),l}({plan:l.plan,config:w?{cpu:B?.functionDefaultMemoryType,duration:B?.functionDefaultTimeout,secureCompute:!!w.connectConfigurations?.length,failover:!!w.serverlessFunctionZeroConfigFailover}:void 0,isUsingActiveCPU:u}),H=Object.keys(O).length>0;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(F,{changes:O,onClose:()=>_(!1),onContinue:z,open:M}),(0,i.jsxs)(x.ProjectSettingsFieldset,{description:"",disabled:!s,error:E,note:s?(0,i.jsxs)(t.Text,{color:"gray-900",children:["Learn more about"," ",(0,i.jsx)(d.Link,{external:!0,href:"/docs/fluid-compute",type:"highlight",children:"Fluid compute"})]}):(0,i.jsx)(t.Text,{color:"gray-900",children:"You need additional permissions to manage your project's fluid compute setting."}),onSave:()=>{if(A&&H)return _(!0);z()},saveDisabled:A===a,saveLoading:L||k,title:"Fluid Compute",children:[(0,i.jsxs)(o.Stack,{gap:2,children:[(0,i.jsx)(t.Text,{lineHeight:20,children:"Enable fluid compute for your Vercel Functions to automatically manage concurrency and optimize performance. Vercel will handle the defaults to ensure the best experience for your workload."}),(0,i.jsx)(t.Text,{lineHeight:20,children:"A new Deployment is required for your changes to take effect."}),(0,i.jsxs)(o.Stack,{align:{md:"center"},direction:{md:"row"},gap:3,children:[(0,i.jsxs)("label",{className:"flex cursor-pointer items-center gap-3",children:[(0,i.jsx)(r.Toggle,{checked:A,onChange:()=>N(!A),size:"large"}),(0,i.jsx)(t.Text,{as:"span",children:A?"Enabled":"Disabled"})]}),V&&l.teamSlug?(0,i.jsx)(d.Link,{href:`/${l.teamSlug}/${l.name}/observability/vercel-functions?advanced=true`,type:"highlight",children:"View Fluid compute metrics"}):null]})]}),U]})]})}function F(e){let{changes:o,open:r,onClose:s,onContinue:a}=e,[c,d]=(0,n.useState)(!1),h=Object.keys(o).length>0;return(0,i.jsxs)(l.Modal.Modal,{active:r,onClickOutside:s,width:580,children:[(0,i.jsxs)(l.Modal.Body,{children:[(0,i.jsxs)(l.Modal.Header,{children:[(0,i.jsx)(l.Modal.Title,{children:"Enable Fluid Compute"}),(0,i.jsx)(l.Modal.Subtitle,{children:"Enabling fluid functions will change your default function settings."})]}),h?(0,i.jsxs)("ul",{className:"m-0 p-0 space-y-2",children:[o.cpu?(0,i.jsx)(w,{from:o.cpu[0],to:o.cpu[1]}):null,(0,i.jsx)(D,{label:"max function duration",left:(0,i.jsxs)(t.Text,{children:[o.duration[0],"s default, up to ",o.maxDuration[0],"s"]}),right:(0,i.jsxs)(t.Text,{children:[o.duration[1],"s default, up to ",o.maxDuration[1],"s"]})}),o.failover?(0,i.jsx)(D,{label:"function failover",left:(0,i.jsx)(t.Text,{children:o.failover[0]?"Enabled":"Disabled"}),right:(0,i.jsx)(t.Text,{children:o.failover[1]?"Enabled":"Disabled"})}):null]}):null,(0,i.jsxs)("div",{className:(0,u.clsx)(h&&"mt-6 space-y-2"),children:[(0,i.jsx)(t.Text,{lineHeight:20,size:16,weight:500,children:"In-function concurrency is part of the fluid compute baseline."}),(0,i.jsx)(t.Text,{lineHeight:20,children:"A new Deployment is required for your changes to take effect."})]})]}),(0,i.jsxs)(l.Modal.Actions,{children:[(0,i.jsx)(l.Modal.Action,{onClick:()=>{d(!1),s()},type:"secondary",children:"Cancel"}),(0,i.jsx)(l.Modal.Action,{loading:c,onClick:()=>{d(!0),a().then(()=>{d(!1)})},children:"Enable"})]})]})}function w(e){let{from:n,to:r}=e,l=(0,k.useNetCpuFunctionsFlag)(),a=b.LAMBDA_DEFAULT_MEMORY_SIZE_TEMPLATE[n],c=l.isReady&&l.value?b.LAMBDA_DEFAULT_MEMORY_SIZE_TEMPLATE_ACTIVE_CPU[r]:b.LAMBDA_DEFAULT_MEMORY_SIZE_TEMPLATE[r];return(0,i.jsx)(D,{label:"function CPU",left:(0,i.jsxs)(o.Stack,{align:"center",direction:"row",gap:2,children:[(0,i.jsx)(t.Text,{children:a.label}),(0,i.jsxs)(s.Badge,{capitalize:!1,size:"sm",variant:"gray-subtle",children:[a.cpu," vCPUs"]}),(0,i.jsxs)(s.Badge,{capitalize:!1,size:"sm",variant:"gray-subtle",children:[a.memory,"GB Memory"]})]}),right:(0,i.jsxs)(o.Stack,{align:"center",direction:"row",gap:2,children:[(0,i.jsx)(t.Text,{children:c.label}),(0,i.jsxs)(s.Badge,{capitalize:!1,size:"sm",variant:"blue-subtle",children:[c.cpu," vCPUs"]}),(0,i.jsxs)(s.Badge,{capitalize:!1,size:"sm",variant:"blue-subtle",children:[c.memory,"GB Memory"]})]})})}function D(e){let{label:n,left:r,right:l}=e;return(0,i.jsxs)("div",{className:"grid grid-cols-[1fr,auto,1fr] items-center gap-1",children:[(0,i.jsxs)(o.Stack,{className:"h-full rounded border border-solid border-gray-alpha-400 p-3",gap:1,justify:"space-between",children:[(0,i.jsxs)(t.Text,{color:"gray-900",children:["Current ",n]}),r]}),(0,i.jsx)("div",{className:"flex rotate-90 items-center justify-center md:rotate-0",children:(0,i.jsx)(a.ChevronRightSmall,{color:"gray-900"})}),(0,i.jsxs)(o.Stack,{className:"h-full rounded border border-solid border-gray-alpha-400 p-3",gap:1,justify:"space-between",children:[(0,i.jsxs)(t.Text,{color:"gray-900",children:["New ",n]}),l]})]})}}}]);

//# sourceMappingURL=e644dd54666bdcdd.js.map
//# debugId=205505d5-4ccd-5c9c-91d0-5f713acea01e
