
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="cf014908-955c-560c-a53f-7d4434bbd562")}catch(e){}}();
(globalThis.TURBOPACK=globalThis.TURBOPACK||[]).push(["object"==typeof document?document.currentScript:void 0,{318846:e=>{"use strict";e.s({CrossSmall:()=>t});let t=(0,e.i(6895406).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M9.96966 11.0303L10.5 11.5607L11.5607 10.5L11.0303 9.96966L9.06065 7.99999L11.0303 6.03032L11.5607 5.49999L10.5 4.43933L9.96966 4.96966L7.99999 6.93933L6.03032 4.96966L5.49999 4.43933L4.43933 5.49999L4.96966 6.03032L6.93933 7.99999L4.96966 9.96966L4.43933 10.5L5.49999 11.5607L6.03032 11.0303L7.99999 9.06065L9.96966 11.0303Z" fill="currentColor"/>')},3295385:e=>{"use strict";e.s({Command:()=>R},3295385);var t=/[\\\/_+.#"@\[\(\{&]/,r=/[\\\/_+.#"@\[\(\{&]/g,l=/[\s-]/,n=/[\s-]/g;function a(e){return e.toLowerCase().replace(n," ")}var i=e.i(3050824),o=e.i(6530772),s=e.i(762985),u=e.i(3743934),d=e.i(2845703),c='[cmdk-group=""]',m='[cmdk-group-items=""]',f='[cmdk-item=""]',p=`${f}:not([aria-disabled="true"])`,v="cmdk-item-select",g="data-value",h=(e,i,o)=>(function(e,i,o){return function e(a,i,o,s,u,d,c){if(d===i.length)return u===a.length?1:.99;var m=`${u},${d}`;if(void 0!==c[m])return c[m];for(var f,p,v,g,h=s.charAt(d),b=o.indexOf(h,u),x=0;b>=0;)(f=e(a,i,o,s,b+1,d+1,c))>x&&(b===u?f*=1:t.test(a.charAt(b-1))?(f*=.8,(v=a.slice(u,b-1).match(r))&&u>0&&(f*=Math.pow(.999,v.length))):l.test(a.charAt(b-1))?(f*=.9,(g=a.slice(u,b-1).match(n))&&u>0&&(f*=Math.pow(.999,g.length))):(f*=.17,u>0&&(f*=Math.pow(.999,b-u))),a.charAt(b)!==i.charAt(d)&&(f*=.9999)),(f<.1&&o.charAt(b-1)===s.charAt(d+1)||s.charAt(d+1)===s.charAt(d)&&o.charAt(b-1)!==s.charAt(d))&&.1*(p=e(a,i,o,s,b+1,d+2,c))>f&&(f=.1*p),f>x&&(x=f),b=o.indexOf(h,b+1);return c[m]=x,x}(e=o&&o.length>0?`${e+" "+o.join(" ")}`:e,i,a(e),a(i),0,0,{})})(e,i,o),b=o.createContext(void 0),x=()=>o.useContext(b),y=o.createContext(void 0),w=()=>o.useContext(y),C=o.createContext(void 0),j=o.forwardRef((e,t)=>{let r=P(()=>{var t,r;return{search:"",value:null!=(r=null!=(t=e.value)?t:e.defaultValue)?r:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),l=P(()=>new Set),n=P(()=>new Map),a=P(()=>new Map),i=P(()=>new Set),d=V(e),{label:x,children:w,value:C,onValueChange:j,filter:S,shouldFilter:k,loop:N,disablePointerSelection:E=!1,vimBindings:I=!0,...A}=e,R=(0,u.useId)(),F=(0,u.useId)(),L=(0,u.useId)(),$=o.useRef(null),z=M();O(()=>{if(void 0!==C){let e=C.trim();r.current.value=e,T.emit()}},[C]),O(()=>{z(6,J)},[]);let T=o.useMemo(()=>({subscribe:e=>(i.current.add(e),()=>i.current.delete(e)),snapshot:()=>r.current,setState:(e,t,l)=>{var n,a,i,o;if(!Object.is(r.current[e],t)){if(r.current[e]=t,"search"===e)H(),U(),z(1,G);else if("value"===e){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let e=document.getElementById(L);e?e.focus():null==(n=document.getElementById(R))||n.focus()}if(z(7,()=>{var e;r.current.selectedItemId=null==(e=_())?void 0:e.id,T.emit()}),l||z(5,J),(null==(a=d.current)?void 0:a.value)!==void 0){null==(o=(i=d.current).onValueChange)||o.call(i,null!=t?t:"");return}}T.emit()}},emit:()=>{i.current.forEach(e=>e())}}),[]),K=o.useMemo(()=>({value:(e,t,l)=>{var n;t!==(null==(n=a.current.get(e))?void 0:n.value)&&(a.current.set(e,{value:t,keywords:l}),r.current.filtered.items.set(e,q(t,l)),z(2,()=>{U(),T.emit()}))},item:(e,t)=>(l.current.add(e),t&&(n.current.has(t)?n.current.get(t).add(e):n.current.set(t,new Set([e]))),z(3,()=>{H(),U(),r.current.value||G(),T.emit()}),()=>{a.current.delete(e),l.current.delete(e),r.current.filtered.items.delete(e);let t=_();z(4,()=>{H(),(null==t?void 0:t.getAttribute("id"))===e&&G(),T.emit()})}),group:e=>(n.current.has(e)||n.current.set(e,new Set),()=>{a.current.delete(e),n.current.delete(e)}),filter:()=>d.current.shouldFilter,label:x||e["aria-label"],getDisablePointerSelection:()=>d.current.disablePointerSelection,listId:R,inputId:L,labelId:F,listInnerRef:$}),[]);function q(e,t){var l,n;let a=null!=(n=null==(l=d.current)?void 0:l.filter)?n:h;return e?a(e,r.current.search,t):0}function U(){if(!r.current.search||!1===d.current.shouldFilter)return;let e=r.current.filtered.items,t=[];r.current.filtered.groups.forEach(r=>{let l=n.current.get(r),a=0;l.forEach(t=>{a=Math.max(e.get(t),a)}),t.push([r,a])});let l=$.current;W().sort((t,r)=>{var l,n;let a=t.getAttribute("id"),i=r.getAttribute("id");return(null!=(l=e.get(i))?l:0)-(null!=(n=e.get(a))?n:0)}).forEach(e=>{let t=e.closest(m);t?t.appendChild(e.parentElement===t?e:e.closest(`${m} > *`)):l.appendChild(e.parentElement===l?e:e.closest(`${m} > *`))}),t.sort((e,t)=>t[1]-e[1]).forEach(e=>{var t;let r=null==(t=$.current)?void 0:t.querySelector(`${c}[${g}="${encodeURIComponent(e[0])}"]`);null==r||r.parentElement.appendChild(r)})}function G(){let e=W().find(e=>"true"!==e.getAttribute("aria-disabled")),t=null==e?void 0:e.getAttribute(g);T.setState("value",t||void 0)}function H(){var e,t,i,o;if(!r.current.search||!1===d.current.shouldFilter){r.current.filtered.count=l.current.size;return}r.current.filtered.groups=new Set;let s=0;for(let n of l.current){let l=q(null!=(t=null==(e=a.current.get(n))?void 0:e.value)?t:"",null!=(o=null==(i=a.current.get(n))?void 0:i.keywords)?o:[]);r.current.filtered.items.set(n,l),l>0&&s++}for(let[e,t]of n.current)for(let l of t)if(r.current.filtered.items.get(l)>0){r.current.filtered.groups.add(e);break}r.current.filtered.count=s}function J(){var e,t,r;let l=_();l&&((null==(e=l.parentElement)?void 0:e.firstChild)===l&&(null==(r=null==(t=l.closest(c))?void 0:t.querySelector('[cmdk-group-heading=""]'))||r.scrollIntoView({block:"nearest"})),l.scrollIntoView({block:"nearest"}))}function _(){var e;return null==(e=$.current)?void 0:e.querySelector(`${f}[aria-selected="true"]`)}function W(){var e;return Array.from((null==(e=$.current)?void 0:e.querySelectorAll(p))||[])}function Z(e){let t=W()[e];t&&T.setState("value",t.getAttribute(g))}function Q(e){var t;let r=_(),l=W(),n=l.findIndex(e=>e===r),a=l[n+e];null!=(t=d.current)&&t.loop&&(a=n+e<0?l[l.length-1]:n+e===l.length?l[0]:l[n+e]),a&&T.setState("value",a.getAttribute(g))}function X(e){let t=_(),r=null==t?void 0:t.closest(c),l;for(;r&&!l;)l=null==(r=e>0?function(e,t){let r=e.nextElementSibling;for(;r;){if(r.matches(t))return r;r=r.nextElementSibling}}(r,c):function(e,t){let r=e.previousElementSibling;for(;r;){if(r.matches(t))return r;r=r.previousElementSibling}}(r,c))?void 0:r.querySelector(p);l?T.setState("value",l.getAttribute(g)):Q(e)}let Y=()=>Z(W().length-1),ee=e=>{e.preventDefault(),e.metaKey?Y():e.altKey?X(1):Q(1)},et=e=>{e.preventDefault(),e.metaKey?Z(0):e.altKey?X(-1):Q(-1)};return o.createElement(s.Primitive.div,{ref:t,tabIndex:-1,...A,"cmdk-root":"",onKeyDown:e=>{var t;null==(t=A.onKeyDown)||t.call(A,e);let r=e.nativeEvent.isComposing||229===e.keyCode;if(!(e.defaultPrevented||r))switch(e.key){case"n":case"j":I&&e.ctrlKey&&ee(e);break;case"ArrowDown":ee(e);break;case"p":case"k":I&&e.ctrlKey&&et(e);break;case"ArrowUp":et(e);break;case"Home":e.preventDefault(),Z(0);break;case"End":e.preventDefault(),Y();break;case"Enter":{e.preventDefault();let t=_();if(t){let e=new Event(v);t.dispatchEvent(e)}}}}},o.createElement("label",{"cmdk-label":"",htmlFor:K.inputId,id:K.labelId,style:D},x),B(e,e=>o.createElement(y.Provider,{value:T},o.createElement(b.Provider,{value:K},e))))}),S=o.forwardRef((e,t)=>{var r,l;let n=(0,u.useId)(),a=o.useRef(null),i=o.useContext(C),c=x(),m=V(e),f=null!=(l=null==(r=m.current)?void 0:r.forceMount)?l:null==i?void 0:i.forceMount;O(()=>{if(!f)return c.item(n,null==i?void 0:i.id)},[f]);let p=L(n,a,[e.value,e.children,a],e.keywords),g=w(),h=F(e=>e.value&&e.value===p.current),b=F(e=>!!f||!1===c.filter()||!e.search||e.filtered.items.get(n)>0);function y(){var e,t;j(),null==(t=(e=m.current).onSelect)||t.call(e,p.current)}function j(){g.setState("value",p.current,!0)}if(o.useEffect(()=>{let t=a.current;if(!(!t||e.disabled))return t.addEventListener(v,y),()=>t.removeEventListener(v,y)},[b,e.onSelect,e.disabled]),!b)return null;let{disabled:S,value:k,onSelect:N,forceMount:E,keywords:I,...A}=e;return o.createElement(s.Primitive.div,{ref:(0,d.composeRefs)(a,t),...A,id:n,"cmdk-item":"",role:"option","aria-disabled":!!S,"aria-selected":!!h,"data-disabled":!!S,"data-selected":!!h,onPointerMove:S||c.getDisablePointerSelection()?void 0:j,onClick:S?void 0:y},e.children)}),k=o.forwardRef((e,t)=>{let{heading:r,children:l,forceMount:n,...a}=e,i=(0,u.useId)(),c=o.useRef(null),m=o.useRef(null),f=(0,u.useId)(),p=x(),v=F(e=>!!n||!1===p.filter()||!e.search||e.filtered.groups.has(i));O(()=>p.group(i),[]),L(i,c,[e.value,e.heading,m]);let g=o.useMemo(()=>({id:i,forceMount:n}),[n]);return o.createElement(s.Primitive.div,{ref:(0,d.composeRefs)(c,t),...a,"cmdk-group":"",role:"presentation",hidden:!v||void 0},r&&o.createElement("div",{ref:m,"cmdk-group-heading":"","aria-hidden":!0,id:f},r),B(e,e=>o.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?f:void 0},o.createElement(C.Provider,{value:g},e))))}),N=o.forwardRef((e,t)=>{let{alwaysRender:r,...l}=e,n=o.useRef(null),a=F(e=>!e.search);return r||a?o.createElement(s.Primitive.div,{ref:(0,d.composeRefs)(n,t),...l,"cmdk-separator":"",role:"separator"}):null}),E=o.forwardRef((e,t)=>{let{onValueChange:r,...l}=e,n=null!=e.value,a=w(),i=F(e=>e.search),u=F(e=>e.selectedItemId),d=x();return o.useEffect(()=>{null!=e.value&&a.setState("search",e.value)},[e.value]),o.createElement(s.Primitive.input,{ref:t,...l,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":d.listId,"aria-labelledby":d.labelId,"aria-activedescendant":u,id:d.inputId,type:"text",value:n?e.value:i,onChange:e=>{n||a.setState("search",e.target.value),null==r||r(e.target.value)}})}),I=o.forwardRef((e,t)=>{let{children:r,label:l="Suggestions",...n}=e,a=o.useRef(null),i=o.useRef(null),u=F(e=>e.selectedItemId),c=x();return o.useEffect(()=>{if(i.current&&a.current){let e=i.current,t=a.current,r,l=new ResizeObserver(()=>{r=requestAnimationFrame(()=>{let r=e.offsetHeight;t.style.setProperty("--cmdk-list-height",r.toFixed(1)+"px")})});return l.observe(e),()=>{cancelAnimationFrame(r),l.unobserve(e)}}},[]),o.createElement(s.Primitive.div,{ref:(0,d.composeRefs)(a,t),...n,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":u,"aria-label":l,id:c.listId},B(e,e=>o.createElement("div",{ref:(0,d.composeRefs)(i,c.listInnerRef),"cmdk-list-sizer":""},e)))}),A=o.forwardRef((e,t)=>{let{open:r,onOpenChange:l,overlayClassName:n,contentClassName:a,container:s,...u}=e;return o.createElement(i.Root,{open:r,onOpenChange:l},o.createElement(i.Portal,{container:s},o.createElement(i.Overlay,{"cmdk-overlay":"",className:n}),o.createElement(i.Content,{"aria-label":e.label,"cmdk-dialog":"",className:a},o.createElement(j,{ref:t,...u}))))}),R=Object.assign(j,{List:I,Item:S,Input:E,Group:k,Separator:N,Dialog:A,Empty:o.forwardRef((e,t)=>F(e=>0===e.filtered.count)?o.createElement(s.Primitive.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),Loading:o.forwardRef((e,t)=>{let{progress:r,children:l,label:n="Loading...",...a}=e;return o.createElement(s.Primitive.div,{ref:t,...a,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":n},B(e,e=>o.createElement("div",{"aria-hidden":!0},e)))})});function V(e){let t=o.useRef(e);return O(()=>{t.current=e}),t}var O="undefined"==typeof window?o.useEffect:o.useLayoutEffect;function P(e){let t=o.useRef();return void 0===t.current&&(t.current=e()),t}function F(e){let t=w(),r=()=>e(t.snapshot());return o.useSyncExternalStore(t.subscribe,r,r)}function L(e,t,r){let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],n=o.useRef(),a=x();return O(()=>{var i;let o=(()=>{var e;for(let t of r){if("string"==typeof t)return t.trim();if("object"==typeof t&&"current"in t)return t.current?null==(e=t.current.textContent)?void 0:e.trim():n.current}})(),s=l.map(e=>e.trim());a.value(e,o,s),null==(i=t.current)||i.setAttribute(g,o),n.current=o}),n}var M=()=>{let[e,t]=o.useState(),r=P(()=>new Map);return O(()=>{r.current.forEach(e=>e()),r.current=new Map},[e]),(e,l)=>{r.current.set(e,l),t({})}};function B(e,t){let r,{asChild:l,children:n}=e;return l&&o.isValidElement(n)?o.cloneElement("function"==typeof(r=n.type)?r(n.props):"render"in r?r.render(n.props):n,{ref:n.ref},t(n.props.children)):t(n)}var D={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"}},7525208:e=>{"use strict";e.s({CommandMenu:()=>c});var t=e.i(6645307),r=e.i(1164214),l=e.i(3295385),n=e.i(1268665),a=e.i(8382218),i=e.i(5163670),o=e.i(8084653),s=e.i(1209519),u=e.i(9443759),d=e.i(6530772);function c(e){let{label:o,options:s,isLoading:c,isSelected:p,onChange:v,onSearch:g,parseNewValue:h,getId:b,getValue:x,value:y,open:w,reverse:C,...j}=e,[S,k]=(0,d.useState)(""),[N,E]=(0,d.useState)(!1),[I,A]=(0,d.useState)(!1),R=(0,d.useRef)(null),V=(0,d.useRef)(null),O=(0,d.useRef)(0);(0,d.useEffect)(()=>{y&&w&&setTimeout(()=>{let e=V.current?.querySelector(`[data-value="${x(y)}"]`);e?.scrollIntoView({block:"start"})},50)},[w]);let P=(0,d.useMemo)(()=>s?.length?`Find ${o}...`:`Enter ${o}`,[s,o]),{selected:F,groups:L}=(0,d.useMemo)(()=>{let e={selected:[],groups:{}};for(let t of s??[])if(p?.(t))e.selected.push(t);else{let r=t.group??"";r in e.groups||(e.groups[r]=[]),e.groups[r].push(t)}return e},[s,p]),M=(0,d.useMemo)(()=>h&&S.length>0&&(s??[]).every(e=>b(e)!==S),[S,s,b,h]),B=(0,d.useCallback)(e=>{if(h){let t=h(e);null===t?E(!0):(v(t),k(""),R.current?.focus())}},[v,h]),D=(0,d.useCallback)(e=>{k(e),E(!1),clearTimeout(O.current),g&&(O.current=setTimeout(()=>{A(!0),g(e).finally(()=>A(!1))},250))},[g]),$=(0,d.useCallback)(e=>{if("Tab"===e.key)e.key=e.shiftKey?"ArrowUp":"ArrowDown";else if(" "===e.key&&0===S.trim().length){e.preventDefault();let t=V.current?.querySelector('[aria-selected="true"] input[type="checkbox"]');t?.click()}},[S]);return(0,t.jsxs)(l.Command,{className:(0,u.cn)("w-100 rounded-lg border-gray-alpha-400 bg-background-100 shadow-menu flex",C?"flex-col-reverse":"flex-col"),loop:!0,onKeyDown:$,children:[(0,t.jsxs)("div",{className:(0,u.cn)("flex w-full items-center justify-between px-4 py-3",s?.length!==0&&"border-b"),children:[(0,t.jsx)(l.Command.Input,{className:(0,u.cn)("w-full border-none bg-transparent text-sm outline-none",N&&"text-[--geist-error]"),onValueChange:D,placeholder:P,ref:R,value:S}),(0,t.jsx)(a.Kbd,{small:!0,style:{paddingRight:"0.5rem"},children:"Esc"})]}),(0,t.jsxs)(l.Command.List,{className:"flex max-h-[288px] w-full flex-col overflow-y-auto",ref:V,children:[s&&!c?(0,t.jsxs)(t.Fragment,{children:[F.length?(0,t.jsx)(m,{addBorder:!0,getId:b,getValue:x,items:F,onChange:v,setSearch:k,...j}):null,Object.entries(L).map(e=>{let[r,l]=e;return(0,t.jsx)(m,{getId:b,getValue:x,heading:r,items:l,onChange:v,setSearch:k,...j},r)})]}):(0,t.jsxs)("div",{className:"flex flex-col items-center gap-2 p-2","data-testid":(0,r.tid)("command-menu","loading"),children:[(0,t.jsx)(i.Skeleton,{className:"h-4",width:"100%"}),(0,t.jsx)(i.Skeleton,{className:"h-4",width:"100%"}),(0,t.jsx)(i.Skeleton,{className:"h-4",width:"100%"})]}),M?(0,t.jsx)(f,{onAddNew:B,search:S}):null,I?(0,t.jsx)("div",{className:"border-t px-4 py-2",children:(0,t.jsx)(n.LoadingDots,{size:4})}):null]})]})}function m(e){let{heading:r,items:n,setSearch:a,renderItem:i,getId:o,getValue:s,onChange:d,addBorder:c}=e;return n.length?(0,t.jsx)(l.Command.Group,{className:(0,u.cn)("h-full p-2  [&>[cmdk-group-heading]]:px-2 [&>[cmdk-group-heading]]:pb-1 [&>[cmdk-group-heading]]:pt-0.5 [&>[cmdk-group-heading]]:text-xs [&>[cmdk-group-heading]]:text-gray-800",c&&"border-b"),heading:r,children:n.map(e=>(0,t.jsx)(l.Command.Item,{className:"w-full cursor-pointer rounded-md text-sm *:aria-selected:rounded  *:aria-selected:bg-gray-100 focus-visible:bg-gray-100 active:bg-gray-100",onSelect:()=>{d(e),a("")},value:s(e),children:i(e)},o(e)))}):null}function f(e){let{search:r,onAddNew:n}=e;return(0,t.jsx)(l.Command.Group,{className:"sticky bottom-0 z-10 rounded-b-lg border-t bg-white outline-none",children:(0,t.jsx)(l.Command.Item,{"aria-label":`add ${r}`,className:"flex w-full cursor-pointer items-center p-1 text-gray-900 *:aria-selected:rounded *:aria-selected:bg-gray-100 focus-visible:bg-gray-100 active:bg-gray-100",onSelect:()=>n(r),value:r,children:(0,t.jsxs)("div",{className:"flex w-full items-center gap-2 p-1.5",children:[(0,t.jsx)(s.PlusCircle,{size:14}),(0,t.jsx)(o.Text,{className:"text-gray-900",size:14,children:`Add "${r}"`})]})})})}},5610265:[e=>{"use strict";e.s({FilterBarContext:()=>t},5610265);let t=(0,e.i(6530772).createContext)(null);t.displayName="FilterBarContext",e.s({AddFilter:()=>i},7339743);var r=e.i(6645307),l=e.i(5674541),n=e.i(9457324),a=e.i(9443759);function i(e){let{iconOnly:t,...i}=e;return(0,r.jsx)(l.Button,{"aria-label":"Add filter",prefix:t?void 0:(0,r.jsx)(n.FilterSmall,{}),shape:t?"square":void 0,size:"small",...i,className:(0,a.cn)("!text-gray-900 hover:!text-gray-1000 data-[state='open']:!bg-gray-100",!t&&"!pl-2",i.className),type:"tertiary",typeName:"button",children:t?(0,r.jsx)(n.FilterSmall,{}):"Add filter"})}},[7339743]],7642531:[e=>{"use strict";e.s({},7642531);var t=e.i(6645307),r=e.i(6530772),l=e.i(5610265),n=e.i(7339743),a=e.i(5674541),i=e.i(318846),o=e.i(9443759),s=e.i(1164214),u=e.i(2385909),d=e.i(5610210),c=e.i(8247297),m=e.i(555528),f=e.i(3921802),p=e.i(7525208),v=e.i(2056425);let g=e=>{let{label:t,id:r}=e;return`${r}${t?`
${t}`:""}`};function h(e){let{values:l,options:n,label:i,rounded:o=!1,size:s="small",onOpenChange:m,onChange:h,onSearch:x,open:y,className:w,parseNewValue:C,children:j,disabled:S}=e,k=(0,r.useCallback)(e=>l.some(t=>{let{id:r}=t;return r===e.id}),[l]),N=(0,r.useCallback)(e=>{let r="string"==typeof e.label&&e.label.length>0,l=r?e.label:e.id;return(0,t.jsx)(b,{text:e.tooltip,children:(0,t.jsxs)("div",{className:(0,d.clsx)("flex w-full items-center gap-2 px-2 py-1.5",e.disabled&&"cursor-not-allowed opacity-75"),onClick:t=>{let r=document.getSelection();if(r?.isCollapsed===!1){t.preventDefault(),t.stopPropagation();return}t.target.closest("label")&&(t.preventDefault(),t.stopPropagation(),h(e,!0))},children:[(0,t.jsx)(c.Checkbox,{checked:k(e),disabled:e.disabled,onChange:()=>void 0,tabIndex:-1}),(0,t.jsx)("div",{className:"flex min-w-0 flex-1 items-center justify-between",children:r&&e.label!==e.id?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"truncate font-medium leading-tight",children:e.label}),(0,t.jsx)("span",{className:"truncate text-sm text-gray-800",children:e.id})]}):""===l?(0,t.jsx)("span",{className:"text-sm text-gray-800",children:v.emptyStringReplacement}):(0,t.jsx)("span",{className:"truncate",children:l})}),e.badge?(0,t.jsx)("div",{className:"ml-2 shrink-0",children:(0,t.jsx)(b,{text:e.badge.tooltip,children:(0,t.jsx)(f.Badge,{size:"sm",...e.badge})})}):null]})})},[h,k]);return(0,t.jsxs)(u.Root,{modal:!0,onOpenChange:m,open:y,children:[(0,t.jsx)(u.Anchor,{className:"flex",children:(0,t.jsx)(u.Trigger,{asChild:!0,children:j||(0,t.jsx)(a.Button,{className:(0,d.clsx)("!ring-1 ring-gray-400 focus:z-10 focus:ring-gray-500",!o&&"rounded-[0!important]","left"===o&&"rounded-r-[0!important]","right"===o&&"rounded-l-[0!important]",S&&"bg-[var(--themed-bg)!important]",w),disabled:S,size:s,type:"secondary",typeName:"button",children:(0,v.getValueLabel)(l,i)})})}),(0,t.jsx)(u.Portal,{children:(0,t.jsx)(u.Content,{align:"start",className:"tailwind-preflight",onCloseAutoFocus:()=>m(!1),sideOffset:8,children:(0,t.jsx)(p.CommandMenu,{getId:v.getValueId,getValue:g,isSelected:k,label:i,onChange:h,onSearch:x,options:n,parseNewValue:C,renderItem:N})})})]})}function b(e){let{text:r,children:l}=e;return r?(0,t.jsx)(m.Tooltip,{className:"w-full",text:r,children:l}):l}e.s({SingleFilterPopoverBox:()=>j},9643821);var x=e.i(4652282);let y=e=>{let{id:t}=e;return t},w=e=>{let{label:t,group:r}=e;return`${t}${r?` ${r}`:""}`},C=e=>(0,t.jsxs)("div",{className:"flex w-full items-center gap-2 rounded px-2 py-1.5",children:["icon"in e&&e.icon?(0,t.jsx)(e.icon,{className:"size-4"}):null,e.label]});function j(e){let{label:r,value:l,options:n,onOpenChange:i,open:o,onChange:s,isLoading:c,rounded:m=!1,size:f="small",className:v,children:g,disabled:h,prefix:b,suffix:j,id:S}=e;return(0,t.jsxs)(u.Root,{modal:!0,onOpenChange:i,open:o,children:[(0,t.jsx)(u.Anchor,{className:"flex",children:(0,t.jsx)(u.Trigger,{asChild:!0,children:g||(0,t.jsx)(a.Button,{id:S,"aria-label":`Select ${r}`,className:(0,d.clsx)("!px-1",!m&&"rounded-[0!important]","left"===m&&"rounded-r-[0!important]","right"===m&&"rounded-l-[0!important]",h&&"bg-[var(--themed-bg)!important]",v),disabled:h,prefix:l&&"icon"in l&&l.icon?(0,t.jsx)(l.icon,{className:"size-4"}):b,size:f,suffix:j,type:"secondary",typeName:"button",children:l?l.label:(0,t.jsx)(x.Plus,{"aria-label":`Select ${r}`})})})}),(0,t.jsx)(u.Portal,{children:(0,t.jsx)(u.Content,{align:"start",className:"tailwind-preflight",sideOffset:8,children:(0,t.jsx)(p.CommandMenu,{getId:y,getValue:w,isLoading:c,label:r,onChange:s,open:o,options:n,renderItem:C,value:l})})})]})}var S=e.i(4185977);function k(e){let t=(0,r.useContext)(l.FilterBarContext);if(!t)throw Error("Missing FilterBarContext.Provider in the React tree");return(0,S.useStore)(t,e)}function N(e){let{value:{value:l}={id:"",value:""},onChange:n,onToggle:a,disabled:i,ref:o}=e,[s,u]=(0,r.useState)(l);return(0,t.jsx)("div",{className:"focus:border-rounded -my-px flex items-center border bg-background-100 px-2",children:(0,t.jsx)("input",{"aria-label":"input value",className:(0,d.clsx)("block w-full bg-background-100 focus:outline-none focus:ring-transparent sm:text-sm",i&&"bg-[--themed-bg] text-gray-700"),disabled:i,onBlur:()=>{s!==l&&n((0,v.toValueObj)(s)),a(!1)},onChange:e=>u(e.target.value),onFocus:()=>a(!0),ref:o,type:"text",value:s.toString()})})}function E(e){let{index:l}=e,n=k(e=>e.filters),u=k(e=>e.removeFilter),d=k(e=>e.chooseValue),c=k(e=>e.chooseOperator),m=k(e=>e.searchValues),f=k(e=>e.toggleFilter),p=k(e=>e.edited),g=k(e=>e.config.dimensions),b=k(e=>e.disabled),x=(0,r.useRef)(null),{open:y,dimension:w,values:C,operator:S,availableValues:E,availableOperators:I,parseValue:A}=(0,r.useMemo)(()=>({open:null,availableValues:void 0,availableOperators:void 0,parseValue:void 0,values:n[l]?.values??[],operator:n[l]?.operator,...p?.index===l?p:{},dimension:g.find(e=>{let{id:t}=e;return t===n[l]?.dimension})??g[0]}),[p,n,l,g]),R=(0,r.useCallback)(e=>{e&&"value"===y||f(e?"value":null,l)},[l,f,y]),V=(0,r.useCallback)(e=>void f(e?"operator":null,l),[l,f]);return(0,r.useEffect)(()=>{"match"===S.type&&"value"===y&&setTimeout(()=>x.current?.focus(),100)},[y,S.type]),(0,t.jsxs)("div",{className:"flex h-8 items-stretch","data-testid":(0,s.tid)("filter-bar","cascading-filter"),children:[(0,t.jsx)("div",{className:"rounded-l-md bg-background-100 px-2 py-1.5 text-sm font-normal shadow-border",children:(0,v.renderItem)(w,!0)}),(0,t.jsx)(j,{className:"!font-normal !ring-1 ring-gray-400 focus:ring-gray-500",disabled:b,label:"operator",onChange:c,onOpenChange:V,open:"operator"===y,options:I,value:S}),"match"===S.type&&(0,t.jsx)(N,{disabled:b,onChange:d,onToggle:R,ref:x,value:C[0]}),"match"!==S.type&&"valueless"!==S.type&&(0,t.jsx)(h,{disabled:b,label:w.label,onChange:d,onOpenChange:R,onSearch:m,open:"value"===y,options:E,parseNewValue:A,values:C}),(0,t.jsx)(a.Button,{"aria-label":"Remove filter",className:(0,o.cn)("!px-0.5 !ring-1 ring-gray-400 hover:!text-gray-1000 focus:ring-gray-500",b?"bg-[var(--themed-bg)!important]":"!text-gray-900"),disabled:b,onClick:()=>u(l),size:"small",style:{borderTopLeftRadius:0,borderBottomLeftRadius:0},svgOnly:!0,type:"secondary",typeName:"button",children:(0,t.jsx)(i.CrossSmall,{size:"small"})})]})}function I(e){let{renderFilter:l}=e,a=k(e=>e.filters),{dimension:i,operator:o,availableValues:s,availableOperators:u,values:d,parseValue:c}=k(e=>e.edited??{dimension:null,operator:null,availableValues:[],availableOperators:[],values:[],parseValue:void 0}),m=k(e=>e.config.dimensions),f=k(e=>e.edited?.index===null?e.edited.open:null),p=k(e=>e.startNewFilter),v=k(e=>e.chooseDimension),g=k(e=>e.chooseOperator),b=k(e=>e.chooseValue),x=k(e=>e.searchValues),y=k(e=>e.disabled);return(0,t.jsxs)("div",{className:"items-top tailwind-preflight flex flex-wrap gap-2",children:[a.map((e,n)=>(0,t.jsx)(r.Fragment,{children:(l||(e=>e))((0,t.jsx)(E,{index:n}),e,n)},n)),!y&&(i?o?(0,t.jsx)(h,{label:i.label,onChange:b,onOpenChange:p,onSearch:x,open:"value"===f,options:s,parseNewValue:c,values:d,children:(0,t.jsx)(n.AddFilter,{})}):(0,t.jsx)(j,{label:"operator",onChange:g,onOpenChange:p,open:"value"===f,options:u,children:(0,t.jsx)(n.AddFilter,{})}):(0,t.jsx)(j,{label:"dimension",onChange:e=>void v(e),onOpenChange:p,open:"operator"===f,options:m,children:(0,t.jsx)(n.AddFilter,{})}))]})}var A=e.i(4953636);function R(e,t,r){let{edited:l}=r();t({edited:l?.index===e?null:l})}function V(e,t,r,l){let{filters:n,edited:a,onChange:i}=l(),o=t?.operator?.type==="valueless",s=void 0===t||o||t.values?.length?[...n.slice(0,e),t?{...n[e],...t}:void 0,...n.slice(e+1)].filter(e=>void 0!==e):n;r({filters:s,edited:t&&a?{...a,operator:t.operator??a.operator,values:t.values??a.values}:null}),i(s)}function O(e,t){let{dimensions:r}=t;return r.find(t=>{let{id:r}=t;return e?.dimension===r})}function P(e,t,r,l){let{valuesByDimension:n,edited:a}=l(),i=[...n[e.id]??[]],o=new Set(i.map(e=>{let{id:t}=e;return t})),s=!(e.id in n);for(let e of t)o.has(e.id)||(o.add(e.id),i.push(e),s=!0);s&&(a?.dimension?.id===e.id&&r({edited:{...a,availableValues:i}}),r({valuesByDimension:{...n,[e.id]:i}}))}function F(e){return"stringArray"===e.type?e=>{let{type:t}=e;return"array"===t||"valueless"===t}:"boolean"===e.type?e=>{let{type:t}=e;return"single"===t||"valueless"===t}:"number"===e.type?e=>{let{type:t}=e;return"multiple"===t||"single"===t||"numerical"===t||"valueless"===t}:e=>{let{type:t}=e;return"multiple"===t||"single"===t||"match"===t||"valueless"===t}}async function L(e,t){let{filters:r,config:l}=t(),n=new Set;for(let e of r){let r=O(e,l);!r||r.id in t().valuesByDimension||n.add(r)}for(let a of(await Promise.allSettled([...n].map(async r=>{P(r,await M({dimension:r},l.resolveValues),e,t)})),r)){let r=O(a,l);"match"!==a.operator.type&&r&&P(r,a.values,e,t)}e({filters:r.map(e=>({...e,values:e.values.map(r=>t().valuesByDimension[e.dimension]?.find(e=>e.id===r.id)??r)}))})}async function M(e,t){let r=t?.(e);return r instanceof Object&&"then"in r?await r??[]:r??[]}function B(e,t){return JSON.stringify(e)===JSON.stringify(t)}function D(e){let{renderFilter:n,...a}=e,i=(0,r.useRef)((0,A.createStore)()((e,t)=>({config:{dimensions:[],operators:[]},filters:[],onChange:()=>void 0,disabled:!1,edited:null,valuesByDimension:{},setProps:async r=>{let{onChange:l,disabled:n,config:a,filters:i}=r,o=t();if(n!==o.disabled&&e({disabled:n}),l!==o.onChange&&e({onChange:l}),B(o.config,a))B(o.filters,i)||(e({filters:i}),await L(e,t));else{e({config:a,filters:i,edited:null});let r=i.filter(e=>{let{dimension:t}=e;return a.dimensions.some(e=>{let{id:r}=e;return r===t})});B(i,r)||(e({filters:r}),l(r)),await L(e,t)}},toggleFilter:async(r,l)=>{let{config:n,disabled:a,edited:i,filters:o,valuesByDimension:s}=t(),u=o[l],d=O(u,n);!a&&u&&d&&(r||i?.index===null||i?.values.length!==0||V(i.index,void 0,e,t),e({edited:r?{index:l,operator:u.operator,values:u.values,open:r,dimension:d,availableOperators:n.operators.filter(F(d)),availableValues:s[d.id],parseValue:(0,v.makeParseValue)(d)}:null}),P(d,await M({dimension:d},n.resolveValues),e,t))},startNewFilter:r=>{let{config:l,disabled:n,edited:a,filters:i,operatorUponCreation:o}=t();if(!n&&(e({edited:r?{index:null,open:"operator",operator:o?void 0:l.defaultSingleOperator,values:[],availableOperators:l.operators}:null}),a?.dimension&&(a.operator?.type==="multiple"||a.operator?.type==="array"))){let{values:r,operator:l,dimension:{id:n}}=a;r.length&&V(i.length,{values:r,operator:l,dimension:n},e,t)}},chooseDimension:async r=>{let{config:l,edited:n,valuesByDimension:a,operatorUponCreation:i}=t();if(!n)return;let o="stringArray"===r.type?l.defaultArrayOperator:l.defaultSingleOperator;e({edited:{...n,open:"value",dimension:r,operator:i?void 0:o,parseValue:(0,v.makeParseValue)(r),availableValues:a[r.id],availableOperators:l.operators.filter(F(r))}}),P(r,await M({dimension:r},l.resolveValues),e,t)},chooseOperator:async r=>{let{edited:l,filters:n}=t();if(!l)return;if(null===l.index)return void("valueless"===r.type&&l.dimension?(e({edited:null}),V(n.length,{dimension:l.dimension.id,operator:r,values:[]},e,t)):e({edited:{...l,open:"value",operator:r}}));if(l.operator?.type==="valueless"&&"valueless"!==r.type){let t={...l,operator:r,open:null};return e({edited:t}),await new Promise(e=>{setTimeout(e,50)}),e({edited:{...t,open:"value"}})}let a=l.values;"multiple"!==r.type&&l.values.length>1&&(a=l.values.slice(0,1)),"valueless"===r.type&&(a=[]),V(l.index,{...n[l.index],operator:r,values:a},e,t),R(l.index,e,t)},chooseValue:(r,l)=>{let{config:n,filters:a,edited:i}=t();if(!i||!i.dimension||!i.operator)return;let{dimension:o,operator:s,values:u}=i;if(function(e,t){let{value:r}=e;return"number"===t.type&&("number"!=typeof r||Number.isNaN(r))||"boolean"===t.type&&!0!==r&&!1!==r}(r,o))return;let d={values:u,operator:s},c=!1;"match"===s.type?d.values=[r]:(u.every(e=>{let{id:t}=e;return t!==r.id})?(P(o,[r],e,t),"multiple"===s.type||"array"===s.type?d.values=[...u,r]:l?(d.values=[...u,r],d.operator=n.defaultMultiOperator):d.values=[r]):(d.values=u.filter(e=>{let{id:t}=e;return t!==r.id}),l&&"multiple"===s.type&&d.values.length<2&&(d.operator=n.defaultSingleOperator)),c=!l),null===i.index?l?e({edited:{...i,...d}}):(d.values.length&&V(a.length,{dimension:i.dimension.id,...d},e,t),e({edited:null})):(0===d.values.length&&c?V(i.index,void 0,e,t):V(i.index,d,e,t),c&&R(i.index,e,t))},searchValues:async r=>{let{config:l,edited:n}=t();if(!n?.dimension)return;let{dimension:a}=n,i=await M({dimension:a,text:r},l.resolveValues);P(a,i,e,t)},removeFilter:r=>{let{disabled:l,filters:n}=t();!l&&n[r]&&V(r,void 0,e,t)}}))),o=(0,r.useMemo)(()=>a,[a]);return(0,r.useEffect)(()=>{i.current.getState().setProps(o)},[o]),(0,t.jsx)(l.FilterBarContext.Provider,{value:i.current,children:(0,t.jsx)(I,{renderFilter:n})})}e.s({FilterBar:()=>D},5450820)},[9643821,5450820]]}]);

//# sourceMappingURL=7711321ba0a55a18.js.map
//# debugId=cf014908-955c-560c-a53f-7d4434bbd562
