
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="3335d601-13c5-5c80-a940-70d58dc7b14c")}catch(e){}}();
(globalThis.TURBOPACK=globalThis.TURBOPACK||[]).push(["object"==typeof document?document.currentScript:void 0,{6563442:[e=>{"use strict";e.s({AsyncButton:()=>h},6563442);var t=e.i(6645307),a=e.i(1099267),r=e.i(3673393);e.s({OpenButton:()=>u},3087014);var n=e.i(2362802),i=e.i(5610210),l=e.i(555528),s=e.i(240708),o=e.i(2464619),c=e.i(6530772);function u(e){let{href:a,size:r,type:u="compact"}=e,{label:d,icon:f}=(0,c.useMemo)(()=>a.includes("analytics")?{label:"Open Web Analytics",icon:(0,t.jsx)(s.LineChart,{})}:{label:"Open Speed Insights",icon:(0,t.jsx)(o.StopwatchFast,{})},[a]),h=(0,t.jsxs)(n.ButtonLink,{"aria-label":d,className:(0,i.clsx)("*:flex","full"!==u&&"group !h-6 !p-0"),href:a,size:r,svgOnly:!0,type:"secondary",children:[f,"compact"!==u?(0,t.jsx)("span",{className:"pl-2",children:d}):null]});return"compact"===u?(0,t.jsx)(l.Tooltip,{desktopOnly:!0,text:d,children:h}):h}e.s({linkFromKeys:()=>f},6485218);var d=e.i(8079677);function f(e,t){let{sectionKey:a,chartKey:r,teamSlug:n,queryState:i}=e,l={teamSlug:n,projectName:t,env:"all",from:i.from,to:i.to};return"fast-data-transfer"===r||"edge-requests"===r?(0,d.computeLink)({page:r,...l}):"isr"===a||"edge-functions"===a&&"execution-units"!==r?(0,d.computeLink)({page:a,...l}):"serverless-functions"===a?(0,d.computeLink)({page:"vercel-functions",...l}):"image-optimization"===a&&"source-image-optimizations"!==r?(0,d.computeLink)({page:"image-optimization",...l}):t&&("speed-insights"===r||"web-analytics"===r)?function(e){let{teamSlug:t,projectName:a,page:r,from:n,to:i}=e,l=new URLSearchParams({environment:"all"});return i&&n&&(l.set("from",`${Math.floor(n.getTime()/1e3)}`),l.set("to",`${Math.floor(i.getTime()/1e3)}`)),`/${[t,a,r].join("/")}?${l.toString()}`}({page:"web-analytics"===r?"analytics":r,...l,projectName:t}):void 0}function h(e){let[{projectId:n}]=(0,r.useUsageQueryState)(),i=f(e,n);return i?i.includes("observability")?(0,t.jsx)(a.OpenObservability,{href:i,size:e.large?"medium":"small",type:"full"}):(0,t.jsx)(u,{href:i,size:e.large?"medium":"small",type:"full"}):null}},[3087014,6485218]],4011773:[e=>{"use strict";e.s({UsageCard:()=>v,UsageCardHeader:()=>j},4011773);var t=e.i(6645307),a=e.i(889716),r=e.i(8084653),n=e.i(3921802);let i=(0,e.i(6895406).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M9.74944 1H8.99944V2.5H9.74944H12.4388L9.46911 5.46967L8.93878 6L9.99944 7.06066L10.5298 6.53033L13.4983 3.56182V6.25V7H14.9983V6.25V2C14.9983 1.44772 14.5506 1 13.9983 1H9.74944ZM2.50195 12.4382V9.75V9H1.00195V9.75V14C1.00195 14.5523 1.44967 15 2.00195 15H6.25079H7.00079V13.5H6.25079H3.56145L6.53112 10.5303L7.06145 10L6.00079 8.93934L5.47046 9.46967L2.50195 12.4382Z" fill="currentColor"/>');var l=e.i(2362802),s=e.i(9443759),o=e.i(4314734);function c(e){let{title:a,id:n}=e;return(0,t.jsxs)(r.Text,{as:"h3",variant:"heading-16",children:[(0,t.jsx)("span",{className:o.default.headingScrollTarget,id:n}),a]})}e.s({ChartLinkButton:()=>h,useChartLink:()=>p},4483564);var u=e.i(6530772),d=e.i(3673393),f=e.i(9565387);function h(e){let{teamSlug:a,chartKey:r,title:n,...i}=e,s=p(a,r);return(0,t.jsx)(l.ButtonLink,{"aria-label":`View details for ${n}`,...i,href:s})}function p(e,t){let[a]=(0,d.useUsageQueryState)();return(0,u.useMemo)(()=>{let r=(0,f.getSearchParamsFromState)(a);return`/${e}/~/usage/${t}${r.size>0?`?${r.toString()}`:""}`},[e,t,a])}var m=e.i(1099267),g=e.i(6563442),x=e.i(6485218);function y(e){let a=(0,x.linkFromKeys)(e);return(0,t.jsx)(u.Suspense,{fallback:a?.includes("observability")?(0,t.jsx)(m.OpenObservability,{href:a,size:e.large?"medium":"small",type:"full"}):null,children:(0,t.jsx)(g.AsyncButton,{...e})})}function v(e){let{children:r,className:n="",header:i,padding:l=6,footer:s,style:c}=e;return(0,t.jsxs)(a.Stack,{className:o.default.card,direction:"column",style:c,children:[i?(0,t.jsx)(a.Stack,{className:o.default.cardHeaderContainer,direction:"column",padding:l,children:i}):null,(0,t.jsx)(a.Stack,{className:n,padding:l,children:r}),s]})}function j(e){let{title:a,chartKey:o,sectionKey:u,description:f,additionalDescription:p,learnMoreHref:m,accessory:g,teamSlug:v,badge:j}=e,b=`${u}-${o}`,[w]=(0,d.useUsageQueryState)(),k=!!(0,x.linkFromKeys)({sectionKey:u,chartKey:o,teamSlug:v,queryState:w});return(0,t.jsxs)("div",{className:"flex flex-col gap-5",children:[(0,t.jsxs)("div",{className:(0,s.cn)("flex gap-5",k?"flex-col md:flex-row":"flex-row"),children:[(0,t.jsxs)("div",{className:"flex flex-1 flex-col gap-1",children:[(0,t.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,t.jsx)(c,{id:b,title:a}),j?(0,t.jsx)(n.Badge,{variant:"amber-subtle",children:j}):null]}),f?(0,t.jsxs)(r.Text,{variant:"copy-14",children:[f," ",m?(0,t.jsx)(l.Link,{external:!0,href:m,target:"_blank",variant:"highlight",children:"Learn More"}):null]}):null,p]}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)(y,{chartKey:o,queryState:w,sectionKey:u,teamSlug:v}),(0,t.jsx)(h,{chartKey:b,shape:"square",size:"small",svgOnly:!0,prefetch:!1,teamSlug:v,title:a,type:"secondary",children:(0,t.jsx)(i,{})})]})]}),g?(0,t.jsx)("div",{className:"grid grid-flow-col items-center",children:g}):null]})}},[4483564]],8635058:[e=>{"use strict";e.s({useUsageFilters:()=>c},8635058);var t=e.i(3093478),a=e.i(6530772),r=e.i(503726),n=e.i(3673393),i=e.i(2158583),l=e.i(8622417);let s=l.defaultPresets["last-30-days"].start;async function o(e){let{queryState:{range:t,to:a,from:r,projectId:n},getBillingCycles:i}=e;if(t){let e=l.defaultPresets[t];if(e)return{projectId:n,from:e.start,to:e.end??l.endOfCurrentHour};if(["current-billing-cycle","previous-billing-cycle"].includes(t)){let e=await i(),a=e?.["current-billing-cycle"===t?"current":"previous"];return a?{from:new Date(a.start),to:new Date(a.end),projectId:n,billingCycles:e,isCurrentBillingCycle:"current-billing-cycle"===t}:{projectId:n,from:s,to:l.endOfCurrentHour,billingCycles:e}}}if(!t&&r&&a)return{from:r,to:a,projectId:n};let o=await i();return o?.current?{from:new Date(o.current.start),to:new Date(o.current.end),projectId:n,billingCycles:o,isCurrentBillingCycle:!0}:{projectId:n,from:s,to:l.endOfCurrentHour,billingCycles:o,isCurrentBillingCycle:!0}}function c(e){let[l,s]=(0,a.useState)(e),{account:c,isLoading:u}=(0,r.useAccount)(),d=!!c?.billing?.period,[f]=(0,n.useUsageQueryState)(),{data:h,isLoading:p}=(0,i.useBillingCycles)(void 0,e?{revalidateOnMount:!e.billingCycles,fallbackData:e.billingCycles}:void 0);return(0,a.useEffect)(()=>{!u&&(d&&p&&l&&!l.billingCycles||o({queryState:f,getBillingCycles:()=>Promise.resolve(d?h??l?.billingCycles:void 0)}).then(e=>{(0,t.default)(e,l)||s(e)}))},[f,h,p,l?.billingCycles,d,u]),l}e.s({getChartDataCache:()=>g,setChartDataCache:()=>m,useChartCache:()=>v,useChartDataCache:()=>j},935229);var u=e.i(3521787),d=e.i(5535439);let f=new Map,h=new Set;function p(e){return h.add(e),()=>{h.delete(e)}}function m(e,t){for(let a of(f.set(e,t),h))a()}function g(e,t){let a=f.get(e);if(a&&x(a.key,t))return a}function x(e,t){return e.teamSlug===t.teamSlug&&(0,u.unstable_serialize)({to:e.filters.to,from:e.filters.from,projectId:e.filters.projectId})===(0,u.unstable_serialize)({to:t.filters.to,from:t.filters.from,projectId:t.filters.projectId})}function y(e){let t={};for(let[a,r]of f)x(r.key,e)&&(t[a]=r);return t}function v(e,t){let[r,n]=(0,a.useState)(y(e)[t]);return(0,a.useEffect)(()=>p(()=>{n(y(e)[t])}),[t,e]),r}function j(e){let t=(0,d.useParams)(),r=c(e),n=t?.teamSlug??"",[i,l]=(0,a.useState)(y({filters:r,teamSlug:n}));return(0,a.useEffect)(()=>p(()=>{l(y({filters:r,teamSlug:n}))}),[r,n]),{isInitialFilters:(0,a.useMemo)(()=>x({filters:e,teamSlug:n},{filters:r,teamSlug:n}),[e,r,n]),cacheData:i,filters:r}}},[935229]],548234:e=>{e.v({hideMeterInfoMobile:"index-module__u8DDsa__hideMeterInfoMobile",hideMeterInfoTablet:"index-module__u8DDsa__hideMeterInfoTablet",valuesContainer:"index-module__u8DDsa__valuesContainer"})},6858236:e=>{e.v({"auto-visibility":"styles-module__ZXZFTq__auto-visibility",bar:"styles-module__ZXZFTq__bar","bar-overlay":"styles-module__ZXZFTq__bar-overlay","empty-chart":"styles-module__ZXZFTq__empty-chart","empty-description":"styles-module__ZXZFTq__empty-description",figure:"styles-module__ZXZFTq__figure"})},469909:e=>{e.v({locked:"index-module__y0a5oq__locked",tooltip:"index-module__y0a5oq__tooltip"})},2872020:e=>{e.v({detailViewButton:"usage-tooltip-module__1lF7UG__detailViewButton",dimensionsContainer:"usage-tooltip-module__1lF7UG__dimensionsContainer",link:"usage-tooltip-module__1lF7UG__link",tooltipDate:"usage-tooltip-module__1lF7UG__tooltipDate",tooltipDateWarning:"usage-tooltip-module__1lF7UG__tooltipDateWarning"})},8266917:e=>{e.v({container:"chart-legend-module__ZPwvPW__container",hasMore:"chart-legend-module__ZPwvPW__hasMore",legendRow:"chart-legend-module__ZPwvPW__legendRow",viewAll:"chart-legend-module__ZPwvPW__viewAll"})},3440070:e=>{e.v({"animated-container":"styles-module__-hP3BW__animated-container",disabled:"styles-module__-hP3BW__disabled",open:"styles-module__-hP3BW__open",row:"styles-module__-hP3BW__row",rowHeader:"styles-module__-hP3BW__rowHeader",skeleton:"styles-module__-hP3BW__skeleton","src-images-container":"styles-module__-hP3BW__src-images-container"})},2309835:e=>{e.v({expanded:"paths-module__jDr7eq__expanded",filtersDescription:"paths-module__jDr7eq__filtersDescription",noData:"paths-module__jDr7eq__noData",odd:"paths-module__jDr7eq__odd",path:"paths-module__jDr7eq__path",pathsContainer:"paths-module__jDr7eq__pathsContainer",pathsRow:"paths-module__jDr7eq__pathsRow",rowContainer:"paths-module__jDr7eq__rowContainer",rowsContainer:"paths-module__jDr7eq__rowsContainer",switchControl:"paths-module__jDr7eq__switchControl",textMatch:"paths-module__jDr7eq__textMatch",value:"paths-module__jDr7eq__value",viewAll:"paths-module__jDr7eq__viewAll"})},894644:[e=>{"use strict";e.s({Empty:()=>l},894644);var t=e.i(6645307),a=e.i(5610210),r=e.i(1164214),n=e.i(2448773),i=e.i(6858236);function l(e){let{title:l,description:s,children:o,className:c=""}=e;return(0,t.jsx)("div",{className:(0,a.clsx)(i.default["empty-chart"],c),"data-testid":(0,r.tid)("usage","metric","empty-state"),children:o||(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.default,{small:!0,weight:500,children:l||"No Data"}),(0,t.jsx)(n.default,{className:i.default["empty-description"],small:!0,type:"secondary",children:s||"There's no data available for your selection."})]})})}e.s({PathsChart:()=>_,PathsMigratedToObservability:()=>k},6987331);var s=e.i(889716),o=e.i(8084653),c=e.i(5163670),u=e.i(6284911),d=e.i(8158100),f=e.i(6530772),h=e.i(8679640),p=e.i(4113687),m=e.i(2362802),g=e.i(5652027),x=e.i(5535439),y=e.i(4373026),v=e.i(3387593),j=e.i(4946541),b=e.i(2309835);function w(e){let{filters:a=[],selectedFilter:r,onFilterChange:n,subFilters:i=[],selectedSubFilter:l,onSubFilterChange:c,filtersClassName:u,children:d}=e,h=a.find(e=>e.value===r),p=h?{text:h.description,icon:h.icon}:void 0;return a.length?(0,t.jsxs)(s.Stack,{className:u,direction:"column",gap:4,paddingBottom:6,children:[(0,t.jsx)("div",{style:{margin:-4},children:(0,t.jsx)(v.Scroller,{overflow:"x",children:(0,t.jsxs)(s.Stack,{align:"center",direction:"row",flex:1,gap:2,justify:"space-between",style:{padding:4},children:[(0,t.jsx)(j.Switch,{children:a.map(e=>(0,t.jsx)(j.Switch.Control,{checked:e.value===r,label:e.label,onChange:()=>(0,f.startTransition)(()=>n?.(e.value)),value:e.value},e.value))}),(0,t.jsxs)(s.Stack,{align:"center",direction:"row",gap:2,children:[d,i.length?(0,t.jsx)(j.Switch,{children:i.map(e=>(0,t.jsx)(j.Switch.Control,{checked:e.value===l,className:b.default.switchControl,label:e.label,onChange:()=>(0,f.startTransition)(()=>c?.(e.value)),value:e.value},e.value))}):null]})]})})}),p?(0,t.jsxs)(s.Stack,{align:"center",className:b.default.filtersDescription,direction:"row",gap:1.5,paddingX:1,children:[p.icon,(0,t.jsx)(o.Text,{color:"gray-900",variant:"copy-14",children:p.text})]}):null]}):null}function k(){let e=(0,x.useParams)();return(0,t.jsxs)(d.Note,{type:"secondary",children:["Top paths have moved to"," ",(0,t.jsx)(m.Link,{href:`/${e?.teamSlug}/~/observability/edge-requests`,children:"Observability"})," ","inside each project."]})}function _(e){let{data:r,formatter:n,getRowHref:i,showSkeleton:u,expanded:d,viewAllHref:g,footerNote:x,noDataMessage:y,...v}=e,[j,k]=(0,f.useState)(""),{rows:_=[],hasMore:O}=(0,f.useMemo)(()=>{if(!d)return{rows:r?.slice(0,6).map((e,t)=>({...e,index:t,parts:[C(e)]})),hasMore:r?.length&&r.length>6};let e=j.toLowerCase(),t=j&&"."!==j?r?.filter(t=>C(t).toLowerCase().includes(e)):r;return{rows:t?.map((e,t)=>({...e,index:t})),hasMore:!1}},[d,r,j]),D=r?.length&&j&&y?(0,t.jsx)(l,{className:b.default.noData,description:y(j),title:"No Results Found"}):(0,t.jsx)(l,{className:b.default.noData});return(0,t.jsxs)(s.Stack,{className:b.default.pathsContainer,"data-expanded":d?"":void 0,direction:"column",children:[(0,t.jsx)(w,{...v,children:d?(0,t.jsx)(T,{search:j,setSearch:k}):null}),u?(0,t.jsx)(s.Stack,{paddingX:1.5,children:Array(d?50:6).fill(null).map((e,a)=>(0,t.jsx)(c.Skeleton,{boxHeight:40,height:28,vcenter:!0,width:"100%"},a))}):(0,t.jsxs)(s.Stack,{className:(0,a.clsx)(b.default.rowsContainer,{[String(b.default.expanded)]:d}),"data-has-more":O?"":void 0,direction:"column",children:[d?(0,t.jsx)(p.Virtuoso,{data:_,itemContent:(e,a)=>(0,t.jsx)(S,{formatter:n,getRowHref:i,row:a,search:j}),overscan:100,useWindowScroll:!0}):_.map(e=>(0,t.jsx)(S,{formatter:n,getRowHref:i,row:e,search:j},C(e))),_.length?null:D]}),d&&x&&!u&&_.length?(0,t.jsx)(s.Stack,{paddingTop:4,children:"string"==typeof x?(0,t.jsx)(o.Text,{color:"gray-900",children:x}):x}):null,O&&g&&!u?(0,t.jsx)(m.ButtonLink,{className:b.default.viewAll,href:g,type:"secondary",children:(0,t.jsxs)(s.Stack,{align:"center",direction:"row",gap:.5,children:[(0,t.jsx)(o.Text,{variant:"label-12",children:"View All"}),(0,t.jsx)(h.ChevronRightSmall,{})]})}):null]})}let S=(0,f.memo)(function(e){let{row:r,search:n,formatter:i,getRowHref:l}=e,c=C(r),u=(0,f.useMemo)(()=>{if(!n||"."===n)return[c];let e=RegExp(`(${n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return c.split(e)},[c,n]),d=(0,f.useMemo)(()=>l?l(r):void 0,[l,r]),h=(0,t.jsxs)(s.Stack,{align:"center",className:(0,a.clsx)(b.default.pathsRow,{[String(b.default.rowContainer)]:!d,[String(b.default.odd)]:(r.index??0)%2}),direction:"row",gap:2,paddingX:2,style:{"--row-percent":r.percentage},children:[(0,t.jsx)(o.Text,{className:b.default.path,title:c,truncate:!0,wrap:!1,children:u.map((e,a)=>(0,t.jsx)("span",{className:a%2?b.default.textMatch:void 0,children:e},(0,g.getUnsafeKey)(a,e)))}),(0,t.jsx)(o.Text,{align:"right",className:b.default.value,style:{minWidth:120},children:i?i(r.value,"display"):r.value})]});return d?(0,t.jsx)(m.Link,{className:b.default.rowContainer,href:d,prefetch:!1,target:"_blank",children:h}):h});function C(e){return e.host?`${e.host}${!e.host||e.path.startsWith("/")?"":"/"}${e.path}`:e.path}function T(e){let{search:a,setSearch:r}=e,[n,i,{currentValue:l}]=(0,y.useDebounceState)(a,100);return(0,f.useEffect)(()=>{(0,f.startTransition)(()=>r(n))},[r,n]),(0,t.jsx)(u.SearchInput,{onChange:e=>i(e.target.value),placeholder:"Filter Top Paths",value:l})}},[6987331]],543209:[e=>{"use strict";e.s({UsageChart:()=>tA,UsageChartWrapper:()=>tF},543209);var t=e.i(6645307),a=e.i(6530772),r=e.i(889716),n=e.i(3162912),i=e.i(503726),l=e.i(5610210),s=e.i(8811733),o=e.i(8084653),c=e.i(555528),u=e.i(3921802),d=e.i(2362802),f=e.i(6325202),h=e.i(4045255),p=e.i(548234);function m(e){let{used:a,increment:i,limit:u,hideOnMobile:f=!0,className:m,formatter:g,value:y,buttonCopy:v,buttonHref:j,pricePerIncrement:b,currency:w,nextTier:k,hidePrices:_}=e,{isActive:S}=(0,h.useUpgradeContext)(),C=u??0,T=S&&k?k:C;return(0,t.jsx)(r.Stack,{className:(0,l.clsx)(m,{[p.default.hideMeterInfoMobile]:f}),direction:"row",children:(0,t.jsx)(c.Tooltip,{className:(0,l.clsx)(p.default.hideMeterInfoMobile,"tooltip-container"),position:"bottom",text:(0,t.jsxs)("div",{style:{paddingTop:4,paddingBottom:4},children:[(0,t.jsx)(o.Text,{color:"gray-900",children:(0,t.jsx)(x,{currency:w,formatter:g,hidePrices:_,increment:i,limit:C,pricePerIncrement:b,value:y})}),(0,t.jsx)(s.Spacer,{y:.5}),(0,t.jsx)(d.ButtonLink,{href:j??"/docs/limits",type:"secondary",children:v??"View Docs"})]}),wrap:!1,children:(0,t.jsx)(n.Gauge,{colors:{primary:"var(--ds-blue-700)"},size:"tiny",value:a/T*100})})})}function g(e){let{value:a,formatter:r,limit:n,nextTier:i,hideOnTablet:s=!0,hideLimit:c=!1}=e,{isActive:d}=(0,h.useUpgradeContext)(),f=i&&d;return(0,t.jsxs)(o.Text,{className:(0,l.clsx)("meter-values-container",p.default.valuesContainer,{[p.default.hideMeterInfoTablet]:s}),color:"gray-900",children:[r(a,"display"),c?null:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{children:" / "}),(0,t.jsxs)("span",{className:"relative",children:[(0,t.jsx)("span",{className:"relative transition-colors",style:{color:f?"var(--ds-gray-700)":void 0},children:n?r(n,"display"):"-"}),(0,t.jsx)("span",{className:"absolute inset-x-0 top-[calc(50%-1px)] block h-[2px] bg-gray-500 transition-transform duration-500",style:{transformOrigin:"left",transform:f?"scaleX(1)":"scaleX(0)"}})]}),i?(0,t.jsxs)("span",{"aria-hidden":!f,className:"ml-2 inline-flex items-center gap-1.5 text-blue-900 transition-all duration-500",style:{transform:f?"translateX(0)":"translateX(8px)",opacity:+!!f},children:[r(i,"display"),(0,t.jsx)(u.Badge,{size:"sm",variant:"blue-subtle",children:"Pro"})]}):null]})]})}function x(e){let{limit:a,value:r,formatter:n,increment:i,pricePerIncrement:l,currency:s,hidePrices:o}=e,c=null!==i&&null!==l&&!o;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(t.Fragment,{children:["You have used"," ",a?Math.floor(r/a*100).toLocaleString():"-","% of the ",a?n(a,"long"):"-"," included in your plan."]}),c?(0,t.jsxs)(t.Fragment,{children:[" ","Once this limit has been reached, you will be charged"," ",(0,f.formatCurrency)(l,s)," per additional"," ",n(i,"long"),"."]}):null]})}var y=e.i(8635058),v=e.i(4011773);function j(e){let{children:a,card:r,sectionKey:n,accessory:i,teamSlug:l,additionalDescription:s,planIteration:o,plan:c,footer:u}=e,d=r.isNew&&o&&"unbundled"!==o&&"hobby"!==c,f=["description"in r?r.description:void 0,d?"This usage metric will soon be part of your plan.":void 0].filter(Boolean).join(" ");return(0,t.jsx)(v.UsageCard,{footer:u,header:(0,t.jsx)(v.UsageCardHeader,{accessory:i,additionalDescription:s,badge:d?"Coming Soon":void 0,chartKey:r.key,description:f,learnMoreHref:r.learnMoreHref,sectionKey:n,teamSlug:l,title:r.title}),children:a},r.key)}var b=e.i(4314734),w=e.i(2784490);function k(){return(k=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function _(e){var t=e.className,r=e.innerRef,n=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)t.indexOf(a=i[r])>=0||(n[a]=e[a]);return n}(e,["className","innerRef"]);return a.default.createElement("rect",k({ref:r,className:(0,w.default)("visx-bar",t)},n))}var S=e.i(7248073),C=e.i(4246457);function T(){return(T=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function O(e){var t=e.top,r=e.left,n=e.transform,i=e.className,l=e.children,s=e.innerRef,o=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)t.indexOf(a=i[r])>=0||(n[a]=e[a]);return n}(e,["top","left","transform","className","children","innerRef"]);return a.default.createElement("g",T({ref:s,className:(0,w.default)("visx-group",i),transform:n||"translate("+(void 0===r?0:r)+", "+(void 0===t?0:t)+")"},o),l)}function D(e){return null==e?void 0:e[0]}function N(e){return null==e?void 0:e[1]}O.propTypes={top:C.default.number,left:C.default.number,transform:C.default.string,className:C.default.string,children:C.default.node,innerRef:C.default.oneOfType([C.default.string,C.default.func,C.default.object])};var M=e.i(1954819),P=e.i(4238523),L=e.i(2811798),I=e.i(6918651),F=e.i(51832),A={ascending:M.stackOrderAscending,descending:P.stackOrderDescending,insideout:L.stackOrderInsideOut,none:I.stackOrderNone,reverse:F.stackOrderReverse};Object.keys(A);var R=e.i(5338864),B=e.i(2978241),q=e.i(3386817),$=e.i(6999696),E=e.i(7576827),U={expand:R.stackOffsetExpand,diverging:B.stackOffsetDiverging,none:q.stackOffsetNone,silhouette:$.stackOffsetSilhouette,wiggle:E.stackOffsetWiggle};function H(){return(H=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function z(e){var t,r=e.data,n=e.className,i=e.top,l=e.left,s=e.x,o=e.y0,c=void 0===o?D:o,u=e.y1,d=void 0===u?N:u,f=e.xScale,h=e.yScale,p=e.color,m=e.keys,g=e.value,x=e.order,y=e.offset,v=e.children,j=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)t.indexOf(a=i[r])>=0||(n[a]=e[a]);return n}(e,["data","className","top","left","x","y0","y1","xScale","yScale","color","keys","value","order","offset","children"]),b=(0,S.stack)();m&&b.keys(m),g&&(t=b.value,t(g)),x&&b.order(x&&A[x]||A.none),y&&b.offset(y&&U[y]||U.none);var k=b(r),C=function(e){if("bandwidth"in e)return e.bandwidth();var t=e.range(),a=e.domain();return Math.abs(t[t.length-1]-t[0])/a.length}(f),T=k.map(function(e,t){var a=e.key;return{index:t,key:a,bars:e.map(function(t,r){var n=(h(c(t))||0)-(h(d(t))||0),i=h(d(t)),l="bandwidth"in f?f(s(t.data)):Math.max((f(s(t.data))||0)-C/2);return{bar:t,key:a,index:r,height:n,width:C,x:l||0,y:i||0,color:p(e.key,r)}})}});return v?a.default.createElement(a.default.Fragment,null,v(T)):a.default.createElement(O,{className:(0,w.default)("visx-bar-stack",n),top:i,left:l},T.map(function(e){return e.bars.map(function(t){return a.default.createElement(_,H({key:"bar-stack-"+e.index+"-"+t.index,x:t.x,y:t.y,height:t.height,width:t.width,fill:t.color},j))})}))}function W(){return(W=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function V(e){var t=e.from,r=void 0===t?{x:0,y:0}:t,n=e.to,i=void 0===n?{x:1,y:1}:n,l=e.fill,s=e.className,o=e.innerRef,c=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)t.indexOf(a=i[r])>=0||(n[a]=e[a]);return n}(e,["from","to","fill","className","innerRef"]);return a.default.createElement("line",W({ref:o,className:(0,w.default)("visx-line",s),x1:r.x,y1:r.y,x2:i.x,y2:i.y,fill:void 0===l?"transparent":l},c))}Object.keys(U),e.i(5781512),e.i(4098645);var G=e.i(7240589);function K(){return(K=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function Z(e){var t,r,n,i,l,s,o,c,u=e.children,d=e.data,f=e.x,h=e.y,p=e.fill,m=e.className,g=e.curve,x=e.innerRef,y=e.defined,v=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)t.indexOf(a=i[r])>=0||(n[a]=e[a]);return n}(e,["children","data","x","y","fill","className","curve","innerRef","defined"]),j=(i=(n={x:f,y:h,defined:void 0===y?function(){return!0}:y,curve:g}).x,l=n.y,s=n.defined,o=n.curve,c=(0,G.line)(),i&&(t=c.x,t(i)),l&&(r=c.y,r(l)),s&&c.defined(s),o&&c.curve(o),c);return u?a.default.createElement(a.default.Fragment,null,u({path:j})):a.default.createElement("path",K({ref:x,className:(0,w.default)("visx-linepath",m),d:j(void 0===d?[]:d)||"",fill:void 0===p?"transparent":p},v))}e.i(6638817),e.i(3973596);var X=e.i(2419587),Y=e.i(6102013),Q=e.i(6781187),J=e.i(6101805),ee=e.i(7036948),et=e.i(9304191),ea=e.i(8666290),er=e.i(212277),en=e.i(9195014),ei=e.i(894644),el=e.i(6858236),es=e.i(5854227),eo=e.i(6041174);function ec(){return(ec=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}var eu=e.i(5674541);e.i(4570625);var ed=e.i(8548567),ef=e.i(9826618),eh=e.i(469909);let ep=e=>{let{left:a,containerWidth:r,children:n}=e,i="-50%",l="0",s="0";if(void 0!==a){let{innerWidth:e}=window,t=a+(e<741?-150:0)+(e-r)/2,n=e-t-300;t<0&&(i=-t/3-50+"%",l=`calc(${t/3+50}% - 8px)`,s="unset"),n<0&&(i=n/3-50+"%",l="unset",s=`calc(${n/3+50}% - 8px)`)}let o=(0,ed.useSpring)({left:a,bottom:0,translateX:i,config:{mass:.05,tension:400,friction:30}});return(0,t.jsx)(ef.animated.div,{className:eh.default.tooltip,style:{...o,"--arrow-left":l,"--arrow-right":s},children:n})};var em=e.i(2872020);let eg=(0,a.memo)(function(e){let{isOpen:a,width:n,left:i,data:l,hide:s,date:o,openDetailModal:c,dataAvailableSince:u}=e;return a&&l?(0,t.jsx)(ep,{containerWidth:n,left:i,children:(0,t.jsxs)(r.Stack,{align:"center",className:em.default.dimensionsContainer,direction:"column",children:[(0,t.jsx)("div",{className:em.default.tooltipDate,children:o}),u&&new Date(l.data.date)<new Date(u)?(0,t.jsxs)("div",{className:em.default.tooltipDateWarning,children:["Started collecting on"," ",(0,eo.format)(new Date(u),"MMM d, y HH:mm")]}):null,c&&l.data.resources?(0,t.jsx)(eu.Button,{className:em.default.detailViewButton,onClick:()=>{s(),c()},size:"small",type:"secondary",children:"Detail View"}):null]})}):null});function ex(e){var t,r,n,i,l,s;let{from:o,to:c,granularity:u,showPercentage:d=!1}=e,{tooltipOpen:f,tooltipLeft:h,tooltipData:p,hideTooltip:m,showTooltip:g}=(r=(t=(0,a.useState)(ec({tooltipOpen:!1},void 0)))[0],n=t[1],i=(0,a.useCallback)(function(e){var t=e.tooltipOpen,a=e.tooltipLeft,r=e.tooltipTop,i=e.tooltipData;return n(function(e){return ec({},e,{tooltipOpen:t,tooltipLeft:a,tooltipTop:r,tooltipData:i})})},[]),l=(0,a.useCallback)(function(e){return i({tooltipOpen:!0,tooltipLeft:e.tooltipLeft,tooltipTop:e.tooltipTop,tooltipData:e.tooltipData})},[i]),s=(0,a.useCallback)(function(){return i({tooltipOpen:!1,tooltipLeft:void 0,tooltipTop:void 0,tooltipData:void 0})},[i]),{tooltipOpen:r.tooltipOpen,tooltipLeft:r.tooltipLeft,tooltipTop:r.tooltipTop,tooltipData:r.tooltipData,updateTooltip:i,showTooltip:l,hideTooltip:s}),x=!!(p?.data.resources&&p.data.resources.length>0),y=(0,a.useRef)(null),v=(0,a.useCallback)(()=>{y.current=window.setTimeout(()=>{m()},200)},[m]),j=(0,a.useCallback)(()=>{y.current&&(clearTimeout(y.current),y.current=null)},[]),b=(0,a.useMemo)(()=>{if(!p?.data)return;let{data:e,value:t}=p.data;return Object.fromEntries(Object.entries(e).map(e=>{let[a,r]=e,n=r||0;return d&&(n={total:n,percent:(0,es.formatPercentage)(n,t)}),[a,n]}))},[p,d]);return{tooltipData:p,tooltipDimension:b,showTooltip:g,hideTooltip:v,cancelHideTooltip:j,usageTooltipProps:{isOpen:f,left:h,data:p,hide:v,shouldShowBreakdown:x,date:p&&(0,es.formatFullDateWithRange)(p.data.date,u,o,c)}}}var ey=e.i(9273711),ev=e.i(3673393);function ej(e){let{defaultGroupingType:t,expanded:r=!1}=e,[{view:n},i]=(0,ev.useUsageQueryState)(),[l,s]=(0,a.useState)(n||t);return((0,a.useEffect)(()=>{r&&!n&&i({view:t})},[r]),r)?{groupingType:n||t,setGroupingType:e=>i({view:e})}:{groupingType:l,setGroupingType:e=>{s(e)}}}var eb=e.i(2120451),ew=e.i(7517602),ek=e.i(8169983),e_=e.i(9939347);function eS(e){let{data:t=[],width:r,range:n,keys:i,colors:l,granularity:s}=e,o=t.map(e=>{let{date:t}=e;return t}),{valueScale:c,tickXValues:u,tickYValues:d}=(0,a.useMemo)(()=>{let e=Math.round(o.length/(r<480?3:r<720||"hour"===s?4:8));return{valueScale:(0,ew.scaleLinear)({domain:[0,n],range:[200,0],clamp:!0}),tickXValues:o.length<=3?o:o.filter((t,a)=>a%e==e>>1),tickYValues:0===n?[0]:[0,n/5,2*n/5,3*n/5,4*n/5,n]}},[o,s,n,r]);return{valueScale:c,colorScale:(0,a.useMemo)(()=>(0,ek.scaleOrdinal)({domain:i,range:l}),[l,i]),tickYValues:d,tickXValues:u}}var eC=e.i(8158100),eT=e.i(4946541),eO=e.i(1164214),eD=e.i(104622),eN=e.i(2774739),eM=e.i(8266917);let eP=(0,a.memo)(function(e){let{groupingType:a,groupingTypeOptions:n,setGroupingType:i,disableGroupBy:l,lastUpdate:s,noteText:u,selectedProjectId:d}=e,f=(0,eN.useAgo)(s,{justNowLabel:"just now"});return(0,t.jsxs)(r.Stack,{align:{sm:"stretch",md:"center"},direction:{sm:"column",md:"column",lg:"row"},gap:4,justify:"space-between",children:[(0,t.jsxs)(r.Stack,{align:{sm:"stretch",md:"center"},className:eM.default.groupingFilterWrapper,direction:{sm:"column",md:"row"},children:[(0,t.jsx)(eT.Switch,{children:n.map(e=>(0,t.jsx)(c.Tooltip,{desktopOnly:!0,style:{flexGrow:1},text:`Group by ${e}`,children:(0,t.jsx)(eT.Switch.Control,{checked:e===a,disabled:l||"Projects"===e&&!!d,label:e,onChange:(0,eD.withAwaitPaint)(()=>i(e)),value:e,width:110})},e))}),u?(0,t.jsx)(eC.Note,{className:eM.default.note,label:!1,size:"small",children:u}):null]}),(0,t.jsx)(r.Stack,{className:eM.default.updatedTimestamp,flex:"0 0 auto",children:(0,t.jsxs)(o.Text,{color:"gray-600","data-testid":(0,eO.tid)("usage","metric","updated-text"),variant:"label-14",children:["Updated ",f||"just now"]})})]})});var eL=e.i(8679640),eI=e.i(6096189),eF=e.i(4377543),eA=e.i(664635),eR=e.i(6285410),eB=e.i(604868),eq=e.i(5809700),e$=e.i(1099267),eE=e.i(3087014);let eU=[{Icon:eI.Hash,accessor:"total"},{Icon:eF.Percentage,accessor:"percent"}],eH=(e,t,a)=>{if(null===e||null===t)return 0;let r=e||0;return Math.max(0,r+(t-r)*a)},ez=(0,a.memo)(function(e){let{keys:n,truncatedKeys:i,chartData:s,colorScale:c,dimension:u,formatter:f,lastUpdate:h,expanded:p=!1,isHovered:m=!1,groupingType:g,linkStyle:x,viewAllHref:y="",emptyValueTitle:v}=e,[j,b]=(0,a.useState)(eU[0].accessor),[w,k]=(0,a.useState)(!1),_=(0,eB.useIsMobile)(),S=(0,eN.useAgo)(h,{justNowLabel:"just now"}),{showPercentage:C,columns:T,data:O}=(0,a.useMemo)(()=>{let[e={}]=Object.values(u),a=1!==n.length&&"object"==typeof e&&"percent"in e&&null!==e.percent,r=[{Header:"Name",accessor:"name"},{Header:"Total",accessor:"total",align:"right"}];a&&r.push({Header:"Percent",accessor:"percent",align:"right"}),_&&r.length>2&&r.splice(r.findIndex(e=>"name"!==e.accessor&&e.accessor!==j),1);let l={},c={};for(let{resources:e=[],regions:t=[],logDrains:a=[]}of s)for(let{title:r,subtitle:n,link:i}of[...e,...t,...a])r&&(n||i)&&(l[r]=n,c[r]=i);return{showPercentage:a,columns:r,data:n.map(e=>{let a=u[e]??0,r=0,n=null;"number"!=typeof a?{total:r,percent:n}=a:r=a;let s=l[e],f=c[e],h=e||(v??"Unknown");return{key:e,groupedInOther:!!i&&!i.includes(e),link:f,name:(0,t.jsxs)(t.Fragment,{children:[f&&"external"===x?(0,t.jsx)(d.Link,{external:!0,href:f,children:h}):h,s?(0,t.jsxs)(t.Fragment,{children:[" ",(0,t.jsx)(o.Text,{as:"span",color:"gray-900",children:s})]}):null]}),total:r,percent:Number.parseFloat(n??"0")}})}},[u,n,_,j,s,g,i,x,v]),D=function(e,t){let[r,n]=(0,a.useState)(e),i=(0,a.useRef)(e),l=(0,eq.usePrefersReducedMotion)();return(0,a.useEffect)(()=>{i.current=e},[t]),(0,a.useEffect)(()=>{let t=performance.now(),a=i.current,r=a.length===e.length;l&&(r=!1);let s=0,o=function(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:performance.now(),l=Math.sin(Math.min((i-t)/100,1)*Math.PI*.5);if(!r||1===l){n(e),Object.assign(a,e);return}s=requestAnimationFrame(o);let c=Array(e.length);for(let t=e.length;t--;){let r=e[t],n=a[t];c[t]={key:r.key,groupedInOther:r.groupedInOther,name:r.name,link:r.link,total:eH(n.total,r.total,l),percent:eH(n.percent,r.percent,l)}}n(c)};return o(),()=>{cancelAnimationFrame(s),n(e=>(Object.assign(a,e),e))}},[e,l]),r}(O,g),N=p?30:6,M=!w&&D.length>N,P=(0,a.useMemo)(()=>{let e=new URL(y,location.origin);return e.searchParams.set("view",g),e.toString()},[y,g]),L=(0,a.useMemo)(()=>M?p?(0,t.jsx)(eu.Button,{className:eM.default.viewAll,onClick:()=>void(0,eR.awaitPaint)().then(()=>k(!0)),type:"secondary",children:(0,t.jsxs)(r.Stack,{align:"center",direction:"row",gap:.5,children:[(0,t.jsx)(o.Text,{variant:"label-12",children:"View All"}),(0,t.jsx)(eL.ChevronRightSmall,{})]})}):(0,t.jsx)(d.ButtonLink,{className:eM.default.viewAll,href:P,type:"secondary",children:(0,t.jsxs)(r.Stack,{align:"center",direction:"row",gap:.5,children:[(0,t.jsx)(o.Text,{variant:"label-12",children:"View All"}),(0,t.jsx)(eL.ChevronRightSmall,{})]})}):null,[M,P,p]),I=(0,a.useMemo)(()=>"none"===x||"external"===x?null:"o11y"===x?function(e){let{link:a}=e;return a?(0,t.jsx)(e$.OpenObservability,{href:a}):null}:function(e){let{link:a}=e;return a?(0,t.jsx)(eE.OpenButton,{href:a}):null},[x]);return(0,t.jsxs)(r.Stack,{className:(0,l.clsx)(eM.default.container,M&&eM.default.hasMore),gap:2,paddingTop:4,children:[(0,t.jsx)("div",{className:"geist-show-on-mobile",children:(0,t.jsxs)(r.Stack,{align:"center",direction:"row",justify:"space-between",style:{marginBlock:"0.5rem 0.25rem"},children:[C?(0,t.jsx)(eT.Switch,{children:eU.map(e=>(0,t.jsx)(eT.Switch.Control,{checked:e.accessor===j,label:(0,t.jsx)(e.Icon,{size:16}),onChange:()=>b(e.accessor),value:e.accessor},e.accessor))}):(0,t.jsx)("div",{}),(0,t.jsxs)(o.Text,{color:"gray-600","data-testid":(0,eO.tid)("usage","metric","updated-text"),variant:"label-14",children:["Updated ",S||"just now"]})]})}),(0,t.jsx)("div",{className:(0,l.clsx)("grid",I?"grid-cols-[44px_1fr_auto_auto]":"grid-cols-[1fr_auto_auto]"),children:D.map((e,a)=>!w&&a>=N?null:(0,t.jsxs)("div",{className:"col-span-full grid grid-cols-subgrid items-center odd:bg-background-200",children:[I?(0,t.jsx)("span",{className:"p-2",children:I(e)}):null,T.map((a,r)=>{let n,i=r===T.length-1;if(0===r){let r=e[a.accessor];return(0,t.jsxs)("span",{className:"flex flex-row items-center gap-3 p-2 font-medium text-gray-1000",children:[(0,t.jsx)(eA.Status,{style:{color:c(e.groupedInOther?"other":e.key)}}),r]},a.accessor)}let s=e[a.accessor];return n="total"===a.accessor?f(s,_?"display":"long"):`${s.toFixed(1)}%`,(0,t.jsx)("span",{className:(0,l.clsx)("p-2 tabular-nums text-gray-900",i?"pr-2 text-right":"pr-10",m&&"text-gray-1000"),children:n},a.accessor)})]},e.key))}),L]})});var eW=e.i(5163670),eV=e.i(5652027);function eG(e){let{metricCount:a}=e;return(0,t.jsx)("div",{children:(0,t.jsxs)(r.Stack,{gap:{sm:1,md:4,lg:4},children:[(0,t.jsxs)(r.Stack,{align:"center",direction:{sm:"column",md:"row",lg:"row"},gap:{sm:2,md:18,lg:18},justify:"space-between",paddingBottom:{sm:2,md:0},children:[(0,t.jsx)(eW.Skeleton,{height:40,width:180}),(0,t.jsx)(eW.Skeleton,{height:22,width:125})]}),(0,t.jsx)(eW.Skeleton,{height:240,width:"100%"}),(0,t.jsx)(r.Stack,{paddingTop:2,children:Array(a).fill(null).map((e,a)=>(0,t.jsxs)(r.Stack,{direction:"row",justify:"space-between",paddingX:2,paddingY:2,children:[(0,t.jsx)(eW.Skeleton,{height:20,width:152-a%2*32}),(0,t.jsxs)(r.Stack,{direction:"row",flex:"0 0 50%",justify:"flex-end",children:[(0,t.jsx)(r.Stack,{align:"flex-end",className:"geist-hide-on-mobile",flex:"0 0 50%",children:(0,t.jsx)(eW.Skeleton,{height:20,width:64+a%2*20})}),(0,t.jsx)(r.Stack,{align:"flex-end",flex:"0 0 50%",children:(0,t.jsx)(eW.Skeleton,{height:20,width:64+a%2*20})})]})]},(0,eV.getUnsafeKey)(a)))})]})})}function eK(){return(0,t.jsx)(eW.Skeleton,{height:234,style:{marginTop:5},width:"100%"})}var eZ=e.i(3579453);let eX=(e,t)=>{if(t?.kind==="custom"){let{singular:e,plural:a}=t;return(0,en.createCountFormatterWithUnit)({singular:e,plural:a})}return e},eY=(0,a.memo)(function(e){let{children:r}=e,[n,i]=(0,a.useState)(!1),[l,s]=(0,a.useState)(360),o=(0,a.useRef)(null);return((0,a.useEffect)(()=>{let e=o.current;if(!e)return;let t=new IntersectionObserver(t=>{let[a=null]=t;if(!a)return;let r=!1;i(e=>(r=e&&!a.isIntersecting,a.isIntersecting)),r&&s(e.clientHeight)},{rootMargin:"800px 0px"});return t.observe(e),()=>t.disconnect()},[]),n)?(0,t.jsx)("div",{ref:o,style:{minHeight:360,transition:"opacity 0.1s"},children:r}):(0,t.jsx)("div",{ref:o,style:{contentVisibility:"hidden",containIntrinsicHeight:l,height:l,minHeight:360,opacity:0}})}),eQ=(0,a.memo)(function(e){let{from:r,to:n,metricNames:i,data:l=[],metricColors:s,formatter:o,unit:c,granularity:u,reverseStack:d,lastUpdate:f,dataAvailableSince:h,selectedProjectId:p,disableGroupBy:m=!1,legendNote:g,groupingTypeEmptyValueTitles:x,groupingTypeOptions:y=["Ratio","Projects"],defaultGroupingType:v="Ratio",groupingTypeLinkStyles:j,onBarSelected:b,dimension:w,expanded:k=!1,viewAllHref:_=""}=e,S=eX(o,c),[C,{width:T}]=(0,ea.default)(),{chartData:O,keys:D,truncatedKeys:N,range:M,dimension:P,groupingType:L,setGroupingType:I,isGroupingEnabled:F}=function(e){let{data:t=[],metricNames:r,formatter:n,defaultGroupingType:i,expanded:l=!1}=e,{groupingType:s,setGroupingType:o}=ej({defaultGroupingType:i,expanded:l}),{groupedData:c,keys:u,truncatedKeys:d}=(0,a.useMemo)(()=>{let e=(e,t)=>e||t;if("Ratio"===s||"Direction"===s||"Count"===s||"Origin"===s)return{groupedData:t.map(e=>{let{sum:t,date:a,resources:n,regions:i,...l}=e;return{data:Object.entries(l).reduce((e,t)=>{let[a,n]=t,i=r[Number.parseInt(a,10)];return i&&(e[i]="number"==typeof n?n:0),e},{}),sum:t,date:a,resources:n,regions:i}}),keys:r,truncatedKeys:r};let a="resources";switch(s){case"Regions":a="regions";break;case"Log Drains":a="logDrains";break;case"Log Sources":a="logSources";break;case"Event Types":a="eventType";break;case"Blob Stores":a="blobStores";break;case"Runtime":a="runtime";break;case"Type":a="cause";break;default:a="resources"}let n=new Map,i=new Set;for(let r of t)for(let{name:t,percent:l,title:s,count:o}of r[a]??[]){let a=e(t,s),c=o||(n.get(a)||0)+l/100*r.sum;n.set(a,c),c/r.sum>.05&&i.add(a)}let l=Array.from(n.entries()).sort((e,t)=>{let[,a]=e,[,r]=t;return a>r?-1:1}),o="other";if(i.size<10){for(let[e]of l)if(i.add(e),i.size>=10)break}let c=Array.from(i).sort((e,t)=>(n.get(t)??0)-(n.get(e)??0)),u=Object.fromEntries(l.map(e=>{let[t]=e;return[t,0]})),d=Object.keys(u);return c.length<d.length&&c.push(o),{groupedData:t.map(t=>{let r=t[a]?.reduce((a,r)=>{let{name:n,title:i,percent:l,count:s}=r,u=e(n,i),d=s||l/100*t.sum;return a[u]=(a[u]??0)+d,c.includes(u)||(a[o]=(a[o]??0)+d),a},{});return{data:{...u,...r},sum:t.sum,date:t.date,resources:t.resources,regions:t.regions,logDrains:t.logDrains,logSources:t.logSources,eventType:t.eventType,blobStores:t.blobStores,runtime:t.runtime,cause:t.cause}}),keys:d,truncatedKeys:c}},[t,s,r]),[f,h,p]=(0,a.useMemo)(()=>{let e={},t=0,a=0;for(let r of c)for(let n of(t<r.sum&&(t=r.sum),a+=r.sum,u))if(n in r.data){let t=r.data[n];if("number"==typeof t){let a=(n in e?e[n].total:0)+t;e[n]={total:a,percent:null}}}if(a>0)for(let[t,{total:r}]of Object.entries(e))e[t]={total:r,percent:(0,es.formatPercentage)(r,a)};return[(0,ey.roundUpAxisRange)(t,n),t>0,e]},[n,c,u]),m=(0,a.useMemo)(()=>c.map(e=>({date:e.date,value:e.sum,data:e.data,resources:e.resources,regions:e.regions,logDrains:e.logDrains,logSources:e.logSources})),[c]);return{chartData:m,keys:u,truncatedKeys:d,range:f,dimension:p,groupingType:s,setGroupingType:o,isGroupingEnabled:h&&m[0]&&("resources"in m[0]||"regions"in m[0]||"logDrains"in m[0]||"logSources"in m[0]||"eventType"in m[0]||"blobStores"in m[0]||"runtime"in m[0]||"cause"in m[0])}}({metricNames:i,data:l,formatter:S,defaultGroupingType:v,expanded:k}),A=O.length>0,{valueScale:R,dateScale:B,colorScale:q,tickYValues:$,tickXValues:E}=function(e){let{data:t=[],width:r}=e;return{dateScale:(0,a.useMemo)(()=>{let e=t.map(e=>{let{date:t}=e;return t});return(0,eb.scaleBand)({domain:e,range:[0,r-50],padding:.4375,paddingOuter:.3})},[t,r]),...eS(e)}}({data:l,width:T,range:M,keys:D,granularity:u,colors:"Projects"===L||"Regions"===L||"Log Drains"===L||"Log Sources"===L?eZ.defaultMetricColors:s}),{usageTooltipProps:U,tooltipData:H,tooltipDimension:W,showTooltip:V,hideTooltip:G,cancelHideTooltip:K}=ex({from:r,to:n,granularity:u,showPercentage:D.length>1}),Z=(0,a.useMemo)(()=>{let e=y.indexOf(L);return j?.[e]??"none"},[L,y,j]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eP,{disableGroupBy:m||!F,groupingType:L,groupingTypeOptions:y,lastUpdate:f,noteText:g,selectedProjectId:p,setGroupingType:I}),(0,t.jsx)(e1,{chartRef:C,chartScales:{dateScale:B,valueScale:R},dataAvailableSince:h,formatter:S,granularity:u,isDataAvailable:A,tickXValues:E,tickYValues:$,usageTooltip:{cancelHideTooltip:K,hideTooltip:G,usageTooltipProps:U},width:T,children:(0,t.jsx)(z,{color:q,data:O,keys:N,order:d?"reverse":"none",value:(e,t)=>e.data[t]??0,x:e=>{let{date:t}=e;return t},xScale:B,yScale:R,children:e=>[e[d?0:e.length-1]?.bars.map(a=>(0,t.jsx)("rect",{className:el.default["bar-overlay"],height:R(0),onClick:b?e=>b({event:e,bar:a}):void 0,onMouseMove:()=>{if(!H||a.index!==H.index){let e=Math.round((R(a.bar[1])||0)-22),t=Math.round(a.x+50+a.width/2);V({tooltipData:{data:a.bar.data,index:a.index},tooltipTop:e,tooltipLeft:t})}},onTouchMove:t=>{K();let{x:r}=(0,ee.localPoint)(t)||{x:0},n=~~(r/(a.width/.5625)),i=e[d?0:e.length-1].bars[n];if(i&&(!H||i.index!==H.index)){let e=Math.round((R(i.bar[1])||0)-22),t=Math.round(i.x+50+i.width/2);V({tooltipData:{data:i.bar.data,index:n},tooltipTop:e,tooltipLeft:t})}},width:a.width/.5625,x:a.x-.4375*a.width*.5/.5625,y:0},`bar-stack-${a.index}-overlay`)),...e.map(e=>e.bars.map(a=>(0,t.jsx)("rect",{className:el.default.bar,fill:a.color,height:a.height,width:a.width,x:a.x,y:a.y},`bar-stack-${e.index}-${a.index}`)))]})}),(0,t.jsx)(ez,{chartData:O,colorScale:q,dimension:W||w||P,expanded:k,formatter:S,groupingType:L,isDataAvailable:A,isHovered:!!W,keys:D,lastUpdate:f,linkStyle:Z,truncatedKeys:N,viewAllHref:_,emptyValueTitle:x?.[L]})]})}),eJ=(0,a.memo)(function(e){return(0,t.jsx)(eY,{children:(0,t.jsx)(eQ,{...e})})}),e0=(0,a.memo)(function(e){let r,{from:n,to:i,metricNames:l,data:s=[],groupByProjectData:o,metricColors:c,formatter:u,unit:d,granularity:f,lastUpdate:h,dataAvailableSince:p,selectedProjectId:m,disableGroupBy:g=!1,legendNote:x,groupingTypeEmptyValueTitles:y,groupingTypeOptions:v=["Average","Projects"],defaultGroupingType:j="Average",groupingTypeLinkStyles:b,setGroupByProject:w,expanded:k=!1,viewAllHref:S=""}=e,C=eX(u,d),[T,{width:O}]=(0,ea.default)(),{chartData:D,keys:N,range:M,dimension:P,groupingType:L,setGroupingType:I,isGroupingEnabled:F}=function(e){let{data:t=[],groupByProjectData:r,metricNames:n,formatter:i,defaultGroupingType:l,expanded:s=!1}=e,{groupingType:o,setGroupingType:c}=ej({defaultGroupingType:l,expanded:s}),{groupedData:u,keys:d}=(0,a.useMemo)(()=>{if("Projects"===o){let e=new Map;for(let t of r||[])for(let a of t.data){let[t,r]=e.get(a.name)??[0,0];e.set(a.name,[t+a.sum,r+a.count])}let a=[...e.entries()].sort((e,t)=>{let[,a]=e,[,r]=t;return a[0]/a[1]>r[0]/r[1]?-1:1}).map(e=>{let[t]=e;return t}),n=Object.fromEntries(a.map(e=>[e,[0,0]])),i=a.map(e=>{for(let a of t){let t=a.resources?.find(t=>{let{name:a}=t;return a===e});if(t)return{...t,title:t.name,sum:0,count:0}}}).filter(e=>void 0!==e);return{groupedData:(r||[]).map(e=>({data:{...n,...Object.fromEntries(e.data.map(e=>[e.name,[e.sum,e.count]]))},resources:i,date:e.date})),keys:a}}return{groupedData:t.map(e=>{let{date:t,resources:a,regions:r,...i}=e;return{data:Object.entries(i).reduce((e,t)=>{let[a,[r,i]]=t,l=n[Number.parseInt(a,10)];return l&&(e[l]=[r,i]),e},{}),date:t,resources:a,regions:r}}),keys:n}},[t,r,o,n]),[f,h,p]=(0,a.useMemo)(()=>{let e={},t=0;for(let a of u)for(let r of d)if(r in a.data){let[n,i]=a.data[r];t<n/i&&(t=n/i);let[l,s]=e[r]??[0,0];e[r]=[n+l,i+s]}let a=Object.fromEntries(Object.entries(e).map(e=>{let[t,[a,r]]=e;return[t,a/r]}));return[(0,ey.roundUpAxisRange)(t,i),t>0,a]},[i,u,d]),m=u.map(e=>{let t=Object.entries(e.data).map(e=>{let[t,[a,r]]=e;return[t,0!==r?a/r:void 0]});return{date:e.date,value:t.reduce((e,t)=>{let[a,r]=t;return Math.max(e,r??0)},0),data:Object.fromEntries(t),resources:e.resources}});return{chartData:m,keys:d,range:f,dimension:p,groupingType:o,setGroupingType:c,isGroupingEnabled:h&&m[0]&&("resources"in m[0]||"regions"in m[0]||"logDrains"in m[0]||"logSources"in m[0]||"eventType"in m[0]||"blobStores"in m[0]||"runtime"in m[0]||"cause"in m[0])}}({metricNames:l,data:s,groupByProjectData:o,formatter:C,defaultGroupingType:j,expanded:k}),A="Projects"===L&&!o,R=D.length>0,{valueScale:B,dateScale:q,colorScale:$,tickYValues:E,tickXValues:U}=function(e){let{data:t=[],width:r}=e;return{dateScale:(0,a.useMemo)(()=>{let e=t.map(e=>{let{date:t}=e;return t});return(0,e_.scalePoint)({domain:e,range:[0,r-36],padding:.3})},[t,r]),...eS(e)}}({data:s,width:O,range:M,keys:N,granularity:f,colors:"Projects"===L||"Regions"===L?eZ.defaultMetricColors:c}),{usageTooltipProps:H,tooltipData:z,tooltipDimension:W,showTooltip:G,hideTooltip:K,cancelHideTooltip:X}=ex({from:n,to:i,granularity:f}),Y=(0,a.useCallback)(e=>{w?.("Projects"===e),I(e)},[w,I]),Q=(0,a.useMemo)(()=>(function(e){let t=e.domain(),a=e(t[0])??0,r=e.step();return e=>Math.max(0,Math.min(Math.round((e-a)/r),t.length-1))})(q),[q]),J=(0,a.useCallback)(e=>{let t;X();let{x:a,y:r}=(0,ee.localPoint)(e)||{x:0,y:0},n=Q(a),i=D[n],l=Object.values(i.data).filter(e=>"number"==typeof e).sort((e,t)=>e-t);if(!l.length)return;let s=B.invert(r),o=(t=l.length-1,(0,er.bisector)(e=>e).left(l,s,0,t));if(z&&n===z.index&&o===z.yIndex)return;let c=(B(l[o])||0)-22,u=(q(i.date)||0)+50;G({tooltipData:{data:i,index:n,yIndex:o},tooltipLeft:u,tooltipTop:c})},[X,D,q,Q,G,z,B]);void 0!==H.left&&(r=Q(H.left-50));let en=(0,a.useMemo)(()=>{let e=v.indexOf(L);return b?.[e]??"none"},[L,v,b]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eP,{disableGroupBy:g||!A&&!F,groupingType:L,groupingTypeOptions:v,lastUpdate:h,noteText:x,selectedProjectId:m,setGroupingType:Y}),(0,t.jsxs)(e1,{chartRef:T,chartScales:{dateScale:q,valueScale:B},dataAvailableSince:p,formatter:C,granularity:f,isDataAvailable:R,loading:A,tickXValues:U,tickYValues:E,usageTooltip:{cancelHideTooltip:X,hideTooltip:K,usageTooltipProps:H},width:O,children:[void 0!==H.left&&(0,t.jsx)(V,{from:{x:H.left-50,y:0},pointerEvents:"none",stroke:"var(--accents-2)",strokeWidth:1,to:{x:H.left-50,y:200}}),N.map(e=>{let n=$(e),i=D.map(t=>({date:t.date,value:t.data[e]})),l="number"==typeof r?i[r]?.value:void 0,s=void 0!==l?B(l):void 0;return(0,t.jsxs)(a.default.Fragment,{children:[(0,t.jsx)(Z,{curve:et.curveLinear,data:i.filter(e=>void 0!==e.value),stroke:n,strokeWidth:2,x:e=>{let{date:t}=e;return q(t)??0},y:e=>{let{value:t}=e;return B(t)}}),void 0!==H.left&&void 0!==s&&(0,t.jsx)("circle",{cx:H.left-50,cy:s,fill:n,pointerEvents:"none",r:4,stroke:"white",strokeWidth:2})]},e)}),(0,t.jsx)(_,{fill:"transparent",height:200,onMouseMove:J,onTouchMove:J,rx:0,width:O,x:0,y:0})]}),(0,t.jsx)(ez,{chartData:D,colorScale:$,dimension:W||P,expanded:k,formatter:C,groupingType:L,isDataAvailable:R,isHovered:!!W,keys:N,lastUpdate:h,linkStyle:en,loading:A,viewAllHref:S,emptyValueTitle:y?.[L]})]})}),e1=(0,a.memo)(function(e){let{chartRef:r,chartScales:{dateScale:n,valueScale:i},children:l,dataAvailableSince:s,formatter:o,granularity:c,isDataAvailable:u,loading:d,tickXValues:f,tickYValues:h,usageTooltip:{cancelHideTooltip:p,hideTooltip:m,usageTooltipProps:g},width:x}=e,y=(0,a.useRef)(null),[v,j]=(0,a.useState)(400);if((0,a.useEffect)(()=>{let e=y.current;if(!e)return;let t=()=>{j(e.clientWidth)};requestAnimationFrame(()=>t());let a=new ResizeObserver(t);return a.observe(e),()=>{a.disconnect()}}),d)return(0,t.jsx)(eK,{});let b=6e4*new Date().getTimezoneOffset();return u?(0,t.jsxs)("figure",{className:el.default.figure,onMouseEnter:p,onMouseLeave:m,ref:r,style:{visibility:x?"visible":"hidden"},children:[(0,t.jsxs)("div",{className:el.default["auto-visibility"],children:[(0,t.jsx)("svg",{height:227,width:50,children:(0,t.jsx)(J.AxisLeft,{hideAxisLine:!0,hideTicks:!0,left:8,scale:i,tickFormat:e=>o(e),tickLabelProps:()=>({fill:"var(--accents-5)",fontSize:14,textAnchor:"start"}),tickValues:h,top:5})}),(0,t.jsxs)("svg",{height:227,ref:y,width:"calc(100% - 50px)",children:[(0,t.jsx)(Q.AxisBottom,{hideAxisLine:!0,hideTicks:!0,scale:n,tickFormat:e=>(0,es.formatDate)(e+("hour"===c?0:b),c),tickLabelProps:()=>({fill:"var(--accents-5)",fontSize:14,textAnchor:"middle"}),tickValues:f,top:200}),(0,t.jsx)(Y.GridRows,{scale:i,stroke:"var(--accents-2)",tickValues:h,width:v}),(0,t.jsx)(X.Group,{children:l})]})]}),(0,t.jsx)(eg,{...g,dataAvailableSince:s,width:x})]}):(0,t.jsx)(ei.Empty,{})}),e5=(0,a.memo)(function(e){return(0,t.jsx)(eY,{children:(0,t.jsx)(e0,{...e})})});e.s({useChartData:()=>tD},4627951);var e2=e.i(5535439),e4=e.i(3521787),e3=e.i(4483564),e6=e.i(3514588),e7=e.i(2158583),e8=e.i(6689585),e9=e.i(1532957),te=e.i(4113687);e.i(6117582);var tt=e.i(2365581),ta=e.i(4237550),tr=e.i(7916122),tn=e.i(2130124),ti=e.i(3440070);function tl(e){let{imageOptimizations:r,selectedGroup:n,query:i,isLoading:s,className:o}=e,[c,d]=(0,a.useState)(n),[f,h]=(0,a.useState)(n);(0,a.useEffect)(()=>{d(n)},[n]);let[p,m]=(0,a.useState)({}),[g,x]=[i.startDatetime,i.endDatetime].map(Number);(0,a.useEffect)(()=>{m({})},[i.projectId,g,x,i.skip]);let{groupCounts:y,groups:v,offsets:j}=(0,a.useMemo)(()=>{let e={offsets:[],groups:[],groupCounts:[]};if(!r)return e;for(let{count:t,timestamp:a}of r){let r=e.groups.indexOf(a);-1===r&&(r=e.groups.push(a)-1,e.offsets[r]=e.groupCounts.reduce((e,t)=>e+t,0)),e.groupCounts[r]=(e.groupCounts[r]||0)+t}return e},[r]),[b,w]=(0,a.useState)(!1),[k,{height:_}]=(0,ea.default)(),S=(0,ed.useSpring)({height:_||54,config:{mass:.15,tension:400,friction:30}}),C=(0,a.useRef)(null);null!==c&&C.current?.scrollToIndex({groupIndex:c,index:0,behavior:"smooth"});let T=(0,a.useMemo)(()=>{let e=[];for(let t=Math.max((f??1)-1,0),a=0,r=0;t<v.length&&null!==f;a+=y[t++],r++){let n=v[t].split(" ")[0].split("T")[0];if(r<3||a<=100)n in p||e.push(n);else break}return e},[y,p,v,f]),O=(0,tn.useUsageImageOptimizations)({...i,buckets:T});(0,a.useEffect)(()=>{if(O.data){if("error"in O.data||0===O.data.data.length)return;let e={};for(let{timestamp:t,sourceImages:a}of O.data.data)e[t.split(" ")[0].split("T")[0]]=a||[];m(t=>({...t,...e}))}},[O.data]);let D=s||O.data&&"error"in O.data||!r?.length;(0,a.useEffect)(()=>{null===c||D||w(!0)},[c,D]);let N=(0,a.useCallback)(e=>{e!==c&&d(null),h(e)},[c]);return(0,t.jsx)(ef.animated.div,{className:(0,l.clsx)(o,ti.default["animated-container"],{[ti.default.open]:b}),style:S,children:(0,t.jsxs)("details",{className:(0,l.clsx)(ti.default["src-images-container"],{[ti.default.open]:b,[ti.default.disabled]:D}),onClick:e=>{e.preventDefault(),!D&&(b||w(!0))},open:b,ref:k,children:[(0,t.jsx)("summary",{onClick:e=>{e.preventDefault(),D||(d(null),w(!1))},children:(0,t.jsxs)("div",{children:[b?(0,t.jsx)(ta.ChevronDown,{color:"gray-700",size:20}):(0,t.jsx)(tr.ChevronRight,{color:"gray-700",size:20}),(0,t.jsx)("span",{children:"View Source Images"})]})}),(0,t.jsx)("div",{children:(0,t.jsx)(te.GroupedVirtuoso,{groupContent:function(e){let a=v[e],r=tt.DateTime.fromISO(a.endsWith("Z")?a:`${a.split(" ").join("T")}.000Z`).toJSDate();return(0,t.jsxs)("div",{className:ti.default.rowHeader,children:[`${(0,eo.format)(r,"MMM d, yyyy")}`,(0,t.jsxs)(u.Badge,{size:"sm",variant:"gray-subtle",children:[y[e].toLocaleString()," Images Optimized"]})]})},groupCounts:y,itemContent:function(e,a){let r=v[a].split(" ")[0].split("T")[0],n=j[a],i=p[r]?.[e-n];return i?(0,t.jsx)("div",{className:ti.default.row,children:i}):O.isLoading?(0,t.jsx)("div",{className:ti.default.row,children:(0,t.jsx)(eW.Skeleton,{width:"100%"})}):(0,t.jsx)("div",{className:ti.default.row,children:"Unknown"})},rangeChanged:(0,a.useMemo)(()=>(0,e9.default)(e=>{let{startIndex:t}=e,a=j.length;for(;a--&&!(t>j[a]););N(a+1)},100),[j,N]),ref:C,style:{height:400}})})]})})}var ts=e.i(7320579),to=e.i(6880253),tc=e.i(3821772),tu=e.i(2781454),td=e.i(854226),tf=e.i(7015259);let th={bandwidth:"sum(bandwidth_total)",execution_time:"sum(serverless_function_execution)",invocations:"sum(requests)",requests:"sum(requests)"};function tp(e,t){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t?`/${t}/~/monitoring`:"/dashboard/monitoring";if(!e)return r;let{targetPath:n,host:i,range:l,pathKey:s}=e,o=th[e.sortKey],c="request_path"===s?"request_path":"source_path",u=a?`match(${c}, '${n}')`:`${c} = '${n}'`;void 0!==i&&(u=`${u} AND host = '${i}'`),void 0!==e.pathType&&(u=`${u} AND path_type = '${e.pathType}'`),void 0!==e.status&&(u=`${u} AND status = '${e.status}'`);let d="",f="";if(l){let e=l.startDate.getTime(),t=Math.min(l.endDate.getTime(),Date.now())-l.startDate.getTime(),a=(0,tf.getDefaultGranularity)(t);d=`&startTime=${e}&deltaTime=${t}`,f=`&g=${a}`}return`${r}?visualize=${encodeURIComponent(o)}&where=${encodeURIComponent(u)}${d}${f}`}function tm(e,t,a,r,n){return[{teamSlug:e,batchKey:a,filters:{to:t.to,from:t.from,projectId:t.projectId},isPage:r,options:n},"usage-metrics-action"]}var tg=e.i(935229),tx=e.i(7289190),ty=e.i(8931635),tv=e.i(9960073);let tj=[{value:"bandwidth",label:"Bandwidth",description:"Total incoming and outgoing bandwidth in GB from any unique path",icon:(0,t.jsx)(tx.ArrowCrossed,{})},{value:"execution_time",label:"Execution",description:"Execution in GB-Hrs from serverless functions",icon:(0,t.jsx)(ty.Lambda,{})},{value:"invocations",label:"Invocations",description:"Number of requests to serverless, ISR, and Edge functions",icon:(0,t.jsx)(ty.Lambda,{})},{value:"requests",label:"Requests",description:"Number of requests to any unique path",icon:(0,t.jsx)(tv.FileText,{})}],tb=[{label:"Request",value:"request_path"},{label:"Source",value:"target_path"}],tw={bandwidth:"size",execution_time:"computingTime",invocations:"count",requests:"count"},tk=["bandwidth","requests","invocations","execution_time"];function t_(e){let{filters:n,chartKey:i,batchKey:l,isPage:s,getData:o,initialData:c,cacheOnly:u}=e,f=(0,e2.useParams)(),[h,p]=(0,a.useState)("bandwidth"),[m,g]=(0,a.useState)("request_path"),[x,y]=(0,a.useState)(!1),{track:v}=(0,td.useTrackActivity)(),j=f?.teamSlug??"";(0,a.useEffect)(()=>{y(!0)},[]);let b="bandwidth"===h&&"request_path"===m,w=tm(j,n,l,s,{usageType:h,pathType:m}),{data:k,isValidating:_}=(0,e4.default)(u?null:w,async e=>{let[t]=e,a=await o(t);return await a.promise},{refreshInterval:0,revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!1,revalidateOnMount:c.error?.code==="timeout",fallback:c.error?.code==="timeout"?{}:{[(0,e4.unstable_serialize)(tm(j,c.filters,l,s,{usageType:"bandwidth",pathType:"request_path"}))]:{[i]:c}}}),S=k?.[i]?.error,C=k?.[i]?.data?.data??[],T=!!C.length,O=(0,tg.useChartCache)({filters:n,teamSlug:j},i),D=O?.data,N=!!(b&&!_&&!S&&k);(0,a.useEffect)(()=>{N&&j&&(0,tg.setChartDataCache)(i,{key:{...w[0]},data:s?void 0:C,isValidating:!1})},[N,i,s,(0,e4.unstable_serialize)(w[0]),f?.teamSlug]),(0,a.useEffect)(()=>{if(!T)return;let e=async e=>{let t=tm(j,n,l,s,{usageType:h,pathType:m,...e});if(!to.cache.get((0,e4.unstable_serialize)(t)))return(0,ts.preload)(t,async e=>{let[t]=e,a=await o(t);return await a.promise})};for(let t of(e({pathType:"target_path"===m?"request_path":"target_path"}),tk))if(t!==h){e({usageType:t});break}},[h,m,T]);let M=(0,a.useCallback)(e=>tp({sortKey:h,targetPath:e.path,host:e.host,pathKey:"target_path"===m?"source_path":m,range:{startDate:n.from,endDate:n.to}},f?.teamSlug),[f?.teamSlug,m,h,n.from,n.to]),P=(0,e3.useChartLink)(f?.teamSlug??"",i),L=(0,a.useCallback)(e=>{let a=tp({...function(e){try{if(!e.includes("."))return{targetPath:e};let t=new URL(e.startsWith("http")?e:`https://${e}`);return{host:t.host,targetPath:t.pathname}}catch{return{targetPath:e}}}(e),sortKey:h,pathKey:"target_path"===m?"source_path":m,range:{startDate:n.from,endDate:n.to}},f?.teamSlug,!0);return(0,t.jsxs)(t.Fragment,{children:["Your search did not match any paths in your Top 1,000 paths. You can look at all your paths with"," ",(0,t.jsx)(d.Link,{href:a,target:"_blank",variant:"highlight",children:"Monitoring"}),"."]})},[f?.teamSlug,m,h,n.from,n.to]);if(!u||D)return{error:S,type:"paths",formatter:tw[h],data:u?D:C,filters:tj,selectedFilter:h,onFilterChange:e=>{u||(p(e),v(tu.VercelActivityAction.UsageTopPathsFilterChange,{plan:f?.plan,planIteration:f?.planIteration,usageType:e,pathType:m}))},subFilters:tb,selectedSubFilter:m,onSubFilterChange:e=>{u||(g(e),v(tu.VercelActivityAction.UsageTopPathsFilterChange,{plan:f?.plan,planIteration:f?.planIteration,usageType:h,pathType:e}))},getRowHref:M,showSkeleton:_||!x,viewAllHref:P,footerNote:u?(0,t.jsx)(r.Stack,{direction:"row",justify:"center",children:(0,t.jsx)(tc.Spinner,{})}):"Showing the top 1,000 paths within the selected time range",noDataMessage:L}}function tS(e){let{props:r,filters:n}=e,[i,l]=(0,a.useState)(null);if(!r||"bar"!==r.type)return;let s=r.data?.map(e=>({timestamp:new Date(e.date).toISOString(),count:e.sum,projectId:"",projectName:""}));return{...r,onBarSelected:e=>{let{bar:t}=e;l(t.index)},footer:(0,t.jsx)(tl,{className:b.default.imageOptimizationsTable,imageOptimizations:s,isLoading:!1,query:{startDatetime:n.from,endDatetime:n.to,projectId:n.projectId},selectedGroup:i})}}function tC(e){let{props:t,filters:r,chartKey:n}=e,i="edge-functions-cpu-time"===n?"edge-function":"middleware",[l,s]=(0,a.useState)(!1),{data:o}=(0,e7.useUsageGroupByProjectMetrics)({type:"edge_group_by_project",edgeInvocationType:i,start:r.from,end:r.to,skip:!l||!i});return t?.type==="line"?{...t,groupByProjectData:o?.data.workerExecutionAvg,setGroupByProject:s}:void 0}function tT(e){let{props:t,filters:a}=e,r=a.projectId?"When filtered by project local artifact usage is not attributed.":void 0;return t?{...t,legendNote:r}:void 0}function tO(e){let{props:r}=e,{isPlus:n,plan:i}=(0,e8.useIsWebAnalyticsBilling)(),{team:l}=(0,e6.useTeam)(),s=(0,a.useMemo)(()=>{if("pro"!==i)return;let e=l?.slug?`/${l.slug}/~/settings/billing#web-analytics`:"/account/billing#web-analytics";return n?(0,t.jsxs)(o.Text,{variant:"copy-14",children:["You have Web Analytics Plus enabled for your team."," ",(0,t.jsx)(d.Link,{href:"/docs/analytics/limits-and-pricing",variant:"highlight",children:"Manage in Billing"}),"."]}):(0,t.jsxs)(o.Text,{variant:"copy-14",children:["Enable the"," ",(0,t.jsx)(d.Link,{href:e,variant:"highlight",children:"Web Analytics Plus Add-on"})," ","to unlock 500k included events per month."]})},[n,i,l?.slug]);return r?{...r,additionalDescription:s}:void 0}function tD(e){let{chartKey:t,batchKey:r,filters:n,initialData:i,getData:l,noRevalidate:s,cacheOnly:o,isPage:c}=e,u=(0,e2.useParams)(),{hook:d,noSWR:f}=(0,a.useMemo)(()=>"image-optimization-source-image-optimizations"===t?{hook:tS}:"networking-top-paths"===t?{hook:t_,noSWR:!0}:"observability-web-analytics"===t?{hook:tO}:"edge-functions-cpu-time"===t||"edge-middleware-cpu-time"===t?{hook:tC}:t.startsWith("artifacts-")?{hook:tT}:{hook:e=>{let{props:t}=e;return t}},[t]),h=u?.teamSlug??"",p=tm(h,n,r,c),{data:m,isValidating:g}=(0,e4.default)(f||o?null:p,async e=>{let[t]=e;if(s)return{};let a=await l(t);return await a.promise},{refreshInterval:0,revalidateOnFocus:!1,revalidateOnReconnect:!1,revalidateOnMount:i.error?.code==="timeout",revalidateIfStale:!1,fallback:i.error?.code==="timeout"?{}:{[(0,e4.unstable_serialize)(tm(h,i.filters,r,c))]:{[t]:i}}}),{data:x,meterData:y,error:v}=m?.[t]??i,j=d({filters:n,props:x,chartKey:t,batchKey:r,getData:l,cacheOnly:o,initialData:i,isPage:c}),b=f?j?.error:v,w=(0,e3.useChartLink)(h,t),k=(0,a.useMemo)(()=>j?{...j,viewAllHref:w,formatter:es.formatters[j.formatter],selectedProjectId:n.projectId}:void 0,[n.projectId,j,w]),_=u?.teamSlug?(0,tg.getChartDataCache)(t,{...p[0]})?.data:void 0;return(0,a.useEffect)(()=>{!s&&!c&&!o&&u?.teamSlug&&(0,tg.setChartDataCache)(t,{key:{...p[0]},data:k,meterData:y,isValidating:g,error:b})},[s,t,k,o,c,p,g,y,b,u?.teamSlug]),{meterData:y,error:b,props:o&&!s?_:k,isValidating:g,footer:j?.footer??null}}var tN=e.i(6987331);function tM(e){let{skeleton:a,card:r,sectionKey:n,teamSlug:i,isPage:l}=e;return(0,t.jsx)(j,{accessory:a.hasMeter?(0,t.jsx)(eW.Skeleton,{height:20,width:120}):null,card:r,sectionKey:n,teamSlug:i,children:(0,t.jsx)(tP,{isPage:l,skeleton:a})})}function tP(e){let{skeleton:a,isPage:r}=e;switch(a.type){case"bar":case"line":return(0,t.jsx)(eG,{metricCount:a.metricCount});case"paths":return(0,t.jsx)(tN.PathsChart,{expanded:r,filters:a.filters,filtersClassName:r?b.default.stickyPathsFilters:void 0,selectedFilter:a.filters?.[0]?.value,selectedSubFilter:a.subFilters?.[0]?.value,showSkeleton:!0,subFilters:a.subFilters});default:return null}}var tL=e.i(1735144);function tI(e){let{type:a}=e;return(0,t.jsx)(r.Stack,{className:"tailwind-preflight",children:(0,t.jsxs)(r.Stack,{align:"center",className:(0,l.clsx)("rounded-md border border-gray-400 bg-background-100",{"h-[392px]":"bar"===a||"line"===a,"h-[340px]":"paths"===a}),direction:"column",gap:5,justify:"center",children:[(0,t.jsx)(r.Stack,{align:"center",className:"size-10 rounded-full bg-red-100",justify:"center",children:(0,t.jsx)(tL.StopFill,{color:"red-900"})}),(0,t.jsxs)(r.Stack,{align:"center",direction:"column",gap:1,children:[(0,t.jsx)(o.Text,{variant:"label-14",weight:500,children:"Something went wrong"}),(0,t.jsx)(o.Text,{color:"gray-900",variant:"copy-14",children:"We couldnt load the data for your selection"})]})]})})}let tF=(0,a.memo)(function(e){let{teamSlug:a,skeleton:l,plan:s,card:o,sectionKey:c,isPage:u,planIteration:d,isReseller:f,...h}=e,p=(0,y.useUsageFilters)(h.initialData.filters),{account:x}=(0,i.useAccount)(),{props:v,meterData:b,isValidating:w,error:k,footer:_}=tD({...h,filters:p,isPage:u});if(k&&!w)return u?(0,t.jsx)(tI,{type:l.type}):(0,t.jsx)(j,{card:o,sectionKey:c,teamSlug:a,children:(0,t.jsx)(tI,{type:l.type})});if(!v||w)return u?(0,t.jsx)(tP,{skeleton:l}):(0,t.jsx)(tM,{card:o,sectionKey:c,skeleton:l,teamSlug:a});if(u)return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(tA,{...v,isPage:!0}),_]});let S=b?.limit||"hobby"===s,C=b?{...b,currency:x?.billing?.currency,formatter:v.formatter,used:b.value,hideOnTablet:!1,hidePrices:f}:void 0;return(0,t.jsx)(j,{accessory:C&&!C.hideChartMeter?(0,t.jsxs)(r.Stack,{direction:"row",gap:2,children:[S?(0,t.jsx)(m,{...C}):(0,t.jsx)(n.Gauge,{className:"geist-hide-on-mobile",size:"tiny",value:0}),(0,t.jsx)(g,{...C,hideLimit:!S})]}):null,additionalDescription:v.additionalDescription,card:o,footer:_,plan:s,planIteration:d,sectionKey:c,teamSlug:a,children:(0,t.jsx)(tA,{...v})})}),tA=(0,a.memo)(function(e){let{isPage:a,...r}=e;switch(r.type){case"bar":return(0,t.jsx)(eJ,{...r,expanded:a});case"line":return(0,t.jsx)(e5,{...r,expanded:a});case"paths":return(0,t.jsx)(tN.PathsChart,{...r,expanded:a,filtersClassName:a?b.default.stickyPathsFilters:void 0});default:return null}})},[4627951]],7421773:e=>{"use strict";e.s({ClientChartWrapper:()=>i});var t=e.i(6645307),a=e.i(8635058),r=e.i(4627951),n=e.i(543209);function i(e){let{children:r,...n}=e,i=(0,a.useUsageFilters)();return i?(0,t.jsx)(l,{...n,filters:i,children:r}):r}function l(e){let{children:a,chartKey:i,batchKey:l,filters:s,noRevalidate:o}=e,{props:c,footer:u}=(0,r.useChartData)({filters:s,isPage:!1,cacheOnly:!0,chartKey:i,batchKey:l,initialData:{filters:s,error:{code:"not_found",message:"Not found"}},noRevalidate:o,getData:async()=>({promise:Promise.resolve({})})});return(0,t.jsxs)(t.Fragment,{children:[c?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.UsageChart,{...c,isPage:!0}),u]}):null,(0,t.jsx)("div",{style:c?{display:"none"}:void 0,children:a})]})}}}]);

//# sourceMappingURL=0dceefca3b723218.js.map
//# debugId=3335d601-13c5-5c80-a940-70d58dc7b14c
