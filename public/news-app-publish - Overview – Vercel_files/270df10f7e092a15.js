
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="3c07eef7-1808-52c7-9d63-721f0a1a837c")}catch(e){}}();
(globalThis.TURBOPACK=globalThis.TURBOPACK||[]).push(["object"==typeof document?document.currentScript:void 0,{5081217:e=>{e.v({alignEnd:"trace-viewer-module__8w33tq__alignEnd",alignStart:"trace-viewer-module__8w33tq__alignStart",ancestorDuration:"trace-viewer-module__8w33tq__ancestorDuration",ancestorLine:"trace-viewer-module__8w33tq__ancestorLine",ancestorLineContainer:"trace-viewer-module__8w33tq__ancestorLineContainer",ancestorName:"trace-viewer-module__8w33tq__ancestorName",ancestorNode:"trace-viewer-module__8w33tq__ancestorNode",ancestorText:"trace-viewer-module__8w33tq__ancestorText",childRow:"trace-viewer-module__8w33tq__childRow",collapsed:"trace-viewer-module__8w33tq__collapsed",color0:"trace-viewer-module__8w33tq__color0",color1:"trace-viewer-module__8w33tq__color1",color2:"trace-viewer-module__8w33tq__color2",color3:"trace-viewer-module__8w33tq__color3",colorHighlight:"trace-viewer-module__8w33tq__colorHighlight",colorVercel:"trace-viewer-module__8w33tq__colorVercel",cursorMarker:"trace-viewer-module__8w33tq__cursorMarker",cursorMarkerContainer:"trace-viewer-module__8w33tq__cursorMarkerContainer",cursorMarkerLabel:"trace-viewer-module__8w33tq__cursorMarkerLabel",cursorMarkerLabelContainer:"trace-viewer-module__8w33tq__cursorMarkerLabelContainer",cursorMarkerStickyParent:"trace-viewer-module__8w33tq__cursorMarkerStickyParent",cursorSelection:"trace-viewer-module__8w33tq__cursorSelection",detailGroup:"trace-viewer-module__8w33tq__detailGroup",detailHeading:"trace-viewer-module__8w33tq__detailHeading",detailHeadingIcon:"trace-viewer-module__8w33tq__detailHeadingIcon",divider:"trace-viewer-module__8w33tq__divider",eventDiamond:"trace-viewer-module__8w33tq__eventDiamond",eventMarker:"trace-viewer-module__8w33tq__eventMarker",eventMarkers:"trace-viewer-module__8w33tq__eventMarkers",eventMarkersContainer:"trace-viewer-module__8w33tq__eventMarkersContainer",eventName:"trace-viewer-module__8w33tq__eventName",eventTimestamp:"trace-viewer-module__8w33tq__eventTimestamp",hidden:"trace-viewer-module__8w33tq__hidden",hoverInfo:"trace-viewer-module__8w33tq__hoverInfo",huge:"trace-viewer-module__8w33tq__huge",inert:"trace-viewer-module__8w33tq__inert",infraSpanDescription:"trace-viewer-module__8w33tq__infraSpanDescription",mapCanvas:"trace-viewer-module__8w33tq__mapCanvas",mapContainer:"trace-viewer-module__8w33tq__mapContainer",mapThumb:"trace-viewer-module__8w33tq__mapThumb",marker:"trace-viewer-module__8w33tq__marker",markerLabel:"trace-viewer-module__8w33tq__markerLabel",markers:"trace-viewer-module__8w33tq__markers",markersContainer:"trace-viewer-module__8w33tq__markersContainer",mobile:"trace-viewer-module__8w33tq__mobile",notch:"trace-viewer-module__8w33tq__notch",searchBar:"trace-viewer-module__8w33tq__searchBar",searchInput:"trace-viewer-module__8w33tq__searchInput",selected:"trace-viewer-module__8w33tq__selected",skeleton:"trace-viewer-module__8w33tq__skeleton",small:"trace-viewer-module__8w33tq__small","span-skeleton":"trace-viewer-module__8w33tq__span-skeleton",spanDetailPanel:"trace-viewer-module__8w33tq__spanDetailPanel",spanDetailPanelAttribute:"trace-viewer-module__8w33tq__spanDetailPanelAttribute",spanDetailPanelAttributeKey:"trace-viewer-module__8w33tq__spanDetailPanelAttributeKey",spanDetailPanelAttributeValue:"trace-viewer-module__8w33tq__spanDetailPanelAttributeValue",spanDetailPanelBody:"trace-viewer-module__8w33tq__spanDetailPanelBody",spanDetailPanelClose:"trace-viewer-module__8w33tq__spanDetailPanelClose",spanDetailPanelCloseVerticalRule:"trace-viewer-module__8w33tq__spanDetailPanelCloseVerticalRule",spanDetailPanelCorner:"trace-viewer-module__8w33tq__spanDetailPanelCorner",spanDetailPanelDuration:"trace-viewer-module__8w33tq__spanDetailPanelDuration",spanDetailPanelName:"trace-viewer-module__8w33tq__spanDetailPanelName",spanDetailPanelQuickLink:"trace-viewer-module__8w33tq__spanDetailPanelQuickLink",spanDetailPanelQuickLinkLabel:"trace-viewer-module__8w33tq__spanDetailPanelQuickLinkLabel",spanDetailPanelResizer:"trace-viewer-module__8w33tq__spanDetailPanelResizer",spanDetailPanelTop:"trace-viewer-module__8w33tq__spanDetailPanelTop",spanDetailPanelTopInfo:"trace-viewer-module__8w33tq__spanDetailPanelTopInfo",spanDetailPanelTraceViewer:"trace-viewer-module__8w33tq__spanDetailPanelTraceViewer",spanDetailPanelTruncatedHeading:"trace-viewer-module__8w33tq__spanDetailPanelTruncatedHeading",spanDuration:"trace-viewer-module__8w33tq__spanDuration",spanName:"trace-viewer-module__8w33tq__spanName",spanNameDetailPanel:"trace-viewer-module__8w33tq__spanNameDetailPanel",spanNode:"trace-viewer-module__8w33tq__spanNode",spanNodeEvent:"trace-viewer-module__8w33tq__spanNodeEvent",spanSpacer:"trace-viewer-module__8w33tq__spanSpacer",timeline:"trace-viewer-module__8w33tq__timeline",traceNode:"trace-viewer-module__8w33tq__traceNode",traceViewer:"trace-viewer-module__8w33tq__traceViewer",traceViewerContent:"trace-viewer-module__8w33tq__traceViewerContent",unlit:"trace-viewer-module__8w33tq__unlit",xHover:"trace-viewer-module__8w33tq__xHover","zoom-buttons-fade-in":"trace-viewer-module__8w33tq__zoom-buttons-fade-in",zoomButton:"trace-viewer-module__8w33tq__zoomButton",zoomButtonGroup:"trace-viewer-module__8w33tq__zoomButtonGroup",zoomButtonTraceViewer:"trace-viewer-module__8w33tq__zoomButtonTraceViewer"})},8877014:e=>{e.v(e.b(["static/chunks/a5e44a44bcd96af0.js","static/chunks/turbopack-a847bc954d8aa066.js"]))},1095718:e=>{"use strict";e.s({TraceViewer:()=>ed,TraceViewerPanel:()=>eu,TraceViewerProvider:()=>es,TraceViewerTimeline:()=>ec},1095718);var t=e.i(6645307),a=e.i(6530772),r=e.i(5610210),n=e.i(5081217),i=e.i(5674541),l=e.i(3979315),s=e.i(4237550),o=e.i(889716),c=e.i(8158100),u=e.i(8084653),d=e.i(3246705),m=e.i(2562362),h=e.i(5163670),p=e.i(595691);let f={root:{startTime:0,endTime:1,duration:1,depth:0,children:[]},spanMap:{},resourceMap:{},filter:"",selected:null,baseScale:1,scaleRatio:1,scale:1,width:640,height:480,timelineWidth:640,timelineHeight:480,panelWidth:380,panelHeight:480,scrollbarWidth:0,timelineRef:{current:null},scrollSnapshotRef:{current:void 0},memoCacheRef:{current:new Map},getQuickLinks:()=>[],withPanel:!1,isMobile:!1},w=e=>(e.width-e.scrollbarWidth-Number(!!(e.selected&&e.withPanel))*e.panelWidth)/e.root.duration,v=(0,a.createContext)({state:f,dispatch:()=>{}});v.displayName="TraceViewerContext";let _=(e,t)=>{switch(t.type){case"setRoot":return e.scrollSnapshotRef.current=void 0,e.memoCacheRef.current.clear(),_({...e,root:t.root,spanMap:t.spanMap,resourceMap:Object.fromEntries(t.resources.map(e=>{let{name:t,attributes:a}=e;return[t,a]}))},{type:"detectBaseScale"});case"setSize":{let a=t.height-56-40-24,r=e.withPanel&&t.width<=768,n={...e,width:t.width,height:t.height,timelineWidth:t.width-Number(!!(e.selected&&e.withPanel&&!r))*e.panelWidth,timelineHeight:a,panelHeight:a,isMobile:r};return n.width!==e.width&&(n=_(n,{type:"detectBaseScale"})),n}case"setPanelWidth":{let a=Math.max(240,Math.min(t.width,e.width-240));return{...e,timelineWidth:e.width-a,panelWidth:a}}case"setFilter":return{...e,filter:t.filter};case"deselect":return _({...e,selected:null,timelineWidth:e.width},{type:"minScale"});case"select":{let a=e.spanMap[t.id];if(!a)return e;return{...e,selected:a,timelineWidth:e.width-(e.withPanel&&!e.isMobile?e.panelWidth:0)}}case"escape":if(e.selected)return _(e,{type:"deselect"});return _(e,{type:"resetScale"});case"toggleSelection":{let a=e;if(e.selected&&(a=_(a,{type:"deselect"})),e.selected?.span.spanId===t.id)return a;return _(a,{type:"select",id:t.id})}case"detectBaseScale":{let t=(e.width-e.scrollbarWidth)/e.root.duration;return{...e,baseScale:t,scale:t*e.scaleRatio}}case"setScale":return{...e,scaleRatio:t.scale,scale:e.baseScale*t.scale};case"resetScale":return _(e,{type:"scaleToRange",t1:e.root.startTime,t2:e.root.endTime});case"scaleToNode":{let a=e.spanMap[t.id];if(!a)return e;return _(_(e,{type:"setScale",scale:(e.width-e.scrollbarWidth-(e.withPanel&&!e.isMobile?e.panelWidth:0))/a.duration/e.baseScale}),{type:"setScrollSnapshot",anchorT:a.startTime-e.root.startTime,anchorX:0})}case"scaleToRange":{let a=Math.abs(t.t1-t.t2);return _(_(e,{type:"setScale",scale:(e.width-e.scrollbarWidth-(e.selected&&e.withPanel?e.panelWidth:0))/a/e.baseScale}),{type:"setScrollSnapshot",anchorT:Math.min(t.t1,t.t2)-e.root.startTime,anchorX:0})}case"adjustScaleRatio":{let{scaleRatio:a}=e;switch(t.direction){case -1:a*=.8;break;case 1:a*=1.25;break;default:a=1}let r=e.timelineRef.current;if(!r)return console.warn("timelineRef is null"),e;let{clientWidth:n,scrollLeft:i}=r;return _(_({...e,scaleRatio:a,scale:e.baseScale*a},{type:"minScale"}),{type:"setScrollSnapshot",anchorT:(i+.5*n)/e.scale,anchorX:.5*n})}case"trackpadScale":{let a=Math.max(w(e)/e.baseScale,e.scaleRatio*(1+.2*Math.sign(t.delta)*Math.sqrt(Math.abs(t.delta))));return _({...e,scaleRatio:a,scale:e.baseScale*a},{type:"setScrollSnapshot",anchorT:t.anchorT,anchorX:t.anchorX})}case"minScale":{let t=w(e);if(e.scale>=t)return e;return{...e,scale:t,scaleRatio:t/e.baseScale}}case"setScrollSnapshot":{let a=e.timelineRef.current;if(!a)return e;let{anchorT:r,anchorX:n}=t,i=r*e.scale-n,{scrollTop:l}=a,s=(l-24-8)/26,o=s+Math.ceil(e.timelineHeight/26);return e.scrollSnapshotRef.current={anchorT:r,anchorX:n,scrollLeft:i,scrollTop:l,startTime:e.root.startTime+i/e.scale,endTime:e.root.startTime+(i+e.timelineWidth)/e.scale,startRow:s,endRow:o,scale:e.scale},e}case"setWithPanel":if(e.withPanel===t.withPanel)return e;return{...e,withPanel:t.withPanel};case"forceRender":return e.memoCacheRef.current.set("",{}),{...e}}};function g(e){let{getQuickLinks:r,withPanel:n=!1,children:i}=e,l=(0,a.useRef)(null),s=(0,a.useRef)(void 0),o=(0,a.useRef)(r);o.current=r;let c=(0,a.useRef)(new Map),u=(0,a.useRef)(new Map),[d,m]=(0,a.useReducer)(_,f,e=>({...e,scrollbarWidth:(()=>{if(!("document"in globalThis))return 0;let e=document.createElement("div");e.style.width="400px",e.style.height="400px",e.style.overflow="scroll",document.body.appendChild(e);let t=400-e.scrollWidth;return e.remove(),t})(),timelineRef:l,scrollSnapshotRef:s,memoCacheRef:c,withPanel:n,getQuickLinks:e=>{let t=e.spanId,a=u.current.get(t);if(a)return a;let r=o.current?.(e)||[];return u.current.set(t,r),r}}));(0,a.useEffect)(()=>m({type:"setWithPanel",withPanel:n}),[n]);let h=(0,a.useMemo)(()=>({state:d,dispatch:m}),[d,m]);return(0,t.jsx)(v.Provider,{value:h,children:i})}let x=()=>(0,a.useContext)(v);var b=e.i(9501637);let y=(e,t)=>e.duration*t<64,k=(e,t)=>e.duration*t>=500,j=e=>e.isVercel?String(n.default.colorVercel):String(n.default[`color${e.resourceIndex%5}`]),T=(e,t)=>{let a=k(e,t),i=e.isHovered&&!a&&!1!==e.isHighlighted;return(0,r.clsx)(n.default.spanNode,a&&n.default.huge,y(e,t)&&n.default.small,e.isSelected&&n.default.selected,i&&n.default.xHover,e.isHighlighted?n.default.colorHighlight:j(e),!1===e.isHighlighted&&n.default.unlit)},S=(0,a.memo)(function(e){let{root:a,scale:r,spans:n,scrollSnapshotRef:i,cache:l}=e;return n.map(e=>(0,t.jsx)(N,{cacheKey:l.get(e.span.spanId),node:e,root:a,scale:r,scrollSnapshotRef:i},e.span.spanId))}),N=(0,a.memo)(function(e){let{node:r,root:i,scale:l,scrollSnapshotRef:s}=e,o=(0,a.useRef)(null);r.ref=o;let{span:c}=r,u=r.isInstrumentationHint?"Get Started":(0,b.formatDuration)(r.duration),d=(r.startTime-i.startTime)*l,m=24+26*r.row,h=r.duration*l,p=24,f=k(r,l),w=y(r,l),v=r.isHovered&&!f&&!1!==r.isHighlighted;w&&!v&&(p*=.4,m+=(24-p)*.5);let _=!1;if(v){let{duration:e,endTime:t}=i,a=s.current;a&&(e=a.endTime-a.startTime,t=a.endTime),_=t-r.startTime<.25*e}return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{"aria-label":`${c.name} - ${u}`,className:T(r,l),"data-span-id":c.spanId,"data-start-time":r.startTime-i.startTime,"data-right-side":_,ref:o,style:{"--span-width":`${h}px`,minWidth:v?h:void 0,width:v?void 0:h,height:p,maxWidth:v&&!_?(i.endTime-r.startTime)*l:void 0,containIntrinsicWidth:v?void 0:h,containIntrinsicHeight:p,left:_?void 0:d,right:_?(i.endTime-r.endTime)*l:void 0,top:m},type:"button",children:w&&!v?null:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:n.default.spanName,children:r.label||c.name}),f?(0,t.jsx)("span",{className:n.default.spanSpacer}):null,v||h>128?(0,t.jsx)("span",{className:n.default.spanDuration,children:u}):null]})}),r.events&&!w?r.events.map(e=>(0,t.jsx)(M,{event:e,node:r,root:i,scale:l},e.key)):null]})}),M=(0,a.memo)(function(e){let{event:i,node:l,root:s,scale:o}=e,c=(0,a.useRef)(null);i.ref=c;let{event:{name:u}}=i,d=(0,b.formatDuration)(i.timestamp-s.startTime),m=(i.timestamp-s.startTime)*o,h=24+26*l.row;return(0,t.jsxs)("div",{"aria-label":`${u} - ${d}`,className:(0,r.clsx)(n.default.spanNodeEvent,l.isHighlighted?n.default.colorHighlight:j(l),!1===l.isHighlighted&&n.default.unlit),"data-hovered":i.isHovered,ref:c,style:{left:m,top:h},children:[(0,t.jsxs)("div",{className:(0,r.clsx)(n.default.hoverInfo,(i.timestamp-l.startTime)/l.duration<.5?n.default.alignStart:n.default.alignEnd),children:[(0,t.jsx)("span",{className:n.default.eventName,children:u}),(0,t.jsx)("span",{className:n.default.eventTimestamp,children:d})]}),(0,t.jsx)("div",{className:n.default.eventDiamond})]})}),q=e=>`${(100*e).toFixed(3)}%`,D=(e,t)=>e<t?-1:+(e>t),L=e=>{let t={};for(let[a,r]of Object.entries(e)){let e=a.indexOf("."),n="",i="";-1!==e?(n=a.substring(0,e),i=a.substring(e+1)):i=a;let l=t[n];l||(l={prefix:n,attributes:[]},t[n]=l),l.attributes.push({key:a,suffix:i,value:String(r)})}let a=Array.from(Object.values(t)).sort((e,t)=>D(e.prefix,t.prefix));for(let e of a)e.attributes.sort((e,t)=>D(e.suffix,t.suffix));return a};function P(e){let{attached:s=!1}=e,{state:{root:c,selected:d,resourceMap:m,getQuickLinks:h,isMobile:p},dispatch:f}=x(),w=(0,a.useMemo)(()=>L(d?.span.attributes??{}),[d]),v=(0,a.useMemo)(()=>{let e=d?.span.resource;if(!e)return[];let t=m[e];return t?L(t):[]},[m,d]),_=(0,a.useMemo)(()=>((e,t)=>{let a=[];if(!t)return a;for(let e=t;"parent"in e;e=e.parent)a.unshift(e);return a})(0,d),[c,d]);if(!d)return null;let{span:g}=d,y=V(d);return(0,t.jsxs)(o.Stack,{className:(0,r.clsx)(n.default.spanDetailPanel,p&&n.default.mobile),children:[s&&!p?(0,t.jsx)(O,{}):null,(0,t.jsx)(o.Stack,{className:n.default.spanDetailPanelTop,direction:"row",children:(0,t.jsxs)(o.Stack,{align:"center",className:n.default.spanDetailPanelTopInfo,direction:"row",gap:3,justify:"space-between",children:[(0,t.jsxs)(o.Stack,{align:"center",className:n.default.spanDetailPanelTruncatedHeading,direction:"row",gap:3,children:[d.isInstrumentationHint?null:(0,t.jsx)(u.Text,{as:"span",className:n.default.spanDetailPanelDuration,monospace:!0,size:13,children:(0,b.formatDuration)(d.duration)}),(0,t.jsx)(u.Text,{as:"span",className:n.default.spanDetailPanelName,size:13,title:g.name,children:g.name})]}),(0,t.jsxs)(o.Stack,{align:"center",className:n.default.spanDetailPanelCorner,direction:"row",gap:2,children:[(0,t.jsx)(o.Stack,{direction:"row",children:(0,t.jsx)("div",{className:n.default.spanDetailPanelCloseVerticalRule})}),(0,t.jsx)(i.Button,{"aria-label":"Close Span Details",className:n.default.spanDetailPanelClose,onClick:()=>f({type:"deselect"}),shape:"square",size:"small",svgOnly:!0,touchEventWorkaround:!0,type:"tertiary",children:(0,t.jsx)(l.Cross,{color:"gray-700",size:20})})]})]})}),(0,t.jsxs)(o.Stack,{className:n.default.spanDetailPanelBody,gap:3,children:[d.isVercel?(0,t.jsx)(F,{node:d}):null,d.isInstrumentationHint?(0,t.jsx)(B,{}):null,!d.isInstrumentationHint&&_.length?(0,t.jsx)(E,{className:n.default.ancestorGroup,name:"Location",children:_.map(e=>(0,t.jsxs)("button",{className:n.default.ancestorNode,onClick:()=>f({type:"select",id:e.span.spanId}),type:"button",children:[(0,t.jsxs)("div",{className:n.default.ancestorText,children:[(0,t.jsx)("span",{className:n.default.ancestorName,children:e.label||e.span.name}),(0,t.jsx)("span",{className:n.default.ancestorDuration,children:(0,b.formatDuration)(e.duration)})]}),(0,t.jsx)("span",{"aria-hidden":!0,className:n.default.ancestorLineContainer,children:(0,t.jsx)("span",{className:(0,r.clsx)(n.default.ancestorLine,j(e)),style:{left:q((e.startTime-c.startTime)/c.duration),width:q(e.duration/c.duration)}})})]},`${d.span.spanId}.${e.span.spanId}`))}):null,y?(0,t.jsx)(W,{getQuickLinks:h,span:d.span}):null,d.events?.length?(0,t.jsx)(E,{name:"Events",children:d.events.map(e=>(0,t.jsxs)(a.Fragment,{children:[(0,t.jsxs)("dl",{className:n.default.spanDetailPanelAttribute,children:[(0,t.jsx)("dt",{className:n.default.spanDetailPanelAttributeKey,children:e.event.name}),(0,t.jsx)("dd",{className:n.default.spanDetailPanelAttributeValue,children:(0,b.formatDuration)(e.timestamp-c.startTime)})]}),Object.entries(e.event.attributes).map(a=>{let[r,n]=a;return(0,t.jsx)(z,{name:`${e.event.name}.${r}`,value:n},r)})]},e.key))}):null,w.length?(0,t.jsx)(E,{name:"Attributes",children:w.map(e=>(0,t.jsx)(a.Fragment,{children:e.attributes.map(e=>{let{key:a,value:r}=e;return(0,t.jsx)(z,{name:a,value:r},a)})},e.prefix))}):null,v.length?(0,t.jsx)(E,{name:"Resource",children:v.map(e=>(0,t.jsx)(a.Fragment,{children:e.attributes.map(e=>{let{key:a,value:r}=e;return(0,t.jsx)(z,{name:a,value:r},a)})},e.prefix))}):null,d.isInstrumentationHint?null:(0,t.jsxs)(E,{name:"Library",children:[(0,t.jsx)(z,{name:"name",value:g.library.name}),g.library.version?(0,t.jsx)(z,{name:"version",value:g.library.version}):null]})]})]})}let R="vc-trace-span-exp:";function E(e){let{name:i,className:l="",children:c}=e,[u,d]=(0,a.useState)(()=>!("localStorage"in globalThis)||"0"!==localStorage.getItem(`${R}${i}`)),m=(0,a.useCallback)(()=>{d(e=>{let t=!e;return localStorage.setItem(`${R}${i}`,String(Number(t))),t})},[i]);return(0,t.jsxs)(o.Stack,{className:(0,r.clsx)(n.default.detailGroup,u?n.default.expanded:n.default.collapsed,l),children:[(0,t.jsxs)("button",{className:n.default.detailHeading,onClick:m,type:"button",children:[(0,t.jsx)("span",{children:i}),(0,t.jsx)(s.ChevronDown,{className:n.default.detailHeadingIcon})]}),u?c:null]})}let C=new Set(["OPTIONS","HEAD","GET","PUT","POST","DELETE"]),H={"Resolve Deployment":"How long it took Vercel's routing layer to retrieve details for the deployment.","Resolve Cache":"How long it took Vercel's routing layer to check for a cached function invocation.","Resolve Route":"How long it took Vercel's routing layer to resolve routing rules, including redirects and rewrites.","Invoke Middleware":"How long it took this middleware to start and run user code.","Invoke Function":"How long it took this Vercel Function to start and run user code.",waitUntil:"How long it took to run user code inside of waitUntil.","Start VM":"How long it took to start the Virtual Machine which contains the Vercel Function.","Spawn Node.js":"How long it took the Virtual Machine to start the Node.js runtime.","Spawn Python":"How long it took the Virtual Machine to start the Python runtime.","Init User Code":"How long it took to import the user code and run any globally-scoped code."},I=new Set(["Start VM","Spawn Node.js","Spawn Python","Init User Code"]),A=e=>{if(!e||!("span"in e))return null;let t=e.span.attributes,a=t["vercel.region"]||t["vercel.function.region"];return a?String(a):null},V=e=>{if(!e.isVercel)return!1;let{name:t}=e.span,a=t.indexOf(" ");if(-1===a)return!1;let r=t.substring(0,a);return C.has(r)};function F(e){let{node:a}=e,{name:r}=a.span,i=H[r];if(!i&&V(a)&&(i="How long it took for Vercel to process the request and send the response."),!i)return null;let l=(e=>{let{name:t}=e.span,a=A(e),r=A(e.parent);return"true"===e.span.attributes["vercel.middleware.internal"]?"The Vercel Toolbar created this middleware.":I.has(t)||"Invoke Function"===t&&e.children.some(e=>I.has(e.span.name))?"This function encountered a cold start.":a&&r&&a!==r?"This request was routed across regions.":null})(a);return(0,t.jsx)(E,{name:"What is this?",children:(0,t.jsxs)("div",{className:n.default.infraSpanDescription,children:[(0,t.jsx)("span",{children:i}),l?(0,t.jsx)(c.Note,{children:l}):l]})})}let W=(0,a.memo)(function(e){let{getQuickLinks:a,span:r}=e,n=a(r);return n.length?(0,t.jsx)(E,{name:"Links",children:n.map(e=>{let{key:a,value:r}=e;return(0,t.jsx)($,{link:r,name:a},a)})}):null});function $(e){let{name:i,link:l}=e,s=function(e){let[t,r]=(0,a.useState)({}),n=void 0!==e.__resolvedValue||void 0!==e.__rejectedValue;return(0,a.useEffect)(()=>{n||e.then(t=>{e.__resolvedValue=t}).catch(t=>{e.__rejectedValue=t}).finally(()=>r({}))},[e,n]),e.__resolvedValue}(l);return(0,t.jsxs)(m.Link,{as:s?void 0:"span",className:(0,r.clsx)(n.default.spanDetailPanelAttribute,n.default.spanDetailPanelQuickLink),href:s?.href||"",children:[(0,t.jsx)("span",{className:n.default.spanDetailPanelAttributeKey,children:i}),(0,t.jsx)("span",{className:(0,r.clsx)(n.default.spanDetailPanelAttributeValue,n.default.spanDetailPanelQuickLinkLabel),children:s?(0,t.jsxs)(t.Fragment,{children:[s.label,s.icon||(0,t.jsx)(p.ExternalSmall,{color:"gray-900"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.Skeleton,{height:18,width:32+8*i.length}),(0,t.jsx)(h.Skeleton,{height:18,rounded:!0,width:18})]})})]})}function B(){return(0,t.jsx)(E,{name:"What is this?",children:(0,t.jsxs)("div",{className:n.default.infraSpanDescription,children:[(0,t.jsx)("span",{children:"You can visualize your application's spans alongside Vercel's spans in this viewer."}),(0,t.jsx)(d.ButtonLink,{href:"https://vercel.com/docs/session-tracing#adding-custom-spans",size:"small",target:"_blank",children:"Get Started"})]})})}function z(e){let{name:a,value:r}=e;return(0,t.jsxs)("dl",{className:n.default.spanDetailPanelAttribute,children:[(0,t.jsx)("dt",{className:n.default.spanDetailPanelAttributeKey,children:a}),(0,t.jsx)("dd",{className:n.default.spanDetailPanelAttributeValue,title:String(r),children:String(r)})]})}function O(){let{state:{panelWidth:e},dispatch:r}=x(),i=(0,a.useRef)({start:{x:0,width:e},x:0,width:e,isHeld:!1});i.current.width=e;let l=(0,a.useCallback)(e=>{if("mouse"!==e.pointerType)return;e.preventDefault();let t=i.current;t.start.x=e.clientX,t.x=e.clientX,t.start.width=t.width,t.isHeld=!0},[]),s=(0,a.useCallback)(()=>{r({type:"setPanelWidth",width:f.panelWidth})},[r]);return(0,a.useEffect)(()=>{let e=0,t=()=>{let e=i.current;r({type:"setPanelWidth",width:e.start.width+e.start.x-e.x})},a=a=>{i.current.isHeld&&(a.preventDefault(),i.current.x=a.clientX,cancelAnimationFrame(e),e=requestAnimationFrame(t))},n=()=>{i.current.isHeld=!1};return window.addEventListener("pointermove",a),window.addEventListener("pointerup",n),()=>{window.removeEventListener("pointermove",a),window.removeEventListener("pointerup",n)}},[r]),(0,t.jsx)("div",{"aria-hidden":!0,className:n.default.spanDetailPanelResizer,onDoubleClick:s,onPointerDown:l})}var K=e.i(9243980);let X=(0,e.i(6895406).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M6.5 1.5C3.73858 1.5 1.5 3.73858 1.5 6.5C1.5 9.26142 3.73858 11.5 6.5 11.5C9.26142 11.5 11.5 9.26142 11.5 6.5C11.5 3.73858 9.26142 1.5 6.5 1.5ZM0 6.5C0 2.91015 2.91015 0 6.5 0C10.0899 0 13 2.91015 13 6.5C13 8.02469 12.475 9.42677 11.596 10.5353L15.0303 13.9697L15.5607 14.5L14.5 15.5607L13.9697 15.0303L10.5353 11.596C9.42677 12.475 8.02469 13 6.5 13C2.91015 13 0 10.0899 0 6.5ZM4.75 5.875H4.125V7.125H4.75H8.25H8.875V5.875H8.25H4.75Z" fill="currentColor"/>');var G=e.i(4843199);function Q(){let{dispatch:e}=x(),r=(0,a.useCallback)(()=>{e({type:"adjustScaleRatio",direction:1})},[e]),l=(0,a.useCallback)(()=>{e({type:"adjustScaleRatio",direction:-1})},[e]),s=(0,a.useCallback)(()=>{e({type:"adjustScaleRatio",direction:0})},[e]);return(0,t.jsxs)(o.Stack,{className:n.default.zoomButtonGroup,direction:"row",children:[(0,t.jsx)(i.Button,{"aria-label":"Zoom Out",className:n.default.zoomButton,onClick:l,svgOnly:!0,variant:"unstyled",children:(0,t.jsx)(X,{})}),(0,t.jsx)("div",{className:n.default.divider}),(0,t.jsx)(i.Button,{"aria-label":"Reset Zoom",className:n.default.zoomButton,onClick:s,svgOnly:!0,variant:"unstyled",children:(0,t.jsx)(G.Minus,{})}),(0,t.jsx)("div",{className:n.default.divider}),(0,t.jsx)(i.Button,{"aria-label":"Zoom In",className:n.default.zoomButton,onClick:r,svgOnly:!0,variant:"unstyled",children:(0,t.jsx)(K.MagnifyingGlassPlus,{})})]})}var U=e.i(8019419);function Z(e){let t=(0,a.useRef)({});return{setStyle:(0,a.useCallback)((a,r)=>{if(t.current[a]=r,e.current){if(!r)return void e.current.style.removeProperty(a);e.current.style.setProperty(a,r)}},[e]),styleRef:t,style:{...t.current}}}let Y=[1,2,4,5,8,10];function J(e){let{scale:a}=e,{state:{root:i}}=x(),l=i.duration,s=Math.floor(Math.log10(l)),o=Math.max(2,Math.pow(10,s)*(Math.floor(Math.log10(.5*l))===s?1:.5)),c=o*a,u=1;for(let e of Y){if(o/e<24)break;u=e}o/=u,c/=u;let d=Math.ceil(l/o),m=Math.ceil(100/c)||1;return(0,t.jsx)("div",{className:n.default.markersContainer,children:(0,t.jsx)("div",{"aria-hidden":!0,className:n.default.markers,style:{width:Math.floor(i.duration*a+15),visibility:-1!==a?"visible":"hidden","--marker-width":`${c}px`},children:Array(d).fill(null).map((e,a)=>{let i=a%m==0;return(0,t.jsx)("span",{className:(0,r.clsx)(n.default.marker,!i&&n.default.notch),children:i?(0,t.jsx)("span",{className:n.default.markerLabel,children:(0,b.formatDuration)(o*a)}):null},String(a))})})})}function ee(e){let{events:a,root:i,scale:l}=e;return(0,t.jsx)("div",{className:n.default.eventMarkersContainer,children:(0,t.jsx)("div",{"aria-hidden":!0,className:n.default.eventMarkers,style:{width:Math.floor(i.duration*l)},children:a.map(e=>(0,t.jsx)("span",{className:(0,r.clsx)(n.default.eventMarker),style:{left:Math.floor((e.timestamp-i.startTime)*l)}},e.key))})})}function et(e){let{memoCacheRef:r,timelineRef:i,root:l,spans:s,events:o,scale:c,dispatch:u,scrollSnapshotRef:d}=e,m=(0,a.useRef)(!1),h=(0,a.useRef)(s);h.current=s;let p=(0,a.useRef)(o);p.current=o;let f=(0,a.useRef)(null),{style:w,setStyle:v}=Z(f),_=(0,a.useRef)(null),g=(0,a.useRef)(null),{style:x,setStyle:y}=Z(g),k=(0,a.useRef)(void 0),j=(0,a.useRef)(null),{style:T,setStyle:S}=Z(j),N=(0,a.useRef)(0);(0,a.useEffect)(()=>{let e=i.current;if(!e)return;let t=N.current,a=0,n=!1,s=!1,o=!1,d=!1,f=0,w=0,g=Date.now()+500,x=()=>{k.current||(k.current=e.getBoundingClientRect())},T=e=>k.current?(e-24-8)/26:0,q=()=>{let e=r.current;for(let t of h.current)t.isHovered&&(t.isHovered=!1,e.set(t.span.spanId,{}));u({type:"forceRender"})},D=0,L=()=>{if(!m.current)return;k.current||x();let i=k.current;if(!i)return;let{scrollLeft:d,scrollTop:N}=e,M=Math.max(0,Math.min(t+d-i.left-8,l.duration*c)),P=`${M-d+8}px`;y("left",P),v("left",P);let R=l.startTime+M/c,E=R-l.startTime;if(E<0||E>l.duration?_.current?.removeAttribute("data-text"):_.current?.setAttribute("data-text",(0,b.formatTimeSelection)(E)),n){let e,r,n=t-a,s=Math.abs(n);if(!o){if(s<4)return;o=!0,S("display","flex"),q()}n>0?(S("left",""),S("right","0")):(S("left","0"),S("right","")),S("width",`${s}px`);let u=Math.max(0,Math.min(a+d-i.left-8,l.duration*c))/c;u<E?(e=u,r=E):(e=E,r=u),j.current?.setAttribute("data-range",`${(0,b.formatTimeSelection)(e)} — ${(0,b.formatTimeSelection)(r)}`),j.current?.setAttribute("data-duration",`${(0,b.formatTimeSelection)(r-e)} selected`)}if(Date.now()<g){D=requestAnimationFrame(L);return}if(d!==f||N!==w){f=d,w=N,D=requestAnimationFrame(L);return}if(t-i.left<128?_.current?.setAttribute("data-align","left"):t-i.left>i.width-128?_.current?.setAttribute("data-align","right"):_.current?.removeAttribute("data-align"),!o&&!s){let e=r.current,t=T(N)-2,a=T(N+i.height)+2;for(let r of h.current){let n=r.row>=t&&r.row<=a&&R>=r.startTime&&R<=r.endTime;r.isHovered!==n&&(r.isHovered=n,e.set(r.span.spanId,{}))}let n=12/c;for(let e of p.current){let t=R>=e.timestamp-n&&R<=e.timestamp+n;if(e.isHovered===t)continue;e.isHovered=t;let a=e.ref?.current;a&&a.setAttribute("data-hovered",String(t))}u({type:"forceRender"})}};D=requestAnimationFrame(L);let P=e=>{"mouse"===e.pointerType&&(m.current=!0)},R=()=>{m.current&&(m.current=!1,q())},E=e=>{let{clientX:a}=e;N.current=t=a,cancelAnimationFrame(D),D=requestAnimationFrame(L)},C=e=>{e.preventDefault()},H=e=>{if(2===e.button)d=!0,e.preventDefault();else{if(0!==e.button)return;d=!1}i.current?.contains(e.target)?(a=t,n=!0):(s=!0,requestAnimationFrame(q))},I=r=>{if(s=!1,!n||(n=!1,!o))return;if(o=!1,S("display",""),S("left",""),S("right",""),S("width",""),r.preventDefault(),r.stopImmediatePropagation(),d){d=!1;return}k.current||x();let i=k.current;if(!i)return;let{scrollLeft:m}=e,h=Math.max(0,Math.min((a+m-i.left-8)/c,l.duration)),p=Math.max(0,Math.min((t+m-i.left-8)/c,l.duration));u({type:"scaleToRange",t1:h+l.startTime,t2:p+l.startTime})},A=e=>{n&&"Escape"===e.key&&(d=!0,I(e))},V=()=>{k.current=void 0,M.current=void 0,cancelAnimationFrame(D),D=requestAnimationFrame(L)},F=()=>{cancelAnimationFrame(D),D=requestAnimationFrame(L)},W=new ResizeObserver(()=>{k.current=void 0});return W.observe(e),window.addEventListener("mousemove",E),e.addEventListener("contextmenu",C),window.addEventListener("mousedown",H),window.addEventListener("mouseup",I),window.addEventListener("blur",I),window.addEventListener("keydown",A,!0),window.addEventListener("scroll",V),e.addEventListener("scroll",F),e.addEventListener("pointerenter",P),e.addEventListener("pointerleave",R),()=>{W.disconnect(),window.removeEventListener("mousemove",E),e.removeEventListener("contextmenu",C),window.removeEventListener("mousedown",H),window.removeEventListener("mouseup",I),window.removeEventListener("blur",I),window.removeEventListener("keydown",A,!0),window.removeEventListener("scroll",V),e.removeEventListener("scroll",F),e.removeEventListener("pointerenter",P),e.removeEventListener("pointerleave",R),cancelAnimationFrame(D),N.current=t,q()}},[u,l,c,y,v,S,r,i,d]);let M=(0,a.useRef)(void 0);var q=e=>{let t=i.current;if(!t)return;k.current??=t.getBoundingClientRect();let a=k.current,r=Math.max(0,Math.min(N.current-a.left-8,a.width-16)),n=0,l=M.current;l?.anchorX===r?n=l.anchorT:M.current=l={anchorT:n=(t.scrollLeft+r)/c,anchorX:r},u({type:"trackpadScale",delta:e/64,anchorT:n,anchorX:r})};let D=(0,a.useRef)(q);return D.current=q,(0,a.useEffect)(()=>{let e=0,t=0,a=()=>{D.current(e),e=0},r=r=>{if(!r.ctrlKey&&!r.metaKey)return;r.preventDefault();let n=-r.deltaY;switch(r.deltaMode){case WheelEvent.DOM_DELTA_PAGE:n*=window.innerHeight;break;case WheelEvent.DOM_DELTA_LINE:n*=20}e+=n,cancelAnimationFrame(t),t=requestAnimationFrame(a)};return window.addEventListener("wheel",r,{passive:!1}),()=>{window.removeEventListener("wheel",r),cancelAnimationFrame(t)}},[]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:n.default.cursorMarkerStickyParent,children:(0,t.jsx)("div",{className:n.default.cursorMarkerLabelContainer,ref:f,style:w,children:(0,t.jsx)("div",{className:n.default.cursorMarkerLabel,ref:_})})}),(0,t.jsx)("div",{className:n.default.cursorMarkerStickyParent,children:(0,t.jsx)("div",{className:n.default.cursorMarkerContainer,ref:g,style:x,children:(0,t.jsx)("div",{className:n.default.cursorMarker,children:(0,t.jsx)("div",{className:n.default.cursorSelection,ref:j,style:T})})})})]})}function ea(){return[]}let er=(0,a.memo)(function(e){let{timelineRef:r,rows:i,scale:l}=e,{state:{root:s,baseScale:o,timelineWidth:c,width:u,scrollbarWidth:d}}=x(),m=u+16,h=(()=>{let[e,t]=(0,a.useState)(1);return(0,a.useLayoutEffect)(()=>{let a=()=>t("devicePixelRatio"in globalThis&&globalThis.devicePixelRatio||1),r=matchMedia(`(resolution: ${e}dppx)`);return r.addEventListener("change",a),a(),()=>{r.removeEventListener("change",a)}},[e]),e})(),p=(0,a.useRef)(null),f=(0,a.useRef)(null),w=u/(u-d)*Math.min(u/c,o/l),v=Math.min(u,(c-d)*w);(0,a.useEffect)(()=>{let e,t=!1,a=0,n=e=>!!p.current?.contains(e),i=0,l=()=>{if(!t||!e)return;let n=r.current;n&&(n.scrollLeft=(a-.5*v-e.left)/w)},s=e=>{({clientX:a}=e),cancelAnimationFrame(i),i=requestAnimationFrame(l)},o=a=>{n(a.target)&&(t=!0,e=p.current?.getBoundingClientRect(),s(a))},c=()=>{t=!1,e=void 0},u=e=>{n(e.target)&&e.cancelable&&e.preventDefault()},d=e=>{t&&e.cancelable&&e.preventDefault()};return window.addEventListener("pointerdown",o),window.addEventListener("pointermove",s),window.addEventListener("pointerup",c),window.addEventListener("blur",c),window.addEventListener("touchstart",u,{passive:!1}),window.addEventListener("touchmove",d,{passive:!1}),()=>{window.removeEventListener("pointerdown",o),window.removeEventListener("pointermove",s),window.removeEventListener("pointerup",c),window.removeEventListener("blur",c),window.removeEventListener("touchstart",u),window.removeEventListener("touchmove",d),cancelAnimationFrame(i)}},[r,w,v]),(0,a.useEffect)(()=>{let e=f.current,t=e?.getContext("2d");if(!e||!t)return;let a=requestAnimationFrame(()=>{t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.scale(h,h);let a=(m-16)/s.duration;for(let e of(t.fillStyle="#ccc",t.beginPath(),i))for(let r of e){let e=7+4*r.row;if(e>=45)break;let n=8+(r.startTime-s.startTime)*a,i=r.duration*a;t.roundRect(n,e,i,3,3)}t.fill()});return()=>cancelAnimationFrame(a)},[h,s,m,i]);let _=(0,a.useRef)(null),{style:g,setStyle:b}=Z(_);return(0,a.useLayoutEffect)(()=>{let e=r.current;if(!e)return;let t=0,a=()=>{b("transform",`translateX(${8+e.scrollLeft*w}px)`)};a();let n=()=>{cancelAnimationFrame(t),t=requestAnimationFrame(a)};return e.addEventListener("scroll",n),()=>{cancelAnimationFrame(t),e.removeEventListener("scroll",n)}},[r,w,b]),(0,t.jsxs)("div",{className:n.default.mapContainer,ref:p,style:{width:v>0?m:"100%",height:56},children:[(0,t.jsx)("canvas",{className:n.default.mapCanvas,height:56*h,ref:f,style:{width:m,height:56},width:m*h}),(0,t.jsx)("div",{className:n.default.mapThumb,ref:_,style:{transform:g.transform,width:v>0?v:"calc(100% - 16px)",top:2,height:52}})]})});var en=e.i(6284911);function ei(){return(0,t.jsx)("nav",{className:n.default.searchBar,children:(0,t.jsx)(el,{})})}function el(){let{dispatch:e}=x(),[r,i]=(0,a.useState)("");return(0,a.useEffect)(()=>{let t=setTimeout(()=>e({type:"setFilter",filter:r}),100);return()=>{clearTimeout(t)}},[e,r]),(0,t.jsx)("div",{className:n.default.searchInput,children:(0,t.jsx)(en.SearchInput,{height:40,onChange:e=>i(e.target.value),placeholder:"Search spans…",value:r,width:"100%"})})}function es(e){let{getQuickLinks:a,children:r}=e;return(0,t.jsx)(g,{getQuickLinks:a,children:r})}let eo={traceId:"skeleton",spans:[{parentSpanId:"",spanId:"root",name:"root span",kind:1,resource:"vercel.runtime",startTime:[5e3,0],endTime:[6e3,0],duration:[1e3,0],library:{name:"vercel-site"},status:{code:1},attributes:{"vercel.ownerId":"team_abc"},traceFlags:1,events:[],links:[]}],resources:[{name:"vercel.runtime",attributes:{}}],rootSpanId:"root"};function ec(i){let{trace:l=eo,className:s="",scrollLock:o=!1,height:c,withPanel:u=!1,highlightedSpans:d}=i,m=l===eo,{state:h,dispatch:p}=x(),{timelineRef:f,scrollSnapshotRef:w}=h,v=h.memoCacheRef.current,_=(d?.length??0)>0;(0,a.useEffect)(()=>{let{root:e,map:t}=(0,U.parseTrace)(l);p({type:"setRoot",root:e,spanMap:t,resources:l.resources||[]})},[p,l]);let{rows:g,spans:b,events:y,scale:k}=(t=>{let{state:r,dispatch:n}=x(),{root:i,filter:l,scale:s,timelineRef:o,timelineWidth:c,spanMap:u,scrollSnapshotRef:d,selected:m,memoCacheRef:h}=r,p=function(e){let[t,r]=(0,a.useState)(e);return(0,a.useEffect)(()=>{if(t===e)return;let a=0,n=0,i=()=>{if(++a<=3){n=requestAnimationFrame(i);return}r(e)};return i(),()=>{cancelAnimationFrame(n)}},[t,e]),t}(r.timelineHeight),f=(0,a.useRef)(0),[w,v]=(0,a.useState)(ea),[_,g]=(0,a.useState)(ea),[b,y]=(0,a.useState)(ea),[k,j]=(0,a.useState)(-1),S=(0,a.useRef)(void 0);return(0,a.useEffect)(()=>S.current?.(l),[l]),(0,a.useEffect)(()=>{if(t?.length){for(let e of w)for(let a of e){let e=t.includes(a.span.spanId);a.isHighlighted!==e&&(a.isHighlighted=e,h.current.set(a.span.spanId,{}))}n({type:"forceRender"})}},[w,t,n,h]),(0,a.useEffect)(()=>{if(!i.startTime)return;let t=new Worker(e.r("8877014")),a=++f.current;t.addEventListener("message",e=>{let t=e.data;switch(t.type){case"setRowsResult":if(t.isEnd)for(let e of t.rows)for(let t of e)t.span=u[t.span.spanId]?.span??t.span;v(t.rows);break;case"updateHighlight":{if(t.requestId!==a)return;let{matches:e}=t;v(t=>{for(let a of t)for(let t of a){let a=e.has(t.span.spanId);t.isHighlighted!==a&&(t.isHighlighted=a,h.current.set(t.span.spanId,{}))}return t}),n({type:"forceRender"})}}});let r={requestId:a,type:"calculateSpanPositions",root:i};return t.postMessage(r),S.current=e=>{let r=e.trim().toLocaleLowerCase();if(!r)return void v(e=>e.map(e=>e.map(e=>(e.isHighlighted=void 0,{...e}))));let n={type:"filterSpans",requestId:a=++f.current,root:i,filter:r};t.postMessage(n)},()=>{t.terminate()}},[i,u,n,h]),(0,a.useEffect)(()=>{if(!w.length)return;let e=o.current,t=d.current,a=!1,r=!1,n=0,l=0,u=Math.max(500,.5*c),m=Array(w.length).fill(null),h=e=>t?e<t.startRow?e-t.startRow:e>t.endRow?e-t.endRow:0:0,f=e=>{if(!t)return 0;let a=0;e.endTime<t.startTime?a=t.startTime-e.endTime:e.startTime>t.endTime&&(a=e.startTime-t.endTime);let r=Math.abs(h(e.row));return a||r?Math.sqrt(Math.pow(a/s,2)+Math.pow(24*r+2,2)):0},v=0,_=()=>{(a||!t)&&(a=!1,(()=>{if(!e)return;let{scrollLeft:a,scrollTop:r}=e,n=(r-24-8)/26,l=n+Math.ceil(p/26);d.current=t={anchorT:a/s,anchorX:0,scrollLeft:a,scrollTop:r,startTime:i.startTime+a/s,endTime:i.startTime+(a+c)/s,startRow:n,endRow:l,scale:s};for(let e=m.length;e--;)m[e]=null})()),(()=>{r=!0;let e=Math.min(1+l+Math.ceil(t?.endRow??1/0),w.length);for(let t=e;t--;){if(m[t])continue;let e=h(t);if(Math.abs(e)>l){if(r=!1,e>0)continue;break}let a=[],i=w[t];if(i){for(let e of i){if(!(0,U.adjustSpanVisibility)(e,s))continue;let t=f(e);n=Math.max(t,n),a.push({d:t,span:e})}m[t]=a}}})();let o=[],x=[];for(let e of m)if(e)for(let{d:t,span:a}of e)!(t>l)&&(o.push(a),a.events&&x.push(...a.events));l<u&&(!r||l<n)&&(l=Math.min(u,l+100),v=requestAnimationFrame(_)),g(o),y(x),j(s)};_();let x=Date.now(),b=e=>{(e.ctrlKey||e.metaKey)&&(x=Date.now())};e?.addEventListener("wheel",b);let k=()=>{Date.now()-x<=50||(a=!0,cancelAnimationFrame(v),v=requestAnimationFrame(_))};return e?.addEventListener("scroll",k),()=>{cancelAnimationFrame(v),e?.removeEventListener("wheel",b),e?.removeEventListener("scroll",k)}},[w,i,s,d,o,c,p]),(0,a.useEffect)(()=>{let e;if(!m)return;for(let t of _)if(t.span.spanId===m.span.spanId){e=t;break}let t=e?.ref?.current;if(e&&t)return e.isSelected=!0,t.className=T(e,s),()=>{e.isSelected=!1,t.className=T(e,s)}},[_,s,m]),{rows:w,spans:_,events:b,scale:k}})(d),j=(0,a.useRef)(null);(0,a.useLayoutEffect)(()=>{let e=j.current;if(!e)return;let t=()=>{let t=e.getBoundingClientRect();p({type:"setSize",width:t.width-16,height:t.height})};t();let a=new ResizeObserver(t);return a.observe(e),window.addEventListener("resize",t),()=>{a.disconnect(),window.removeEventListener("resize",t)}},[p]);let N=(0,a.useRef)({t:0,x:-1,y:-1,spanId:""}),M=(0,a.useCallback)(e=>{let t=N.current,a=Date.now(),{clientX:r,clientY:i}=e,l=Math.sqrt(Math.pow(r-t.x,2)+Math.pow(i-t.y,2));if(a-t.t<=500&&l<=8)return(e.stopPropagation(),e.preventDefault(),t.spanId)?(p({type:"select",id:t.spanId}),void p({type:"scaleToNode",id:t.spanId})):void p({type:"resetScale"});let s=e.target;if(!s.closest(`.${String(n.default.timeline)}`))return;let o=s.closest("[data-span-id]"),c=o?.dataset.spanId||"";N.current={x:r,y:i,t:a,spanId:c},c&&(p({type:"toggleSelection",id:c}),e.stopPropagation())},[p]);(0,a.useLayoutEffect)(()=>{let e=f.current;if(!e)return;let t=w.current;t&&(e.scrollLeft=t.anchorT*k-t.anchorX)},[w,f,k]),(0,a.useEffect)(()=>{let e=h.selected?.span.spanId;if(!e)return;let t=setTimeout(()=>{let t=h.timelineRef.current,a=t?.querySelector(`[data-span-id="${e}"]`);if(!t||!a)return;let r=t.getBoundingClientRect(),n=a.getBoundingClientRect();n.width<r.width&&(n.left<r.left||n.right>r.right||n.top<r.top||n.bottom>r.bottom)&&a.scrollIntoView({block:"nearest",inline:"center",behavior:"smooth"})},500);return()=>{clearTimeout(t)}},[h.selected,h.timelineRef]),(0,a.useEffect)(()=>{let e=e=>{"Escape"===e.key&&p({type:"escape"})};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[p]),(0,a.useEffect)(()=>{if(!o)return;let e=document.documentElement,t=document.body;e.style.overflow="clip",t.style.overflow="clip";let a=e=>{e?.cancelable?e.preventDefault():window.scrollTo({left:0,top:0,behavior:"instant"})};return a(),window.addEventListener("scroll",a,{passive:!1}),()=>{e.style.overflow="",t.style.overflow="",window.removeEventListener("scroll",a)}},[o]);let q=Math.max(h.timelineHeight-h.scrollbarWidth,26+26*g.length-2+84),D=!!(h.isMobile&&h.selected);return(0,t.jsxs)("div",{className:(0,r.clsx)(n.default.traceViewer,m&&n.default.skeleton,s),onClickCapture:M,ref:j,style:{height:c,"--timeline-padding":"8px","--row-height":"24px","--row-padding":"2px","--search-height":`${40*!_}px`,"--search-gap":`${!_?8:2}px`,"--map-height":"56px","--timeline-width":`${h.timelineWidth}px`,"--timeline-height":`${h.timelineHeight}px`,"--timeline-scroll-width":`${Math.round(h.root.duration*h.scale)}px`,"--panel-width":`${h.panelWidth}px`,"--panel-height":`${h.panelHeight}px`,"--height":`${h.height}px`,"--scrollbar-width":`${h.scrollbarWidth}px`,"--marker-height":"24px","--marker-notch-height":"8px"},children:[_?null:(0,t.jsx)(ei,{}),(0,t.jsx)(er,{rows:g,scale:k,timelineRef:f}),(0,t.jsxs)("div",{className:(0,r.clsx)(n.default.traceViewerContent,D&&n.default.inert),children:[(0,t.jsx)("div",{className:n.default.timeline,ref:f,children:(0,t.jsx)("div",{style:{position:"relative",width:h.timelineWidth,height:h.timelineHeight-16,padding:8,paddingBottom:0},children:(0,t.jsxs)("div",{className:n.default.traceNode,style:{width:h.root.duration*k||void 0,height:q-16},children:[(0,t.jsx)(J,{scale:k}),(0,t.jsx)(ee,{events:y,root:h.root,scale:k}),(0,t.jsx)(et,{dispatch:p,events:y,memoCacheRef:h.memoCacheRef,root:h.root,scale:k,scrollSnapshotRef:w,spans:b,timelineRef:f}),(0,t.jsx)(S,{cacheKey:v.get(""),cache:v,root:h.root,scale:k,scrollSnapshotRef:w,spans:b})]})})}),(0,t.jsx)("div",{className:n.default.zoomButtonTraceViewer,children:(0,t.jsx)(Q,{})})]}),u?(0,t.jsx)("div",{className:(0,r.clsx)(n.default.spanDetailPanelTraceViewer,!h.selected&&n.default.hidden,h.isMobile&&n.default.mobile),children:(0,t.jsx)(P,{attached:!0})}):null]})}function eu(e){let{className:a="",children:i=null}=e,{state:l}=x();return l.selected?(0,t.jsx)("div",{className:(0,r.clsx)(n.default.spanDetailPanelTraceViewer,a),style:{position:"relative","--search-height":"0","--search-gap":"0","--map-height":"0","--panel-width":"100%","--panel-height":"100%","--height":"100%","--scrollbar-width":`${l.scrollbarWidth}px`},children:(0,t.jsx)(P,{})}):i}function ed(e){return(0,t.jsx)(g,{getQuickLinks:e.getQuickLinks,withPanel:!0,children:(0,t.jsx)(ec,{withPanel:!0,...e})})}}}]);

//# sourceMappingURL=a3a0952a54c87038.js.map
//# debugId=3c07eef7-1808-52c7-9d63-721f0a1a837c
