
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="31615436-d878-5f05-9dbe-4ce1f6a2f000")}catch(e){}}();
(globalThis.TURBOPACK=globalThis.TURBOPACK||[]).push(["object"==typeof document?document.currentScript:void 0,{5501761:e=>{e.v({projectSelectItem:"project-select-item-module__D1hM1a__projectSelectItem"})},8242533:e=>{"use strict";e.s({ProjectSelector:()=>m,ProjectTypes:()=>j},8242533);var t=e.i(6645307),o=e.i(889716),r=e.i(8084653),n=e.i(5249128),i=e.i(787594),s=e.i(5019368),l=e.i(3920197),a=e.i(1164214),c=e.i(2146499),d=e.i(4168375),h=e.i(5501761);function u(e){let{project:n,onRemove:i,disabled:s}=e;return(0,t.jsxs)("div",{className:h.default.projectSelectItem,"data-testid":(0,a.tid)("project-selected","item"),children:[(0,t.jsxs)(o.Stack,{align:{sm:"flex-start",lg:"center"},direction:{sm:"column",lg:"row"},gap:2,children:[(0,t.jsxs)(o.Stack,{align:"center",direction:"row",gap:2,children:[(0,t.jsx)(c.ProjectLogo,{deploymentId:n.latestDeployments?.[n.latestDeployments.length-1]?.id,framework:n.framework,project:n,size:20}),(0,t.jsx)(r.Text,{color:"gray-900",weight:600,children:n.name})]}),(0,t.jsx)(r.Text,{color:"gray-900",children:n.targets?.production?.alias?.[0]})]}),i&&!s?(0,t.jsx)(d.IconAction,{Icon:l.CrossCircle,onAction:()=>i(n.id)}):null]},n.id)}var j=function(e){return e.ALL="all",e.SOME="some",e}({});function m(e){let{projects:l,projectType:a,onProjectTypeUpdated:c,onProjectsUpdated:d,title:h,description:j,disabled:m}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(o.Stack,{gap:3,children:[(0,t.jsx)("div",{children:(0,t.jsx)(s.FormTitleDescription,{description:j,title:h})}),(0,t.jsx)(n.RadioGroup,{disabled:m,onChange:e=>c(e),value:a,children:(0,t.jsxs)(o.Stack,{direction:"row",gap:6,children:[(0,t.jsx)(n.RadioGroup.Item,{value:"all",children:"All Team Projects"}),(0,t.jsx)(n.RadioGroup.Item,{value:"some",children:"Specific Projects"})]})})]}),"some"===a&&(0,t.jsxs)(o.Stack,{gap:3,children:[(0,t.jsx)(r.Text,{as:"h4",color:"gray-900",lineHeight:12,size:12,weight:600,children:"LINK TO PROJECTS"}),(0,t.jsx)(i.ProjectSelect,{disabled:m,hasLogo:!0,onSelect:e=>{d([...l,e])},selected:l,verifyIntegrationsPermissions:!1}),l.length?(0,t.jsx)("div",{children:l.map(e=>(0,t.jsx)(u,{disabled:m,onRemove:e=>d(l.filter(t=>t.id!==e)),project:e},e.id))}):null]})]})}},2591058:e=>{e.v({project:"projects-labels-module__UH8jOG__project",projectsWrapper:"projects-labels-module__UH8jOG__projectsWrapper"})},3472761:e=>{"use strict";e.s({ProjectsLabels:()=>a});var t=e.i(6645307),o=e.i(8084653),r=e.i(555528),n=e.i(2146499),i=e.i(2591058);function s(e){let{project:r}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.ProjectLogo,{deploymentId:r.latestDeployment,framework:r.framework,project:r,size:16}),(0,t.jsx)(o.Text,{color:"gray-900",size:14,weight:500,children:r.name})]})}function l(e){let{project:o}=e;return(0,t.jsx)("div",{className:i.default.project,children:(0,t.jsx)(s,{project:o})})}function a(e){let{projectsMetadata:n,teamSlug:s}=e;return n&&n.length>0?(0,t.jsxs)("div",{className:i.default.projectsWrapper,children:[(0,t.jsx)(o.Text,{color:"gray-900",size:14,style:{justifyContent:"center",textAlign:"center"},weight:500,children:"Connected to"})," ",n.slice(0,4).map(e=>(0,t.jsx)(l,{project:e,teamSlug:s},e.id)),n.length>4&&(0,t.jsx)(r.Tooltip,{position:"top",text:n.slice(4).map(e=>e.name).join(", "),children:(0,t.jsxs)(o.Text,{color:"gray-900",size:14,weight:500,children:["and ",n.length-4," more"]})})]}):(0,t.jsx)(o.Text,{color:"gray-900",size:14,weight:500,children:"Connected to all projects"})}},9681376:e=>{"use strict";e.s({WebhookProjectScope:()=>h,WebhookTargetType:()=>d,filterWebhookEventNamesByProjectScope:()=>b,filterWebhookEventsByWebhookTargetType:()=>m,formatWebhookEventNamesList:()=>j,isWebhookEventWithinProjectScope:()=>p,useWebhookEvents:()=>u});var t=e.i(3521787),o=e.i(7284756),r=e.i(2304959),n=e.i(9525255),i=e.i(1183506),s=e.i(9336536),l=e.i(503726),a=e.i(3585235),c=e.i(5785123),d=function(e){return e.Integration="webhook-target-integration",e.Team="webhook-target-team",e}({}),h=function(e){return e.All="all",e.Selected="selected",e.None="none",e}({});function u(e){let o=(0,l.useAccount)(),{can:r,isLoading:n}=(0,a.default)(),d=!n&&r(c.Action.List,c.Resource.Webhooks);return(0,t.default)(()=>d?s.API_WEBHOOK_EVENTS:null,e=>{let t=o.team?.id,r=new URLSearchParams(t?{teamId:t}:{});return(0,i.fetchAPI)(`${e}?${r.toString()}`,{throwOnHTTPError:!0})},e)}function j(e,t,i){let s=Object.entries((0,o.default)(i,e=>x(t,e).category)).map(o=>{var r,i,s,l;let[a,c]=o,d=c.map(e=>x(t,e)),h=(r=t,i=a,r.filter(e=>e.category===i));return{groupWebhookEvents:d,category:function(e,t){let o=e.find(e=>{let{name:o}=e;return o===t});if(!o)throw Error(`Cannot find webhook event for name '${t}'`);return o}(e,a),includesAllCategoryEvents:(s=d,l=h,(0,n.default)(g(s).sort(),g(l).sort()))}});return e.length===s.length&&s.every(e=>{let{includesAllCategoryEvents:t}=e;return t})?"All events":(0,r.default)(s,[e=>{let{includesAllCategoryEvents:t}=e;return!t},e=>{let{category:t}=e;return t.label}]).map(e=>{let{category:t,includesAllCategoryEvents:o,groupWebhookEvents:r}=e;return o?`All ${t.label}`:r.map(e=>{let{label:t}=e;return t}).join(", ")}).join(", ")}function m(e,t){return e.filter(e=>e.targets.some(e=>k(e).type===t))}function b(e,t,o){return t.filter(t=>{let r=e.find(e=>{let{name:o}=e;return o===t});if(!r)throw Error(`Could not find webhook event for webhook event name '${t}'`);return p(r,o)})}function p(e,t){let o=e.targets.find(e=>k(e).type===t.type);if(!o)throw Error(`No matching webhook target type found for '${t.type}' in webhook event '${e.name}'`);let{projectScope:r}=k(o);return r===t.projectScope||"none"===r}function k(e){return"string"==typeof e?{type:e,projectScope:"none"}:e}function x(e,t){let o=e.find(e=>{let{name:o}=e;return o===t});if(!o)throw Error(`Cannot find webhook event for name '${t}'`);return o}function g(e){return e.map(e=>{let{name:t}=e;return t})}},8839771:e=>{e.v({webhookEventsError:"webhooks-module__jzy6ma__webhookEventsError",webhookEventsGrid:"webhooks-module__jzy6ma__webhookEventsGrid"})},3140743:e=>{"use strict";e.s({WebhookEventsGroupRedacted:()=>f,WebhookEventsSelector:()=>g},3140743);var t=e.i(6645307),o=e.i(7284756),r=e.i(2304959),n=e.i(6530772),i=e.i(889716),s=e.i(8084653),l=e.i(8158100),a=e.i(1917237),c=e.i(9681376),d=e.i(8247297),h=e.i(4789498),u=e.i(1164214);function j(e){let{label:o,webhookEvents:r,availableWebhookEvents:n,selectedWebhookEvents:l,onSelectedWebhookEventsChange:a}=e;return(0,t.jsxs)(i.Stack,{children:[(0,t.jsx)(h.Label,{value:o}),(0,t.jsx)(i.Stack,{gap:3,children:r.map(e=>{let o=!m(n,e);return(0,t.jsx)(d.Checkbox,{checked:m(l,e),"data-testid":(0,u.tid)("account-settings",e.name),disabled:o,onChange:()=>{m(l,e)?a?.(l.filter(t=>{let{name:o}=t;return o!==e.name})):a?.([...l,e])},style:{alignItems:"baseline"},children:(0,t.jsxs)(i.Stack,{gap:1,children:[(0,t.jsx)(s.Text,{color:o?"gray-800":void 0,children:e.label}),(0,t.jsx)(s.Text,{color:o?"gray-800":"gray-900",monospace:!0,size:12,children:e.name})]})},e.name)})})]})}function m(e,t){return e.some(e=>{let{name:o}=e;return o===t.name})}var b=e.i(8839771),p=e.i(5163670),k=e.i(5071261);function x(e){let{webhookEventCount:o,redacted:r}=e;return(0,t.jsxs)(i.Stack,{gap:3,children:[r?(0,t.jsx)(k.RedactedBar,{width:150}):(0,t.jsx)(p.Skeleton,{boxHeight:20,height:16,width:160}),(0,t.jsx)(i.Stack,{gap:3,children:Array(o).fill(0).map((e,o)=>(0,t.jsx)(d.Checkbox,{checked:!1,disabled:!0,onChange:()=>{},style:{alignItems:"start"},children:(0,t.jsx)(i.Stack,{gap:1,paddingTop:1,children:r?(0,t.jsxs)(i.Stack,{gap:1,style:{minWidth:"150px"},children:[(0,t.jsx)(k.RedactedBar,{width:150}),(0,t.jsx)(k.RedactedBar,{width:120})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.Skeleton,{height:18,width:150}),(0,t.jsx)(p.Skeleton,{height:16,width:120})]})})},o))})]})}function g(e){let{initialWebhookEventNames:o,webhookTarget:r,webhookEventNames:a,onWebhookEventNamesChange:d}=e,{data:h,error:u}=(0,c.useWebhookEvents)(),j=(0,n.useCallback)(e=>{d(e.map(e=>{let{name:t}=e;return t}))},[d]);if(!h)return(0,t.jsx)(v,{});if(u)return(0,t.jsx)(y,{});let m=h.webhookEventCategories,b=h.webhookEvents,p=(0,c.filterWebhookEventsByWebhookTargetType)(b,r.type).filter(e=>!!(!e.enabled&&o.includes(e.name))||e.enabled),k=p.filter(e=>{let{name:t}=e;return a.includes(t)}),x=p.filter(e=>{let{deprecated:t,autoSubscribed:o}=e;return!t&&!o}),g=p.filter(e=>{let{deprecated:t,autoSubscribed:o}=e;return t&&!o}),f=g.length>0&&g.some(e=>o.includes(e.name)),S=p.filter(e=>{let{deprecated:t,autoSubscribed:o}=e;return!t&&o}),_=S.length>0,E=p.filter(e=>!!(0,c.isWebhookEventWithinProjectScope)(e,r)&&(!e.deprecated||!!o.includes(e.name)));return(0,t.jsxs)(i.Stack,{gap:10,children:[(0,t.jsx)(w,{availableWebhookEvents:E,onSelectedWebhookEventsChange:j,selectedWebhookEvents:k,webhookEventCategories:m,webhookEvents:x}),f?(0,t.jsxs)(i.Stack,{gap:4,children:[(0,t.jsx)(s.Text,{as:"h3",size:16,weight:600,children:"Deprecated Webhooks"}),(0,t.jsxs)(l.Note,{children:["The following webhooks have been deprecated and can no longer be added, only removed. Please check out the"," ",(0,t.jsx)("a",{href:"https://vercel.com/docs/webhooks#introduction/legacy-event-types",children:"Legacy Event Types documentation"})," ","for information on how to upgrade."]}),(0,t.jsx)(w,{availableWebhookEvents:E,onSelectedWebhookEventsChange:j,selectedWebhookEvents:k,webhookEventCategories:m,webhookEvents:g})]}):null,_?(0,t.jsxs)(i.Stack,{gap:4,children:[(0,t.jsx)(s.Text,{as:"h3",size:16,weight:600,children:"Automatically Subscribed Webhooks"}),(0,t.jsx)(l.Note,{children:"The following webhooks are subscribed automatically and cannot be disabled."}),(0,t.jsx)(w,{availableWebhookEvents:[],selectedWebhookEvents:S,webhookEventCategories:m,webhookEvents:S})]}):null]})}function w(e){let{webhookEventCategories:n,webhookEvents:i,availableWebhookEvents:s,selectedWebhookEvents:l,onSelectedWebhookEventsChange:a}=e,c=(0,o.default)(i,e=>e.category),d=(0,r.default)(Object.entries(c),e=>e[1].length).reverse();return(0,t.jsx)("div",{className:b.default.webhookEventsGrid,children:d.map(e=>{let[o,r]=e,i=n.find(e=>{let{name:t}=e;return t===o});return(0,t.jsx)(j,{availableWebhookEvents:s,label:i?.label||"Unknown",onSelectedWebhookEventsChange:a,selectedWebhookEvents:l,webhookEvents:r},o)})})}function v(){return(0,t.jsxs)("div",{className:b.default.webhookEventsGrid,children:[(0,t.jsx)(x,{webhookEventCount:4}),(0,t.jsx)(x,{webhookEventCount:2})]})}function f(e){let{isLoading:o}=e;return(0,t.jsxs)("div",{className:b.default.webhookEventsGrid,children:[(0,t.jsx)(x,{redacted:!o,webhookEventCount:4}),(0,t.jsx)(x,{redacted:!o,webhookEventCount:2})]})}function y(){return(0,t.jsx)(i.Stack,{align:"center",className:b.default.webhookEventsError,justify:"center",children:(0,t.jsx)(a.Error,{error:{message:"Unable to load webhook events.",action:"Please contact us",link:"https://vercel.com/contact"}})})}},4276190:e=>{"use strict";e.s({useActiveBudget:()=>s});var t=e.i(3521787),o=e.i(6649026),r=e.i(1183506),n=e.i(9336536),i=e.i(3514588);let s=()=>{let{isReady:e,team:s}=(0,i.useTeam)(),l=(0,t.default)(()=>e?`${n.API_BUDGETS}${(0,o.encode)({teamId:s?.id})}`:null,e=>(0,r.fetchAPI)(e,{throwOnHTTPError:!0}));return{...l,activeBudget:l.data?.data[0]}}},3115188:e=>{"use strict";e.s({useBudgetWebhookUrl:()=>d,useWebhooks:()=>c});var t=e.i(3521787),o=e.i(6649026),r=e.i(1183506),n=e.i(9336536),i=e.i(3514588),s=e.i(3585235),l=e.i(5785123),a=e.i(4276190);function c(e){let{isReady:a,team:c}=(0,i.useTeam)(),{can:d,isLoading:h}=(0,s.default)(),u={list:d(l.Action.List,l.Resource.Webhooks),create:d(l.Action.Create,l.Resource.Webhooks),remove:d(l.Action.Delete,l.Resource.Webhooks),isLoading:h},j=(0,t.default)(()=>a&&!u.isLoading&&u.list&&e?.enabled?((e,t)=>{let o=new URLSearchParams;return o.set("limit","20"),o.set("includes[]","project"),e&&o.set("teamId",e),t&&o.set("projectId",t),`${n.API_WEBHOOKS}?${o.toString()}`})(c?.id,e.projectId):null,e=>(0,r.fetchAPI)(e,{throwOnHTTPError:!0}),e),m=async e=>{let{id:t,teamId:i}=e,s=await (0,r.fetchAPI)(`${n.API_WEBHOOKS}/${t}${(0,o.encode)({teamId:i})}`,{method:"DELETE",throwOnHTTPError:!0,returnStatus:!0});return await j.mutate(),s},b=async e=>{let{events:t,projectIds:i,teamId:s,url:l}=e,a=await (0,r.fetchAPI)(`${n.API_WEBHOOKS}${(0,o.encode)({teamId:s})}`,{method:"POST",throwOnHTTPError:!0,body:{events:t,projectIds:i,url:l}});return await j.mutate(),a};return{...j,deleteWebhook:m,createWebhook:b,permissions:u}}let d=()=>{let{isReady:e,team:s}=(0,i.useTeam)(),{activeBudget:l}=(0,a.useActiveBudget)(),c=(0,t.default)(()=>e&&l?.webhookId?`${n.API_WEBHOOKS}/${l.webhookId}/${(0,o.encode)({teamId:s?.id})}`:null,e=>(0,r.fetchAPI)(e,{throwOnHTTPError:!0}));return{...c,webhookUrl:c.data?.url??void 0}}},8654115:e=>{e.v({"code-wrapper":"form-add-webhooks-modal-module__KmZ2yW__code-wrapper",dropdown:"form-add-webhooks-modal-module__KmZ2yW__dropdown","modal-main":"form-add-webhooks-modal-module__KmZ2yW__modal-main","modal-title":"form-add-webhooks-modal-module__KmZ2yW__modal-title",secret:"form-add-webhooks-modal-module__KmZ2yW__secret","secret-warn":"form-add-webhooks-modal-module__KmZ2yW__secret-warn","secret-warn-text":"form-add-webhooks-modal-module__KmZ2yW__secret-warn-text","secret-wrapper":"form-add-webhooks-modal-module__KmZ2yW__secret-wrapper"})},575229:e=>{"use strict";e.s({FormAddWebhookModal:()=>p},575229);var t=e.i(6645307),o=e.i(6530772),r=e.i(3277953),n=e.i(4237550),i=e.i(7916122),s=e.i(889716),l=e.i(8084653),a=e.i(8934201),c=e.i(1164214),d=e.i(8975439),h=e.i(5172876),u=e.i(8995909),j=e.i(2362802);function m(){return(0,t.jsxs)("div",{children:[(0,t.jsxs)(l.Text,{as:"span",color:"gray-900",children:["Learn more about"," "]}),(0,t.jsx)(j.Link,{external:!0,href:"/docs/integrations/webhooks-overview/webhooks-api#securing-webhooks",type:"secondary",children:"Securing Webhooks"})]})}var b=e.i(8654115);function p(e){let{webhook:j,onClose:p}=e,[k,x]=(0,o.useState)(!1);return(0,t.jsxs)(a.Modal.Modal,{active:!!j,onClickOutside:p,sticky:!0,width:"32rem",children:[(0,t.jsxs)(a.Modal.Body,{children:[(0,t.jsx)(a.Modal.Header,{children:(0,t.jsx)(a.Modal.Title,{children:"Webhook Created"})}),(0,t.jsxs)(s.Stack,{gap:4,children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(l.Text,{weight:500,children:"Make sure to secure all webhook requests."}),(0,t.jsxs)(l.Text,{children:["Confirm authenticity by comparing the"," ",(0,t.jsx)(d.default,{children:"x-vercel-signature"})," request header to a dynamically generated SHA based on:"]})]}),(0,t.jsxs)(s.Stack,{align:"center",className:b.default["secret-wrapper"],direction:"row",gap:1,justify:"space-between",children:[(0,t.jsxs)(s.Stack,{direction:"row",children:[(0,t.jsx)(l.Text,{children:"Secret:"}),(0,t.jsx)(l.Text,{className:b.default.secret,color:"pink-900","data-testid":(0,c.tid)("webhooks","secret"),children:j?.secret})]}),(0,t.jsx)(h.default,{label:"Copy code",textToCopy:j?.secret??"",type:"tertiary"})]}),(0,t.jsxs)(s.Stack,{align:"center",className:b.default["secret-warn"],direction:"row",gap:3,children:[(0,t.jsx)(r.Warning,{}),(0,t.jsx)(l.Text,{className:b.default["secret-warn-text"],children:"This secret will not be shown again"})]}),(0,t.jsxs)(s.Stack,{align:"center",as:"button",className:b.default.dropdown,direction:"row",gap:1,onClick:()=>x(!k),children:[k?(0,t.jsx)(n.ChevronDown,{size:20}):(0,t.jsx)(i.ChevronRight,{size:20}),(0,t.jsx)("span",{children:"How to verify request headers"})]}),k?(0,t.jsx)("div",{className:b.default["code-wrapper"],children:(0,t.jsx)(u.CodeHighlight,{highlightedLinesNumbers:void 0,language:"javascript",children:`const crypto = require('crypto');

async function verifySignature(req) {
  const payload = await req.text();
  const signature = crypto
    .createHmac('sha1', process.env.WEBHOOK_SECRET)
    .update(payload)
    .digest('hex');
  return signature === req.headers['x-vercel-signature'];
}`})}):null,(0,t.jsx)(m,{})]})]}),(0,t.jsx)(a.Modal.Actions,{children:(0,t.jsx)(a.Modal.Action,{fullWidth:!0,onClick:p,children:"Done"})})]})}},7661701:e=>{e.v({age:"webhook-entity-module__07J-Aa__age","globe-wrapper":"webhook-entity-module__07J-Aa__globe-wrapper",main:"webhook-entity-module__07J-Aa__main",remove:"webhook-entity-module__07J-Aa__remove",reveal:"webhook-entity-module__07J-Aa__reveal","webhook-entity":"webhook-entity-module__07J-Aa__webhook-entity","webhook-project":"webhook-entity-module__07J-Aa__webhook-project","webhook-projects-wrapper":"webhook-entity-module__07J-Aa__webhook-projects-wrapper"})},1965178:e=>{e.v({"webhook-list":"webhooks-list-module__o4B0ia__webhook-list"})},2809033:e=>{"use strict";e.s({WebhooksList:()=>_},2809033);var t=e.i(6645307),o=e.i(8084653),r=e.i(3514588),n=e.i(3115188),i=e.i(6382421),s=e.i(6530772),l=e.i(5140160),a=e.i(3920197),c=e.i(5163670),d=e.i(889716),h=e.i(1164214),u=e.i(2226734),j=e.i(9681376),m=e.i(4168375),b=e.i(3472761),p=e.i(7661701);function k(e){let{webhook:r,onRemoveTriggered:n,teamSlug:i,canRemoveWebhook:s}=e;return(0,t.jsxs)("div",{className:p.default["webhook-entity"],"data-testid":r?(0,h.tid)("webhooks","item"):void 0,children:[(0,t.jsx)("div",{className:p.default["globe-wrapper"],children:(0,t.jsx)(l.Globe,{color:"gray-700",size:24})}),(0,t.jsxs)(d.Stack,{className:p.default.main,gap:1,paddingTop:.5,children:[r?(0,t.jsx)(d.Stack,{className:p.default.url,direction:"row",children:(0,t.jsx)(o.Text,{monospace:!0,title:r.url,truncate:1,weight:500,children:r.url})}):(0,t.jsx)(c.Skeleton,{boxHeight:20,height:16,vcenter:!0,width:200}),(0,t.jsx)(d.Stack,{direction:"row",children:(0,t.jsx)(d.Stack,{gap:2,children:r?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{children:(0,t.jsx)(x,{events:r.events})}),(0,t.jsx)(b.ProjectsLabels,{projectsMetadata:r.projectsMetadata,teamSlug:i})]}):(0,t.jsxs)(d.Stack,{gap:2,children:[(0,t.jsx)(c.Skeleton,{boxHeight:20,height:16,width:240}),(0,t.jsx)(c.Skeleton,{boxHeight:20,height:16,vcenter:!0,width:100})]})})})]}),(0,t.jsx)(d.Stack,{className:p.default.age,direction:"row",paddingTop:.5,children:r?(0,t.jsxs)(o.Text,{color:"gray-900",children:["Added"," ",(0,u.ago)(Date.now()-r.createdAt,{justNowLabel:"now",suffix:" ago"})]}):(0,t.jsx)(c.Skeleton,{height:16,width:100})}),s?(0,t.jsx)(d.Stack,{align:"baseline",className:p.default.remove,direction:"row",children:(0,t.jsx)(m.IconAction,{Icon:a.CrossCircle,onAction:()=>r&&n?.(r)})}):(0,t.jsx)("div",{style:{width:24}})]})}function x(e){let{events:r}=e,{data:n,error:i,isLoading:l}=(0,j.useWebhookEvents)(),a=(0,s.useMemo)(()=>r&&n?(0,j.formatWebhookEventNamesList)(n.webhookEventCategories,n.webhookEvents,r):"",[r,n]);return!r||l?(0,t.jsxs)(d.Stack,{direction:"row",gap:3,children:[(0,t.jsx)(o.Text,{children:"Events:"}),(0,t.jsx)(c.Skeleton,{boxHeight:20,height:16,vcenter:!0,width:200})]}):i?(0,t.jsxs)(o.Text,{children:["Events: ",r.join(", ")]}):(0,t.jsxs)(o.Text,{children:["Events: ",a]})}var g=e.i(7315479),w=e.i(8934201),v=e.i(584439),f=e.i(1917237);function y(e){let{removeError:r,webhookBeingRemoved:n,onRemove:i,isRemovingWebhook:s,onClose:l}=e;return n?(0,t.jsxs)(w.Modal.Modal,{active:!!n,onClickOutside:l,children:[(0,t.jsx)(w.Modal.Body,{children:(0,t.jsxs)(d.Stack,{gap:4,children:[(0,t.jsx)(w.Modal.Title,{center:!0,children:"Remove Webhook"}),(0,t.jsxs)(o.Text,{align:"center",children:["The Webhook ",n.url," will be permanently deleted. Are you sure you want to continue?"]}),r?(0,t.jsx)(f.Error,{error:r}):null]})}),(0,t.jsxs)(w.Modal.Actions,{children:[(0,t.jsx)(w.Modal.Action,{onClick:l,type:"secondary",children:"Cancel"}),(0,t.jsx)(w.Modal.Action,{loading:s,onClick:i,children:"Remove"})]})]}):null}var S=e.i(1965178);function _(e){let{EmptyState:l,projectId:a,isProjectReady:c=!0,title:d}=e,{team:h,isReady:u}=(0,r.useTeam)(),{data:j,error:m,permissions:b}=(0,n.useWebhooks)({projectId:a,enabled:c}),{removeError:p,isRemovingWebhook:x,webhookBeingRemoved:w,handleClose:f,handleRemoveWebhook:_,setWebhookBeingRemoved:E}=(e=>{let{teamId:t,isProjectReady:o,projectId:r}=e,[i,l]=(0,s.useState)(!1),[a,c]=(0,s.useState)(null),[d,h]=(0,s.useState)(null),u=(0,v.useToasts)(),{deleteWebhook:j}=(0,n.useWebhooks)({projectId:r,enabled:o}),m=(0,s.useCallback)(async()=>{if(a){l(!0);try{if(((await j({id:a.id,teamId:t})).status??404)>=400)throw Error("Webhook not found");c(null),u.success({text:"Removed Webhook successfully.",key:"remove-webhook"})}catch(e){h((0,g.normalizeError)(e))}finally{l(!1)}}},[a,t,u,j]);return{isRemovingWebhook:i,webhookBeingRemoved:a,removeError:d,handleClose:(0,s.useCallback)(()=>{l(!1),h(null)},[]),handleRemoveWebhook:m,setWebhookBeingRemoved:c}})({teamId:h?.id,projectId:a,isProjectReady:c}),T=!c||!u||b.isLoading||b.list&&!m&&!j;return T||b.list?!l&&(T||j?.length===0)?null:T&&l?(0,t.jsxs)("div",{className:S.default["webhook-list"],children:[(0,t.jsx)(k,{teamSlug:null}),(0,t.jsx)(k,{teamSlug:null}),(0,t.jsx)(k,{teamSlug:null})]}):(0,t.jsxs)(t.Fragment,{children:[j?.length===0?l:(0,t.jsxs)(t.Fragment,{children:[d?(0,t.jsx)(o.Text,{as:"h3",size:20,weight:600,children:d}):null,(0,t.jsx)("div",{className:S.default["webhook-list"],children:j?.map(e=>(0,t.jsx)(k,{canRemoveWebhook:b.remove,onRemoveTriggered:E,teamSlug:h?.slug??null,webhook:e},e.id))})]}),(0,t.jsx)(y,{isRemovingWebhook:x,onClose:()=>{f(),E(null)},onRemove:_,removeError:p,webhookBeingRemoved:w})]}):(0,t.jsx)(i.AdditionalPermissionsRequired,{resource:"webhooks",team:h})}},1552829:e=>{e.v({"webhook-events-wrapper":"form-webhooks-events-module__mJ74LW__webhook-events-wrapper"})},7024680:e=>{e.v({"add-webhooks-wrapper":"form-add-webhooks-module__ndWq1q__add-webhooks-wrapper"})},7261449:e=>{"use strict";e.s({AddWebhooks:()=>E},7261449);var t=e.i(6645307),o=e.i(6530772),r=e.i(5674541),n=e.i(6531164),i=e.i(611347),s=e.i(7238633),l=e.i(889716),a=e.i(8084653),c=e.i(584439),d=e.i(9240532),h=e.i(2362802),u=e.i(3514588),j=e.i(9326250),m=e.i(3115188),b=e.i(9681376),p=e.i(8242533),k=e.i(575229),x=e.i(3140743),g=e.i(5019368),w=e.i(1552829);function v(e){let{canListWebhooks:o,arePermissionsLoading:r,selectedEvents:n,onEventsChange:i,webhookTarget:s}=e;return(0,t.jsxs)("div",{children:[(0,t.jsx)(g.FormTitleDescription,{description:"Select the events the webhook will listen to. At least one must be selected.",title:"Events"}),!r&&o?(0,t.jsx)("div",{className:w.default["webhook-events-wrapper"],children:(0,t.jsx)(x.WebhookEventsSelector,{initialWebhookEventNames:[],onWebhookEventNamesChange:i,webhookEventNames:n,webhookTarget:s})}):(0,t.jsx)("div",{className:w.default["webhook-events-wrapper"],children:(0,t.jsx)(x.WebhookEventsGroupRedacted,{isLoading:r})})]})}var f=e.i(631755),y=e.i(6202145);function S(e){let{url:o,onUrlChanged:r}=e;return(0,t.jsxs)(l.Stack,{gap:3,children:[(0,t.jsx)("div",{children:(0,t.jsx)(g.FormTitleDescription,{as:"label",description:(0,t.jsxs)(a.Text,{as:"span",children:["Webhooks events will be sent as ",(0,t.jsx)(y.InlineCode,{children:"POST"})," ","request to this URL."]}),htmlFor:"webhook-url",title:"Endpoint"})}),(0,t.jsx)(f.Input,{explicitId:"webhook-url",id:"webhook-url",maxLength:512,onChange:e=>r(e.target.value),placeholder:"https://my-app.com/webhooks",value:o,width:"100%"})]})}var _=e.i(7024680);function E(){let e=(0,c.useToasts)(),{createWebhook:x,permissions:g}=(0,m.useWebhooks)({enabled:!0}),{data:w,isLoading:f}=(0,b.useWebhookEvents)(),[y,E]=(0,o.useState)([]),[T,W]=(0,o.useState)(""),[A,C]=(0,o.useState)(p.ProjectTypes.ALL),[P,L]=(0,o.useState)([]),{isReady:I,team:N}=(0,u.useTeam)(),[O,R]=(0,o.useState)(null),[B,H]=(0,o.useState)(!1),M={type:b.WebhookTargetType.Team,projectScope:A===p.ProjectTypes.ALL?b.WebhookProjectScope.All:b.WebhookProjectScope.Selected},F=(0,o.useCallback)(async()=>{let t={events:y,url:T,projectIds:A===p.ProjectTypes.ALL?void 0:P.map(e=>e.id),teamId:N?.id},o=t.url?t.events.length?null:"At least one event is required":"An Endpoint is required!";if(o)return void e.error(o);H(!0);try{let e=await x(t);R(e),E([]),W(""),C(p.ProjectTypes.ALL),L([])}catch(t){e.error(t?.message??"An error occurred while creating the webhook")}finally{H(!1)}},[x,y,A,P,N?.id,e,T]),z=!!(N?.billing?.plan==="hobby"||N?.billing?.trial&&"pro"===N.billing.plan),$=!g.isLoading&&g.create&&!z,K=!g.isLoading&&g.list&&!z;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.Stack,{align:"center",direction:"row",gap:2,children:(0,t.jsx)(a.Text,{as:"h3",size:20,weight:600,children:(0,t.jsx)(d.SearchContextHighlighter,{children:"Add Webhooks"})})}),(0,t.jsxs)(i.Fieldset,{className:_.default["add-webhooks-wrapper"],children:[(0,t.jsx)(n.FieldsetContent,{disabled:!$,children:(0,t.jsxs)(l.Stack,{gap:6,children:[(0,t.jsx)(v,{arePermissionsLoading:g.isLoading,canListWebhooks:K,onEventsChange:E,selectedEvents:y,webhookTarget:M}),(0,t.jsx)(p.ProjectSelector,{description:"Choose which projects should send events to the specified endpoint.",disabled:f||!$,onProjectTypeUpdated:e=>{C(e),E((0,b.filterWebhookEventNamesByProjectScope)(w.webhookEvents,y,{...M,projectScope:e===p.ProjectTypes.ALL?b.WebhookProjectScope.All:b.WebhookProjectScope.Selected}))},onProjectsUpdated:L,projectType:A,projects:P,title:"Projects"}),(0,t.jsx)(S,{onUrlChanged:W,url:T})]})}),(0,t.jsxs)(s.FieldsetFooter,{children:[(0,t.jsx)(s.FieldsetFooter.Status,{children:z?(0,t.jsxs)("span",{children:["This feature is available on the"," ",(0,t.jsx)(h.Link,{external:!0,href:"/pricing",tab:!0,type:"highlight",children:"Pro plan"}),"."]}):$?(0,t.jsxs)("span",{children:["Learn more about"," ",(0,t.jsx)(h.Link,{external:!0,href:"/docs/integrations#webhooks",type:"highlight",children:"Webhooks"})]}):"You need additional permissions to manage Webhooks."}),(0,t.jsx)(s.FieldsetFooter.Actions,{children:z?(0,t.jsx)(h.Link,{href:"/pricing",type:"highlight",target:"_blank",children:(0,t.jsx)(r.Button,{size:"small",children:"Upgrade"})}):(0,t.jsx)(r.Button,{loading:B||!I,onClick:(0,j.promiseToCallback)(F),size:"small",typeName:"submit",children:"Create Webhook"})})]})]}),(0,t.jsx)(k.FormAddWebhookModal,{onClose:()=>R(null),webhook:O})]})}}}]);

//# sourceMappingURL=92398e6bc03c5874.js.map
//# debugId=31615436-d878-5f05-9dbe-4ce1f6a2f000
