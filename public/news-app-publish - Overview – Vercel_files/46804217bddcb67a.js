
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="14ab264b-b1c0-549b-8160-833af5dfd000")}catch(e){}}();
(globalThis.TURBOPACK=globalThis.TURBOPACK||[]).push(["object"==typeof document?document.currentScript:void 0,{3014986:e=>{e.v({contributorInfo:"manage-role-modal-module__oQbjma__contributorInfo",editButton:"manage-role-modal-module__oQbjma__editButton",linkButton:"manage-role-modal-module__oQbjma__linkButton",projectColumn:"manage-role-modal-module__oQbjma__projectColumn",projectColumnLabel:"manage-role-modal-module__oQbjma__projectColumnLabel",projectModalArrow:"manage-role-modal-module__oQbjma__projectModalArrow",projectRoleEntity:"manage-role-modal-module__oQbjma__projectRoleEntity",projectRoleEntityError:"manage-role-modal-module__oQbjma__projectRoleEntityError",projectRoleEntityWarning:"manage-role-modal-module__oQbjma__projectRoleEntityWarning",radioGroupItem:"manage-role-modal-module__oQbjma__radioGroupItem",readOnlyItem:"manage-role-modal-module__oQbjma__readOnlyItem",removeButton:"manage-role-modal-module__oQbjma__removeButton",selectedItem:"manage-role-modal-module__oQbjma__selectedItem",teamRoleEntity:"manage-role-modal-module__oQbjma__teamRoleEntity"})},896448:[e=>{"use strict";e.s({ManageRoleModal:()=>es,changeEntitlements:()=>er,getDirectEntitlementArray:()=>en,isTruthy:()=>et},896448);var l=e.i(6645307),s=e.i(6530772),t=e.i(5175803),a=e.i(889716),i=e.i(5674541),n=e.i(8084653),r=e.i(5249128),o=e.i(555528),c=e.i(8934201),d=e.i(584439),m=e.i(8158100),u=e.i(2254575),p=e.i(1917237),h=e.i(8247297),g=e.i(1735144),j=e.i(5495572),x=e.i(6465700),f=e.i(5610210),y=e.i(1164214),b=e.i(1183506),T=e.i(9336536),v=e.i(3514588),E=e.i(3326412),R=e.i(5617834),S=e.i(9959972),I=e.i(1933128),N=e.i(8012856),C=e.i(4774832),_=e.i(6140702),A=e.i(8981169);e.s({AdditionalPermissionsMessage:()=>P,directorySyncPermissionsMessage:()=>M},6083766);var w=e.i(2362802);let M="This Team Member is managed with Directory Sync.";function P(){return(0,l.jsxs)(l.Fragment,{children:["Additional permissions are required to manage Team members."," ",(0,l.jsx)(w.Link,{href:"/docs/rbac",variant:"highlight",children:"Learn More â†’"})]})}e.s({AccessGroupsManageSticky:()=>ee},213266);var k=e.i(6960707),G=e.i(5165976),O=e.i(2385909),D=e.i(8382218),$=e.i(1550899),B=e.i(9948746),z=e.i(2824080),L=e.i(1209519),F=e.i(5535439),J=e.i(604868);e.i(8893248);var V=e.i(7936324),Q=e.i(628938),W=e.i(9766694),H=e.i(1763478);function U(e){let{accessGroupsData:t,value:a=[],onChange:r,isOpen:o,setIsOpen:c}=e,{teamSlug:d}=(0,v.useTeam)(),m=(0,F.useRouter)(),u=[...t].sort((e,l)=>e.isDsyncManaged&&!l.isDsyncManaged?1:!e.isDsyncManaged&&l.isDsyncManaged?-1:e.name.localeCompare(l.name)),p=(0,Q.useCommand)(),[h,g]=(0,s.useState)(a),[j,x]=(0,s.useState)({}),y=(0,J.useIsMobile)(),b=p.setInputValue;return((0,s.useEffect)(()=>{if(!o){g(a),x(K(a));return}x(K(h))},[o,r,h,a]),y)?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)($.Drawer,{onDismiss:()=>{c(!1),b(""),Y(h,a)||r?.(h)},show:o,children:(0,l.jsx)(q,{accessGroups:u,activeAccessGroupMap:j,commandProps:p,setSelectedAccessGroups:g})}),(0,l.jsx)(i.Button,{"aria-label":"Add access group",onClick:()=>c(!0),style:{padding:"0",width:"var(--geist-form-small-height)",height:"var(--geist-form-small-height)"},svgOnly:!0,type:"tertiary",children:(0,l.jsx)(L.PlusCircle,{})})]}):(0,l.jsxs)(O.Root,{onOpenChange:e=>{!e&&(b(""),Y(h,a)||r?.(h)),c(e)},children:[(0,l.jsx)(O.Trigger,{asChild:!0,children:(0,l.jsx)(i.Button,{"aria-label":"Add access group",style:{padding:"0",width:"var(--geist-form-small-height)",height:"var(--geist-form-small-height)"},svgOnly:!0,type:"tertiary",children:(0,l.jsx)(L.PlusCircle,{})})}),(0,l.jsx)(O.Portal,{children:(0,l.jsx)(O.Content,{align:"start",className:H.default.content,side:"bottom",children:(0,l.jsx)(q,{accessGroups:u,activeAccessGroupMap:j,commandProps:p,setSelectedAccessGroups:g,children:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(V.Command.Separator,{}),(0,l.jsx)(V.Command.Item,{callback:()=>{m.push(`/${d}/~/settings/access-groups`)},className:(0,f.clsx)(H.default.item),children:(0,l.jsx)("div",{className:"flex flex-1 items-center",children:(0,l.jsx)("div",{className:"flex flex-1 flex-col",children:(0,l.jsx)(n.Text,{children:"Manage Access Groups"})})})})]})})})})]})}function q(e){let{accessGroups:s,commandProps:t,activeAccessGroupMap:i,setSelectedAccessGroups:r,children:o}=e;return(0,l.jsx)("div",{className:(0,f.clsx)(W.default.command,W.default.primary,H.default.command),children:(0,l.jsxs)(V.Command,{...t,children:[(0,l.jsxs)(a.Stack,{align:"center",className:W.default.input,direction:"row",children:[(0,l.jsx)(z.MagnifyingGlass,{color:"gray-500",size:20}),(0,l.jsx)(V.Command.Input,{placeholder:"Filter access groups"}),(0,l.jsx)(D.Kbd,{className:W.default.kbd,children:"Esc"})]}),(0,l.jsxs)(V.Command.List,{className:`${W.default.list} tailwind`,disableDynamicHeight:!0,emptyMessage:(0,l.jsx)(X,{onClear:()=>{t.setInputValue("")},prompt:t.inputValue}),children:[s?.map(e=>(0,l.jsx)(V.Command.Item,{callback:()=>{e.isDsyncManaged||r(function(){let l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return l.includes(e.accessGroupId)?l.filter(l=>l!==e.accessGroupId):[...l,e.accessGroupId]})},className:(0,f.clsx)(H.default.item,e.role&&H.default.itemWithRole,e.isDsyncManaged&&"opacity-50"),disabled:e.isDsyncManaged,value:e.name,children:(0,l.jsxs)("div",{className:"flex flex-1 items-center gap-4",children:[(0,l.jsxs)("div",{className:"flex flex-1 flex-col",children:[(0,l.jsx)(n.Text,{className:"max-w-52 truncate",color:e.isDsyncManaged?"gray-900":"gray-1000",children:e.name}),e.role?(0,l.jsx)(n.Text,{color:"gray-900",size:14,children:A.projectRolesMap[e.role].label}):null]}),i[e.accessGroupId]?(0,l.jsx)(B.Check,{size:20}):null,e.isDsyncManaged?(0,l.jsx)(G.LockClosed,{size:20}):null]})},e.accessGroupId)),o]})]})})}function K(e){let l={};if(!e)return l;for(let s of e)l[s]=!0;return l}function Y(e,l){if(e.length!==l.length)return!1;for(let s of e)if(!l.includes(s))return!1;return!0}function X(e){let{onClear:s,prompt:t}=e;return(0,l.jsxs)(a.Stack,{align:"center",direction:"column",gap:3,justify:"center",padding:4,children:[(0,l.jsxs)(n.Text,{className:"flex-1",children:['No results for "',t,'"']}),(0,l.jsx)(i.Button,{onClick:s,size:"small",type:"secondary",children:"Clear search"})]})}function Z(e){let{value:s=[],isOpen:t,setIsOpen:r,onChange:c,accessGroupsData:d}=e,m=s.map(e=>e.accessGroupId);return(0,l.jsxs)(a.Stack,{gap:2,children:[(0,l.jsxs)(a.Stack,{align:"center",direction:"row",gap:1,children:[(0,l.jsx)(n.Text,{size:16,weight:500,children:"Access Groups"}),(0,l.jsx)(U,{accessGroupsData:d,isOpen:t,onChange:e=>{c(e)},setIsOpen:r,value:m})]}),s.length?(0,l.jsx)(u.Entity.List,{children:s.map(e=>(0,l.jsx)(u.Entity,{paddingY:2,right:(0,l.jsx)(o.Tooltip,{desktopOnly:!0,disableTriggers:!e.isDsyncManaged,text:"This Access Group is Dsync Managed",children:(0,l.jsx)(i.Button,{"aria-label":"Remove Access Group",disabled:e.isDsyncManaged,onClick:()=>{c(m.filter(l=>l!==e.accessGroupId))},shape:"square",size:"small",svgOnly:!0,type:"tertiary",children:e.isDsyncManaged?(0,l.jsx)(G.LockClosed,{}):(0,l.jsx)(k.MinusCircle,{size:16})})}),children:(0,l.jsx)(u.Entity.Content,{description:e.role?A.projectRolesMap[e.role].label:void 0,title:e.name})},e.accessGroupId))}):(0,l.jsx)(n.Text,{color:"gray-900",children:"No access groups selected."})]})}function ee(e){let{accessGroupsData:s,isOpen:t,setIsOpen:a,value:i=[],onChange:n}=e,r=s.filter(e=>i.includes(e.accessGroupId));return(0,l.jsx)(Z,{accessGroupsData:s,isOpen:t,onChange:n,setIsOpen:a,value:r})}var el=e.i(3014986);function es(e){let{member:r,project:f,onClose:w,onClearProject:P,revalidateSearch:k,revalidateAccessGroups:G,accessGroupsData:O}=e,D=!!r.joinedFrom?.dsyncUserId,{canHaveProjectRole:$,isValidRoleCombination:B,getDefaultProjectRole:z}=(0,R.useRoleUtils)(),[L,F]=(0,s.useState)(D||f?"PROJECT":"TEAM"),[J,V]=(0,s.useState)(!0),[Q,W]=(0,s.useState)(!1),[H,U]=(0,s.useState)(!1),{team:q}=(0,v.useTeam)(),K=(0,d.useToasts)(),[Y,X]=(0,s.useState)(!1),[Z,es]=(0,s.useState)(null),[en,er]=(0,s.useState)(r.role),[eo,ec]=(0,s.useState)([...new Set([...r.teamRoles||[],r.role])]),[ed,em]=(0,s.useState)(r.teamPermissions||[]),[eu,ep]=(0,s.useState)(r.projects?.map(e=>({project:{id:e.id,name:e.name},role:e.role}))||[]),[eh,eg]=(0,s.useState)(r.accessGroups?.map(e=>String(e.id))||[]),{value:ej}=(0,E.useHasNewRBAC)(),ex=eu.filter(e=>e.project.id),ef=f?eu.find(e=>e.project.id===f.id)?.role:void 0,ey=O?.filter(e=>eh.includes(e.accessGroupId)).map(e=>e.role)||[],eb=function(e){let l=!1,s=!1;for(let t of e){if("ADMIN"===t)return"ADMIN";"PROJECT_DEVELOPER"===t&&(l=!0),"PROJECT_VIEWER"===t&&(s=!0)}return l?"PROJECT_DEVELOPER":s?"PROJECT_VIEWER":void 0}(["DEVELOPER"===r.role?"PROJECT_DEVELOPER":void 0,ef,...ey]),{teamRoles:eT,teamPermissions:ev,simplifyRoles:eE}=(0,R.useAvailableRolesInfo)(),eR=ev.filter(e=>e.compatibleRoles.some(e=>eo.includes(e))||e.includedIn.some(e=>eo.includes(e))),eS=eT.find(e=>e.role===en),eI=eb?A.projectRolesMap[eb]:void 0,eN=(0,R.getRolesInfo)({teamRoles:eo,teamPermissions:ed}),eC=(0,C.isHobby)(q);async function e_(){es(null),X(!0);let{teamRoles:e,teamPermissions:l}=eE(eo,ed);try{await eA(),await k(s=>s?.map(s=>({...s,members:s.members.map(s=>s.uid!==r.uid?s:{...s,role:ej?e[0]:en,teamRoles:ej?e:void 0,teamPermissions:ej?l:void 0,projects:ex.map(e=>({id:e.project.id,name:e.project.name,role:e.role})),accessGroups:eh.map(e=>({id:e,name:O?.find(l=>l.accessGroupId===e)?.name}))})})),{revalidate:!1}),await G(),V(!1),K.success("User access has been updated.")}catch(e){es(e)}X(!1)}async function eA(){if(!q||eC)return;let e=[];for(let l of eu)e.push({projectId:l.project.id,role:l.role||null});for(let l of r.projects??[])eu.some(e=>e.project.id===l.id)||e.push({projectId:l.id,role:null});let l=r.accessGroups?.map(e=>e.id)||[],s=eh.filter(e=>!l.includes(e)),t=l.filter(e=>f?!eh.includes(e)&&O?.find(l=>l.accessGroupId===e):!eh.includes(e)),{teamRoles:a,teamPermissions:i}=eE(eo,ed),n=e.length>0,o=s.length>0||t.length>0,c=r.role!==en,d=new Set(r.teamRoles).size!==new Set(a).size||r.teamRoles?.some(e=>!a.includes(e));if(n||o||c||d)return(0,b.fetchAPI)(`${T.API_TEAMS_MEMBERS}/${q.id}/members/${r.uid}`,{body:JSON.stringify({role:ej?void 0:en,teamRoles:ej?a:void 0,teamPermissions:ej?i:void 0,projects:$(en)?e:void 0,accessGroupsToAdd:o?s:void 0,accessGroupsToRemove:o?t:void 0}),method:"PATCH",throwOnHTTPError:!0})}let ew=z(en),eM=ex.filter(e=>$(en)&&ew&&!B(en,e.role??ew)),eP=eM.length>0,ek=!eP&&(eo.length>0||!ej),eG=function(e){let{selectedTeamRole:l,projectCount:s,accessGroupCount:t}=e;if(0===s&&0===t)return"DEVELOPER"===l?"Optionally you can assign Project Admin roles":"No project role has been assigned";let a=[s>0?`${s} project role${1===s?"":"s"}`:null,t>0?`${t} access group${1===t?"":"s"}`:null].filter(Boolean).join(" and "),i=`${s+t>1?"have":"has"} been assigned`;return`${a} ${i}`}({selectedTeamRole:en,projectCount:ex.length,accessGroupCount:eh.length}),{value:eO}=(0,S.useEntitlement)("v0-team-seats"),eD=r.entitlements?.some(e=>"v0"===e.entitlement),e$=eO&&q?.billing?.plan!=="enterprise",eB=(0,l.jsx)(i.Button,{align:"start",className:"tailwind-preflight",onClick:()=>{F("PROJECT")},size:"small",suffix:(0,l.jsx)(j.SettingsGear,{}),type:eP?"warning":"secondary",children:(0,l.jsxs)(a.Stack,{align:"center",className:"w-full",direction:"row",gap:2,justify:"stretch",children:[(0,l.jsx)(_.ProjectAvatarGroup,{projectIds:ex.map(e=>e.project.id).filter(et)}),eP?(0,l.jsxs)(n.Text,{className:"flex-1",color:"inherit",children:[eM.length," project"," ",1===eM.length?"role is":"roles are"," ","unavailable"]}):(0,l.jsx)(n.Text,{className:"flex-1",color:ex.length?"gray-1000":"gray-900",children:eG})]})}),ez=(0,l.jsx)(i.Button,{align:"start",className:"tailwind-preflight",disabled:!0,size:"small",type:"warning",children:(0,l.jsxs)(a.Stack,{align:"center",className:"w-full",direction:"row",gap:2,justify:"stretch",children:[(0,l.jsx)(_.ProjectAvatarGroup,{projectIds:r.projects?.map(e=>e.id)}),(0,l.jsxs)(n.Text,{children:[r.projects?.length," project"," ",r.projects?.length===1?"role":"roles"," will be removed"]})]})}),eL=$(en)?(0,l.jsx)(l.Fragment,{children:eB}):(0,l.jsx)(l.Fragment,{children:r.projects?.length?ez:null}),eF=(0,l.jsx)(i.Button,{align:"start",className:"w-full",disabled:!ek,onClick:()=>{F("PROJECT")},size:"small",suffix:(0,l.jsx)(j.SettingsGear,{}),type:eP?"warning":"secondary",children:(0,l.jsxs)(a.Stack,{align:"center",className:"w-full",direction:"row",gap:2,justify:"stretch",children:[(0,l.jsx)(_.ProjectAvatarGroup,{projectIds:ex.map(e=>e.project.id).filter(et)}),eP?(0,l.jsxs)(n.Text,{className:"flex-1",color:"inherit",children:[eM.length," project"," ",1===eM.length?"role is":"roles are"," ","unavailable"]}):(0,l.jsx)(n.Text,{className:"flex-1",color:ex.length?"gray-1000":"gray-900",children:function(e){let{projectCount:l,accessGroupCount:s}=e;if(0===l&&0===s)return"Manage project access and additional permissions";let t=[l>0?`${l} project role${1===l?"":"s"}`:null,s>0?`${s} access group${1===s?"":"s"}`:null].filter(Boolean).join(" and "),a=`${l+s>1?"have":"has"} been assigned`;return`${t} ${a}`}({projectCount:ex.length,accessGroupCount:eh.length})})]})}),eJ=eR.map(e=>{let l=e.includedIn.find(e=>eo.includes(e));return{checked:!!l||ed.includes(e.role),disabled:!!(l||D),permission:e,includedIn:l}}),eV=eJ.some(e=>e.checked),eQ=!D||eV;return(0,l.jsxs)(c.Modal.Modal,{active:J,disableFocusTrap:!0,onAnimationDone:()=>{X(!1),es(null),w()},onClickOutside:e=>{!Q&&!H&&(e?.target instanceof HTMLElement&&e.target.closest("[data-geist-menu-item]")||V(!1))},children:[(0,l.jsxs)(c.Modal.Body,{className:"tailwind-preflight",padding:0,children:[(0,l.jsxs)("div",{className:"flex flex-col gap-1 px-6 pb-5 pt-6",children:[(0,l.jsx)(c.Modal.Title,{children:f?"Manage Project Access":"Manage Team Access"}),(0,l.jsx)(c.Modal.Subtitle,{children:(0,l.jsxs)(a.Stack,{align:"center",className:"flex-wrap",direction:"row",gap:1,children:[(0,l.jsx)(n.Text,{as:"span",color:"gray-900",children:"Manage the roles "}),(0,l.jsxs)("div",{className:"flex content-center gap-1",children:[(0,l.jsx)(t.Avatar,{size:20,username:r.username}),(0,l.jsx)(n.Text,{as:"span",weight:500,children:r.name||r.username})]}),(0,l.jsx)(n.Text,{as:"span",color:"gray-900",children:" has for "}),f?(0,l.jsxs)("div",{className:"flex content-center gap-1",children:[(0,l.jsx)(I.ProjectAvatar,{project:f,size:16}),(0,l.jsx)(n.Text,{as:"span",weight:500,children:f.name})]}):(0,l.jsxs)("div",{className:"flex content-center gap-1",children:[(0,l.jsx)(t.Avatar,{size:20,teamId:q?.id}),(0,l.jsx)(n.Text,{as:"span",weight:500,children:q?.name||"this team"})]})]})})]}),"TEAM"!==L&&f?(0,l.jsx)(a.Stack,{paddingX:6,children:(0,l.jsx)(u.Entity.List,{children:(0,l.jsx)(u.Entity,{paddingY:3,right:(0,l.jsxs)(l.Fragment,{children:[ef&&eb!==ef?(0,l.jsx)(o.Tooltip,{delayTime:300,position:"top",text:"An access group has overrided the selected project role.",children:(0,l.jsx)(g.StopFill,{color:"amber-900"})}):null,(0,l.jsx)(o.Tooltip,{delayTime:300,disableTriggers:!D,position:"bottom",text:M,children:(0,l.jsx)(i.Button,{className:el.default.editButton,disabled:D,onClick:()=>{F("TEAM"),P?.()},size:"small",type:"secondary",children:"Edit"})})]}),children:eS?(0,l.jsx)(u.Entity.Content,{description:eS.label,fill:!0,title:eI?.label||"No access"}):null})})}):null,"TEAM"===L||f?null:(0,l.jsx)(a.Stack,{paddingX:6,children:(0,l.jsx)(u.Entity.List,{children:(0,l.jsx)(u.Entity,{paddingY:3,right:(0,l.jsx)(o.Tooltip,{delayTime:300,disableTriggers:!D,position:"bottom",text:M,children:(0,l.jsx)(i.Button,{className:el.default.editButton,disabled:D,onClick:()=>{F("TEAM"),P?.()},size:"small",type:"secondary",children:"Edit"})}),children:eS?(0,l.jsx)(u.Entity.Content,{description:eN.teamRoles.map(e=>e.description).join(", "),fill:!0,title:eN.teamRoles.map(e=>e.label).join(", ")}):null})})}),"TEAM"===L&&ej?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(ei,{disableRoles:{VIEWER:{disabled:!!(!eD&&e$&&1),message:"Requires a v0 seat."}},onChange:e=>{ec(e)},value:eo}),(0,l.jsx)("div",{className:"w-full border-t border-gray-200 bg-gray-100/50 px-6 py-3",children:eF})]}):null,"TEAM"!==L||ej?null:(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(ea,{disableRoles:{VIEWER:{disabled:!!(!eD&&e$&&1),message:"Requires a v0 seat."}},onChange:e=>{er(e)},persistedRole:r.role,projectRolesInfo:eL,value:en})}),"PROJECT"===L&&ej&&eQ?(0,l.jsxs)("div",{className:"flex flex-col gap-2 px-6 pt-4",children:[(0,l.jsx)(n.Text,{size:16,weight:500,children:"Team Permissions"}),eJ.map(e=>{let{permission:s,checked:t,disabled:a,includedIn:i}=e,n=s.includedIn.find(e=>eo.includes(e)),r=[i&&`Already included in the ${n} role.`,D&&"This user permissions are managed by Directory Sync."].filter(Boolean).join("\n\n");return D&&!t?null:(0,l.jsxs)("div",{className:"flex gap-1",children:[(0,l.jsx)(o.Tooltip,{delayTime:300,disableTriggers:!a,position:"left",text:r,children:(0,l.jsx)(h.Checkbox,{checked:t,disabled:a,onChange:()=>{ed.includes(s.role)?em(ed.filter(e=>e!==s.role)):em([...ed,s.role])},children:s.label})}),s.description?(0,l.jsx)(o.Tooltip,{text:s.description,children:(0,l.jsx)(x.InformationFillSmall,{color:"gray-900",size:16})}):null]},s.role)})]}):null,"PROJECT"===L?(0,l.jsxs)(a.Stack,{gap:6,padding:6,children:[f?(0,l.jsxs)(a.Stack,{gap:2,children:[(0,l.jsx)(n.Text,{size:16,weight:500,children:"Project Role"}),(0,l.jsx)(A.ProjectRoleSelector,{allowSelectNoRole:!0,menuButtonWidth:170,menuWidth:"100%",onChange:e=>{let l=eu.filter(e=>e.project.id!==f.id);"UNDEFINED"!==e&&l.push({project:{id:f.id,name:f.name},role:e}),ep(l)},teamRole:en,value:ef||"UNDEFINED"})]}):(0,l.jsxs)(a.Stack,{gap:2,children:[eP?(0,l.jsx)(m.Note,{fill:!0,type:"error",children:"Some selected Project Roles are not available for the Developer role and should be updated or removed."}):null,(0,l.jsx)(N.ProjectMultiselect,{isOpen:H,onSetProjectRoles:ep,projectRoles:eu,setIsOpen:U,teamRole:"CONTRIBUTOR"})]}),O?(0,l.jsx)(ee,{accessGroupsData:O,isOpen:Q,onChange:e=>{eg(e)},setIsOpen:W,value:eh}):null,Z?(0,l.jsx)("div",{className:"p-4",children:(0,l.jsx)(p.Error,{error:Z})}):null]}):null,"TEAM"===L&&Z?(0,l.jsx)("div",{className:"p-4",children:(0,l.jsx)(p.Error,{error:Z})}):null]}),(0,l.jsxs)(c.Modal.Actions,{children:[(0,l.jsx)(c.Modal.Action,{onClick:()=>V(!1),type:"secondary",children:"Cancel"}),(0,l.jsx)(o.Tooltip,{delayTime:300,disableTriggers:!eP,position:"top",text:"Some project roles are unavailable.",children:(0,l.jsx)(c.Modal.Action,{"data-testid":(0,y.tid)("members","manage-role-modal","save-button"),disabled:eC||!ek,loading:Y,onClick:e_,children:"Save Changes"})})]})]})}function et(e){return null!=e}function ea(e){let{value:s,onChange:t,projectRolesInfo:i,persistedRole:o,disableRoles:c}=e,{canHaveProjectRole:d}=(0,R.useRoleUtils)(),{teamRoles:m}=(0,R.useAvailableRolesInfo)();return(0,l.jsx)(r.RadioGroup,{label:"Project Role Select",onChange:e=>{t(e)},value:s,children:m.map(e=>{let t=d(s)&&e.role===s,m=!d(s)&&e.role===o,u=c?.[e.role]?.disabled,p=c?.[e.role]?.message;return(0,l.jsx)(r.RadioGroup.Item,{className:(0,f.clsx)("tailwind",el.default.radioGroupItem,s===e.role&&el.default.selectedItem),disabled:u,fullWidth:!0,value:e.role,children:(0,l.jsx)(a.Stack,{align:"center",className:u?"opacity-50":"","data-testid":(0,y.tid)("members","manage-role-modal","role-option",String(e.role)),direction:"row",justify:"stretch",children:(0,l.jsxs)(a.Stack,{flex:1,gap:2,children:[(0,l.jsxs)(a.Stack,{children:[(0,l.jsx)(n.Text,{weight:500,children:e.label}),(0,l.jsxs)(n.Text,{color:"gray-900",children:[e.description,u?`. ${p} `:null]})]}),t||m?i:null]})})},e.role)})})}function ei(e){let{value:s,onChange:t,disableRoles:a}=e,{teamRoles:i}=(0,R.useAvailableRolesInfo)();return(0,l.jsx)(l.Fragment,{children:i.map(e=>{let r=e.role,c=a?.[r]?.disabled,d=a?.[r]?.message,m=s.find(e=>{let l=i.find(l=>l.role===e);return!!l&&l.includedTeamRoles.includes(r)});return(0,l.jsx)(o.Tooltip,{className:"w-full",delayTime:300,disableTriggers:!m,forceHide:!m,position:"left",text:`Already included in the ${m} role.`,children:(0,l.jsx)(h.Checkbox,{checked:!!m||s.includes(r),className:(0,f.clsx)("w-full border-t border-gray-200 px-6 py-3",s.includes(r)&&!m&&"bg-gray-100/50"),disabled:!!m||c,fullWidth:!0,onChange:()=>{s.includes(r)?t(s.filter(e=>e!==r)):t([...s,r])},value:r,children:(0,l.jsxs)("div",{className:"",children:[(0,l.jsx)(n.Text,{weight:500,children:e.label}),(0,l.jsxs)(n.Text,{color:"gray-900",children:[e.description,c?`. ${d} `:null]})]})})},r)})})}function en(e){return e.entitlements?e.entitlements.filter(e=>e.hasDirectAssignation).map(e=>e.entitlement):[]}async function er(e){let{userId:l,teamId:s,existingEntitlements:t,newEntitlements:a}=e,i=a.filter(e=>!t.includes(e)),n=t.filter(e=>!a.includes(e));for(let e of i)await (0,b.fetchAPI)(`${T.API_TEAMS_MEMBERS}/${s}/members/${l}/entitlement?teamId=${s}`,{body:JSON.stringify({entitlement:e}),method:"POST",throwOnHTTPError:!0});for(let e of n)await (0,b.fetchAPI)(`${T.API_TEAMS_MEMBERS}/${s}/members/${l}/entitlement?teamId=${s}`,{body:JSON.stringify({entitlement:e}),method:"DELETE",throwOnHTTPError:!0})}e.s({ProjectAccessBadges:()=>ep},2165676);var eo=e.i(8418504),ec=e.i(6253446),ed=e.i(2240289),em=e.i(3266492);let eu={PROJECT_VIEWER:"Viewer",PROJECT_DEVELOPER:"Developer",ADMIN:"Admin"};function ep(e){let{projectAccess:t,config:i={expanded:!1}}=e,{expanded:r}=i,c=t.projects?t.projects.map(e=>e.id).filter(Boolean):[],{accessGroups:d}=t,m=t.projects?.reduce((e,l)=>{if(!l.id)return e;let s=eu[l.role];return{...e,[l.id]:s}},{}),{data:u,isLoading:p}=(0,ed.useProjects)(c.length?c:[]);if(!c.length&&!d?.length)return null;let h=d?.length??0,g=c.length>4?3:c.length,j=c.length-g+(r?0:h);if(!u&&!h||p)return(0,l.jsxs)(a.Stack,{direction:"row",children:[c.slice(0,g).map(e=>(0,l.jsx)("div",{className:em.default.placeholder},e)),j?(0,l.jsxs)("div",{className:em.default.placeholder,children:["+",j]}):null]});let f=h>1?`${h} access groups`:d?.[0]?.name;return(0,l.jsxs)(l.Fragment,{children:[r&&d?.length?(0,l.jsxs)(a.Stack,{align:"center",className:"tailwind-preflight",direction:"row",gap:.5,children:[(0,l.jsx)(n.Text,{className:"max-w-32 truncate",color:"gray-900",children:f}),(0,l.jsx)(o.Tooltip,{text:(0,l.jsxs)(a.Stack,{gap:1,children:[(0,l.jsx)(n.Text,{align:"left",weight:600,children:"Access Groups"}),d.map(e=>(0,l.jsx)(n.Text,{align:"left",className:"geist-ellipsis",title:e.name,children:e.name},e.name))]}),children:(0,l.jsx)(x.InformationFillSmall,{color:"gray-900",size:16})})]}):null,(0,l.jsx)(o.Tooltip,{text:(0,l.jsxs)(a.Stack,{className:"tailwind-preflight",gap:2,style:{maxHeight:195,overflow:"auto",paddingLeft:1},children:[u?.length?(0,l.jsxs)(a.Stack,{gap:1,children:[(0,l.jsx)(n.Text,{align:"left",weight:600,children:"Project Roles"}),u.map(e=>(0,l.jsx)(s.Fragment,{children:(0,l.jsxs)(a.Stack,{align:"center",direction:"row",gap:2,children:[(0,l.jsx)(ec.ProjectWithDeploymentAvatar,{project:e,size:16}),(0,l.jsx)(n.Text,{align:"left",className:"geist-ellipsis flex-1",title:e.name,children:e.name}),m?.[e.id]?(0,l.jsx)(n.Text,{className:"whitespace-nowrap",children:m[e.id]}):null]})},e.id))]}):null,!r&&d?.length?(0,l.jsxs)(a.Stack,{gap:1,children:[(0,l.jsx)(n.Text,{align:"left",weight:600,children:"Access Groups"}),d.map(e=>(0,l.jsx)(n.Text,{align:"left",className:"geist-ellipsis",title:e.name,children:e.name},e.name))]}):null]}),children:(0,l.jsxs)(a.Stack,{direction:"row",children:[u?.slice(0,g).map(e=>(0,l.jsx)(ec.ProjectWithDeploymentAvatar,{className:em.default.projectAvatar,project:e,size:20,title:e.name},e.id)),j?(0,l.jsx)("div",{className:em.default.placeholder,children:u?`+${j}`:(0,l.jsx)(eo.Users,{className:em.default.placeholderIcon,color:"gray-900",size:12})}):null]})})]})}},[6083766,213266,2165676]]}]);

//# sourceMappingURL=b95987d826476375.js.map
//# debugId=14ab264b-b1c0-549b-8160-833af5dfd000
