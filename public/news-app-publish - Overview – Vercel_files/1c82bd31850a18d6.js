
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="8ccab1ac-3e9d-5862-88bb-4c2ef03dc39f")}catch(e){}}();
(globalThis.TURBOPACK=globalThis.TURBOPACK||[]).push(["object"==typeof document?document.currentScript:void 0,{6788278:e=>{"use strict";e.s({EmailNotificationRule:()=>y});var t=e.i(6645307),a=e.i(6530772),n=e.i(7315479),s=e.i(653558),i=e.i(2733203),l=e.i(1190215),r=e.i(4105925),c=e.i(5163670),o=e.i(3821772),d=e.i(889716),u=e.i(8084653),m=e.i(584439),h=e.i(9948746),x=e.i(4237550),g=e.i(1183506),f=e.i(9336536),j=e.i(5454140),p=e.i(7007071),b=e.i(9443759);function y(e){let{teamId:y,className:v}=e,[N,C]=(0,a.useState)(!1),[S,E]=(0,a.useState)("primary"),{user:w,isLoading:k}=(0,j.useUser)(),{data:T,isLoading:I}=(0,p.useEmailNotifications)();(0,a.useEffect)(()=>{y&&T&&w&&E(T.rules[y]?.email??"primary")},[y,T,w]);let O=async(e,t)=>{E(e),C(!0);try{let t=await (0,g.fetchAPI)(f.API_NOTIFICATION_RULES,{method:"PATCH",body:JSON.stringify({teamId:y,email:e})});if(t.error)throw Error((0,n.normalizeError)(t.error).message);E(e),m.toasts.success({text:"Notification email updated successfully."})}catch(a){E(t);let e=(0,n.normalizeError)(a);m.toasts.error({text:`Failed to update notification email. Error: ${e.message}`})}finally{C(!1)}},P=async e=>{E("primary"),C(!0);try{let e=await (0,g.fetchAPI)(f.API_NOTIFICATION_RULES,{method:"DELETE",body:JSON.stringify({teamId:y})});if(e.error)throw Error((0,n.normalizeError)(e.error).message);m.toasts.success({text:"Notification email updated successfully."})}catch(a){E(e);let t=(0,n.normalizeError)(a);m.toasts.error({text:`Failed to update notification email. Error: ${t.message}`})}finally{C(!1)}},_=w?[w.email,...w.secondaryEmails?.filter(e=>{let{verified:t}=e;return t}).map(e=>{let{email:t}=e;return t})??[]]:[];return(0,t.jsx)(c.Skeleton,{show:!y||k||I,children:(0,t.jsxs)(l.MenuContainer,{children:[(0,t.jsx)(i.MenuButton,{align:"start","aria-label":"Select notification email",className:(0,b.cn)("w-full",v),disabled:N,size:"small",suffix:(0,t.jsx)(d.Stack,{paddingRight:1,children:N?(0,t.jsx)(o.Spinner,{}):(0,t.jsx)(x.ChevronDown,{})}),svgOnly:!0,type:"tertiary",typeName:"button",children:(0,t.jsx)(u.Text,{className:"overflow-hidden text-ellipsis",color:N?"gray-600":void 0,title:w?.email,children:"primary"===S?`Primary Email (${w?.email})`:S})}),(0,t.jsxs)(s.Menu,{style:{minWidth:"320px"},children:[(0,t.jsx)(r.MenuItem,{onClick:()=>void P(S),suffix:"primary"===S?(0,t.jsx)(h.Check,{}):null,children:(0,t.jsxs)(u.Text,{className:"overflow-hidden text-ellipsis text-nowrap",title:w?.email,children:["Primary Email (",w?.email,")"]})},"primary"),_.map(e=>(0,t.jsx)(r.MenuItem,{onClick:()=>void O(e,S),suffix:S===e?(0,t.jsx)(h.Check,{}):null,children:(0,t.jsx)(u.Text,{className:"overflow-hidden text-ellipsis text-nowrap",title:e,children:e})},e))]})]})})}},7135832:e=>{e.v({main:"notifications-module__N9pa2G__main"})},1954505:e=>{"use strict";e.s({TeamNotifications:()=>eh,TeamNotificationsSkeleton:()=>ex},1954505);var t=e.i(6645307),a=e.i(6530772),n=e.i(5535439),s=e.i(5163670),i=e.i(889716),l=e.i(8084653),r=e.i(584439),c=e.i(2362802),o=e.i(1183506),d=e.i(3514588),u=e.i(503726),m=e.i(654868),h=e.i(1060912),x=e.i(2052446),g=e.i(5253502);let f=()=>{let{hasLoaded:e,get:t}=(0,g.useLocalStorageObject)("notifications-dev"),n=(0,a.useMemo)(()=>!!e&&(t("showTestButton")??!1),[e,t]);return{hasLoaded:e,showTestButton:n}};var j=e.i(2687142),p=e.i(2043778),b=e.i(773826),y=e.i(3521787);async function v(e){return Promise.resolve({creditLedgers:[{currency:"managed_infrastructure_units",title:"Managed Infrastructure Units",periodStart:"2024-07-01T00:00:00Z",periodEnd:"2024-10-01T00:00:00Z",total:5e5,used:5e5,remaining:0},{currency:"web_analytics_units",title:"Web Analytics Units",periodStart:"2024-07-01T00:00:00Z",periodEnd:"2024-10-01T00:00:00Z",total:1e5,used:1e4,remaining:9e4},{currency:"developer_experience_units",title:"Developer Experience Units",periodStart:"2024-07-01T00:00:00Z",periodEnd:"2024-10-01T00:00:00Z",total:3e5,used:1e5,remaining:2e5}]})}var N=e.i(9495609),C=e.i(7573892),S=e.i(9802771);let E={email:"Email",in_app_feed:"Web",chat:"Chat",sms:"SMS",push:"Push",http:"Webhook"};function w(e){let{channel:a,isChannelEnabled:n=!0,onToggle:s,savePrefs:i=!0,teamId:l,userId:c}=e,o=(0,x.usePreferences)(),d=o.isChannelEnabled(a)&&n;return(0,t.jsx)(N.Toggle,{checked:d,onChange:()=>{if("function"==typeof s&&s(),i){let e=`${E[a]} notifications ${d?"disabled":"enabled"}`;o.preferenceSet&&(e=`${e} for you on this team`),o.setChannel({channel:a,enabled:!d}).then(()=>{r.toasts.success(e),C.analytics.track(S.AnalyticsEvent.NOTIFICATIONS_PREF_CHANGED,{channel:a,action:d?"disable":"enable",teamId:l??"none",uri:"NONE",category:"NONE",user:c??"none"})}).catch(()=>{r.toasts.error("Error saving change")})}},size:"large"})}e.i(7848711);var k=e.i(6216539),T=e.i(3974870);function I(e){let{name:a,children:n}=e;return(0,t.jsx)(k.EntityHeader,{children:(0,t.jsxs)(T.ChannelStack,{children:[(0,t.jsx)(T.ChannelText,{children:a}),(0,t.jsx)("div",{style:{flexGrow:1}}),n]})})}var O=e.i(5870342),P=e.i(8247297),_=e.i(8934201),M=e.i(5610210),A=e.i(1330899);let F={miuCreditsUsage:"managed_infrastructure_units",devexCreditsUsage:"developer_experience_units"};function L(e){let{name:a,uri:n,upcomingCommitmentUsage:s}=e;if(!s)return null;let i=R(n,s);if(!i)return null;let r=(0,A.calculateCommitmentCadence)({periodStart:new Date(i.periodStart),periodEnd:new Date(i.periodEnd)}),c=(0,A.formatCount)(i.total);return(0,t.jsxs)(l.Text,{className:O.default.entCustomCopy,children:[(0,t.jsxs)(l.Text,{weight:500,children:["Your ",r," commitment is for ",c," ",a,"."]})," ","If your usage exceeds your commitment, you’ll receive an invoice with on-demand charges."]})}function D(e){let{uri:a,upcomingCommitmentUsage:n,percent:s}=e;if(!n)return null;let i=R(a,n);if(!i)return null;let r=i.total,c=r*(Number(s)/100),o=(0,A.formatCount)(r),d=(0,A.formatCount)(c);return(0,t.jsxs)(l.Text,{as:"span",color:"gray-900",weight:500,children:[d," ",(0,t.jsxs)(l.Text,{as:"span",color:"gray-900",weight:400,children:["/ ",o]})]})}function R(e,t){let a=e in F?F[e]:null;if(a)return t.creditLedgers.find(e=>e.currency===a)}let U=e=>{let{active:n,isUnbundledPricingPlan:s,overageSelections:c,setActive:o,setOverageSelections:d,selectedChannel:u,selectedOverageData:m,selectedOverage:g,teamId:f,upcomingCommitmentUsage:j,user:p}=e,b=(0,x.usePreferences)(),[y,v]=(0,a.useState)(m),[N,E]=(0,a.useState)([]),[w,k]=(0,a.useState)([]),T=Object.entries(y),I=g.isEnterpriseOnly;return(0,t.jsxs)(_.Modal.Modal,{active:n,onClickOutside:()=>o(null),children:[(0,t.jsxs)(_.Modal.Body,{children:[(0,t.jsxs)(l.Text,{as:"div",className:O.default.overageTitle,lineHeight:24,size:20,wrap:!0,children:[g.name," Notifications"]}),I?(0,t.jsx)(L,{name:g.name,upcomingCommitmentUsage:j,uri:g.uri}):null,(0,t.jsxs)("div",{children:[(0,t.jsxs)(i.Stack,{className:(0,M.clsx)(O.default.overageRow,O.default.overageRowBorder),direction:"row",justify:"space-between",children:[(0,t.jsxs)(l.Text,{color:"gray-900",weight:500,children:["Notify at:"," "]}),g.hasAdditionalCharge?(0,t.jsx)(l.Text,{color:"gray-900",children:"Additional charge"}):null]}),T.map(e=>{let[a,{checked:n,amount:s}]=e;return(0,t.jsxs)(i.Stack,{className:(0,M.clsx)(O.default.overageRow,O.default.overageRowBorder),direction:"row",justify:"space-between",children:[(0,t.jsx)(P.Checkbox,{checked:n,onChange:()=>{n?(E([...N,a]),w.indexOf(a)>=0&&k(w.filter(e=>e!==a))):(k([...w,a]),N.indexOf(a)>=0&&E(N.filter(e=>e!==a))),v({...y,[a]:{amount:s,checked:!n}})},children:(0,t.jsxs)(i.Stack,{align:"center",direction:"row",children:[(0,t.jsx)(l.Text,{className:O.default.overageNotifyText,weight:500,children:Number.parseInt(a).toLocaleString("en-us",{style:"unit",unit:"percent"})}),I?(0,t.jsx)(D,{percent:a,upcomingCommitmentUsage:j,uri:g.uri}):null]})}),s&&g.hasAdditionalCharge?(0,t.jsxs)(l.Text,{color:"gray-900",children:["$",Math.floor(s).toLocaleString("en-us")]}):null]},a)})]})]}),(0,t.jsxs)(_.Modal.Actions,{children:[(0,t.jsx)(_.Modal.Action,{onClick:()=>o(null),type:"secondary",children:"Cancel"}),(0,t.jsx)(_.Modal.Action,{onClick:()=>{let e=Object.entries(y).reduce((e,t)=>t[1].checked?[...e,Number(t[0])]:e,[]),t=s?h.UNBUNDLED_WORKFLOW_IDS[g.uri]:h.WORKFLOW_IDS[g.uri];b.mutateOveragePreferences({percentages:e,uri:g.uri,channels:[u],workflowId:t}).then(()=>{o(null),d({...c,[`${g.uri}_${u}`]:e}),r.toasts.success({text:"Change saved",preserve:!1}),N.forEach(e=>{C.analytics.track(S.AnalyticsEvent.NOTIFICATIONS_PREF_CHANGED,{channel:u,uri:g.uri,category:g.name,teamId:f??"none",action:"disable",percentage:e,user:p})}),w.forEach(e=>{C.analytics.track(S.AnalyticsEvent.NOTIFICATIONS_PREF_CHANGED,{channel:u,uri:g.uri,category:g.name,teamId:f??"none",action:"enable",percentage:e,user:p})})}).catch(e=>{r.toasts.error(`Error saving change: ${e}`)})},children:"Save changes"})]})]})};var $=e.i(1085429),G=e.i(555528);function B(e){let{text:n,uri:s,channel:i,category:l,onChangeItem:r,teamId:c,tooltip:o,isDisabled:d,workflowId:u,isChecked:m,user:h,hasAdditionalCharge:g,isEnterpriseOnly:f}=e,j=(0,x.usePreferences)(),[p,b]=(0,a.useState)(!1);(0,a.useEffect)(()=>{b(m)},[m]);let y=(0,a.useCallback)(()=>{let e=!p;b(e),r({uri:s,isEnabled:p,channel:i,workflowId:u,preferences:j,name:n,hasAdditionalCharge:g,isEnterpriseOnly:f}),C.analytics.track(S.AnalyticsEvent.NOTIFICATIONS_PREF_CHANGED,{channel:i,uri:s,category:l,teamId:c??"none",user:h,action:e?"enable":"disable"})},[p,r,s,i,u,j,n,l,c,h,g,f]),v=o;return d&&(v=[o,"Cannot disable this notification because it is disabled on all other channels."].filter(Boolean).join(" ")),(0,t.jsxs)("label",{className:O.default.checkboxItem,children:[(0,t.jsx)(P.Checkbox,{checked:p,disabled:d,onChange:y}),(0,t.jsx)(T.ItemText,{children:n}),v?(0,t.jsx)(G.Tooltip,{text:v,children:(0,t.jsx)($.Question,{color:"gray-600"})}):null]})}var H=e.i(5495572),W=e.i(5674541);function z(e){let{channel:n,isOwner:s,isUnbundledPricingPlan:l,setSelectedOverage:r,setSelectedChannel:c,saveDetailPreferenceChange:o,team:d,group:u,overageSelections:m,user:g}=e,f=(0,x.usePreferences)(),j=(0,a.useMemo)(()=>!!m[`${u.uri}_${n}`]&&m[`${u.uri}_${n}`].length>0,[u.uri,n,m]),p=(0,a.useMemo)(()=>"in_app_feed"===n?"email":"in_app_feed",[n]),b=!(0,a.useMemo)(()=>!!m[`${u.uri}_${p}`]&&m[`${u.uri}_${p}`].length>0,[m,u.uri,p])||!f.isChannelEnabled(p),y=s&&j&&b;return d?(0,t.jsxs)(i.Stack,{align:"center",direction:"row",justify:"space-between",children:[(0,t.jsx)(B,{category:u.name,channel:n,hasAdditionalCharge:u.hasAdditionalCharge,isChecked:j,isDisabled:y,onChangeItem:o,teamId:d.id,text:u.name,uri:u.uri,user:g,workflowId:l?h.UNBUNDLED_WORKFLOW_IDS[u.uri]:h.WORKFLOW_IDS[u.uri]}),(0,t.jsx)(W.Button,{"aria-label":`${u.name}-button`,className:O.default.detailPreferenceGearBtn,disabled:y,onClick:()=>{r(u),c(n)},size:"small",style:{width:"32px",padding:"0"},svgOnly:!0,type:"tertiary",children:(0,t.jsx)(H.SettingsGear,{color:"gray-700"})})]},u.name):null}var V=e.i(6788278),K=e.i(8214218),Z=e.i(3585235),q=e.i(6700141),J=e.i(7337588),Y=e.i(2145411),Q=e.i(4085793);function X(){let{team:e,isLoading:n}=(0,d.useTeam)(),{value:s,isReady:o}=(0,q.useEmailNotificationRulesFlag)(),[g,N]=(0,a.useState)(null),[C,S]=(0,a.useState)(""),[E,k]=(0,a.useState)({}),[P,_]=(0,a.useState)(!1),[M,A]=(0,a.useState)(!1),F=(0,x.usePreferences)(),L=(0,a.useRef)(F);(0,a.useEffect)(()=>{L.current=F},[F]);let{can:D,isLoading:R}=(0,Z.default)({teamId:e?.id}),$=(0,u.useAccount)(),G=n||R||F.isLoading||$.isLoading,{hasLoaded:B,showTestButton:H}=f(),W=!$.team||!!(e&&$.teams?.find(t=>t.slug===e.slug)?.membership?.role==="OWNER"),X=(0,a.useMemo)(()=>e?.billing?.plan==="pro",[e?.billing?.plan]),ee=(0,a.useMemo)(()=>e?.billing?.plan==="enterprise",[e?.billing?.plan]),et=(0,a.useMemo)(()=>(0,b.isOnUnbundledPricingPlan)(e),[e]),ea=(0,a.useMemo)(()=>(0,h.createNotificationsView)(D,{team:e,showTestButton:B&&H,usageItemDetails:X,showMonitoring:e?.enabledInvoiceItems?.monitoring?.enabled??!1,isLogDrainsGaEnabled:!!e?.enabledInvoiceItems?.logDrainsUsage,isSpendManagementEnabled:X,isEntUnbundledPricingEnabled:!!(ee&&et),isUnbundledPricingEnabled:!!et}),[D,B,H,X,ee,e,et]),en=(0,a.useCallback)(t=>{let{workflowId:a,uri:n,channel:s,isEnabled:i,preferences:l,name:c,hasAdditionalCharge:o,isEnterpriseOnly:d}=t,u=i?[]:e?.billing?.invoiceItems&&n in h.OVERAGE_TIER_DEFAULTS?h.OVERAGE_TIER_DEFAULTS[n][(0,h.getTierForOverageItem)(e,n)]:h.OVERAGE_DEFAULTS[n];l.mutateOveragePreferences({percentages:u,uri:n,channels:[s],workflowId:a}).then(()=>{i&&r.toasts.success({text:"Change saved. By turning off this toggle, you will no longer receive notifications for any additional charges. Please ensure that you monitor your usage closely to avoid any unexpected charges.",preserve:!0}),u.length>0&&(S(s),N({uri:n,name:c,hasAdditionalCharge:o,isEnterpriseOnly:d})),k({...E,[`${n}_${s}`]:u})}).catch(()=>{r.toasts.error("Error saving change")})},[E,e]),es=(0,a.useMemo)(()=>{if(g?.uri&&e?.billing?.invoiceItems){let t=e.billing.invoiceItems[g.uri],a=(g.uri in h.OVERAGE_TIER_DEFAULTS?h.OVERAGE_TIER_DEFAULTS[g.uri][(0,h.getTierForOverageItem)(e,g.uri)]:h.OVERAGE_DEFAULTS[g.uri]).reduce((e,t)=>({...e,[Number(t)]:{amount:null,checked:!1}}),{}),n=E[`${g.uri}_${C}`]??[];return Object.entries(a).forEach(e=>{let[s]=e,i=Number(s),l=i<100||!t?0:Number(s)/100*t.threshold-t.threshold,r=t?Math.abs(Math.ceil(l/t.batch)*t.price/100):null;n.includes(i)?a[i]={amount:r,checked:!0}:a[i]={amount:r,checked:!1}}),a}return{}},[g?.uri,C,E,e]);(0,a.useEffect)(()=>{!G&&o&&F.setPrefsLoaded()},[F,G,o]),(0,a.useEffect)(()=>{if(!G){let t=(0,K.getOverageCategories)(ea);L.current.getUserData().then(a=>{a?.phone_number&&A(!0);let{overagePreferences:n,requiresUpdate:s}=(0,K.getOveragePreferences)({userData:a??{},categories:t,team:e});k(n),s&&L.current.mutateAllOveragePreferences({overageSelections:n})}).catch(()=>r.toasts.error("Could not load overage data"))}},[$.user?.uid,e,G,g,P]);let ei=(0,p.useCommentsViewEnabled)("enable-comments-notifications-view"),{data:el}=(0,y.default)(()=>e&&e.billing?.plan==="enterprise"&&(0,b.isOnUnbundledPricingPlan)(e)?e.slug:null,v);return(0,t.jsxs)(t.Fragment,{children:[g?(0,t.jsx)(U,{active:!!g,isUnbundledPricingPlan:et,overageSelections:E,selectedChannel:C,selectedOverage:g,selectedOverageData:es,setActive:N,setOverageSelections:k,teamId:e?.id,upcomingCommitmentUsage:el,user:$.user?.uid}):null,P&&!M?(0,t.jsx)(j.default,{onVerified:()=>{L.current.mutateUserPreferences(),A(!0),_(!P)}}):null,K.viewInstances.map(a=>{let{name:n,channel:r}=a,o="sms"===r;if(o&&(!W||($.account?.billing?.plan??"hobby")!=="pro"))return null;let d=o?F.isChannelEnabled(r)&&M:F.isChannelEnabled(r),u="Email"===n||"Web"===n&&ei;return(0,t.jsxs)("section",{className:O.default.section,children:[(0,t.jsxs)(I,{name:n,children:[d?null:(0,t.jsx)(l.Text,{color:"gray-900",style:{marginRight:"calc(var(--geist-space) * 2)"},children:"Notifications Off"}),W?null:(0,t.jsx)(w,{channel:r,teamId:e?.id,userId:$.user?.uid}),W&&o?(0,t.jsx)(w,{channel:r,isChannelEnabled:d,onToggle:()=>{_(!P)},savePrefs:!(!P&&!M),teamId:e?.id,userId:$.user?.uid}):null]}),d?(0,t.jsx)(J.Entity,{children:(0,t.jsxs)(Y.EntityField,{children:["Email"===n&&s?(0,t.jsx)(T.ItemStack,{children:(0,t.jsxs)(i.Stack,{gap:4,children:[(0,t.jsxs)(i.Stack,{align:{lg:"center"},direction:{sm:"column",lg:"row"},gap:{sm:4},justify:"space-between",children:[(0,t.jsxs)(l.Text,{as:"div",children:[(0,t.jsx)(l.Text,{as:"p",weight:600,children:"Default notifications email"}),"Choose where you would like to receive team related notifications."]}),(0,t.jsx)(V.EmailNotificationRule,{teamId:e?.id})]}),(0,t.jsx)(m.default,{margin:0})]})},"email-notification-rules"):null,ea.map(a=>o&&!a.availableOnSMS?null:(0,t.jsxs)(T.ItemStack,{children:[(0,t.jsx)(T.CategoryStack,{children:(0,t.jsx)(T.CategoryText,{className:O.default.categoryName,children:a.name})}),(0,t.jsx)("ul",{className:O.default.checkboxList,children:a.groups.map(n=>!n.availableOnSMS&&o?null:(0,t.jsx)(i.Stack,{className:O.default.rowGroup,children:n.configurable&&!o?(0,t.jsx)(z,{channel:r,group:n,isOwner:W,isUnbundledPricingPlan:et,overageSelections:E,saveDetailPreferenceChange:en,setSelectedChannel:S,setSelectedOverage:N,team:e,user:$.user?.uid},n.name):(0,t.jsx)(Q.CheckboxItem,{category:a.name,channel:r,isOwner:W,teamId:e?.id,text:n.name,uri:n.uri},n.name)},n.name))})]},a.name)),u?(0,t.jsxs)(T.ItemStack,{gap:4,style:{maxWidth:"72ch",margin:"0 var(--geist-space-2x)"},children:[(0,t.jsx)(T.CategoryStack,{children:(0,t.jsx)(T.CategoryText,{children:"Comments"})}),(0,t.jsxs)(l.Text,{color:"gray-900",children:["Comment notifications are configured per Preview. Go to Preferences in the toolbar menu to configure your notifications for that Preview."," ",(0,t.jsx)(c.Link,{href:"/docs/workflow-collaboration/comments/using-comments#manage-notifications",variant:"highlight",children:"More in our Documentation →"})]})]}):null]})}):null]},r)})]})}function ee(){return(0,t.jsxs)("section",{className:O.default.section,children:[(0,t.jsx)(I,{name:(0,t.jsx)(s.Skeleton,{width:120})}),(0,t.jsx)(J.Entity,{children:(0,t.jsxs)(Y.EntityField,{children:[(0,t.jsxs)(T.ItemStack,{children:[(0,t.jsx)(T.CategoryStack,{children:(0,t.jsx)(T.CategoryText,{className:O.default.categoryName,children:(0,t.jsx)(s.Skeleton,{width:120,height:18,boxHeight:24,vcenter:!0})})}),(0,t.jsx)("ul",{className:O.default.checkboxList,children:(0,t.jsx)(i.Stack,{className:O.default.rowGroup,children:(0,t.jsx)(Q.CheckboxItemSkeleton,{})})})]}),(0,t.jsxs)(T.ItemStack,{children:[(0,t.jsx)(T.CategoryStack,{children:(0,t.jsx)(T.CategoryText,{className:O.default.categoryName,children:(0,t.jsx)(s.Skeleton,{width:120,height:18,boxHeight:24,vcenter:!0})})}),(0,t.jsx)("ul",{className:O.default.checkboxList,children:(0,t.jsxs)(i.Stack,{className:O.default.rowGroup,children:[(0,t.jsx)(Q.CheckboxItemSkeleton,{}),(0,t.jsx)(Q.CheckboxItemSkeleton,{}),(0,t.jsx)(Q.CheckboxItemSkeleton,{})]})})]})]})})]})}var et=e.i(6531164),ea=e.i(611347),en=e.i(7238633),es=e.i(631755),ei=e.i(8350390),el=e.i(1755874),er=e.i(1164214);let ec=(0,a.memo)(function(e){let{height:a=79,footerHeight:n=32,noFooter:i,className:l}=e;return(0,t.jsxs)(ea.Fieldset,{className:l,children:[(0,t.jsx)(et.FieldsetContent,{children:(0,t.jsx)(s.Skeleton,{boxHeight:a,width:120})}),!i&&(0,t.jsx)(en.FieldsetFooter,{children:(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{style:{height:4}}),(0,t.jsx)(s.Skeleton,{boxHeight:n-8,width:200}),(0,t.jsx)("div",{style:{height:4}})]})})]})}),eo=(0,a.memo)(function(e){let{disabled:n,onClick:s}=e,{account:l}=(0,u.useAccount)(),[r,c]=(0,a.useState)(""),[o,d]=(0,a.useState)(""),[m,h]=(0,a.useState)("");return l?(0,t.jsxs)(i.Stack,{direction:"column",gap:8,children:[(0,t.jsxs)(ea.Fieldset,{disabled:n,children:[(0,t.jsxs)(et.FieldsetContent,{children:[(0,t.jsx)(el.FieldsetTitle,{children:"Send a Test"}),(0,t.jsx)(ei.FieldsetSubtitle,{children:"Generate and send a test notification to your inbox"})]}),(0,t.jsx)(en.FieldsetFooter,{children:(0,t.jsx)(en.FieldsetFooter.Actions,{children:(0,t.jsx)(W.Button,{"data-testid":(0,er.tid)("notifications","send-test"),onClick:()=>{s()},children:"Send"})})})]}),(0,t.jsxs)(ea.Fieldset,{disabled:n,children:[(0,t.jsxs)(et.FieldsetContent,{children:[(0,t.jsx)(el.FieldsetTitle,{children:"Send a Usage Overage Notification"}),(0,t.jsx)(ei.FieldsetSubtitle,{children:"Generate and send a usage overage notification to your inbox"}),(0,t.jsx)(es.Input,{"aria-labelledby":"workflowId",label:"Enter workflow id",onChange:e=>c(e.target.value),value:r}),(0,t.jsx)(es.Input,{"aria-labelledby":"percent",label:"Enter percent usage",onChange:e=>d(e.target.value),value:o}),(0,t.jsx)(es.Input,{"aria-labelledby":"productKey",label:"Enter product key",onChange:e=>h(e.target.value),value:m})]}),(0,t.jsx)(en.FieldsetFooter,{children:(0,t.jsx)(en.FieldsetFooter.Actions,{children:(0,t.jsx)(W.Button,{"data-testid":(0,er.tid)("notifications","send-overage-test"),onClick:()=>{s(r.length?r:void 0,Number(o),m)},children:"Send"})})})]})]}):(0,t.jsx)(ec,{footerHeight:30,height:38})});var ed=e.i(6514339),eu=e.i(7135832);function em(){let{team:e}=(0,d.useTeam)();return(0,t.jsxs)(i.Stack,{gap:4,children:[(0,t.jsxs)(l.Text,{color:"gray-900",children:["Manage your personal notification settings",e?(0,t.jsxs)("span",{children:[" for the ",e.name," team."]}):null]}),(0,t.jsxs)(l.Text,{color:"gray-900",children:["Read the"," ",(0,t.jsx)(c.Link,{href:"/docs/notifications",target:"_blank",type:"highlight",children:"Notifications documentation"})," ","to learn more."]})]})}function eh(){let e=(0,n.useRouter)(),{team:s,user:i}=(0,u.useAccount)(),{hasLoaded:l,showTestButton:c}=f(),{isLoading:d,state:m}=(0,ed.useNotificationsVisibility)(),h=(0,r.useToasts)(),g=(0,a.useCallback)(async(e,t,a)=>{if(!i||!s)return;let n={tenant:s.id,actor:{id:i.uid,avatar:i.avatar,name:i.username,type:"user"},focus:{id:s.id,slug:s.slug,avatar:s.avatar,type:"team",name:s.name},data:{dry:!1,actionUrl:location.href,sponsored:!0,usagePercent:t??"100",billingPeriodEnd:new Date().toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric"}),usageAmount:"1,002",notificationType:"warning",topProject:null,usageCost:"$40",usageName:a??"Bandwidth",shortUsageName:null,usageType:a??"bandwidth",batchPrice:"$40",batch:"100 GB",billingPlan:"pro",threshold:"1 TB"},workflowId:e};try{await (0,o.fetchAPI)(`/api/notifications?workspaceId=${s.id}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n),throwOnHTTPError:!0}),h.message("Test notification sent")}catch(e){h.error("Failed to send test")}},[s,i,h]);return"limited"!==m&&null!==m||d||e.replace(s?`/${s.slug}/~/settings`:"/account"),(0,t.jsx)("main",{className:eu.default.main,children:(0,t.jsxs)(x.PreferencesProvider,{defaultLoaded:!1,fallback:(0,t.jsx)(ex,{}),children:[(0,t.jsx)("section",{children:(0,t.jsx)(em,{})}),(0,t.jsx)(X,{}),l&&c?(0,t.jsx)("section",{children:(0,t.jsx)(eo,{onClick:g})}):null]})})}function ex(){return(0,t.jsxs)("main",{className:eu.default.main,children:[(0,t.jsx)("section",{children:(0,t.jsxs)(i.Stack,{gap:4,children:[(0,t.jsx)(s.Skeleton,{width:250,height:16,boxHeight:20,vcenter:!0}),(0,t.jsx)(s.Skeleton,{width:200,height:16,boxHeight:20,vcenter:!0})]})}),(0,t.jsx)(ee,{})]})}},5768110:e=>{"use strict";e.s({NotificationSettings:()=>ei},5768110);var t=e.i(6645307),a=e.i(6530772),n=e.i(8158100),s=e.i(5163670),i=e.i(2362802),l=e.i(2052446),r=e.i(6700141),c=e.i(3585235),o=e.i(4717455),d=e.i(5674541),u=e.i(9495609),m=e.i(3863591),h=e.i(9469765),x=e.i(5049863),g=e.i(5495572),f=e.i(503726),j=e.i(6788278),p=e.i(5526737),b=e.i(2687142),y=e.i(584439),v=e.i(7573892),N=e.i(9802771),C=e.i(8214218);function S(e){let{channel:a,teamId:n,userId:s,onChange:i,...r}=e,c=(0,l.usePreferences)();async function o(e){try{await c.setChannel({channel:a,enabled:e}),i?.(e);let t=C.viewInstances.find(e=>e.channel===a)?.name,l=`${t} notifications ${e?"enabled":"disabled"}`;c.preferenceSet&&(l=`${l} for you on this team`),y.toasts.success(l),v.analytics.track(N.AnalyticsEvent.NOTIFICATIONS_PREF_CHANGED,{channel:a,action:e?"enable":"disable",teamId:n,uri:"NONE",category:"NONE",user:s??"none"})}catch(e){y.toasts.error("Error saving change")}}return(0,t.jsx)(u.Toggle,{checked:c.isChannelEnabled(a),onChange:o,...r})}var E=e.i(4374461),w=e.i(1183506),k=e.i(6649026);function T(e){return(0,C.getPreferenceSettingValue)({setting:e?.workflows?.["daily-usage-overage-summary"],channel:"email"})?"daily":"weekly"}function I(e){let{team:t}=e;return(0,E.default)("/v1/notifications/preferences",async(e,a)=>{let{arg:n}=a;return await (0,w.fetchAPI)(`${e}${(0,k.encode)({teamId:t.id})}`,{method:"PUT",body:{cadence:n.cadence},throwOnHTTPError:!0})})}function O(e){let{team:n,isNotificationRulesFlagEnabled:s}=e,r=(0,l.usePreferences)(),c=(0,f.useAccount)(),[o,u]=(0,a.useState)(!1),y=r.userPreferences.phone_number,{trigger:v}=I({team:n});return(0,t.jsx)("div",{className:"material-base flex flex-col gap-4 px-5 py-4",children:(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("div",{className:"flex flex-1 items-center gap-3",children:[(0,t.jsx)(M,{children:(0,t.jsx)(x.Bell,{})}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("p",{className:"text-label-14 m-0 p-0 font-medium",children:"Web"}),(0,t.jsx)("p",{className:"text-copy-14 m-0 p-0",children:"Receive notifications in the Vercel dashboard."})]})]}),(0,t.jsx)("div",{className:"ml-auto flex items-center gap-2",children:(0,t.jsx)(S,{className:"p-0",channel:"in_app_feed",teamId:n.id,userId:c.user?.uid,size:"large"})})]}),(0,t.jsx)("hr",{className:"m-0 h-0 border-b border-t-0 border-gray-200 p-0"}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("div",{className:"flex min-w-0 items-center gap-3",children:[(0,t.jsx)(M,{children:(0,t.jsx)(m.Email,{})}),(0,t.jsxs)("div",{className:"flex min-w-0 flex-col",children:[(0,t.jsx)("p",{className:"text-label-14 m-0 p-0 font-medium",children:"Email"}),s?(0,t.jsx)("div",{className:"relative -left-1",children:(0,t.jsx)(j.EmailNotificationRule,{teamId:n.id,className:"!h-[20px] !px-0 [&>span]:pl-1 [&>span]:pr-0"})}):c.user?.email]})]}),(0,t.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[(0,t.jsx)(i.ButtonLink,{"aria-label":"Edit email",href:"/account/settings#email",type:"tertiary",shape:"square",svgOnly:!0,size:"small",className:"shrink-0",children:(0,t.jsx)(g.SettingsGear,{})}),(0,t.jsx)(S,{className:"p-0",channel:"email",teamId:n.id,userId:c.user?.uid,size:"large",onChange:e=>{let t=null;e&&(t=T(r.preferences)),v({cadence:t})}})]})]}),(0,t.jsx)("hr",{className:"m-0 h-0 border-b border-t-0 border-gray-200 p-0"}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(M,{children:(0,t.jsx)(h.Phone,{})}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("p",{className:"text-label-14 m-0 p-0 font-medium",children:"Phone"}),(0,t.jsx)("div",{className:"flex items-center gap-2",children:y?(0,t.jsx)(p.default,{autoHideDialCode:!0,disabled:!0,format:!0,formatOnInit:!0,nationalMode:!1,onPhoneNumberChange:()=>{},onSelectFlag:()=>{},useMobileFullscreenDropdown:!0,placeholder:"No phone number set",value:y,flagClassName:"!w-[20px]",inputWrapperClassName:"!shadow-none",inputClassName:"!text-gray-1000 ![-webkit-text-fill-color:unset] !bg-transparent !h-[20px] !pl-[28px]"}):(0,t.jsx)("p",{className:"text-copy-14 m-0 p-0 text-gray-700",children:"No phone number."})})]})]}),(0,t.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[(0,t.jsx)(d.Button,{"aria-label":"Edit phone",onClick:()=>u(!0),type:"tertiary",shape:"square",svgOnly:!0,size:"small",className:"shrink-0",children:(0,t.jsx)(g.SettingsGear,{})}),(0,t.jsx)(S,{className:"ml-auto p-0",channel:"sms",teamId:n.id,userId:c.user?.uid,onMouseDown:e=>{y||(e.preventDefault(),u(!0))},size:"large"})]})]}),o?(0,t.jsx)(b.default,{onClose:()=>{u(!1)},onVerified:()=>{r.mutateUserPreferences(),u(!1)}}):null]})})}function P(){return(0,t.jsxs)("div",{className:"material-base flex flex-col gap-4 px-5 py-4",children:[(0,t.jsx)(_,{}),(0,t.jsx)("hr",{className:"m-0 h-0 border-b border-t-0 border-gray-200 p-0"}),(0,t.jsx)(_,{}),(0,t.jsx)("hr",{className:"m-0 h-0 border-b border-t-0 border-gray-200 p-0"}),(0,t.jsx)(_,{})]})}function _(){return(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("div",{className:"flex flex-1 items-center gap-3",children:[(0,t.jsx)(s.Skeleton,{width:32,height:32,className:"shrink-0",rounded:!0}),(0,t.jsxs)("div",{className:"flex flex-1 flex-col",children:[(0,t.jsx)(s.Skeleton,{width:60,height:18,boxHeight:20,vcenter:!0}),(0,t.jsx)(s.Skeleton,{width:"80%",className:"md:max-w-[300px]",height:18,boxHeight:20,vcenter:!0})]})]}),(0,t.jsx)("div",{className:"ml-auto flex items-center gap-2",children:(0,t.jsx)(u.Toggle,{checked:!1,className:"ml-auto p-0",disabled:!0,size:"large"})})]})}function M(e){let{children:a}=e;return(0,t.jsx)("span",{className:"hidden size-[32px] items-center justify-center rounded-full border border-solid border-gray-alpha-400 bg-gray-100 p-1 md:flex",children:a})}var A=e.i(8247297),F=e.i(204269),L=e.i(9542446),D=e.i(1190215),R=e.i(2733203),U=e.i(653558),$=e.i(4105925),G=e.i(9948746),B=e.i(1060912);function H(e){let{group:t,channels:n}=e,s=(0,l.usePreferences)();return(0,a.useCallback)(async e=>{try{await s.mutateOveragePreferences({percentages:e,uri:t.uri,channels:n,workflowId:B.UNBUNDLED_WORKFLOW_IDS[t.uri]});let a=n.some(e=>s.isGroupEnabled(t.uri,e));0===e.length?await s.setGroup({uri:t.uri,channels:n,enabled:!1}):a||await s.setGroup({uri:t.uri,channels:n.filter(e=>"sms"!==e||!!s.userPreferences.phone_number),enabled:!0}),y.toasts.success({text:"Change saved",preserve:!1})}catch(e){y.toasts.error(`Error saving change: ${e.message}`)}},[s,t,n])}function W(e){let{group:a,channels:n,value:s,invoiceItem:i}=e,l=function(e){let t=B.OVERAGE_DEFAULTS[e.uri];return t?{label:"Notify at",options:t.map(e=>({name:`${e}%`,value:e})),multiSelect:!0}:null}(a),r=H({group:a,channels:n});return l?(0,t.jsxs)(D.MenuContainer,{closeOnSelect:!1,children:[(0,t.jsx)(R.MenuButton,{"aria-label":"Preferences",type:"tertiary",shape:"square",svgOnly:!0,size:"tiny",children:(0,t.jsx)(g.SettingsGear,{})}),(0,t.jsxs)(U.Menu,{className:"min-w-[200px]",children:[l.label?(0,t.jsx)($.MenuItem,{className:"text-gray-900",disabled:!0,children:l.label}):null,l.options.map(e=>{let a=(0,C.getAmountForOveragePercent)({invoiceItem:i,percent:e.value});return(0,t.jsx)($.MenuItem,{onClick:()=>{s.includes(e.value)?r(s.filter(t=>t!==e.value)):r([...s,e.value])},children:(0,t.jsxs)("div",{className:"flex w-full items-center justify-between gap-3",children:[(0,t.jsx)("div",{className:"text-label-13 flex-1",children:e.name}),a?(0,t.jsxs)("div",{className:"text-label-13 text-gray-700",children:["$",a]}):null,s.includes(e.value)?(0,t.jsx)(G.Check,{}):null]})},e.value)})]})]}):null}function z(e){let{group:a,channels:n,defaultValue:s,onChange:i}=e,r=(0,l.usePreferences)(),{workflowIds:c=[]}=a,o=s;for(let e of c)if(n.some(t=>(0,C.getPreferenceSettingValue)({setting:r.preferences?.workflows?.[e],channel:t}))){o=e;break}async function d(e){try{let t={};for(let a of c)for(let s of n)t[a]={channel_types:{[s]:e===a}};if(!r.preferences)return;let{preferences:s}=r;await r.setPreferences({preferences:{...s,categories:{...s.categories,[a.uri]:{channel_types:{email:!0}}},workflows:{...s.workflows,...t}}}),i?.(e),y.toasts.success({text:"Change saved",preserve:!1})}catch(e){y.toasts.error(`Error saving change: ${e.message}`)}}return(0,t.jsxs)(D.MenuContainer,{closeOnSelect:!0,children:[(0,t.jsx)(R.MenuButton,{"aria-label":"Preferences",type:"tertiary",shape:"square",svgOnly:!0,size:"tiny",children:(0,t.jsx)(g.SettingsGear,{})}),(0,t.jsx)(U.Menu,{children:c.map(e=>(0,t.jsx)($.MenuItem,{onClick:()=>{d(e)},children:(0,t.jsxs)("div",{className:"text-label-13 flex w-full items-center justify-between gap-3",children:[(0,B.getWorkflowIdDisplayName)(e),o===e?(0,t.jsx)(G.Check,{}):null]})},e))})]})}function V(e){let{uri:a,channel:n,category:s,teamId:i,onChange:r,...c}=e,o=(0,l.usePreferences)(),d=o.isGroupEnabled(a,n),u=!o.isChannelEnabled(n)||"spendManagement"===a&&!o.activeBudget;return(0,t.jsx)(A.Checkbox,{checked:d,disabled:u,onChange:function(e){(0,C.savePreferenceChange)(s,n,d,a,o,i),r?.(e)},...c})}var K=e.i(773826);let Z={Usage:6,Team:5,Deployments:4,Domains:3,Integrations:2,"Edge Config":1};function q(e){let{team:t,usageSummaryEmailsEnabled:n}=e,{can:s,isLoading:i}=(0,c.default)({teamId:t.id}),l=t.billing?.plan==="pro";return{isLoading:i,preferenceItems:(0,a.useMemo)(()=>{let e=(0,B.createNotificationsView)(s,{team:t,showTestButton:!1,usageItemDetails:l,showMonitoring:t.enabledInvoiceItems?.monitoring?.enabled??!1,isLogDrainsGaEnabled:!!t.enabledInvoiceItems?.logDrainsUsage,isSpendManagementEnabled:l,isEntUnbundledPricingEnabled:!!(t.billing?.plan==="enterprise"&&(0,K.isOnUnbundledPricingPlan)(t)),isUnbundledPricingEnabled:(0,K.isOnUnbundledPricingPlan)(t),usageSummaryEmailsEnabled:n});return n?e.sort((e,t)=>Z[t.name]-Z[e.name]):e},[s,t,l,n])}}var J=e.i(6192985);let Y=[50,75,100];function Q(e){let{group:a,channels:n,value:s}=e,r=(0,l.usePreferences)(),c=(0,L.useLink)(),o=H({group:a,channels:n});return(0,t.jsxs)(D.MenuContainer,{closeOnSelect:!1,children:[(0,t.jsx)(R.MenuButton,{"aria-label":"Preferences",type:"tertiary",shape:"square",svgOnly:!0,size:"tiny",children:(0,t.jsx)(g.SettingsGear,{})}),(0,t.jsxs)(U.Menu,{className:"min-w-[275px] [&>li:first-child]:h-[60px]",children:[(0,t.jsx)($.MenuItem,{children:(0,t.jsxs)(i.Link,{className:"flex flex-col gap-1",href:c("/[teamSlug]/~/settings/billing#spend-management"),children:[(0,t.jsxs)("div",{className:"text-label-14 font-medium",children:["Spend Management is"," ",r.activeBudget?"enabled":"disabled"]}),(0,t.jsx)("div",{className:"text-label-13 text-gray-900",children:"Manage it in the team's billing settings"})]})}),(0,t.jsx)(J.MenuDivider,{}),(0,t.jsx)($.MenuItem,{className:"text-gray-900",disabled:!0,children:"Notify at"}),Y.map(e=>(0,t.jsx)($.MenuItem,{onClick:()=>{s.includes(e)?o(s.filter(t=>t!==e)):o([...s,e])},children:(0,t.jsxs)("div",{className:"flex w-full items-center justify-between gap-3",children:[(0,t.jsxs)("div",{className:"text-label-13 flex-1",children:[e,"%"]}),s.includes(e)?(0,t.jsx)(G.Check,{}):null]})},e))]})]})}let X={sms:3,in_app_feed:2,email:1};function ee(e){let{team:n,usageSummaryEmailsEnabled:s}=e,i=(0,l.usePreferences)();(0,L.useLink)();let[r,c]=(0,a.useState)(!1);(0,f.useAccount)();let o=!!i.userPreferences.phone_number,d=n.billing?.plan==="pro";C.viewInstances.filter(e=>{let{channel:t}=e;return!!d||"sms"!==t}).sort((e,t)=>X[t.channel]-X[e.channel]);let{isLoading:u,preferenceItems:m}=q({team:n,usageSummaryEmailsEnabled:s}),{trigger:h}=I({team:n}),x=u||i.isLoading;(0,a.useEffect)(()=>{x||i.setPrefsLoaded()},[i,x]);let{overagePreferences:g}=(0,a.useMemo)(()=>{let e=(0,C.getOverageCategories)(m);return(0,C.getOveragePreferences)({userData:i.userPreferences,categories:e,team:n})},[m,i,n]);return(0,t.jsx)("div",{className:"flex flex-col gap-6",children:m.map(e=>{let a=e.availableOnSMS&&e.groups.some(e=>e.availableOnSMS);return(0,t.jsxs)(F.TableRoot,{className:"text-foreground [&_tbody[aria-hidden]]:hidden first:[&_td]:pl-0 first:[&_th]:pl-0",children:[(0,t.jsxs)(F.TableColgroup,{children:[(0,t.jsx)(F.TableCol,{className:"flex-1"}),a?(0,t.jsx)(F.TableCol,{className:"w-[50px]"}):null,(0,t.jsx)(F.TableCol,{className:"w-[50px]"}),(0,t.jsx)(F.TableCol,{className:"w-[50px]"})]}),(0,t.jsx)(F.TableHeader,{children:(0,t.jsxs)(F.TableRow,{children:[(0,t.jsx)(F.TableHead,{children:e.name}),a?(0,t.jsx)(F.TableHead,{children:"SMS"}):null,(0,t.jsx)(F.TableHead,{children:"Web"}),(0,t.jsx)(F.TableHead,{children:"Email"})]})}),(0,t.jsx)(F.TableBody,{bordered:!0,children:e.groups.map(a=>(0,t.jsxs)(F.TableRow,{className:"",children:[(0,t.jsx)(F.TableCell,{children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[a.name,"spendManagement"!==a.uri||i.activeBudget?null:" (Disabled)",a.description?(0,t.jsx)("div",{className:"text-copy-13 text-gray-900",children:a.description}):null]}),a.configurable?"usage-overage-summary"===a.uri?(0,t.jsx)(z,{group:a,channels:["email"],defaultValue:"weekly-usage-overage-summary",onChange:e=>{h({cadence:"daily-usage-overage-summary"===e?"daily":"weekly"})}}):"spendManagement"===a.uri?(0,t.jsx)(Q,{group:a,channels:C.allChannels,value:(0,C.getMergedOveragePreference)(g,a)}):(0,t.jsx)(W,{group:a,channels:a.availableOnSMS?C.allChannels:C.allChannels.filter(e=>"sms"!==e),value:(0,C.getMergedOveragePreference)(g,a),invoiceItem:n.billing?.invoiceItems?.[a.uri]}):null]})}),function(e){let{view:a,group:s}=e;return a.availableOnSMS&&a.groups.some(e=>e.availableOnSMS)?s.availableOnSMS&&o?(0,t.jsx)(F.TableCell,{className:"text-center",children:(0,t.jsx)(V,{className:"flex items-center justify-center p-0",category:a.name,channel:"sms",teamId:n.id,uri:s.uri})}):s.availableOnSMS&&!o?(0,t.jsxs)(F.TableCell,{className:"text-center",children:[(0,t.jsx)(A.Checkbox,{checked:!1,readOnly:!0,onClick:()=>{c(!0)}}),r?(0,t.jsx)(b.default,{onClose:()=>{c(!1)},onVerified:()=>{(0,C.savePreferenceChange)(a.name,"sms",!1,s.uri,i,n.id),i.mutateUserPreferences(),c(!r)}}):null]}):(0,t.jsx)(F.TableCell,{}):null}({view:e,group:a}),(0,t.jsx)(F.TableCell,{className:"text-center",children:"usage-overage-summary"!==a.uri?(0,t.jsx)(V,{className:"flex items-center justify-center p-0",category:e.name,channel:"in_app_feed",teamId:n.id,uri:a.uri}):null}),(0,t.jsx)(F.TableCell,{className:"!text-center",children:(0,t.jsx)(V,{className:"flex items-center justify-center p-0",category:e.name,channel:"email",teamId:n.id,uri:a.uri,onChange:e=>{if("usage-overage-summary"===a.uri){let t=null;e.target.checked&&(t=T(i.preferences)),h({cadence:t})}}})})]},a.name))})]},e.name)})})}function et(){return(0,t.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,t.jsx)(ea,{items:1}),(0,t.jsx)(ea,{items:1}),(0,t.jsx)(ea,{items:3})]})}function ea(e){let{items:a}=e;return(0,t.jsxs)(F.TableRoot,{className:"text-foreground [&_tbody[aria-hidden]]:hidden",children:[(0,t.jsxs)(F.TableColgroup,{children:[(0,t.jsx)(F.TableCol,{className:"flex-1"}),(0,t.jsx)(F.TableCol,{className:"w-[50px]"}),(0,t.jsx)(F.TableCol,{className:"w-[50px]"})]}),(0,t.jsx)(F.TableHeader,{children:(0,t.jsxs)(F.TableRow,{children:[(0,t.jsx)(F.TableHead,{children:(0,t.jsx)(s.Skeleton,{width:80,height:16,boxHeight:20,vcenter:!0})}),(0,t.jsx)(F.TableHead,{children:"Web"}),(0,t.jsx)(F.TableHead,{children:"Email"})]})}),(0,t.jsx)(F.TableBody,{bordered:!0,children:Array(a).fill(null).map((e,a)=>(0,t.jsx)(en,{},a))})]})}function en(){return(0,t.jsxs)(F.TableRow,{children:[(0,t.jsx)(F.TableCell,{children:(0,t.jsx)(s.Skeleton,{width:120,height:16,boxHeight:20,vcenter:!0})}),(0,t.jsx)(F.TableCell,{className:"text-center",children:(0,t.jsx)(s.Skeleton,{width:20,height:20,vcenter:!0,className:"mx-auto"})}),(0,t.jsx)(F.TableCell,{className:"text-center",children:(0,t.jsx)(s.Skeleton,{width:20,height:20,vcenter:!0,className:"mx-auto"})})]})}var es=e.i(9242048);function ei(e){let{teamSlug:a,usageSummaryEmailsEnabled:n}=e;return(0,t.jsx)(l.PreferencesProvider,{defaultLoaded:!1,fallback:(0,t.jsx)(er,{}),children:(0,t.jsx)(el,{teamSlug:a,usageSummaryEmailsEnabled:n})})}function el(e){let{teamSlug:s,usageSummaryEmailsEnabled:d}=e,{data:u}=(0,o.useTeam)(s),m=(0,l.usePreferences)();!function(e){let{team:t,usageSummaryEmailsEnabled:n}=e,s=(0,l.usePreferences)(),i=(0,a.useRef)(null),{preferenceItems:r}=q({team:t,usageSummaryEmailsEnabled:n});(0,es.default)("unsubscribe",async e=>{i.current=e}),(0,a.useEffect)(()=>{!async function(){let e=i.current;if(e&&!s.isLoading&&(i.current=null,s.isGroupEnabled(e,"email"))){let t=r.flatMap(e=>e.groups).find(t=>t.uri===e),a=t?.name??e;try{await s.setGroup({uri:e,channels:["email"],enabled:!1}),y.toasts.success(`You have been unsubscribed from ${a}.`)}catch(e){y.toasts.error(`Error unsubscribing from ${a}.`)}}}()},[s,t,n,r])}({team:u,usageSummaryEmailsEnabled:d});let{value:h,isReady:x}=(0,r.useEmailNotificationRulesFlag)(),{isLoading:g}=(0,c.default)({teamId:u.id}),f=m.isLoading||g||!x;return(0,a.useEffect)(()=>{f||m.setPrefsLoaded()},[m,f]),(0,t.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)("h3",{className:"text-heading-24 m-0 p-0",children:"Notifications"}),(0,t.jsxs)("p",{className:"text-label-14 m-0 p-0",children:["Manage your personal notification settings for the ",u.name," team."]})]}),(0,t.jsx)(O,{team:u,isNotificationRulesFlagEnabled:h}),(0,t.jsx)(ee,{team:u,usageSummaryEmailsEnabled:d}),(0,t.jsxs)(n.Note,{fill:!0,type:"secondary",children:["Comment notifications are managed per deployment, change your preference via the toolbar menu."," ",(0,t.jsx)(i.Link,{external:!0,icon:!1,href:"https://vercel.com/docs/workflow-collaboration/comments/using-comments#manage-notifications",children:"Learn More →"})]})]})}function er(){return(0,t.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)("h3",{className:"text-heading-24 m-0 p-0",children:"Notifications"}),(0,t.jsx)(s.Skeleton,{width:250,height:16,boxHeight:20,vcenter:!0})]}),(0,t.jsx)(P,{}),(0,t.jsx)(et,{})]})}}}]);

//# sourceMappingURL=ff2eb435a5c6547c.js.map
//# debugId=8ccab1ac-3e9d-5862-88bb-4c2ef03dc39f
