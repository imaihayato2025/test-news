
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="11f7ee82-0772-5c29-ac75-6fbbb3f97278")}catch(e){}}();
(globalThis.TURBOPACK=globalThis.TURBOPACK||[]).push(["object"==typeof document?document.currentScript:void 0,{7883155:[e=>{"use strict";e.s({useChat:()=>tg},7883155);var t,r,a,s,o,i,n,l,c,u,d,p,h,g,m,v,f,b,y,E,I,w,S,T,A,_=e.i(6530772);e.s({AbstractChat:()=>ti,DefaultChatTransport:()=>ts,callCompletionApi:()=>tt,isDeepEqualData:()=>function e(t,r){if(t===r)return!0;if(null==t||null==r)return!1;if("object"!=typeof t&&"object"!=typeof r)return t===r;if(t.constructor!==r.constructor)return!1;if(t instanceof Date&&r instanceof Date)return t.getTime()===r.getTime();if(Array.isArray(t)){if(t.length!==r.length)return!1;for(let a=0;a<t.length;a++)if(!e(t[a],r[a]))return!1;return!0}let a=Object.keys(t),s=Object.keys(r);if(a.length!==s.length)return!1;for(let o of a)if(!s.includes(o)||!e(t[o],r[o]))return!1;return!0},isToolUIPart:()=>eK,parsePartialJson:()=>eU},7356923);var R=e.i(436272),x=e.i(7936346);e.i(1361258);var k=e.i(5751665),k=k,M=e.i(6615754),C=e.i(442955),k=k,j=Symbol.for("vercel.ai.gateway.error"),O=class e extends(r=Error,t=j,r){constructor({message:e,statusCode:r=500,cause:a}){super(e),this[t]=!0,this.statusCode=r,this.cause=a}static isInstance(t){return e.hasMarker(t)}static hasMarker(e){return"object"==typeof e&&null!==e&&j in e&&!0===e[j]}},N="GatewayAuthenticationError",D=Symbol.for(`vercel.ai.gateway.error.${N}`),P=class e extends(s=O,a=D,s){constructor({message:e="Authentication failed",statusCode:t=401,cause:r}={}){super({message:e,statusCode:t,cause:r}),this[a]=!0,this.name=N,this.type="authentication_error"}static isInstance(e){return O.hasMarker(e)&&D in e}static createContextualError(t){let{apiKeyProvided:r,oidcTokenProvided:a,message:s="Authentication failed",statusCode:o=401,cause:i}=t;return new e({message:r?`AI Gateway authentication failed: Invalid API key provided.

The token is expected to be provided via the 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.`:a?`AI Gateway authentication failed: Invalid OIDC token provided.

The token is expected to be provided via the 'VERCEL_OIDC_TOKEN' environment variable. It expires every 12 hours.
- make sure your Vercel project settings have OIDC enabled
- if running locally with 'vercel dev', the token is automatically obtained and refreshed
- if running locally with your own dev server, run 'vercel env pull' to fetch the token
- in production/preview, the token is automatically obtained and refreshed

Alternative: Provide an API key via 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.`:`AI Gateway authentication failed: No authentication provided.

Provide either an API key or OIDC token.

API key instructions:

The token is expected to be provided via the 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.

OIDC token instructions:

The token is expected to be provided via the 'VERCEL_OIDC_TOKEN' environment variable. It expires every 12 hours.
- make sure your Vercel project settings have OIDC enabled
- if running locally with 'vercel dev', the token is automatically obtained and refreshed
- if running locally with your own dev server, run 'vercel env pull' to fetch the token
- in production/preview, the token is automatically obtained and refreshed`,statusCode:o,cause:i})}},F="GatewayInvalidRequestError",L=Symbol.for(`vercel.ai.gateway.error.${F}`),U=class extends(i=O,o=L,i){constructor({message:e="Invalid request",statusCode:t=400,cause:r}={}){super({message:e,statusCode:t,cause:r}),this[o]=!0,this.name=F,this.type="invalid_request_error"}static isInstance(e){return O.hasMarker(e)&&L in e}},K="GatewayRateLimitError",B=Symbol.for(`vercel.ai.gateway.error.${K}`),J=class extends(l=O,n=B,l){constructor({message:e="Rate limit exceeded",statusCode:t=429,cause:r}={}){super({message:e,statusCode:t,cause:r}),this[n]=!0,this.name=K,this.type="rate_limit_exceeded"}static isInstance(e){return O.hasMarker(e)&&B in e}},V="GatewayModelNotFoundError",G=Symbol.for(`vercel.ai.gateway.error.${V}`),q=k.object({modelId:k.string()}),Y=class extends(u=O,c=G,u){constructor({message:e="Model not found",statusCode:t=404,modelId:r,cause:a}={}){super({message:e,statusCode:t,cause:a}),this[c]=!0,this.name=V,this.type="model_not_found",this.modelId=r}static isInstance(e){return O.hasMarker(e)&&G in e}},W="GatewayInternalServerError",$=Symbol.for(`vercel.ai.gateway.error.${W}`),H=class extends(p=O,d=$,p){constructor({message:e="Internal server error",statusCode:t=500,cause:r}={}){super({message:e,statusCode:t,cause:r}),this[d]=!0,this.name=W,this.type="internal_server_error"}static isInstance(e){return O.hasMarker(e)&&$ in e}},z="GatewayResponseError",Q=Symbol.for(`vercel.ai.gateway.error.${z}`),X=class extends(g=O,h=Q,g){constructor({message:e="Invalid response from Gateway",statusCode:t=502,response:r,validationError:a,cause:s}={}){super({message:e,statusCode:t,cause:s}),this[h]=!0,this.name=z,this.type="response_error",this.response=r,this.validationError=a}static isInstance(e){return O.hasMarker(e)&&Q in e}};function Z(e){let{response:t,statusCode:r,defaultMessage:a="Gateway request failed",cause:s,authMethod:o}=e,i=ee.safeParse(t);if(!i.success)return new X({message:`Invalid error response format: ${a}`,statusCode:r,response:t,validationError:i.error,cause:s});let n=i.data,l=n.error.type,c=n.error.message;switch(l){case"authentication_error":return P.createContextualError({apiKeyProvided:"api-key"===o,oidcTokenProvided:"oidc"===o,statusCode:r,cause:s});case"invalid_request_error":return new U({message:c,statusCode:r,cause:s});case"rate_limit_exceeded":return new J({message:c,statusCode:r,cause:s});case"model_not_found":{let e=q.safeParse(n.error.param);return new Y({message:c,statusCode:r,modelId:e.success?e.data.modelId:void 0,cause:s})}default:return new H({message:c,statusCode:r,cause:s})}}var ee=k.object({error:k.object({message:k.string(),type:k.string().nullish(),param:k.unknown().nullish(),code:k.union([k.string(),k.number()]).nullish()})});function et(e,t){var r;return O.isInstance(e)?e:x.APICallError.isInstance(e)?Z({response:function(e){if(void 0!==e.data)return e.data;if(null!=e.responseBody)try{return JSON.parse(e.responseBody)}catch(t){return e.responseBody}return{}}(e),statusCode:null!=(r=e.statusCode)?r:500,defaultMessage:"Gateway request failed",cause:e,authMethod:t}):Z({response:{},statusCode:500,defaultMessage:e instanceof Error?`Gateway request failed: ${e.message}`:"Unknown Gateway error",cause:e,authMethod:t})}var er="x-ai-gateway-auth-method";function ea(e){let t=es.safeParse(e[er]);return t.success?t.data:void 0}var es=k.union([k.literal("api-key"),k.literal("oidc")]),eo=class{constructor(e){this.config=e}async getAvailableModels(){try{let{value:e}=await (0,R.getFromApi)({url:`${this.config.baseURL}/config`,headers:await (0,R.resolve)(this.config.headers()),successfulResponseHandler:(0,R.createJsonResponseHandler)(ec),failedResponseHandler:(0,R.createJsonErrorResponseHandler)({errorSchema:k.any(),errorToMessage:e=>e}),fetch:this.config.fetch});return e}catch(e){throw et(e)}}},ei=k.object({specificationVersion:k.literal("v2"),provider:k.string(),modelId:k.string()}),en=k.object({input:k.string(),output:k.string()}),el=k.object({id:k.string(),name:k.string(),description:k.string().nullish(),pricing:en.nullish(),specification:ei}),ec=k.object({models:k.array(el)}),eu=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v2",this.supportedUrls={"*/*":[/.*/]}}get provider(){return this.config.provider}async doGenerate(e){let{abortSignal:t,...r}=e,a=await (0,R.resolve)(this.config.headers());try{let{responseHeaders:s,value:o,rawValue:i}=await (0,R.postJsonToApi)({url:this.getUrl(),headers:(0,R.combineHeaders)(a,e.headers,this.getModelConfigHeaders(this.modelId,!1),await (0,R.resolve)(this.config.o11yHeaders)),body:this.maybeEncodeFileParts(r),successfulResponseHandler:(0,R.createJsonResponseHandler)(k.any()),failedResponseHandler:(0,R.createJsonErrorResponseHandler)({errorSchema:k.any(),errorToMessage:e=>e}),...t&&{abortSignal:t},fetch:this.config.fetch});return{...o,request:{body:r},response:{headers:s,body:i},warnings:[]}}catch(e){throw et(e,ea(a))}}async doStream(e){let{abortSignal:t,...r}=e,a=await (0,R.resolve)(this.config.headers());try{let{value:s,responseHeaders:o}=await (0,R.postJsonToApi)({url:this.getUrl(),headers:(0,R.combineHeaders)(a,e.headers,this.getModelConfigHeaders(this.modelId,!0),await (0,R.resolve)(this.config.o11yHeaders)),body:this.maybeEncodeFileParts(r),successfulResponseHandler:(0,R.createEventSourceResponseHandler)(k.any()),failedResponseHandler:(0,R.createJsonErrorResponseHandler)({errorSchema:k.any(),errorToMessage:e=>e}),...t&&{abortSignal:t},fetch:this.config.fetch});return{stream:s.pipeThrough(new TransformStream({transform(t,r){if(t.success){let a=t.value;("raw"!==a.type||e.includeRawChunks)&&("response-metadata"===a.type&&a.timestamp&&"string"==typeof a.timestamp&&(a.timestamp=new Date(a.timestamp)),r.enqueue(a))}else r.error(t.error)}})),request:{body:r},response:{headers:o}}}catch(e){throw et(e,ea(a))}}isFilePart(e){return e&&"object"==typeof e&&"type"in e&&"file"===e.type}maybeEncodeFileParts(e){for(let t of e.prompt)for(let e of t.content)if(this.isFilePart(e)&&e.data instanceof Uint8Array){let t=Uint8Array.from(e.data),r=M.Buffer.from(t).toString("base64");e.data=new URL(`data:${e.mediaType||"application/octet-stream"};base64,${r}`)}return e}getUrl(){return`${this.config.baseURL}/language-model`}getModelConfigHeaders(e,t){return{"ai-language-model-specification-version":"2","ai-language-model-id":e,"ai-language-model-streaming":String(t)}}};async function ed(){var e,t;let r=null!=(t=null==(e=eg().headers)?void 0:e["x-vercel-oidc-token"])?t:C.default.env.VERCEL_OIDC_TOKEN;if(!r)throw new P({message:"OIDC token not available",statusCode:401});return r}async function ep(){var e;return null==(e=eg().headers)?void 0:e["x-vercel-id"]}var eh=Symbol.for("@vercel/request-context");function eg(){var e,t,r;return null!=(r=null==(t=null==(e=globalThis[eh])?void 0:e.get)?void 0:t.call(e))?r:{}}async function em(e){let t=(0,R.loadOptionalSetting)({settingValue:e.apiKey,environmentVariableName:"AI_GATEWAY_API_KEY"});if(t)return{token:t,authMethod:"api-key"};try{return{token:await ed(),authMethod:"oidc"}}catch(e){return null}}!function(){var e,t;let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=null,s=null,o=null!=(e=r.metadataCacheRefreshMillis)?e:3e5,i=0,n=null!=(t=(0,R.withoutTrailingSlash)(r.baseURL))?t:"https://ai-gateway.vercel.sh/v1/ai",l=async()=>{let e=await em(r);if(e)return{Authorization:`Bearer ${e.token}`,"ai-gateway-protocol-version":"0.0.1",[er]:e.authMethod,...r.headers};throw P.createContextualError({apiKeyProvided:!1,oidcTokenProvided:!1,statusCode:401})},c=e=>{let t=(0,R.loadOptionalSetting)({settingValue:void 0,environmentVariableName:"VERCEL_DEPLOYMENT_ID"}),a=(0,R.loadOptionalSetting)({settingValue:void 0,environmentVariableName:"VERCEL_ENV"}),s=(0,R.loadOptionalSetting)({settingValue:void 0,environmentVariableName:"VERCEL_REGION"});return new eu(e,{provider:"gateway",baseURL:n,headers:l,fetch:r.fetch,o11yHeaders:async()=>{let e=await ep();return{...t&&{"ai-o11y-deployment-id":t},...a&&{"ai-o11y-environment":a},...s&&{"ai-o11y-region":s},...e&&{"ai-o11y-request-id":e}}}})},u=function(e){if(new.target)throw Error("The Gateway Provider model function cannot be called with the new keyword.");return c(e)};u.getAvailableModels=async()=>{var e,t,c;let u=null!=(c=null==(t=null==(e=r._internal)?void 0:e.currentDate)?void 0:t.call(e).getTime())?c:Date.now();return(!a||u-i>o)&&(i=u,a=new eo({baseURL:n,headers:l,fetch:r.fetch}).getAvailableModels().then(e=>(s=e,e)).catch(async e=>{throw et(e,ea(await l()))})),s?Promise.resolve(s):a},u.imageModel=e=>{throw new x.NoSuchModelError({modelId:e,modelType:"imageModel"})},u.languageModel=c,u.textEmbeddingModel=e=>{throw new x.NoSuchModelError({modelId:e,modelType:"textEmbeddingModel"})}}(),e.i(4987197),e.i(1949907),e.i(2703953);var ev=Object.defineProperty,ef=Symbol.for("vercel.ai.error.AI_NoOutputSpecifiedError");x.AISDKError;Symbol.for("vercel.ai.error.AI_InvalidArgumentError");x.AISDKError;Symbol.for("vercel.ai.error.AI_RetryError");x.AISDKError;Symbol.for("vercel.ai.error.AI_DownloadError");x.AISDKError;Symbol.for("vercel.ai.error.AI_InvalidDataContentError");x.AISDKError;var eb=k.union([k.string(),k.instanceof(Uint8Array),k.instanceof(ArrayBuffer),k.custom(e=>{var t,r;return null!=(r=null==(t=globalThis.Buffer)?void 0:t.isBuffer(e))&&r},{message:"Must be a Buffer"})]),ey=Symbol.for("vercel.ai.error.AI_InvalidMessageRoleError");x.AISDKError;Symbol.for("vercel.ai.error.AI_InvalidStreamPartError");x.AISDKError;Symbol.for("vercel.ai.error.AI_InvalidToolInputError");x.AISDKError;Symbol.for("vercel.ai.error.AI_MCPClientError");x.AISDKError;Symbol.for("vercel.ai.error.AI_NoImageGeneratedError");x.AISDKError;var eE="AI_NoObjectGeneratedError",eI=`vercel.ai.error.${eE}`,ew=Symbol.for(eI),eS=class extends x.AISDKError{constructor({message:e="No object generated.",cause:t,text:r,response:a,usage:s,finishReason:o}){super({name:eE,message:e,cause:t}),this[m]=!0,this.text=r,this.response=a,this.usage=s,this.finishReason=o}static isInstance(e){return x.AISDKError.hasMarker(e,eI)}};m=ew;Symbol.for("vercel.ai.error.AI_NoSuchToolError");x.AISDKError;Symbol.for("vercel.ai.error.AI_ToolCallRepairError");x.AISDKError,x.AISDKError;Symbol.for("vercel.ai.error.AI_MessageConversionError");x.AISDKError;var eT=k.lazy(()=>k.union([k.null(),k.string(),k.number(),k.boolean(),k.record(k.string(),eT),k.array(eT)])),eA=k.record(k.string(),k.record(k.string(),eT)),e_=k.object({type:k.literal("text"),text:k.string(),providerOptions:eA.optional()}),eR=k.object({type:k.literal("image"),image:k.union([eb,k.instanceof(URL)]),mediaType:k.string().optional(),providerOptions:eA.optional()}),ex=k.object({type:k.literal("file"),data:k.union([eb,k.instanceof(URL)]),filename:k.string().optional(),mediaType:k.string(),providerOptions:eA.optional()}),ek=k.object({type:k.literal("reasoning"),text:k.string(),providerOptions:eA.optional()}),eM=k.object({type:k.literal("tool-call"),toolCallId:k.string(),toolName:k.string(),input:k.unknown(),providerOptions:eA.optional(),providerExecuted:k.boolean().optional()}),eC=k.discriminatedUnion("type",[k.object({type:k.literal("text"),value:k.string()}),k.object({type:k.literal("json"),value:eT}),k.object({type:k.literal("error-text"),value:k.string()}),k.object({type:k.literal("error-json"),value:eT}),k.object({type:k.literal("content"),value:k.array(k.union([k.object({type:k.literal("text"),text:k.string()}),k.object({type:k.literal("media"),data:k.string(),mediaType:k.string()})]))})]),ej=k.object({type:k.literal("tool-result"),toolCallId:k.string(),toolName:k.string(),output:eC,providerOptions:eA.optional()}),eO=k.object({role:k.literal("system"),content:k.string(),providerOptions:eA.optional()}),eN=k.object({role:k.literal("user"),content:k.union([k.string(),k.array(k.union([e_,eR,ex]))]),providerOptions:eA.optional()}),eD=k.object({role:k.literal("assistant"),content:k.union([k.string(),k.array(k.union([e_,ex,ek,eM,ej]))]),providerOptions:eA.optional()}),eP=k.object({role:k.literal("tool"),content:k.array(ej),providerOptions:eA.optional()});k.union([eO,eN,eD,eP]),(0,R.createIdGenerator)({prefix:"aitxt",size:24}),TransformStream;var eF=k.union([k.strictObject({type:k.literal("text-start"),id:k.string(),providerMetadata:eA.optional()}),k.strictObject({type:k.literal("text-delta"),id:k.string(),delta:k.string(),providerMetadata:eA.optional()}),k.strictObject({type:k.literal("text-end"),id:k.string(),providerMetadata:eA.optional()}),k.strictObject({type:k.literal("error"),errorText:k.string()}),k.strictObject({type:k.literal("tool-input-start"),toolCallId:k.string(),toolName:k.string(),providerExecuted:k.boolean().optional()}),k.strictObject({type:k.literal("tool-input-delta"),toolCallId:k.string(),inputTextDelta:k.string()}),k.strictObject({type:k.literal("tool-input-available"),toolCallId:k.string(),toolName:k.string(),input:k.unknown(),providerExecuted:k.boolean().optional(),providerMetadata:eA.optional()}),k.strictObject({type:k.literal("tool-output-available"),toolCallId:k.string(),output:k.unknown(),providerExecuted:k.boolean().optional()}),k.strictObject({type:k.literal("tool-output-error"),toolCallId:k.string(),errorText:k.string(),providerExecuted:k.boolean().optional()}),k.strictObject({type:k.literal("reasoning"),text:k.string(),providerMetadata:eA.optional()}),k.strictObject({type:k.literal("reasoning-start"),id:k.string(),providerMetadata:eA.optional()}),k.strictObject({type:k.literal("reasoning-delta"),id:k.string(),delta:k.string(),providerMetadata:eA.optional()}),k.strictObject({type:k.literal("reasoning-end"),id:k.string(),providerMetadata:eA.optional()}),k.strictObject({type:k.literal("reasoning-part-finish")}),k.strictObject({type:k.literal("source-url"),sourceId:k.string(),url:k.string(),title:k.string().optional(),providerMetadata:eA.optional()}),k.strictObject({type:k.literal("source-document"),sourceId:k.string(),mediaType:k.string(),title:k.string(),filename:k.string().optional(),providerMetadata:eA.optional()}),k.strictObject({type:k.literal("file"),url:k.string(),mediaType:k.string(),providerMetadata:eA.optional()}),k.strictObject({type:k.string().startsWith("data-"),id:k.string().optional(),data:k.unknown(),transient:k.boolean().optional()}),k.strictObject({type:k.literal("start-step")}),k.strictObject({type:k.literal("finish-step")}),k.strictObject({type:k.literal("start"),messageId:k.string().optional(),messageMetadata:k.unknown().optional()}),k.strictObject({type:k.literal("finish"),messageMetadata:k.unknown().optional()}),k.strictObject({type:k.literal("message-metadata"),messageMetadata:k.unknown()})]);function eL(e,t){if(void 0===e&&void 0===t)return;if(void 0===e)return t;if(void 0===t)return e;let r={...e};for(let a in t)if(Object.prototype.hasOwnProperty.call(t,a)){let s=t[a];if(void 0===s)continue;let o=a in e?e[a]:void 0,i=null!==s&&"object"==typeof s&&!Array.isArray(s)&&!(s instanceof Date)&&!(s instanceof RegExp),n=null!=o&&"object"==typeof o&&!Array.isArray(o)&&!(o instanceof Date)&&!(o instanceof RegExp);i&&n?r[a]=eL(o,s):r[a]=s}return r}async function eU(e){if(void 0===e)return{value:void 0,state:"undefined-input"};let t=await (0,R.safeParseJSON)({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=await (0,R.safeParseJSON)({text:function(e){let t=["ROOT"],r=-1,a=null;function s(e,s,o){switch(e){case'"':r=s,t.pop(),t.push(o),t.push("INSIDE_STRING");break;case"f":case"t":case"n":r=s,a=s,t.pop(),t.push(o),t.push("INSIDE_LITERAL");break;case"-":t.pop(),t.push(o),t.push("INSIDE_NUMBER");break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":r=s,t.pop(),t.push(o),t.push("INSIDE_NUMBER");break;case"{":r=s,t.pop(),t.push(o),t.push("INSIDE_OBJECT_START");break;case"[":r=s,t.pop(),t.push(o),t.push("INSIDE_ARRAY_START")}}function o(e,a){switch(e){case",":t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break;case"}":r=a,t.pop()}}function i(e,a){switch(e){case",":t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":r=a,t.pop()}}for(let n=0;n<e.length;n++){let l=e[n];switch(t[t.length-1]){case"ROOT":s(l,n,"FINISH");break;case"INSIDE_OBJECT_START":switch(l){case'"':t.pop(),t.push("INSIDE_OBJECT_KEY");break;case"}":r=n,t.pop()}break;case"INSIDE_OBJECT_AFTER_COMMA":'"'===l&&(t.pop(),t.push("INSIDE_OBJECT_KEY"));break;case"INSIDE_OBJECT_KEY":'"'===l&&(t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY"));break;case"INSIDE_OBJECT_AFTER_KEY":":"===l&&(t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE"));break;case"INSIDE_OBJECT_BEFORE_VALUE":s(l,n,"INSIDE_OBJECT_AFTER_VALUE");break;case"INSIDE_OBJECT_AFTER_VALUE":o(l,n);break;case"INSIDE_STRING":switch(l){case'"':t.pop(),r=n;break;case"\\":t.push("INSIDE_STRING_ESCAPE");break;default:r=n}break;case"INSIDE_ARRAY_START":"]"===l?(r=n,t.pop()):(r=n,s(l,n,"INSIDE_ARRAY_AFTER_VALUE"));break;case"INSIDE_ARRAY_AFTER_VALUE":switch(l){case",":t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":r=n,t.pop();break;default:r=n}break;case"INSIDE_ARRAY_AFTER_COMMA":s(l,n,"INSIDE_ARRAY_AFTER_VALUE");break;case"INSIDE_STRING_ESCAPE":t.pop(),r=n;break;case"INSIDE_NUMBER":switch(l){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":r=n;break;case"e":case"E":case"-":case".":break;case",":t.pop(),"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&i(l,n),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]&&o(l,n);break;case"}":t.pop(),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]&&o(l,n);break;case"]":t.pop(),"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&i(l,n);break;default:t.pop()}break;case"INSIDE_LITERAL":{let s=e.substring(a,n+1);"false".startsWith(s)||"true".startsWith(s)||"null".startsWith(s)?r=n:(t.pop(),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]?o(l,n):"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&i(l,n))}}}let n=e.slice(0,r+1);for(let r=t.length-1;r>=0;r--)switch(t[r]){case"INSIDE_STRING":n+='"';break;case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":n+="}";break;case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":n+="]";break;case"INSIDE_LITERAL":{let t=e.substring(a,e.length);"true".startsWith(t)?n+="true".slice(t.length):"false".startsWith(t)?n+="false".slice(t.length):"null".startsWith(t)&&(n+="null".slice(t.length))}}return n}(e)})).success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"}}function eK(e){return e.type.startsWith("tool-")}function eB(e){return e.type.split("-")[1]}function eJ(e){return"object"==typeof e&&null!==e}async function eV(e){let{stream:t,onError:r}=e,a=t.getReader();try{for(;;){let{done:e}=await a.read();if(e)break}}catch(e){null==r||r(e)}finally{a.releaseLock()}}(0,R.createIdGenerator)({prefix:"aitxt",size:24}),(0,R.createIdGenerator)({prefix:"aiobj",size:24});var eG=class{constructor(){this.queue=[],this.isProcessing=!1}async processQueue(){if(!this.isProcessing){for(this.isProcessing=!0;this.queue.length>0;)await this.queue[0](),this.queue.shift();this.isProcessing=!1}}async run(e){return new Promise((t,r)=>{this.queue.push(async()=>{try{await e(),t()}catch(e){r(e)}}),this.processQueue()})}};(0,R.createIdGenerator)({prefix:"aiobj",size:24}),x.AISDKError,((e,t)=>{for(var r in t)ev(e,r,{get:t[r],enumerable:!0})})({},{object:()=>eY,text:()=>eq});var eq=()=>({type:"text",responseFormat:{type:"text"},async parsePartial(e){let{text:t}=e;return{partial:t}},async parseOutput(e){let{text:t}=e;return t}}),eY=e=>{let{schema:t}=e,r=(0,R.asSchema)(t);return{type:"object",responseFormat:{type:"json",schema:r.jsonSchema},async parsePartial(e){let{text:t}=e,r=await eU(t);switch(r.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return{partial:r.value};default:{let e=r.state;throw Error(`Unsupported parse state: ${e}`)}}},async parseOutput(e,t){let{text:a}=e,s=await (0,R.safeParseJSON)({text:a});if(!s.success)throw new eS({message:"No object generated: could not parse the response.",cause:s.error,text:a,response:t.response,usage:t.usage,finishReason:t.finishReason});let o=await (0,R.safeValidateTypes)({value:s.value,schema:r});if(!o.success)throw new eS({message:"No object generated: response did not match schema.",cause:o.error,text:a,response:t.response,usage:t.usage,finishReason:t.finishReason});return o.value}}},eW=Symbol.for("vercel.ai.error.AI_NoSuchProviderError");x.NoSuchModelError;var e$=k.object({name:k.string(),version:k.string()}).passthrough(),eH=k.object({_meta:k.optional(k.object({}).passthrough())}).passthrough(),ez=k.object({method:k.string(),params:k.optional(eH)}),eQ=k.object({experimental:k.optional(k.object({}).passthrough()),logging:k.optional(k.object({}).passthrough()),prompts:k.optional(k.object({listChanged:k.optional(k.boolean())}).passthrough()),resources:k.optional(k.object({subscribe:k.optional(k.boolean()),listChanged:k.optional(k.boolean())}).passthrough()),tools:k.optional(k.object({listChanged:k.optional(k.boolean())}).passthrough())}).passthrough();eH.extend({protocolVersion:k.string(),capabilities:eQ,serverInfo:e$,instructions:k.optional(k.string())});var eX=eH.extend({nextCursor:k.optional(k.string())}),eZ=k.object({name:k.string(),description:k.optional(k.string()),inputSchema:k.object({type:k.literal("object"),properties:k.optional(k.object({}).passthrough())}).passthrough()}).passthrough();eX.extend({tools:k.array(eZ)});var e0=k.object({type:k.literal("text"),text:k.string()}).passthrough(),e1=k.object({type:k.literal("image"),data:k.string().base64(),mimeType:k.string()}).passthrough(),e2=k.object({uri:k.string(),mimeType:k.optional(k.string())}).passthrough(),e4=e2.extend({text:k.string()}),e5=e2.extend({blob:k.string().base64()}),e6=k.object({type:k.literal("resource"),resource:k.union([e4,e5])}).passthrough();eH.extend({content:k.array(k.union([e0,e1,e6])),isError:k.boolean().default(!1).optional()}).or(eH.extend({toolResult:k.unknown()}));var e7=k.object({jsonrpc:k.literal("2.0"),id:k.union([k.string(),k.number().int()])}).merge(ez).strict(),e3=k.object({jsonrpc:k.literal("2.0"),id:k.union([k.string(),k.number().int()]),result:eH}).strict(),e9=k.object({jsonrpc:k.literal("2.0"),id:k.union([k.string(),k.number().int()]),error:k.object({code:k.number().int(),message:k.string(),data:k.optional(k.unknown())})}).strict(),e8=k.object({jsonrpc:k.literal("2.0")}).merge(k.object({method:k.string(),params:k.optional(eH)})).strict();async function te(e){let{stream:t,onTextPart:r}=e,a=t.pipeThrough(new TextDecoderStream).getReader();for(;;){let{done:e,value:t}=await a.read();if(e)break;await r(t)}}async function tt(e){var t;let{api:r,prompt:a,credentials:s,headers:o,body:i,streamProtocol:n="data",setCompletion:l,setLoading:c,setError:u,setAbortController:d,onFinish:p,onError:h,fetch:g=fetch}=e;try{c(!0),u(void 0);let e=new AbortController;d(e),l("");let h=await g(r,{method:"POST",body:JSON.stringify({prompt:a,...i}),credentials:s,headers:{"Content-Type":"application/json",...o},signal:e.signal}).catch(e=>{throw e});if(!h.ok)throw Error(null!=(t=await h.text())?t:"Failed to fetch the chat response.");if(!h.body)throw Error("The response body is empty.");let m="";switch(n){case"text":await te({stream:h.body,onTextPart:e=>{m+=e,l(m)}});break;case"data":await eV({stream:(0,R.parseJsonEventStream)({stream:h.body,schema:eF}).pipeThrough(new TransformStream({async transform(e){if(!e.success)throw e.error;let t=e.value;if("text-delta"===t.type)m+=t.delta,l(m);else if("error"===t.type)throw Error(t.errorText)}})),onError:e=>{throw e}});break;default:throw Error(`Unknown stream protocol: ${n}`)}return p&&p(a,m),d(null),m}catch(e){if("AbortError"===e.name)return d(null),null;e instanceof Error&&h&&h(e),u(e)}finally{c(!1)}}async function tr(e){if(null==e)return[];if(!globalThis.FileList||!(e instanceof globalThis.FileList))throw Error("FileList is not supported in the current environment");return Promise.all(Array.from(e).map(async e=>{let{name:t,type:r}=e;return{type:"file",mediaType:r,filename:t,url:await new Promise((t,r)=>{let a=new FileReader;a.onload=e=>{var r;t(null==(r=e.target)?void 0:r.result)},a.onerror=e=>r(e),a.readAsDataURL(e)})}}))}k.union([e7,e8,e3,e9]),x.AISDKError;var ta=class{constructor({api:e="/api/chat",credentials:t,headers:r,body:a,fetch:s,prepareSendMessagesRequest:o,prepareReconnectToStreamRequest:i}){this.api=e,this.credentials=t,this.headers=r,this.body=a,this.fetch=s,this.prepareSendMessagesRequest=o,this.prepareReconnectToStreamRequest=i}async sendMessages(e){var t,r,a,s,o;let{abortSignal:i,...n}=e,l=await (0,R.resolve)(this.body),c=await (0,R.resolve)(this.headers),u=await (0,R.resolve)(this.credentials),d=await (null==(t=this.prepareSendMessagesRequest)?void 0:t.call(this,{api:this.api,id:n.chatId,messages:n.messages,body:{...l,...n.body},headers:{...c,...n.headers},credentials:u,requestMetadata:n.metadata,trigger:n.trigger,messageId:n.messageId})),p=null!=(r=null==d?void 0:d.api)?r:this.api,h=(null==d?void 0:d.headers)!==void 0?d.headers:{...c,...n.headers},g=(null==d?void 0:d.body)!==void 0?d.body:{...l,...n.body,id:n.chatId,messages:n.messages,trigger:n.trigger,messageId:n.messageId},m=null!=(a=null==d?void 0:d.credentials)?a:u,v=null!=(s=this.fetch)?s:globalThis.fetch,f=await v(p,{method:"POST",headers:{"Content-Type":"application/json",...h},body:JSON.stringify(g),credentials:m,signal:i});if(!f.ok)throw Error(null!=(o=await f.text())?o:"Failed to fetch the chat response.");if(!f.body)throw Error("The response body is empty.");return this.processResponseStream(f.body)}async reconnectToStream(e){var t,r,a,s,o;let i=await (0,R.resolve)(this.body),n=await (0,R.resolve)(this.headers),l=await (0,R.resolve)(this.credentials),c=await (null==(t=this.prepareReconnectToStreamRequest)?void 0:t.call(this,{api:this.api,id:e.chatId,body:{...i,...e.body},headers:{...n,...e.headers},credentials:l,requestMetadata:e.metadata})),u=null!=(r=null==c?void 0:c.api)?r:`${this.api}/${e.chatId}/stream`,d=(null==c?void 0:c.headers)!==void 0?c.headers:{...n,...e.headers},p=null!=(a=null==c?void 0:c.credentials)?a:l,h=null!=(s=this.fetch)?s:globalThis.fetch,g=await h(u,{method:"GET",headers:d,credentials:p});if(204===g.status)return null;if(!g.ok)throw Error(null!=(o=await g.text())?o:"Failed to fetch the chat response.");if(!g.body)throw Error("The response body is empty.");return this.processResponseStream(g.body)}},ts=class extends ta{constructor(e={}){super(e)}processResponseStream(e){return(0,R.parseJsonEventStream)({stream:e,schema:eF}).pipeThrough(new TransformStream({async transform(e,t){if(!e.success)throw e.error;t.enqueue(e.value)}}))}};function to(e){if(!e||"assistant"!==e.role)return!1;let t=e.parts.reduce((e,t,r)=>"step-start"===t.type?r:e,-1),r=e.parts.slice(t+1).filter(eK);return r.length>0&&r.every(e=>"output-available"===e.state)}var ti=class{constructor({generateId:e=R.generateId,id:t=e(),transport:r=new ts,maxSteps:a=1,messageMetadataSchema:s,dataPartSchemas:o,state:i,onError:n,onToolCall:l,onFinish:c,onData:u}){var d=this;this.activeResponse=void 0,this.jobExecutor=new eG,this.sendMessage=async function(e){var t,r,a;let s,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(s="text"in e||"files"in e?{parts:[...Array.isArray(e.files)?e.files:await tr(e.files),..."text"in e&&null!=e.text?[{type:"text",text:e.text}]:[]]}:e,null!=e.messageId){let r=d.state.messages.findIndex(t=>t.id===e.messageId);if(-1===r)throw Error(`message with id ${e.messageId} not found`);if("user"!==d.state.messages[r].role)throw Error(`message with id ${e.messageId} is not a user message`);d.state.messages=d.state.messages.slice(0,r+1),d.state.replaceMessage(r,{...s,id:e.messageId,role:null!=(t=s.role)?t:"user",metadata:e.metadata})}else d.state.pushMessage({...s,id:null!=(r=s.id)?r:d.generateId(),role:null!=(a=s.role)?a:"user",metadata:e.metadata});await d.makeRequest({trigger:"submit-user-message",messageId:e.messageId,...o})},this.regenerate=async function(){let{messageId:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=null==e?d.state.messages.length-1:d.state.messages.findIndex(t=>t.id===e);if(-1===r)throw Error(`message ${e} not found`);d.state.messages=d.state.messages.slice(0,"assistant"===d.messages[r].role?r:r+1),await d.makeRequest({trigger:"regenerate-assistant-message",messageId:e,...t})},this.resumeStream=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};await d.makeRequest({trigger:"resume-stream",...e})},this.addToolResult=async e=>{let{toolCallId:t,output:r}=e;this.jobExecutor.run(async()=>{(function(e){let{messages:t,toolCallId:r,output:a}=e,s=t[t.length-1].parts.find(e=>eK(e)&&e.toolCallId===r);null!=s&&(s.state="output-available",s.output=a)})({messages:this.state.messages,toolCallId:t,output:r}),this.messages=this.state.messages,"submitted"!==this.status&&"streaming"!==this.status&&to(this.lastMessage)&&this.makeRequest({trigger:"submit-tool-result"})})},this.stop=async()=>{var e;("streaming"===this.status||"submitted"===this.status)&&(null==(e=this.activeResponse)?void 0:e.abortController)&&this.activeResponse.abortController.abort()},this.id=t,this.maxSteps=a,this.transport=r,this.generateId=e,this.messageMetadataSchema=s,this.dataPartSchemas=o,this.state=i,this.onError=n,this.onToolCall=l,this.onFinish=c,this.onData=u}get status(){return this.state.status}setStatus(e){let{status:t,error:r}=e;this.status!==t&&(this.state.status=t,this.state.error=r)}get error(){return this.state.error}get messages(){return this.state.messages}get lastMessage(){return this.state.messages[this.state.messages.length-1]}set messages(e){this.state.messages=e}async makeRequest(e){var t,r;let{trigger:a,metadata:s,headers:o,body:i,messageId:n}=e;this.setStatus({status:"submitted",error:void 0});let l=this.state.messages.length,c=this.lastMessage,u=null!=(t=null==c?void 0:c.parts.filter(e=>"step-start"===e.type).length)?t:0;try{let e,t={state:function(e){let{lastMessage:t,messageId:r}=e;return{message:(null==t?void 0:t.role)==="assistant"?t:{id:r,metadata:void 0,role:"assistant",parts:[]},activeTextParts:{},activeReasoningParts:{},partialToolCalls:{}}}({lastMessage:this.state.snapshot(c),messageId:this.generateId()}),abortController:new AbortController};if(this.activeResponse=t,"resume-stream"===a){let t=await this.transport.reconnectToStream({chatId:this.id,metadata:s,headers:o,body:i});if(null==t)return;e=t}else e=await this.transport.sendMessages({chatId:this.id,messages:this.state.messages,abortSignal:t.abortController.signal,metadata:s,headers:o,body:i,trigger:a,messageId:n});await eV({stream:function(e){let{stream:t,onToolCall:r,messageMetadataSchema:a,dataPartSchemas:s,runUpdateMessageJob:o,onError:i,onData:n}=e;return t.pipeThrough(new TransformStream({async transform(e,t){await o(async s=>{var o,l,c,u;let{state:d,write:p}=s;function h(e){var t;let r=d.message.parts.find(t=>eK(t)&&t.toolCallId===e.toolCallId);null!=r?(r.state=e.state,r.input=e.input,r.output=e.output,r.errorText=e.errorText,r.providerExecuted=null!=(t=e.providerExecuted)?t:r.providerExecuted,null!=e.providerMetadata&&"input-available"===r.state&&(r.callProviderMetadata=e.providerMetadata)):d.message.parts.push({type:`tool-${e.toolName}`,toolCallId:e.toolCallId,state:e.state,input:e.input,output:e.output,errorText:e.errorText,providerExecuted:e.providerExecuted,...null!=e.providerMetadata?{callProviderMetadata:e.providerMetadata}:{}})}async function g(e){if(null!=e){let t=null!=d.message.metadata?eL(d.message.metadata,e):e;null!=a&&await (0,R.validateTypes)({value:t,schema:a}),d.message.metadata=t}}switch(e.type){case"text-start":{let t={type:"text",text:"",providerMetadata:e.providerMetadata,state:"streaming"};d.activeTextParts[e.id]=t,d.message.parts.push(t),p();break}case"text-delta":{let t=d.activeTextParts[e.id];t.text+=e.delta,t.providerMetadata=null!=(o=e.providerMetadata)?o:t.providerMetadata,p();break}case"text-end":{let t=d.activeTextParts[e.id];t.state="done",t.providerMetadata=null!=(l=e.providerMetadata)?l:t.providerMetadata,delete d.activeTextParts[e.id],p();break}case"reasoning-start":{let t={type:"reasoning",text:"",providerMetadata:e.providerMetadata,state:"streaming"};d.activeReasoningParts[e.id]=t,d.message.parts.push(t),p();break}case"reasoning-delta":{let t=d.activeReasoningParts[e.id];t.text+=e.delta,t.providerMetadata=null!=(c=e.providerMetadata)?c:t.providerMetadata,p();break}case"reasoning-end":{let t=d.activeReasoningParts[e.id];t.providerMetadata=null!=(u=e.providerMetadata)?u:t.providerMetadata,t.state="done",delete d.activeReasoningParts[e.id],p();break}case"file":d.message.parts.push({type:"file",mediaType:e.mediaType,url:e.url}),p();break;case"source-url":d.message.parts.push({type:"source-url",sourceId:e.sourceId,url:e.url,title:e.title,providerMetadata:e.providerMetadata}),p();break;case"source-document":d.message.parts.push({type:"source-document",sourceId:e.sourceId,mediaType:e.mediaType,title:e.title,filename:e.filename,providerMetadata:e.providerMetadata}),p();break;case"tool-input-start":{let t=d.message.parts.filter(eK);d.partialToolCalls[e.toolCallId]={text:"",toolName:e.toolName,index:t.length},h({toolCallId:e.toolCallId,toolName:e.toolName,state:"input-streaming",input:void 0,providerExecuted:e.providerExecuted}),p();break}case"tool-input-delta":{let t=d.partialToolCalls[e.toolCallId];t.text+=e.inputTextDelta;let{value:r}=await eU(t.text);h({toolCallId:e.toolCallId,toolName:t.toolName,state:"input-streaming",input:r}),p();break}case"tool-input-available":if(h({toolCallId:e.toolCallId,toolName:e.toolName,state:"input-available",input:e.input,providerExecuted:e.providerExecuted,providerMetadata:e.providerMetadata}),p(),r&&!e.providerExecuted){let t=await r({toolCall:e});null!=t&&(h({toolCallId:e.toolCallId,toolName:e.toolName,state:"output-available",input:e.input,output:t}),p())}break;case"tool-output-available":{let t=d.message.parts.filter(eK);if(null==t)throw Error("tool_result must be preceded by a tool_call");let r=t.findIndex(t=>t.toolCallId===e.toolCallId);if(-1===r)throw Error("tool_result must be preceded by a tool_call with the same toolCallId");let a=eB(t[r]);h({toolCallId:e.toolCallId,toolName:a,state:"output-available",input:t[r].input,output:e.output,providerExecuted:e.providerExecuted}),p();break}case"tool-output-error":{let t=d.message.parts.filter(eK);if(null==t)throw Error("tool_result must be preceded by a tool_call");let r=t.findIndex(t=>t.toolCallId===e.toolCallId);if(-1===r)throw Error("tool_result must be preceded by a tool_call with the same toolCallId");let a=eB(t[r]);h({toolCallId:e.toolCallId,toolName:a,state:"output-error",input:t[r].input,errorText:e.errorText,providerExecuted:e.providerExecuted}),p();break}case"start-step":d.message.parts.push({type:"step-start"});break;case"finish-step":d.activeTextParts={},d.activeReasoningParts={};break;case"start":null!=e.messageId&&(d.message.id=e.messageId),await g(e.messageMetadata),(null!=e.messageId||null!=e.messageMetadata)&&p();break;case"finish":case"message-metadata":await g(e.messageMetadata),null!=e.messageMetadata&&p();break;case"error":null==i||i(Error(e.errorText));break;default:if(e.type.startsWith("data-")){if(e.transient){null==n||n(e);break}let t=null!=e.id?d.message.parts.find(t=>e.type===t.type&&e.id===t.id):void 0;null!=t?t.data=eJ(t.data)&&eJ(e.data)?eL(t.data,e.data):e.data:d.message.parts.push(e),null==n||n(e),p()}}t.enqueue(e)})}}))}({stream:e,onToolCall:this.onToolCall,onData:this.onData,messageMetadataSchema:this.messageMetadataSchema,dataPartSchemas:this.dataPartSchemas,runUpdateMessageJob:e=>this.jobExecutor.run(()=>e({state:t.state,write:()=>{var e;this.setStatus({status:"streaming"}),t.state.message.id===(null==(e=this.lastMessage)?void 0:e.id)?this.state.replaceMessage(this.state.messages.length-1,t.state.message):this.state.pushMessage(t.state.message)}})),onError:e=>{throw e}}),onError:e=>{throw e}}),null==(r=this.onFinish)||r.call(this,{message:t.state.message}),this.setStatus({status:"ready"})}catch(e){if("AbortError"===e.name)return this.setStatus({status:"ready"}),null;this.onError&&e instanceof Error&&this.onError(e),this.setStatus({status:"error",error:e})}finally{this.activeResponse=void 0}(function(e){let{originalMaxToolInvocationStep:t,originalMessageCount:r,maxSteps:a,messages:s}=e,o=s[s.length-1],i=o.parts.filter(e=>"step-start"===e.type).length;return a>1&&null!=o&&(s.length>r||i!==t)&&to(o)&&i<a})({originalMaxToolInvocationStep:u,originalMessageCount:l,maxSteps:this.maxSteps,messages:this.state.messages})&&await this.makeRequest({metadata:s,headers:o,body:i,trigger:"submit-tool-result"})}},tn=e.i(9489862);e.i(3521787);var tl=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},tc=(e,t,r)=>(tl(e,t,"read from private field"),r?r.call(e):t.get(e)),tu=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},td=(e,t,r,a)=>(tl(e,t,"write to private field"),a?a.call(e,r):t.set(e,r),r),tp=class{constructor(e=[]){tu(this,v,void 0),tu(this,f,"ready"),tu(this,b,void 0),tu(this,y,new Set),tu(this,E,new Set),tu(this,I,new Set),this.pushMessage=e=>{td(this,v,tc(this,v).concat(e)),tc(this,w).call(this)},this.popMessage=()=>{td(this,v,tc(this,v).slice(0,-1)),tc(this,w).call(this)},this.replaceMessage=(e,t)=>{td(this,v,[...tc(this,v).slice(0,e),this.snapshot(t),...tc(this,v).slice(e+1)]),tc(this,w).call(this)},this.snapshot=e=>structuredClone(e),this["~registerMessagesCallback"]=(e,t)=>{let r=t?function(e,t){return null!=t?(0,tn.default)(e,t):e}(e,t):e;return tc(this,y).add(r),()=>{tc(this,y).delete(r)}},this["~registerStatusCallback"]=e=>(tc(this,E).add(e),()=>{tc(this,E).delete(e)}),this["~registerErrorCallback"]=e=>(tc(this,I).add(e),()=>{tc(this,I).delete(e)}),tu(this,w,()=>{tc(this,y).forEach(e=>e())}),tu(this,S,()=>{tc(this,E).forEach(e=>e())}),tu(this,T,()=>{tc(this,I).forEach(e=>e())}),td(this,v,e)}get status(){return tc(this,f)}set status(e){td(this,f,e),tc(this,S).call(this)}get error(){return tc(this,b)}set error(e){td(this,b,e),tc(this,T).call(this)}get messages(){return tc(this,v)}set messages(e){td(this,v,[...e]),tc(this,w).call(this)}};v=new WeakMap,f=new WeakMap,b=new WeakMap,y=new WeakMap,E=new WeakMap,I=new WeakMap,w=new WeakMap,S=new WeakMap,T=new WeakMap;var th=class extends ti{constructor({messages:e,...t}){let r=new tp(e);super({...t,state:r}),tu(this,A,void 0),this["~registerMessagesCallback"]=(e,t)=>tc(this,A)["~registerMessagesCallback"](e,t),this["~registerStatusCallback"]=e=>tc(this,A)["~registerStatusCallback"](e),this["~registerErrorCallback"]=e=>tc(this,A)["~registerErrorCallback"](e),td(this,A,r)}};function tg(){let{experimental_throttle:e,resume:t=!1,...r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,_.useRef)("chat"in r?r.chat:new th(r));("chat"in r&&r.chat!==a.current||"id"in r&&a.current.id!==r.id)&&(a.current="chat"in r?r.chat:new th(r));let s=(0,_.useCallback)(t=>a.current["~registerMessagesCallback"](t,e),[e]),o=(0,_.useSyncExternalStore)(s,()=>a.current.messages,()=>a.current.messages),i=(0,_.useSyncExternalStore)(a.current["~registerStatusCallback"],()=>a.current.status,()=>a.current.status),n=(0,_.useSyncExternalStore)(a.current["~registerErrorCallback"],()=>a.current.error,()=>a.current.error),l=(0,_.useCallback)(e=>{"function"==typeof e&&(e=e(a.current.messages)),a.current.messages=e},[a]);return(0,_.useEffect)(()=>{t&&a.current.resumeStream()},[t,a]),{id:a.current.id,messages:o,setMessages:l,sendMessage:a.current.sendMessage,regenerate:a.current.regenerate,stop:a.current.stop,error:n,resumeStream:a.current.resumeStream,status:i,addToolResult:a.current.addToolResult}}A=new WeakMap},[7356923]]}]);

//# sourceMappingURL=6d09fd53b09cd31c.js.map
//# debugId=11f7ee82-0772-5c29-ac75-6fbbb3f97278
