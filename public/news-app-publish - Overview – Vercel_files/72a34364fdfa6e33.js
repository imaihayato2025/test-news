
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="eb3b98f3-d628-5549-b7de-4bc46de67f2f")}catch(e){}}();
(globalThis.TURBOPACK=globalThis.TURBOPACK||[]).push(["object"==typeof document?document.currentScript:void 0,{8392691:e=>{"use strict";e.s({V0MarketplaceProvider:()=>l,useV0Marketplace:()=>c});var t=e.i(6645307),n=e.i(6530772),r=e.i(5535439),o=e.i(3509620),i=e.i(2240289);e.i(2815117);var s=e.i(5710779);let a=(0,n.createContext)(void 0);function l(e){let{value:l,children:c}=e,d=(0,r.useRouter)(),{token:u,planId:g,productId:p,vercelProjectSlug:h,needPrefix:x}=l??{},{createConnection:j}=(0,s.useResourceConnection)(),{data:m}=(0,i.useProject)(h),v=(0,n.useMemo)(()=>{if(!u||!m?.id)return;let e=!1;try{e=!!window.opener}catch(e){}return{connectProjectAndReturnToV0:async t=>{let{integrationId:n,productId:r,resourceId:i,productSlug:s}=t;r&&n&&m.id&&(await j({projectId:m.id,deployments:void 0,resourceId:i,envVarEnvironments:[o.EnvTarget.Production,o.EnvTarget.Preview,o.EnvTarget.Development],v0token:u,envVarPrefix:x?s.toUpperCase():void 0}),e?(await new Promise(e=>{setTimeout(e,500)}),window.close()):d.push("https://v0.dev/chat"))},vercelProjectSlug:h,productId:p,planId:g,token:u,needPrefix:x??!1}},[u,m?.id,h,p,g,j,d,x]);return(0,t.jsx)(a.Provider,{value:v,children:c})}a.displayName="V0MarketplaceContext";let c=()=>(0,n.useContext)(a)},7775281:[e=>{"use strict";e.s({blockConnectionUntilResourceIsAvailable:()=>n},7775281);var t=e.i(8774211),n=(0,t.createServerReference)("405c4e71ad3234284a84b4bd48cda188af633deb86",t.callServer,void 0,t.findSourceMapURL,"blockConnectionUntilResourceIsAvailable");function r(e){if(!e)return!1;if("protocols"in e)return e.protocols.storage?.status==="enabled";if("product"in e){let t=e.product;if("supportedProtocols"in t)return t.supportedProtocols.includes("storage")}return!1}e.s({areResourceDeploymentsEnabled:()=>r},3642313),e.s({ResourceStatus:()=>g},7048806);var o=e.i(6645307),i=e.i(664635),s=e.i(889716),a=e.i(5163670),l=e.i(8084653),c=e.i(3921802);function d(e){let{label:t,type:n}=e,r="teal-600";return"error"===n&&(r="red-700"),"init"===n&&(r="gray-500"),(0,o.jsxs)(s.Stack,{align:"center",direction:"row",gap:2,children:[(0,o.jsx)(i.Status,{color:r}),(0,o.jsx)(l.Text,{lineHeight:16,children:t})]})}function u(e){let{label:t}=e;return(0,o.jsx)(s.Stack,{align:"center",direction:"row",gap:2,children:(0,o.jsx)(c.Badge,{variant:"red",children:t})})}function g(e){let{resource:t}=e;switch(t?.status){case"suspended":return(0,o.jsx)(u,{label:"Suspended"});case"limits-exceeded-suspended":return(0,o.jsx)(u,{label:"Limits Exceeded"});case"limits-exceeded-suspended-store-count":return(0,o.jsx)(u,{label:"Store Count Limit Reached"});case"available":return(0,o.jsx)(d,{label:"Available",type:"ok"});case"error":return(0,o.jsx)(d,{label:"Error",type:"error"});case"initializing":return(0,o.jsx)(d,{label:"Initializing",type:"init"});case"uninstalled":return(0,o.jsx)(d,{label:"Uninstalled",type:"error"});default:return(0,o.jsx)(a.Skeleton,{boxHeight:20,height:16,vcenter:!0,width:114})}}},[3642313,7048806]],7030156:e=>{"use strict";e.s({ResourceProjectSelector:()=>h});var t=e.i(6645307),n=e.i(6530772),r=e.i(1782286),o=e.i(889716),i=e.i(8084653),s=e.i(3921802),a=e.i(3621043),l=e.i(8158100),c=e.i(6621512),d=e.i(3431702),u=e.i(1164214),g=e.i(2146499),p=e.i(5245685);function h(e){let{allowSelectConnectedProjects:h,selectedProject:x,account:j,onProjectSelected:m,resourceTitle:v,...b}=e,[f,S]=(0,n.useState)(""),y=(0,n.useMemo)(()=>(0,r.default)(S,500),[]),[,k]=(0,d.useProjectListInfinite)({limit:20,search:f,latestDeployments:0,slug:j},{},!1,!0),C=k.initialDataLoaded,w=e=>!!e&&("connectedProjectIds"in b?b.connectedProjectIds.includes(e.id):b.includedInConnectedProjects(e)),P=w(x);return(0,t.jsxs)(o.Stack,{gap:4,children:[(0,t.jsxs)(a.Combobox,{"data-testid":(0,u.tid)("connect-project","select-project-combobox"),filter:e=>e,onChange:e=>{let t=k.projects.find(t=>t.id===e)??null;(!w(t)||h)&&m(t)},onClear:()=>S(""),placeholder:"Search Projects...",prefixIcon:x?.latestDeployments&&x.latestDeployments.length>0?(0,t.jsx)(g.ProjectLogo,{deploymentId:x.latestDeployments[0]?.id??"",framework:x.framework,project:x,size:20}):null,value:x?.name??null,children:[(0,t.jsx)(a.Combobox.Input,{onChange:e=>y(e.target.value)}),(0,t.jsx)(a.Combobox.List,{emptyMessage:C?f?`No project found with the name "${f}".`:"No project under this account.":"Loading...",ListFooterComponent:(0,t.jsx)(p.LoadMore,{swr:k}),children:k.projects.map(e=>{let n=w(e);return(0,t.jsxs)(a.Combobox.Option,{className:"w-full flex-row items-center justify-between gap-2","data-testid":(0,u.tid)("connect-project","select-project",e.id),disabled:n&&!h,value:e.id,children:[(0,t.jsxs)(o.Stack,{align:"center",direction:"row",gap:2,children:[(0,t.jsx)(g.ProjectLogo,{deploymentId:e.latestDeployments?.[e.latestDeployments.length-1]?.id,framework:e.framework,project:e,size:20}),(0,t.jsx)(i.Text,{children:e.name})]}),n?(0,t.jsx)(s.Badge,{variant:"gray",children:"connected"}):null]},e.id)})})]}),P&&h?(0,t.jsx)(l.Note,{fill:!0,label:!1,type:"secondary",variant:"contrast",children:(0,t.jsxs)(o.Stack,{direction:"column",children:[(0,t.jsxs)(o.Stack,{direction:"row",gap:2,children:[(0,t.jsx)(c.Information,{className:"stroke-gray-900",size:20}),(0,t.jsxs)(i.Text,{color:"gray-1000",lineHeight:24,weight:500,children:["This project has already been connected to this ",v]})]}),(0,t.jsx)(i.Text,{color:"gray-900",children:"To connect it again, use a different Environment Variable Name."})]})}):null]})}},2031422:[e=>{"use strict";e.s({FormLogSources:()=>l},2031422);var t=e.i(6645307),n=e.i(8247297),r=e.i(889716),o=e.i(8084653),i=e.i(1164214),s=e.i(3326412),a=e.i(5019368);function l(e){let{disabled:l,onSourcesChanged:c,sources:d,selectedSourceValues:u}=e,{value:g}=(0,s.useFirewallLogDrains)();return(0,t.jsxs)(r.Stack,{className:"tailwind-preflight",gap:3,children:[(0,t.jsx)("div",{children:(0,t.jsx)(a.FormTitleDescription,{description:"Logs from the selected sources will be forwarded to your log drain. At least one must be selected.",title:"Sources"})}),(0,t.jsx)("div",{className:"grid grid-cols-1 gap-2 md:grid-cols-2",children:d.map(e=>{let{label:r,value:s,description:a}=e;if("firewall"!==s||g)return(0,t.jsxs)("div",{className:"flex-col gap-0.5",children:[(0,t.jsxs)("div",{className:"inline-flex items-center gap-2",children:[(0,t.jsx)(n.Checkbox,{checked:u.includes(s),"data-testid":(0,i.tid)("log-drain-source",s),disabled:l,onChange:()=>{u.includes(s)?c(u.filter(e=>e!==s)):c([...u,s])}}),(0,t.jsx)(o.Text,{color:"inherit",children:r})]}),(0,t.jsx)(o.Text,{className:"flex-1",color:l?"inherit":"gray-900",size:12,children:a})]},s)})})]})}e.s({FormSamplingRate:()=>d},4798346);var c=e.i(4983656);function d(e){let{disabled:n,onSamplingRateChanged:o,samplingRate:i}=e;return(0,t.jsxs)(r.Stack,{gap:3,children:[(0,t.jsx)("div",{children:(0,t.jsx)(a.FormTitleDescription,{description:"A percentage of logs matching the sampling rate will be sent to your log drain.",title:"Sampling Rate"})}),(0,t.jsxs)(r.Stack,{align:"center",direction:"row",gap:3,children:[(0,t.jsxs)("span",{style:{minWidth:35},children:[i,"%"]}),(0,t.jsx)(c.Slider,{disabled:n,max:100,min:1,onValueChange:o,value:i})]})]})}},[4798346]],7888720:e=>{"use strict";e.s({ResourceEnvironmentSelector:()=>a});var t=e.i(6645307),n=e.i(8247297),r=e.i(1917237),o=e.i(889716),i=e.i(8084653),s=e.i(3509620);function a(e){let{environments:a,error:l,onChange:c,resourceTitle:d}=e,u={[s.EnvTarget.Development]:"Development",[s.EnvTarget.Preview]:"Preview",[s.EnvTarget.Production]:"Production"},[g,p]=Object.entries(a).reduce((e,t)=>(e[t[0]in u?0:1].push(t),e),[[],[]]);return(0,t.jsxs)(o.Stack,{gap:3,children:[(0,t.jsx)(i.Text,{size:14,weight:600,children:"Environments"}),(0,t.jsxs)(i.Text,{color:"gray-900",lineHeight:16,size:13,children:["Choose which environments of the project to make this ",d," ","available to."]}),(0,t.jsxs)(o.Stack,{gap:2,children:[(0,t.jsx)(o.Stack,{direction:"row",gap:4,children:g.map(e=>{let[r,o]=e;return(0,t.jsx)(n.Checkbox,{checked:o,onChange:()=>{c({...a,[r]:!o})},children:u[r]},`environment-${r}`)})}),p.length>0&&(0,t.jsx)(o.Stack,{direction:"row",gap:4,children:p.map(e=>{let[r,o]=e;return(0,t.jsx)(n.Checkbox,{checked:o,onChange:()=>{c({...a,[r]:!o})},children:r},`environment-${r}`)})})]}),l?(0,t.jsx)(r.Error,{children:l}):null]})}},3827171:[e=>{"use strict";e.s({ConnectResourceForCurrentProjectStep:()=>es,CreateResourceConnectionModal:()=>ei,CreateResourceConnectionModalStep:()=>er,UpdateResourceConnectionModal:()=>ea},3827171);var t=e.i(6645307),n=e.i(6530772),r=e.i(889716),o=e.i(8934201),i=e.i(584439),s=e.i(1917237),a=e.i(8084653),l=e.i(1164214),c=e.i(3509620),d=e.i(503726),u=e.i(6494827),g=e.i(8935741),p=e.i(3521787),h=e.i(7775281),x=e.i(2240289),j=e.i(8392691),m=e.i(4325351),v=e.i(6580759),b=e.i(5037292),f=e.i(5710779),S=e.i(1993163),y=e.i(612939),k=e.i(3331605);e.i(9389778);var C=e.i(1310591),w=e.i(3941020),P=e.i(3642313),T=e.i(8447321),R=e.i(7048806),E=e.i(9990438),D=e.i(7030156),I=e.i(8247297),L=e.i(631755),M=e.i(9495609),O=e.i(8158100),N=e.i(437915),A=e.i(2362802),z=e.i(3514588),V=e.i(1587761),B=e.i(3326412),F=e.i(3585235),U=e.i(5785123),q=e.i(1460036),$=e.i(5610210),H=e.i(6799491),W=e.i(2031422),_=e.i(4798346),G=e.i(7779393),K=e.i(7888720);function X(e){let{isLoading:n,store:o,advancedOptions:i,onChangeAdvancedOptions:s,prefixPlaceholder:l,sampleEnvVarName:c,logDrainEnabled:d}=e,u=(0,m.getResourceTitleByResource)(o);return(0,t.jsxs)(r.Stack,{gap:6,children:[(0,t.jsx)(K.ResourceEnvironmentSelector,{environments:i.environments,error:i.error?.environments,onChange:e=>s({...i,environments:e,error:{...i.error,environments:void 0}}),resourceTitle:u}),o?.type==="integration"&&(0,P.areResourceDeploymentsEnabled)(o)?(0,t.jsx)(Z,{advancedOptions:i,onChangeAdvancedOptions:s,store:o}):null,(0,b.isProtocolSupportedByResource)(o,"logDrain")?(0,t.jsx)(Y,{advancedOptions:i,logDrainEnabled:d,onChangeAdvancedOptions:s}):null,(0,t.jsx)(G.Expander,{className:"w-full rounded border border-solid border-gray-200",expandedClassName:"bg-background-100",isExpandedDefault:!!i.error,title:(0,t.jsxs)(r.Stack,{direction:"row",gap:1,paddingX:3,paddingY:2,children:[(0,t.jsx)(G.ExpanderTrigger,{}),(0,t.jsx)(a.Text,{color:"gray-900",size:13,weight:500,children:"Advanced Options"})]}),children:(0,t.jsx)(r.Stack,{paddingX:3,paddingY:2,children:(0,t.jsx)(r.Stack,{gap:4,children:(0,t.jsxs)(r.Stack,{gap:3,children:[(0,t.jsx)(L.Input,{"aria-label":"Environment Variables Prefix",disabled:n,error:i.error?.envPrefix,label:"Environment Variables Prefix",onChange:e=>s({...i,envPrefix:e.currentTarget.value,error:{...i.error,envPrefix:void 0}}),placeholder:l,suffix:c,value:i.envPrefix,width:"100%"}),(0,t.jsx)(a.Text,{color:"gray-900",size:13,children:"This prefix will be applied to the environment variables that are automatically created for the project."})]})})})})]})}function Y(e){let{advancedOptions:o,onChangeAdvancedOptions:i,logDrainEnabled:l}=e,{can:c,isLoading:d}=(0,F.default)(),{team:u}=(0,z.useTeam)(),g=(0,b.hasFreeBillingPlan)(u),p=!u||g||d||!c(U.Action.Create,U.Resource.LogDrains),[h,x]=(0,n.useState)(l??!!(0,w.getLogDrainProtocolSettings)(o)),j=(0,w.getLogDrainProtocolSettings)(o)??{sources:[],samplingRate:1};return(0,t.jsxs)(r.Stack,{gap:3,children:[(0,t.jsx)(a.Text,{size:14,weight:500,children:"Log Drain Configuration"}),(0,t.jsxs)(O.Note,{icon:(0,t.jsx)(N.Dollar,{color:"gray-900"}),children:[(0,t.jsx)("b",{children:"Log Drains"})," are billed $0.50 per 1GB processed."," ",(0,t.jsx)(A.Link,{href:"/docs/log-drains#usage-and-pricing",target:"_blank",underline:!0,children:"Learn more"})]}),(0,t.jsxs)(r.Stack,{className:"rounded border border-solid border-gray-200",children:[o.error?.protocolSettings?(0,t.jsx)(r.Stack,{className:"px-4 py-3",children:(0,t.jsx)(s.Error,{error:o.error.protocolSettings})}):null,g?(0,t.jsx)(r.Stack,{className:"px-4 py-3",children:(0,t.jsxs)(O.Note,{fill:!0,type:"warning",children:["Log Drains are not available for the current plan.",(0,t.jsx)("br",{}),(0,t.jsx)(A.Link,{href:"/dashboard?upgradeTeam=log-drains-cta",target:"_blank",variant:"highlight",children:"Upgrade to Pro"})," ","to continue."]})}):null,(0,t.jsx)(r.Stack,{className:"px-4 py-3",children:(0,t.jsx)(r.Stack,{direction:"row",children:(0,t.jsx)(M.Toggle,{checked:h,direction:"switch-first",disabled:p,onChange:e=>{x(e),e?i({...o,protocolSettings:{logDrain:j}}):i({...o,protocolSettings:{logDrain:void 0}})},size:"large",children:(0,t.jsx)(a.Text,{children:"Enable LogDrain"})})})}),(0,t.jsxs)(r.Stack,{align:"center",className:(0,$.clsx)("border-0 border-t border-solid border-gray-200 px-4 py-3",{"opacity-50":!h}),gap:3,children:[(0,t.jsx)(W.FormLogSources,{disabled:p||!h,onSourcesChanged:e=>{i({...o,protocolSettings:{logDrain:{...j,sources:e}}})},selectedSourceValues:j.sources,sources:q.LogSourcesWithDescription}),(0,t.jsx)(_.FormSamplingRate,{disabled:p||!h,onSamplingRateChanged:e=>{i({...o,protocolSettings:{logDrain:{...j,samplingRate:e[0]/100}}})},samplingRate:[100*j.samplingRate]})]})]})]})}function Z(e){let{store:o,advancedOptions:i,onChangeAdvancedOptions:s}=e,{data:l}=(0,H.useIntegration)(o.product.integration.id),d=l?.flags?.includes(V.LaunchDarklyIntegrationFlags.MarketplaceDeploymentActions),{value:u}=(0,B.useLaunchDarklyTeamFeatureFlag)("deployment-integrations"),{product:g}=(0,H.useIntegrationAndProduct)({integrationIdOrSlug:o.product.integration.id,productIdOrSlug:o.product.id,teamIdOrSlug:o.ownerId}),p=g?.actions??[],h=(0,n.useMemo)(()=>[{target:c.EnvTarget.Preview,name:"Preview"},{target:c.EnvTarget.Production,name:"Production"}],[]),x=i.deployments;return d&&u?(0,t.jsxs)(r.Stack,{gap:3,children:[(0,t.jsx)(a.Text,{size:14,weight:600,children:"Deployments"}),(0,t.jsxs)(r.Stack,{className:"rounded-md border border-solid border-gray-200",children:[(0,t.jsx)(r.Stack,{className:"px-4 py-3",children:(0,t.jsx)(M.Toggle,{checked:x?.required??!1,labelCasing:"normal",onChange:e=>{s({...i,deployments:{...x,required:e}})},size:"large",children:(0,t.jsx)(a.Text,{size:13,style:{whiteSpace:"normal"},children:"Resource is required to be in an active state before deployment can start."})})}),p.length>0?(0,t.jsxs)(r.Stack,{className:(0,$.clsx)("border-0 border-t border-solid border-gray-200 px-4 py-3",{"opacity-50":!x?.required}),gap:3,children:[(0,t.jsx)(a.Text,{size:13,weight:500,children:"Choose actions to enable for this integration."}),(0,t.jsx)(r.Stack,{direction:"row",gap:4,children:p.map(e=>(0,t.jsxs)(r.Stack,{gap:2,children:[(0,t.jsxs)(a.Text,{color:"gray-900",size:13,weight:400,children:[e.slug,": ",e.name]}),e.description?(0,t.jsxs)(a.Text,{color:"gray-900",size:12,children:[e.description,e.link?(0,t.jsx)(A.Link,{external:!0,href:e.link}):null]}):null,(0,t.jsx)(r.Stack,{direction:"row",gap:4,children:h.map(n=>(0,t.jsx)(I.Checkbox,{checked:x?.actions?.[e.slug]?.[n.target]??!1,disabled:!x?.required||!i.environments[n.target],onChange:t=>{s({...i,deployments:{...x,actions:{...x?.actions,[e.slug]:{...x?.actions?.[e.slug],[n.target]:t.target.checked}}}})},children:n.name},n.target))})]},e.slug))})]}):null]})]}):null}var J=e.i(7932046),Q=e.i(4601702);function ee(e){let{resource:n}=e;if(!n||"integration"!==n.type)return null;let o=n.product.projectConnectionScopes;if(!o||0===o.length)return null;let i=o.map(e=>(0,Q.scopeFormatter)(e)??null).filter(et).reduce((e,t)=>{let{permission:n}=t;return e[n].push(t),e},{Read:[],"Read and Write":[]});return(0,t.jsxs)(r.Stack,{gap:2,children:[(0,t.jsx)(a.Text,{children:"This integration requires the following permissions"}),(0,t.jsx)(r.Stack,{as:"ul",className:"m-0 list-none p-0","data-testid":(0,l.tid)("connect-project","scopes"),gap:4,children:Object.entries(i).map(e=>{let[n,o]=e;return 0===o.length?null:(0,t.jsxs)(r.Stack,{align:"center",as:"li",direction:"row",gap:3,children:[(0,t.jsx)("div",{className:"flex-basis",children:(0,t.jsx)(J.IconDefault,{size:24})}),(0,t.jsxs)(r.Stack,{gap:1,children:[(0,t.jsx)(r.Stack,{align:"center",direction:"row",gap:2,children:(0,t.jsx)(a.Text,{className:"whitespace-nowrap",weight:600,children:n})}),(0,t.jsx)("ul",{className:"m-0 list-none p-0",children:o.map((e,n)=>{let{resource:r}=e;return(0,t.jsx)("li",{style:{display:"inline"},children:(0,t.jsxs)(a.Text,{as:"span",className:"tailwind-preflight",children:[r,n===o.length-1?null:", "]})},r)})})]})]},n)})})]})}function et(e){return null!=e}function en(e){let{resource:t,blockData:n}=e,r=t?.status;return n&&!n.blockConnection||t&&"integration"!==t.type||"available"===r}function er(e){let{backOrCancelLabel:d,project:x,store:S,connection:y,title:k,subtitle:C,onBack:D,onClickOutside:I,onConnectionCreated:L,ProjectSelector:M,initialEnvPrefix:O,resourceId:N,logDrainEnabled:A}=e,{mutateResourceListAndProject:z}=(0,v.useMutateResourceCache)(),{mutate:V}=(0,T.useResourceItem)({resourceId:N,includeGuides:!0}),{createConnection:B,updateConnection:F}=(0,f.useResourceConnection)(),{token:U}=(0,j.useV0Marketplace)()||{},[q,$]=(0,n.useState)(!1),[H,W]=(0,n.useState)({envPrefix:O??y?.envVarPrefix??void 0,environments:{[c.EnvTarget.Development]:y?.environments.includes(c.EnvTarget.Development)??!0,[c.EnvTarget.Preview]:y?.environments.includes(c.EnvTarget.Preview)??!0,[c.EnvTarget.Production]:y?.environments.includes(c.EnvTarget.Production)??!0,...x?.customEnvironments?.reduce((e,t)=>(e[t.slug]=!0,e),{})??{}},deployments:y?.deployments?{required:y.deployments.required,actions:y.deployments.actions.reduce((e,t)=>{let{slug:n,environments:r}=t;return e[n]=r.reduce((e,t)=>(e[t]=!0,e),{}),e},{})}:!y&&(0,P.areResourceDeploymentsEnabled)(S)?{required:!0,actions:{}}:void 0,protocolSettings:y?.protocolSettings??void 0,error:null}),[_,G]=(0,n.useState)(!1),[K,Y]=(0,n.useState)(null),Z=(0,u.usePrevious)(x),[J,Q]=(0,n.useState)(!1);(0,n.useEffect)(()=>{J||x&&(!Z||x.id===Z.id)||(Q(!0),W({...H,error:null,environments:{[c.EnvTarget.Development]:!0,[c.EnvTarget.Preview]:!0,[c.EnvTarget.Production]:!0,...x?.customEnvironments?.reduce((e,t)=>(e[t.slug]=!0,e),{})??{}}}))},[H,J,Z,x]);let et=(0,n.useCallback)(async()=>{if(x)try{let e=[c.EnvTarget.Production,c.EnvTarget.Preview,c.EnvTarget.Development,...x.customEnvironments?.map(e=>e.slug)??[]].filter(e=>H.environments[e]),t=H.deployments?{required:H.deployments.required??!1,actions:H.deployments.required?Object.entries(H.deployments.actions??{}).map(t=>{let[n,r]=t;return{slug:n,environments:Object.entries(r).reduce((t,n)=>{let[r,o]=n;return o&&e.includes(r)&&t.push(r),t},[])}}).filter(e=>{let{environments:t}=e;return t.length>0}):[]}:void 0;if(G(!0),Y(null),W({...H,error:null}),0===e.length){W({...H,error:{environments:"Select at least one Environment for your Environment Variable"}}),G(!1);return}if(H.envPrefix&&!/^[a-zA-Z][a-zA-Z0-9_]*$/.test(H.envPrefix)){W({...H,error:{envPrefix:"The prefix contains invalid characters. It must start with a letter and be made of letters, digits, and underscores only."}}),G(!1);return}let n=function(e,t){let n=(0,w.getLogDrainProtocolSettings)({protocolSettings:t});return(0,b.isProtocolSupportedByResource)(e,"logDrain")&&n&&!n.sources.length?"Select at least one source to enable log draining":null}(S,H.protocolSettings);if(n){W({...H,error:{protocolSettings:n}}),G(!1);return}y?await F({resourceId:N,connectionId:y.id,envVarPrefix:H.envPrefix,envVarEnvironments:e,deployments:t,protocolSettings:H.protocolSettings}):await B({projectId:x.id,envVarPrefix:H.envPrefix,envVarEnvironments:e,deployments:t,resourceId:N,protocolSettings:H.protocolSettings,v0token:U}),i.toasts.success({text:`Connected Project ${x.name} to ${(0,m.getResourceTitleByResource)(S)}`,key:x.id}),await z(x.name,S?.type==="integration"?S.product.supportedProtocols[0]:"storage"),await V(),S?.type==="integration"&&S.product.showSSOLinkOnProjectConnection?$(!0):(L&&await L(),I())}catch(e){if((0,g.isAPIError)(e))e.code===f.ResourceConnectionsErrorCodes.ProjectEnvVarNotUnique?W({...H,error:{envPrefix:e.message}}):Y(e.message);else throw e}finally{G(!1)}},[x,H,S,y,z,V,F,N,B,U,L,I]),{isWaitingForAvailableResource:er,onSubmit:ei,resourceStatus:es,isSubmitDisabled:ea}=function(e){let{initialResource:t,resourceId:r,handleSubmit:o}=e,{data:i}=(0,T.useResourceItem)({resourceId:r,revalidateStatus:!0}),[s,a]=(0,n.useState)(!1),l=i?.store.status,c=(0,n.useRef)(!1),d=i?.store??t,u=d?.type==="integration"?d.product.slug:null,{data:g}=(0,p.default)(u?"marketplace-product-block-connection-until-available":null,()=>(0,h.blockConnectionUntilResourceIsAvailable)(u));return(0,n.useEffect)(()=>{!c.current&&s&&en({blockData:g,resource:d})&&(c.current=!0,o())},[o,g,s,d]),{isWaitingForAvailableResource:!!(s&&"available"!==l&&g?.blockConnection),onSubmit:()=>{if(en({blockData:g,resource:d}))return void o();a(!0)},resourceStatus:l,isSubmitDisabled:!d||!!("integration"===d.type&&!g)}}({resourceId:N,handleSubmit:et});return(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),ei()},children:[(0,t.jsx)(o.Modal.Body,{children:(0,t.jsxs)(r.Stack,{gap:6,children:[(0,t.jsxs)(r.Stack,{gap:2,children:[(0,t.jsx)(o.Modal.Title,{center:!0,children:k}),C?(0,t.jsx)(o.Modal.Subtitle,{children:C}):null]}),(0,t.jsx)(o.Modal.Inset,{last:!0,children:eo(S)&&q?(0,t.jsxs)(r.Stack,{gap:4,children:[(0,t.jsxs)(a.Text,{children:["Project ",x?.name," successfully connected to"," ",(0,m.getResourceTitleByResource)(S)]}),(0,t.jsxs)(a.Text,{children:["Complete the project configuration in the"," ",S.product.integration.name," Dashboard"]})]}):(0,t.jsxs)(r.Stack,{className:er?"geist-disabled pointer-events-none":void 0,gap:6,children:[M,(0,t.jsx)(ee,{resource:S}),(0,t.jsx)(X,{advancedOptions:H,isLoading:_,logDrainEnabled:A,onChangeAdvancedOptions:W,prefixPlaceholder:(0,b.getEnvPrefixByResource)(S),sampleEnvVarName:(0,b.getSampleEnvVarNameByResource)(S),store:S}),K?(0,t.jsx)(s.Error,{children:K}):null]})})]})}),(0,t.jsxs)(o.Modal.Actions,{children:[(0,t.jsx)(o.Modal.Action,{onClick:q?()=>{L&&L(),I()}:D,type:"secondary",children:q?"Later":d}),eo(S)&&q?(0,t.jsx)(E.OpenInPartnerDashboardButton,{buttonVariant:"default",componentType:"button",integrationConfigurationId:S.product.integrationConfigurationId,label:`Open in ${S.product.integration.name}`,onClick:()=>{L&&L(),I()},productId:S.product.id,externalResourceId:S.externalResourceId,teamIdOrSlug:S.ownerId,projectId:x?.id}):(0,t.jsx)(o.Modal.Action,{buttonType:"submit","data-testid":(0,l.tid)("connect-project","store-modal-connect-project"),disabled:!x||ea,loading:_||er,type:er?"secondary":"default",children:er?(0,t.jsx)(R.ResourceStatus,{resource:es?{status:es}:null}):y?"Update":"Connect"})]})]})}function eo(e){return!!(e?.type==="integration"&&e.product.showSSOLinkOnProjectConnection)}function ei(e){let{active:r,store:i,onClickOutside:s,onAnimationDone:a,onConnectionCreated:l,resourceId:c}=e,[u,g]=(0,n.useState)(null),{team:p,user:h}=(0,d.useAccount)(),x=p?p.slug:h?.username;return(0,t.jsx)(o.Modal.Modal,{active:r,allowOverflow:!0,onAnimationDone:a,onClickOutside:s,width:540,children:(0,t.jsx)(er,{ProjectSelector:(0,t.jsx)(D.ResourceProjectSelector,{account:x,allowSelectConnectedProjects:(0,b.isProtocolSupportedByResource)(i,"logDrain"),connectedProjectIds:i?.projectsMetadata.map(e=>e.projectId)??[],onProjectSelected:e=>{g(e)},resourceTitle:(0,m.getResourceTitleByResource)(i),selectedProject:u}),backOrCancelLabel:"Cancel",onBack:s,onClickOutside:s,onConnectionCreated:l,project:u,resourceId:c,store:i,title:(0,w.getConnectProjectOrLogDrainLabel)(i)})})}function es(e){let{resource:o}=e,{onClose:i,onBack:s,state:l,onResourceUpdated:c}=(0,S.useResourceModalsContext)(),{type:d}=o,{projectSlug:u}=(0,C.useProjectSlug)(),g=(0,x.useProject)(u),p=(0,n.useCallback)(()=>{c({resource:o,isConnected:!0})},[c,o]);return l.type!==k.ResourceModalsActionTypes.CreateEnvs||"integration"!==d?null:(0,t.jsx)(er,{backOrCancelLabel:l.backOrCancelLabel,onBack:s,onClickOutside:i,onConnectionCreated:p,project:g.data,resourceId:o.id,store:o,subtitle:(0,t.jsxs)(r.Stack,{align:"center",direction:"row",gap:1.5,justify:"center",children:[(0,t.jsx)(a.Text,{color:"gray-900",children:"Connect to"}),(0,t.jsx)(y.ProductIcon,{icon:o.product.iconUrl,size:"small"}),(0,t.jsx)(a.Text,{color:"gray-1000",weight:500,children:o.name})]}),title:`Configure ${g.data?.name??""}`})}function ea(e){let{active:n,store:i,connection:s,resourceId:l,onClickOutside:c,onAnimationDone:d,onConnectionCreated:u}=e,g=(0,x.useProject)(s.projectId);return"integration"!==i.type?null:(0,t.jsx)(o.Modal.Modal,{active:n,allowOverflow:!0,onAnimationDone:d,onClickOutside:c,width:540,children:(0,t.jsx)(er,{backOrCancelLabel:"Cancel",connection:s,onBack:c,onClickOutside:c,onConnectionCreated:u,project:g.data,resourceId:l,store:i,subtitle:(0,t.jsxs)(r.Stack,{align:"center",direction:"row",gap:1.5,justify:"center",children:[(0,t.jsx)(a.Text,{color:"gray-900",children:"Connect to"}),(0,t.jsx)(y.ProductIcon,{icon:i.product.iconUrl,size:"small"}),(0,t.jsx)(a.Text,{color:"gray-1000",weight:500,children:i.name})]}),title:`Configure ${g.data?.name??""}`})})}e.s({DeleteStoreConnectionModal:()=>ed},9199642);var el=e.i(36632),ec=e.i(263946);function ed(e){let{active:l,onClickOutside:c,connections:d,onAnimationDone:u,resourceId:g,resourceTitle:p}=e,{removeConnections:h}=(0,f.useResourceConnection)(),[x,j]=(0,n.useState)(!1),[m,v]=(0,n.useState)(null),b=(0,i.useToasts)(),S=(0,n.useCallback)(async e=>{e.preventDefault(),v(null),j(!0);try{await h({connectionIds:d.map(e=>e.id),resourceId:g}),j(!1),c()}catch(e){j(!1),(0,el.isError)(e)?v(e):b.error(`Unexpected error while removing the ${p} connection`)}},[h,d,g,c,b,p]),y=d.some(e=>(0,w.isLogDrainInConnection)(e));return(0,t.jsx)(o.Modal.Modal,{active:l,onAnimationDone:u,onClickOutside:c,children:(0,t.jsxs)("form",{onSubmit:e=>void S(e),children:[(0,t.jsx)(o.Modal.Body,{children:(0,t.jsxs)(r.Stack,{gap:6,children:[(0,t.jsxs)(o.Modal.Title,{center:!1,children:["Remove"," ",y?"Project Connection & Log Drain":"Project Connection"]}),(0,t.jsxs)(r.Stack,{gap:6,children:[(0,t.jsxs)(r.Stack,{gap:2,children:[(0,t.jsx)(a.Text,{children:"Are you sure you want to remove this project connection?"}),(0,t.jsxs)(a.Text,{children:["Removing the connection will delete the associated environment variables from the project and future deployments will not be able to access the ",p,"."]})]}),(0,t.jsxs)(r.Stack,{gap:3,children:[(0,t.jsx)(a.Text,{color:"gray-900",children:"Projects"}),(0,t.jsx)(ec.ProjectConnectionsListInModal,{connections:d})]}),m?(0,t.jsx)(s.Error,{children:m.message}):null]})]})}),(0,t.jsxs)(o.Modal.Actions,{children:[(0,t.jsx)(o.Modal.Action,{disabled:x,onClick:c,type:"secondary",children:"Cancel"}),(0,t.jsx)(o.Modal.Action,{buttonType:"submit",disabled:x,loading:x,children:1===d.length?"Remove Connection":`Remove ${d.length} Connections`})]})]})})}},[9199642]]}]);

//# sourceMappingURL=5da708a7b5f5b2eb.js.map
//# debugId=eb3b98f3-d628-5549-b7de-4bc46de67f2f
