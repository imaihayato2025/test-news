
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="4989e561-a7f4-56b1-9983-3b43e38bdb2a")}catch(e){}}();
(globalThis.TURBOPACK=globalThis.TURBOPACK||[]).push(["object"==typeof document?document.currentScript:void 0,{3486352:e=>{"use strict";e.s({deleteEnvVar:()=>a,isSharedEnv:()=>i,isSharedEnvID:()=>s});var t=e.i(6649026),n=e.i(1183506),r=e.i(9336536);function i(e){return s(e.id)}function s(e){return e.startsWith("env")}function a(e){let{envVars:s,teamId:a,projectId:l}=e;return i(s[0])?function(e){let{envVars:i,teamId:s}=e;return(0,n.fetchAPI)(`${r.API_SHARED_ENV_VARIABLES}${(0,t.encode)({teamId:s})}`,{body:JSON.stringify({ids:i.map(e=>e.id)}),method:"DELETE",throwOnHTTPError:!0})}({envVars:s,teamId:a}):function(e){let{envVars:i,projectId:s,teamId:a}=e;return Promise.all(i.map(e=>(0,n.fetchAPI)(`${(0,r.API_PROJECTS_VERSION)("v7")}/${s??""}/env/${e.id}${(0,t.encode)({teamId:a})}`,{method:"DELETE",throwOnHTTPError:!0})))}({envVars:s,teamId:a,projectId:l})}},745124:e=>{"use strict";e.s({useDecryptEnvVar:()=>h});var t=e.i(3521787),n=e.i(7320579),r=e.i(6530772),i=e.i(6649026),s=e.i(1183506),a=e.i(9336536),l=e.i(3509620),o=e.i(3514588),d=e.i(3585235),u=e.i(5785123),c=e.i(3486352);function h(e,h,m){let[p,g]=(0,r.useState)(void 0),{cache:y}=(0,n.useSWRConfig)(),{data:f}=function(e,n,r,h){let{isReady:m,team:p}=(0,o.useTeam)(),{can:g,isLoading:y}=(0,d.default)(e?{projectIdOrName:e}:void 0),f=g(u.Action.Read,u.Resource.ProjectEnvVars),b=m&&!y&&f&&n&&r!==l.EnvType.Sensitive,x="";return b&&((0,c.isSharedEnvID)(n)?x=`${a.API_SHARED_ENV_VARIABLES}/${n}${(0,i.encode)({teamId:p?.id})}`:e&&(x=`${(0,a.API_PROJECTS_VERSION)("v1")}/${encodeURIComponent(e)}/env/${n}${(0,i.encode)({teamId:p?.id})}`)),(0,t.default)(x,e=>(0,s.fetchAPI)(e,{throwOnHTTPError:!0}),void 0)}(m.projectId||m.projectName,p?.id,p?.type);return(0,r.useEffect)(()=>{if(!p||!f||p.type===l.EnvType.Sensitive)return;let t=y.get(e)?.data;if(0===t.envs.length)return;let n=[...t.envs],r=n.findIndex(e=>e.id===p.id),i=n[r];f.updatedAt&&i.updatedAt&&!(f.updatedAt<i.updatedAt)&&(n[r]=f,h({envs:n},!1),g(void 0))},[e,y,f,p,h]),{decryptEnvVar:g}}},2964099:[e=>{"use strict";e.s({useWrappedToolbarAuthLinkHandler:()=>g,wrapURLWithFeedback:()=>p},2964099);var t=e.i(854226),n=e.i(2781454),r=e.i(5454140);e.s({useArePreviewCommentsEnabled:()=>c,useCommentsEnabledForDeployment:()=>m},429041);var i=e.i(6530772),s=e.i(503726),a=e.i(1389821),l=e.i(2240289),o=e.i(8955572),d=e.i(745124),u=e.i(5938635);function c(e){var t,n;let{account:r,team:u,isLoading:c}=(0,s.useAccount)(),h=r?.enablePreviewFeedback??"default",m=h.includes("-force")||!1,p=function(e){switch(e){case"on":case"default":default:return!0;case"off":return!1}}(h.replace("-force","")),g=(0,a.useProjectIdOrName)(),{data:y,isLoading:f}=(0,l.useProject)(g,{apiVersion:"v13"}),b=y?y.enablePreviewFeedback??!0:p,x=m?p:b,v=e?.branch,j=e?.target,E=!m&&e?y?.name:void 0,{data:{envs:I=[]}={},mutate:C,isLoading:k}=(0,o.default)(E),S=v?I.find(e=>"VERCEL_PREVIEW_FEEDBACK_ENABLED"===e.key&&e.gitBranch===v):void 0,w=j?I.find(e=>"VERCEL_PREVIEW_FEEDBACK_ENABLED"===e.key&&(Array.isArray(e.target)?e.target.includes(j):e.target===j)&&!e.gitBranch):void 0,A=S??w,{decryptEnvVar:R}=(0,d.useDecryptEnvVar)(E?(0,o.getUseProjectEnvsSWRKey)(E,u?.id):"",C,{projectName:E,teamId:u?.id});(0,i.useEffect)(()=>{A?.decrypted===!1&&R(A)},[A,R]);let L=A?.decrypted===!0?(t=A.value,n=x,("1"===t||"true"===t||void 0)??("0"!==t&&"false"!==t&&void 0)??n):x;return c||!y&&f||k?{value:null,isLoading:!0}:{value:L,isLoading:!1}}let h=new Date("2024-05-24").getTime();function m(e){var t;let n=e&&"previewCommentsEnabled"in e,{data:r}=(0,u.default)(n?void 0:e?.id);return t=n?e:r,!!t?.previewCommentsEnabled&&(null===t.target||"production"===t.target&&!!(t.createdAt>h))}let p=(e,t)=>{let n=e.replace(/https?:\/\//,"");return`https://vercel.com/api/toolbar/link/${n}?via=${t.via}${t.isProduction?"&p=1":""}${t.intent?`&i=${t.intent}`:""}${t.passThrough?"&passThrough=1":""}${t.page?`&page=${t.page}`:""}`};function g(e){let{user:i}=(0,r.useUser)(),s=!i||i.limited,a=m(e.deployment),l=e.deployment?.target==="production",o=l&&s,{track:d}=(0,t.useTrackActivity)();if(!a||l)return{};let u=t=>{if(!("click"===t.type||"auxclick"===t.type||"contextmenu"===t.type||"key"in t&&"Enter"===t.key))return;let r=t.target;if(!(r instanceof HTMLElement))return;let i=r.closest("a"),s=i?.getAttribute("href");if(!i||!s||!s.startsWith("http")||s.startsWith("https://vercel.live/link/")||s.startsWith("https://vercel.com/api/toolbar/link/")){(s?.startsWith("https://vercel.live/link/")||s?.startsWith("https://vercel.com/api/toolbar/link/"))&&console.error(`bad wrap from: ${window.location.href} to: ${s} via: ${e.via}`);return}if("contextmenu"===t.type)return void d(n.VercelActivityAction.ToolbarWrappedUrlContextMenuOpened,{via:e.via});let a=new URL(s),u=a.pathname,c=p(a.hostname,{via:e.via,isProduction:l,passThrough:o,page:u}),h=document.createElement("a");Array.from(i.attributes).forEach(e=>{h.setAttribute(e.name,e.value)}),h.href=c,"key"in t?h.dispatchEvent(new window.KeyboardEvent("keydown",{bubbles:t.bubbles,cancelable:t.cancelable,key:t.key,code:t.code,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,metaKey:t.metaKey})):(h.dispatchEvent(new window.MouseEvent("click",{bubbles:t.bubbles,cancelable:t.cancelable,detail:t.detail,screenX:t.screenX,screenY:t.screenY,clientX:t.clientX,clientY:t.clientY,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,metaKey:t.metaKey,button:t.button,buttons:t.buttons})),t.preventDefault())};return{onClick:u,onKeyDown:u,onAuxClick:u,onContextMenu:u}}},[429041]],3153829:e=>{"use strict";function t(e){return`https://${e}`}e.s({domainToUrl:()=>t})},3076719:e=>{"use strict";function t(e,t){return t?`${e}${t.startsWith("/")?t:`/${t}`}`:e}e.s({withDefaultRoute:()=>t})},6025740:e=>{"use strict";e.s({useOnDemandConcurrentBuilds:()=>r});let t={enabled:!0,disabledReason:void 0},n=e=>({enabled:!1,disabledReason:e});function r(e,r){if(!e||!e.billing)return n("other");if("enterprise"===e.billing.plan)return"unbundled"===e.billing.planIteration?r?t:n("no-permission"):n("enterprise-non-unbundled");if("pro"===e.billing.plan)return"active"===e.billing.status?r?t:n("no-permission"):n("pro-non-active");return n("hobby-plan")}},5128868:e=>{"use strict";e.s({StartBuildingNowModal:()=>u});var t=e.i(6645307),n=e.i(6530772),r=e.i(8934201),i=e.i(889716),s=e.i(8084653),a=e.i(584439),l=e.i(1183506),o=e.i(9336536),d=e.i(2362802);function u(e){let[u,c]=(0,n.useState)(!1),h=(0,a.useToasts)(),m=(0,n.useCallback)(async()=>{if(!e.deploymentId||!e.teamId)return;c(!0);let t=new URLSearchParams;t.append("teamId",e.teamId);let n=`${(0,o.API_DEPLOYMENTS)("v13")}/${e.deploymentId}/skip-queue?${t.toString()}`;200===(await (0,l.fetchAPI)(n,{method:"POST",body:void 0,throwOnHTTPError:!1,returnStatus:!0})).status?(h.success("Deployment will start building now."),e.onSuccess?.()):h.error("Something went wrong"),c(!1),e.onClose()},[e,h]);return(0,t.jsxs)(r.Modal.Modal,{active:e.active,onClickOutside:e.onClose,width:"500px",children:[(0,t.jsxs)(r.Modal.Body,{children:[(0,t.jsx)(r.Modal.Header,{children:(0,t.jsx)(r.Modal.Title,{children:(0,t.jsx)(i.Stack,{align:"center",direction:"row",gap:2,children:"Start Building Now"})})}),(0,t.jsxs)(i.Stack,{align:"center",direction:"column",gap:2,children:[(0,t.jsxs)(s.Text,{children:["This will bypass the regular queue and start your build immediately. On-demand builds are billed in 1 minute increments."," ",(0,t.jsx)(d.Link,{href:"/docs/deployments/managing-builds#on-demand-concurrent-builds",target:"_blank",variant:"highlight",children:"Learn more."})]}),e.teamId&&e.projectName?(0,t.jsxs)(s.Text,{children:["If you frequently need faster builds for this project, consider enabling"," ",(0,t.jsx)(d.Link,{as:`/${e.teamId}/${encodeURIComponent(e.projectName)}/settings/build-and-deployment`,href:"/[teamSlug]/[project]/settings/build-and-deployment",target:"_blank",variant:"highlight",children:"On-Demand Concurrent Builds"})," ","at the project level."]}):null,(0,t.jsx)(s.Text,{children:'By clicking "Confirm" you agree to be charged for on-demand concurrency.'})]})]}),(0,t.jsxs)(r.Modal.Actions,{children:[(0,t.jsx)(r.Modal.Action,{loading:!1,onClick:e.onClose,type:"secondary",children:"Close"}),(0,t.jsx)(r.Modal.Action,{disabled:u,loading:u,onClick:m,children:"Confirm"})]})]})}},6559527:e=>{"use strict";e.s({ScreenshotOrStatus:()=>ee},6559527);var t=e.i(6645307),n=e.i(6530772),r=e.i(5610210),i=e.i(5535439),s=e.i(555528),a=e.i(5674541),l=e.i(889716),o=e.i(8084653),d=e.i(2362802),u=e.i(7573892),c=e.i(9802771),h=e.i(503726),m=e.i(2448773),p=e.i(3585235),g=e.i(5785123),y=e.i(6025740),f=e.i(8232065),b=e.i(3153829),x=e.i(3076719),v=e.i(1922196),j=e.i(9505396);let E=new Map;window.addEventListener("storage",e=>{e.key&&(null===e.newValue?E.delete(e.key):E.set(e.key,e.newValue))});class I{key;defaultValue;constructor(e,t){this.key=e,this.defaultValue=t,this.init()}init(){if(!E.has(this.key))try{E.set(this.key,window.localStorage?.getItem(this.key))}catch(e){}}reset(){this.set(this.defaultValue)}get(){let e=E.get(this.key);if(!e)return this.defaultValue;try{return JSON.parse(e)}catch(e){return this.defaultValue}}set(e){try{let t=JSON.stringify(e);window.localStorage?.setItem(this.key,t),E.set(this.key,t)}catch(e){}}remove(){try{window.localStorage?.removeItem(this.key),E.delete(this.key)}catch(e){}}}e.i(7901367);var C=e.i(540570),k=e.i(2964099),S=e.i(5128868),w=e.i(3387593),A=e.i(8811733),R=e.i(878537);let L=e=>{let{title:n,message:r,link:i,action:s="Learn More",onDismiss:l}=e;return(0,t.jsxs)(R.default,{style:{padding:"var(--geist-gap)",width:"100%",height:"100%",position:"absolute"},children:[(0,t.jsx)(m.default,{Component:"span",h5:!0,children:n}),(0,t.jsx)(A.Spacer,{y:1/3}),(0,t.jsx)(R.default,{className:"min-h-0 break-words",children:(0,t.jsx)(w.Scroller,{children:(0,t.jsx)(m.default,{Component:"p",noMargin:!0,small:!0,type:"secondary",children:r})})}),(0,t.jsx)(A.Spacer,{y:2/3}),(0,t.jsxs)(R.default,{row:!0,style:{justifyContent:"center",alignItems:"flex-end"},children:[(0,t.jsx)(a.Button,{onClick:l,size:"small",style:{flex:"1"},type:"secondary",children:"Dismiss"}),i?(0,t.jsx)(A.Spacer,{x:.5}):null,i?(0,t.jsx)(d.ButtonLink,{href:i,size:"small",style:{flex:"1"},children:s}):null]})]})},T=["https://vercel.com/","https://zeit.ink/","https://vercel.link/","https://err.sh/","https://github.com/zeit/","https://github.com/vercel/"],D=e=>{let{status:n,link:r,buttonText:i}=e;return!function(e){return"string"==typeof e&&T.some(t=>e.startsWith(t))}(r)?"QUEUED"===n&&r?(0,t.jsx)(d.ButtonLink,{href:r,size:"small",children:i||"Add Concurrent Builds"}):(0,t.jsx)(a.Button,{passthroughOnClick:e=>{e.preventDefault();let t=document.querySelector("[data-status=error]");t&&(t?.dataset.state!=="open"&&t.querySelector("button")?.click(),t.scrollIntoView({behavior:"smooth"}))},type:"secondary",children:"View Logs"}):(0,t.jsx)(d.ButtonLink,{href:r,size:"small",type:"secondary",children:"Learn More"})},N=e=>{let{title:n,link:r,message:i,buttonText:s,status:a,actionButton:o}=e;return(0,t.jsxs)(R.default,{style:{padding:"var(--geist-gap)",width:"100%",height:"100%",position:"absolute"},children:[(0,t.jsx)(m.default,{Component:"span",h5:!0,children:n}),(0,t.jsx)(A.Spacer,{y:1/3}),(0,t.jsx)(R.default,{className:"min-h-0 break-words",children:(0,t.jsx)(w.Scroller,{children:(0,t.jsx)(m.default,{Component:"p",noMargin:!0,small:!0,type:"secondary",children:i||"Your deployment has failed to build successfully. Please check out the logs for more details."})})}),r||o?(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(l.Stack,{direction:"column",gap:2,children:[r?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(D,{buttonText:s,link:r,status:a})}):(0,t.jsx)(A.Spacer,{y:1/6}),o?(0,t.jsx)(t.Fragment,{children:o}):null]})}):null]})};var B=e.i(442955),M=e.i(5163670),P=e.i(7179748),_=e.i(4576696);function O(e,t){switch(t.type){case"LIGHT_IMAGE_LOADING":return{...e,lightImage:"pending"};case"LIGHT_IMAGE_SUCCESS":return{...e,lightImage:"success"};case"LIGHT_IMAGE_FAILURE":return{...e,lightImage:"failure"};case"DARK_IMAGE_LOADING":return{...e,darkImage:"pending"};case"DARK_IMAGE_SUCCESS":return{...e,darkImage:"success"};case"DARK_IMAGE_FAILURE":return{...e,darkImage:"failure"};default:return e}}let U={lightImage:"pending",darkImage:"pending"};function $(e,t,n,r){let i=new URL("/api/screenshot","production"!==B.default.env.VERCEL_ENV&&B.default.env.VERCEL_URL?`https://${B.default.env.VERCEL_URL}`:"https://vercel.com");return t?(i.searchParams.set("dark","dark"===e?"1":"0"),i.searchParams.set("deploymentId",t),n&&i.searchParams.set("teamId",n),r&&i.searchParams.set("withStatus","1"),`${i.pathname}${i.search}`):""}function F(e){let{srcLight:n,srcDark:r,onLoad:i,onError:s,alt:a}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(V,{alt:a,className:"absolute block size-full dark:hidden",onError:()=>s("light"),onLoad:()=>i("light"),src:n}),(0,t.jsx)(V,{alt:a,className:"absolute hidden size-full dark:block",onError:()=>s("dark"),onLoad:()=>i("dark"),src:r})]})}function V(e){let{src:i,onLoad:s,renderScale:a=3,onError:l,className:o,alt:d}=e,u=(0,n.useRef)(null),c=(0,n.useRef)(null),[h,m]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{let e=u.current;if(!e)return;c.current||(c.current=new Image);let t=c.current,n=()=>{let n=e.getContext("2d");if(!n)return;let r=e.offsetWidth,i=e.offsetHeight,s=r*a,l=i*a;e.width=s,e.height=l,n.scale(a,a),n.clearRect(0,0,s,l);let o=Math.min(r/t.width,i/t.height),d=r/2-t.width/2*o;n.drawImage(t,d,0,t.width*o,t.height*o)};if(t.src===i)return;t.src=i,t.onload=()=>{s(),m(!0),n()},t.onerror=()=>{l()};let r=()=>{n()};return window.addEventListener("resize",r),r(),()=>{window.removeEventListener("resize",r)}},[i,a]),(0,t.jsx)("canvas",{"aria-hidden":"true","aria-label":d,className:(0,r.clsx)(o,"size-full",{"animate-blurIn":h}),ref:u,role:"img",style:{width:"100%",height:"100%"}})}let K=n.default.memo(e=>{let{deployment:s,placeholder:a,noBorderRadius:l=!1,withReachable:o=!1,withImageWrapper:d=!0,onReady:u,height:c=400,width:h=640,onScreenshotFailed:m=()=>null}=e,p="string"==typeof s?.url?s.url:"",g="string"==typeof s?.id?s.id:void 0,y=h?{"--width":(0,_.px)(h)}:{},{teamSlug:f=""}=(0,i.useParams)()??{},b=(0,n.useMemo)(()=>$("dark",g,f,o),[g,f,o]),x=(0,n.useMemo)(()=>$("light",g,f,o),[g,f,o]),[v,j]=(0,n.useReducer)(O,U),{resolvedTheme:E}=(0,P.useTheme)(),I=(0,n.useCallback)(e=>{void 0===e?(j({type:"LIGHT_IMAGE_SUCCESS"}),j({type:"DARK_IMAGE_SUCCESS"})):j({type:"dark"===e?"DARK_IMAGE_SUCCESS":"LIGHT_IMAGE_SUCCESS"}),u?.(!0)},[u]),C=(0,n.useCallback)(e=>{b&&x&&(void 0===e?(j({type:"LIGHT_IMAGE_FAILURE"}),j({type:"DARK_IMAGE_FAILURE"}),u?.(!1)):("dark"===e?b:x)&&(j({type:"dark"===e?"DARK_IMAGE_FAILURE":"LIGHT_IMAGE_FAILURE"}),u?.(!1)))},[u,b,x]),k="dark"===E?"failure"===v.darkImage:"failure"===v.lightImage,S=a||("dark"===E?"pending"===v.darkImage:"pending"===v.lightImage);if(k||!S&&!s)return m();let w=(0,t.jsx)(F,{alt:`Preview Screenshot of ${p}`,onError:C,onLoad:I,srcDark:b,srcLight:x});return(0,t.jsx)(M.Skeleton,{show:S,squared:l,style:{width:"100%",height:"100%"},children:d?(0,t.jsx)("div",{className:(0,r.clsx)("relative aspect-[var(--width,640)/var(--height,400)] size-full",{"rounded-none":l}),style:c?{"--height":(0,_.px)(c),...y}:{},children:w}):w})});var Q=e.i(3514588),H=e.i(8934201),W=e.i(584439),G=e.i(1183506),z=e.i(9336536);function q(e){let r=(0,i.useRouter)(),[s,a]=(0,n.useState)(!1),u=(0,W.useToasts)(),c=(0,n.useCallback)(async()=>{if(e.deploymentId&&e.teamId&&e.projectName){a(!0);{let t=new URLSearchParams;t.append("teamId",e.teamId),200===(await (0,G.fetchAPI)(`${(0,z.API_PROJECTS_VERSION)("v9")}/${e.projectName}?${t.toString()}`,{method:"PATCH",body:JSON.stringify({resourceConfig:{elasticConcurrencyEnabled:!0,buildMachineType:e.buildMachineType}}),throwOnHTTPError:!1,returnStatus:!0})).status?u.success(`Enabled ${e.buildMachineTypeLabel}`):(u.error("Something went wrong"),a(!1),e.onClose())}{let t=new URLSearchParams;t.append("teamId",e.teamId),t.append("forceNew","1"),t.append("withCache","1");let n=`${(0,z.API_DEPLOYMENTS)("v13")}?${t.toString()}`,i=await (0,G.fetchAPI)(n,{method:"POST",body:JSON.stringify({deploymentId:e.deploymentId,meta:{action:"redeploy",buildMachineUpgradeReason:e.oomReport,buildMachineAfterUpgrade:e.buildMachineType},name:e.projectName}),throwOnHTTPError:!1,returnStatus:!0});if(200===i.status&&i.body.inspectorUrl){e.onSuccess?.();let t=new URL(i.body.inspectorUrl);r.push(t.pathname)}else u.error("Something went wrong")}a(!1),e.onClose()}},[e,u,r]);return(0,t.jsxs)(H.Modal.Modal,{active:e.active,onClickOutside:e.onClose,width:"500px",children:[(0,t.jsxs)(H.Modal.Body,{children:[(0,t.jsx)(H.Modal.Header,{children:(0,t.jsx)(H.Modal.Title,{children:(0,t.jsxs)(l.Stack,{align:"center",direction:"row",gap:2,children:["Enable ",e.buildMachineTypeLabel]})})}),(0,t.jsxs)(l.Stack,{align:"center",direction:"column",gap:2,children:[(0,t.jsxs)(o.Text,{children:["Overcome memory constraints by activating On-demand Concurrency with"," ",e.buildMachineTypeLabel,"."]}),e.teamId&&e.projectName?(0,t.jsxs)(o.Text,{children:["Adjust this setting anytime via your project's"," ",(0,t.jsx)(d.Link,{as:`/${e.teamId}/${encodeURIComponent(e.projectName)}/settings/build-and-deployment#on-demand-concurrent-builds`,href:"/[teamSlug]/[project]/settings/build-and-deployment",target:"_blank",variant:"highlight",children:"On-Demand Concurrent Builds"})," ","options."]}):null,(0,t.jsxs)(o.Text,{children:['By clicking "Confirm & Redeploy" you agree to be charged for On-demand Concurrency.'," ",(0,t.jsx)(d.Link,{href:"/docs/deployments/managing-builds#enhanced-build-machines",target:"_blank",variant:"highlight",children:"Learn more"})]})]})]}),(0,t.jsxs)(H.Modal.Actions,{children:[(0,t.jsx)(H.Modal.Action,{loading:!1,onClick:e.onClose,type:"secondary",children:"Close"}),(0,t.jsx)(H.Modal.Action,{disabled:s,loading:s,onClick:c,children:"Confirm & Redeploy"})]})]})}var Y=e.i(2240289),J=e.i(3326412);let X=new Map([["enterprise-non-unbundled","Contact sales to enable On-Demand Concurrent Builds"],["pro-non-active","Upgrade to Pro to enable On-Demand Concurrent Builds"],["no-permission","Only project admins and team owners can trigger builds on-demand"]]);function Z(e){let{deploy:r,showError:i,isInConcurrentBuildsQueue:o,isInSystemBuildsQueue:u,compact:c,ctaOverride:b,projectName:x}=e,{status:v,errorMessage:j,errorLink:E=""}=r,{data:I}=(0,f.useFeatureFlag)("enable-team-deployments-page"),{user:k,team:w}=(0,h.useAccount)(),A=(0,C.useOpenUpgradeModal)(),R=r.target?g.Resource.Deployment:g.Resource.DeploymentPreview,{can:L}=(0,p.default)(),T=L(g.Action.Update,R),D=L(g.Action.Update,g.Resource.ConcurrentBuilds),[B,M]=(0,n.useState)(null),[P,_]=(0,n.useState)(!1),O="string"==typeof r.id?r.id:void 0,{enabled:U,disabledReason:$}=(0,y.useOnDemandConcurrentBuilds)(w,T),F=U||$&&X.has($),V=$?X.get($):void 0,[K,Q]=(0,n.useState)(U),H=(0,Y.useProject)(x),W=(0,J.useProAndEntOnDemandTurboBuilds)(),G=(0,n.useMemo)(()=>H.isLoading||!H.data?null:void 0===H.data.resourceConfig||!1===H.data.resourceConfig.elasticConcurrencyEnabled||void 0===H.data.resourceConfig.buildMachineType?"enhanced":"enhanced"===H.data.resourceConfig.buildMachineType&&W.isReady&&W.value?"turbo":null,[H,W]),z=F?(0,t.jsx)(et,{enabled:K,onClick:()=>M(O??null),reasonWhyStartBuildingNowIsDisabled:V}):null,Z=new URLSearchParams({content:"I'd like to add extra concurrent builds to my contract."});if(!w)return(0,t.jsx)(m.default,{className:"m-auto text-center",small:!0,type:"secondary",children:"Loadingâ€¦"});if(k?.email&&Z.set("email",k.email),"ERROR"===v){if(!i)return(0,t.jsx)(m.default,{className:"m-auto text-center",small:!0,type:"error",children:"Deployment Failed"});if("out-of-memory"===r.oomReport&&G){var ee;let e=`${(ee=G)[0].toUpperCase()+ee.slice(1)} Builds`;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(N,{actionButton:(0,t.jsx)(s.Tooltip,{text:D?void 0:`You don't have permission to Enable ${e}.`,children:(0,t.jsxs)(a.Button,{className:"w-full",disabled:!D,onClick:()=>{_(!0)},size:"small",type:"default",children:["Enable ",e]})}),message:`To expand your machine size to get additional memory and disk space, consider enabling ${e}.`,status:v,title:"Build Failed (out of memory)"}),(0,t.jsx)(q,{active:P,buildMachineType:G,buildMachineTypeLabel:e,deploymentId:r.id||null,onClose:()=>{_(!1)},onSuccess:()=>{_(!1)},oomReport:r.oomReport,projectName:x??null,teamId:w.slug})]})}return(0,t.jsx)(N,{link:E,message:j||"Your deployment has failed to build successfully. Please check out the logs for more details.",status:v,title:"Build Failed"})}if("FROZEN"===v||"FAILED"===v)return(0,t.jsx)(m.default,{className:"m-auto text-center",small:!0,type:"secondary",children:"No Screenshot Available"});if("NO_PRODUCTION"===v)return(0,t.jsx)(s.Tooltip,{className:"m-auto text-center",delay:!1,text:"To deploy to production, push to the Repository Default branch.",children:(0,t.jsx)(m.default,{small:!0,type:"secondary",children:"No Production Deployment"})});if("CANCELED"===v)return i&&j?(0,t.jsx)(N,{link:E,message:j||"Deployment canceled.",status:v,title:"Build Canceled"}):(0,t.jsx)(m.default,{className:"m-auto text-center",small:!0,type:"secondary",children:"Deployment Canceled"});if("QUEUED"===v&&u)return(0,t.jsx)(m.default,{className:"m-auto text-center",small:!0,type:"secondary",children:"Initializing..."});if("QUEUED"===v||b){let e="Deployments",n=I?(0,t.jsx)(d.Link,{href:`/${w.slug}/~/deployments?status=building%2Cqueued`,underline:!0,children:e}):e;return"pro-concurrent-builds"===b||w.billing?.plan==="pro"&&o?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(N,{message:(0,t.jsxs)(t.Fragment,{children:["The build will start once your other ",n," have finished. Add"," ",(0,t.jsx)(d.Link,{as:`/${w.slug}/~/settings/billing#concurrent-builds`,href:"/[teamSlug]/~/settings/billing#concurrent-builds",target:"_blank",underline:!0,children:"concurrent build slots"})," ","or use"," ",(0,t.jsx)(d.Link,{as:`/${w.slug}/${encodeURIComponent(x??"")}/settings/build-and-deployment`,href:"/[teamSlug]/[project]/settings/build-and-deployment",target:"_blank",underline:!0,children:"On-Demand Concurrent Builds"})," ","to avoid the queue."]}),actionButton:z,status:"QUEUED",title:"Deployment Queued"}),(0,t.jsx)(S.StartBuildingNowModal,{active:!!B,deploymentId:B,onClose:()=>{M(null)},onSuccess:()=>{Q(!1)},projectName:x??null,teamId:w.slug})]}):"enterprise-concurrent-builds"===b||w.billing?.plan==="enterprise"&&o?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(N,{message:(0,t.jsxs)(l.Stack,{direction:"column",gap:1,children:[(0,t.jsxs)("div",{children:["The build will start once your other ",n," have finished."]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(d.Link,{href:`/contact/sales?${Z.toString()}`,underline:!0,children:"Contact Sales"})," ","to add concurrent build slots or use"," ",(0,t.jsx)(d.Link,{as:`/${w.slug}/${encodeURIComponent(x??"")}/settings/build-and-deployment`,href:"/[teamSlug]/[project]/settings/build-and-deployment",target:"_blank",underline:!0,children:"On-Demand Concurrent Builds"})," ","to avoid the queue."]})]}),actionButton:z,status:"QUEUED",title:"Deployment Queued"}),(0,t.jsx)(S.StartBuildingNowModal,{active:!!B,deploymentId:B,onClose:()=>{M(null)},onSuccess:()=>{Q(!1)},projectName:x??null,teamId:w.slug})]}):"hobby-concurrent-builds"===b||w.billing?.plan==="hobby"&&o?(0,t.jsx)(N,{message:(0,t.jsxs)(t.Fragment,{children:["The build will start once your other ",n," have finished. Pro teams can use On-Demand Concurrent Builds to avoid the queue."]}),status:"QUEUED",title:"Another build is in progress",actionButton:(0,t.jsx)(a.Button,{onClick:()=>{A({teamHint:w.id,source:"concurrent-builds-queue"})},size:"small",type:"default",children:"Upgrade to Pro"})}):c?(0,t.jsx)(m.default,{className:"m-auto text-center",small:!0,type:"secondary",children:"Deployment Queued"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(N,{message:(0,t.jsxs)(t.Fragment,{children:["The build will start once other"," ",x?(0,t.jsx)(d.Link,{href:`/${w.slug}/${x}/deployments?status=building%2Cqueued`,underline:!0,children:e}):e," ","for this branch have finished."," ",(0,t.jsx)(d.Link,{href:"/docs/builds/build-queues#git-branch-queue",underline:!0,children:"Learn more."})]}),actionButton:z,status:"QUEUED",title:"Deployment Queued"}),(0,t.jsx)(S.StartBuildingNowModal,{active:!!B,deploymentId:B,onClose:()=>{M(null)},onSuccess:()=>{Q(!1)},projectName:x??null,teamId:w.slug})]})}return(0,t.jsx)(m.default,{className:"m-auto text-center",small:!0,type:"secondary",children:"Building..."})}function ee(e){var s;let{deployment:a,ignoreAliasWarning:l=!0,placeholder:h,toolbarVia:m,customHref:p,compact:g,...y}=e,{showError:f=!1,link:v=!0,empty:E=!1,noHighlight:C,noBorder:S,noBorderRadius:w,useDeploymentUrl:A=!1,onClick:R}=y,T=null!=(s=a)&&"project"in s?a.project?.name:void 0,D=(0,i.useSearchParams)(),{domain:B}=(0,j.useBestProductionDomain)(T),M=B||y.projectDomain||null,[P,_]=function(e){let t=(0,n.useMemo)(()=>e?new I(`show-deployment-warning:${e.uid||e.id}`,!0):null,[e]),[r,i]=(0,n.useState)(()=>{let e=t?.get();return"boolean"!=typeof e||e});return[r,e=>{t?.set(e),i(e)}]}(a),{onClick:O,...U}=(0,k.useWrappedToolbarAuthLinkHandler)({via:m??"project-screenshot",deployment:v?a:void 0}),{team:$}=(0,Q.useTeam)(),F=function(e){if(!e||!("microfrontends"in e)||!e.microfrontends)return!1;let t=e.microfrontends;return!t.isDefaultApp&&!t.defaultRoute}(a),V=`/${$?.slug}/${T}/settings/microfrontends#default-route`,H=(0,n.useMemo)(()=>(function(e){if(null!==e){if(null!==e.get("overrideHobbyConcurrentBuildsCta"))return"hobby-concurrent-builds";if(null!==e.get("overrideProConcurrentBuildsCta"))return"pro-concurrent-builds";if(null!==e.get("overrideEnterpriseConcurrentBuildsCta"))return"enterprise-concurrent-builds"}})(D),[D]),W=(0,n.useMemo)(()=>{if(!a)return E?{status:"NO_PRODUCTION"}:null;let e=A?a.url:en(a,M);return{id:a.uid||a.id,url:e,target:a.target,status:a.state||a.status||a.readyState,errorMessage:a.readyStateReasonExternal||a.errorMessage,errorLink:a.errorLink,aliasWarning:a.aliasWarning,oomReport:a.oomReport}},[A,a,E,M]),G=!l&&P&&W?.status==="READY"&&W?.aliasWarning?.code==="deprecated_now_sh",z=W&&"READY"!==W.status,q=W?.status==="ERROR"||a?.aliasError,Y=(0,n.useCallback)(()=>(0,t.jsx)(Z,{deploy:{...W,status:"FAILED"},isInConcurrentBuildsQueue:a?.isInConcurrentBuildsQueue,isInSystemBuildsQueue:a?.isInSystemBuildsQueue,projectName:T,showError:f}),[W,f,T,a?.isInConcurrentBuildsQueue,a?.isInSystemBuildsQueue]),J=(0,n.useMemo)(()=>H?(0,t.jsx)(Z,{ctaOverride:H,deploy:W??{},isInConcurrentBuildsQueue:a?.isInConcurrentBuildsQueue,isInSystemBuildsQueue:a?.isInSystemBuildsQueue,projectName:T,showError:f}):a?.aliasError?(0,t.jsx)(N,{message:a.aliasError.message,status:"ERROR",title:"Domain Error"}):G?(0,t.jsx)(L,{link:W.aliasWarning.link,message:W.aliasWarning.message,onDismiss:()=>_(!1),title:"Warning"}):z?(0,t.jsx)(Z,{compact:g,deploy:W,isInConcurrentBuildsQueue:a?.isInConcurrentBuildsQueue,isInSystemBuildsQueue:a?.isInSystemBuildsQueue,projectName:T,showError:f}):F?(0,t.jsxs)("div",{className:"flex flex-col gap-2 p-6",children:[(0,t.jsx)(o.Text,{size:16,weight:600,children:"Default Route Missing"}),(0,t.jsxs)(o.Text,{className:"text-[var(--geist-secondary)]",children:[(0,t.jsx)(d.Link,{href:V,underline:!0,children:"Set the default route"})," ","for this microfrontend to screenshot the correct path. The default route is used anywhere that the microfrontend domain is referenced for this project."," ",(0,t.jsx)(d.Link,{external:!0,href:"/docs/microfrontends/managing-microfrontends#set-a-default-route",tab:!0,type:"highlight",children:"Learn More"})]})]}):v&&a?.url?(0,t.jsx)(d.Link,{"aria-label":"Visit Deployment",href:p||(0,x.withDefaultRoute)((0,b.domainToUrl)(A?a.url:en(a,M)),a.defaultRoute),...U,onClick:e=>{R?.(e),O?.(e),u.analytics.track(c.AnalyticsEvent.DEPLOYMENT_OVERVIEW_CLICKED_SCREENSHOT,{projectId:a.projectId||M?.projectId,deploymentId:a.id,deploymentTarget:a.target})},style:{width:"100%"},tab:!0,children:(0,t.jsx)(K,{deployment:W,onScreenshotFailed:Y,placeholder:h,withReachable:!0,...y})}):(0,t.jsx)(K,{deployment:W,onScreenshotFailed:()=>(0,t.jsx)(Z,{deploy:{...W,status:"FAILED"},isInConcurrentBuildsQueue:a?.isInConcurrentBuildsQueue,isInSystemBuildsQueue:a?.isInSystemBuildsQueue,projectName:T,showError:f}),placeholder:h,withReachable:!0,...y}),[H,W,a,v,M,y,_,z,G,f,A,Y,h,T,R]);return(0,t.jsx)("div",{className:(0,r.clsx)("geist-ratio","size-full p-0","border border-solid border-[var(--ds-gray-400)]","rounded-[var(--geist-radius)]","flex flex-none justify-center","overflow-hidden","aspect-[640/400]",{"w-screen max-w-full":z,"bg-[var(--ds-background-200)]":W?.status==="CANCELED"||W?.status==="QUEUED"||W?.status==="FROZEN"||W?.status==="FAILED",group:!C,"border-[var(--ds-red-500)]":q,"border-[var(--ds-amber-400)]":G,"min-w-[108px]":W?.status==="NO_PRODUCTION","border-0":S,"rounded-none":w}),style:{"--ratio":"62.5%"},children:J})}function et(e){let{onClick:n,enabled:r,reasonWhyStartBuildingNowIsDisabled:i}=e;return void 0!==i?(0,t.jsx)(s.Tooltip,{position:"right",style:{alignItems:"center",flex:"1",justifyContent:"center",width:"100%"},text:i,children:(0,t.jsx)(a.Button,{disabled:!0,size:"small",style:{alignItems:"center",flex:"1",justifyContent:"center"},children:"Start Building Now"})}):(0,t.jsx)(a.Button,{disabled:!r,onClick:n,size:"small",type:"default",children:"Start Building Now"})}function en(e,t){let n=t?.name||e.url;return!n||(0,v.default)(n)?e.url:n}}}]);

//# sourceMappingURL=4967c28d91f9ecee.js.map
//# debugId=4989e561-a7f4-56b1-9983-3b43e38bdb2a
